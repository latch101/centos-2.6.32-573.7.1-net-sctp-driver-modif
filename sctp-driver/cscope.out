cscope 15 $HOME/workspace_rivu/master_idc2/sctp-driver               0000927072
	@associola.c

51 
	~<lšux/ty³s.h
>

52 
	~<lšux/fú.h
>

53 
	~<lšux/pŞl.h
>

54 
	~<lšux/š™.h
>

56 
	~<lšux/¦ab.h
>

57 
	~<lšux/š.h
>

58 
	~<Ãt/v6.h
>

59 
	~<Ãt/sùp/sùp.h
>

60 
	~<Ãt/sùp/sm.h
>

63 
sùp_assoc_bh_rcv
(
wÜk_¡ruù
 *
wÜk
);

64 
sùp_assoc_ä“_ascÚf_acks
(
sùp_assocŸtiÚ
 *
asoc
);

65 
sùp_assoc_ä“_ascÚf_queue
(
sùp_assocŸtiÚ
 *
asoc
);

71 
u32
 
	gidr_low
 = 1;

77 
sùp_assocŸtiÚ
 *
	$sùp_assocŸtiÚ_š™
(
sùp_assocŸtiÚ
 *
asoc
,

78 cÚ¡ 
sùp_’dpošt
 *
•
,

79 cÚ¡ 
sock
 *
sk
,

80 
sùp_scİe_t
 
scİe
,

81 
gå_t
 
gå
)

83 
sùp_sock
 *
¥
;

84 
i
;

85 
sùp_·¿mhdr_t
 *
p
;

86 
”r
;

89 
¥
 = 
	`sùp_sk
((
sock
 *)
sk
);

92 
asoc
->
•
 = (
sùp_’dpošt
 *)ep;

93 
	`sùp_’dpošt_hŞd
(
asoc
->
•
);

96 
asoc
->
ba£
.
sk
 = (
sock
 *)sk;

97 
	`sock_hŞd
(
asoc
->
ba£
.
sk
);

100 
asoc
->
ba£
.
ty³
 = 
SCTP_EP_TYPE_ASSOCIATION
;

103 
	`©omic_£t
(&
asoc
->
ba£
.
»fút
, 1);

104 
asoc
->
ba£
.
d—d
 = 0;

105 
asoc
->
ba£
.
m®loûd
 = 0;

108 
	`sùp_bšd_addr_š™
(&
asoc
->
ba£
.
bšd_addr
, 
•
->ba£.bšd_addr.
pÜt
);

110 
asoc
->
¡©e
 = 
SCTP_STATE_CLOSED
;

118 
asoc
->
cook›_liã
 = 
	`ktime_£t
(
¥
->
assoı¬ams
.
§soc_cook›_liã
 / 1000, (sp->assocparams.sasoc_cookie_life % 1000)*1000);

120 
asoc
->
äag_pošt
 = 0;

121 
asoc
->
u£r_äag
 = 
¥
->user_frag;

126 
asoc
->
max_»Œªs
 = 
¥
->
assoı¬ams
.
§soc_asocmaxrxt
;

127 
asoc
->
pf_»Œªs
 = 
sùp_pf_»Œªs
;

129 
asoc
->
¹o_š™Ÿl
 = 
	`m£cs_to_jiff›s
(
¥
->
¹ošfo
.
¤to_š™Ÿl
);

130 
asoc
->
¹o_max
 = 
	`m£cs_to_jiff›s
(
¥
->
¹ošfo
.
¤to_max
);

131 
asoc
->
¹o_mš
 = 
	`m£cs_to_jiff›s
(
¥
->
¹ošfo
.
¤to_mš
);

133 
asoc
->
ov”®l_”rÜ_couÁ
 = 0;

138 
asoc
->
hbš‹rv®
 = 
	`m£cs_to_jiff›s
(
¥
->hbinterval);

141 
asoc
->
·thmaxrxt
 = 
¥
->pathmaxrxt;

144 
asoc
->
·thmtu
 = 
¥
->pathmtu;

147 
asoc
->
§ckd–ay
 = 
	`m£cs_to_jiff›s
(
¥
->sackdelay);

148 
asoc
->
§ckäeq
 = 
¥
->sackfreq;

153 
asoc
->
·¿m_æags
 = 
¥
->param_flags;

158 
asoc
->
max_bur¡
 = 
¥
->max_burst;

161 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_NONE
] = 0;

162 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T1_COOKIE
] =‡soc->
¹o_š™Ÿl
;

163 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T1_INIT
] =‡soc->
¹o_š™Ÿl
;

164 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
] =‡soc->
¹o_š™Ÿl
;

165 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T3_RTX
] = 0;

166 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T4_RTO
] = 0;

172 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
]

173 ğ5 * 
asoc
->
¹o_max
;

175 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_HEARTBEAT
] = 0;

176 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_SACK
] =‡soc->
§ckd–ay
;

177 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_AUTOCLOSE
] =

178 ()
¥
->
autoşo£
 * 
HZ
;

181 
i
 = 
SCTP_EVENT_TIMEOUT_NONE
; i < 
SCTP_NUM_TIMEOUT_TYPES
; ++i)

182 
	`£tup_tim”
(&
asoc
->
tim”s
[
i
], 
sùp_tim”_ev’ts
[i],

183 ()
asoc
);

189 
asoc
->
c
.
sš™_max_š¡»ams
 = 
¥
->
š™msg
.sinit_max_instreams;

190 
asoc
->
c
.
sš™_num_o¡»ams
 = 
¥
->
š™msg
.sinit_num_ostreams;

191 
asoc
->
max_š™_©‹m±s
 = 
¥
->
š™msg
.
sš™_max_©‹m±s
;

193 
asoc
->
max_š™_timeo
 =

194 
	`m£cs_to_jiff›s
(
¥
->
š™msg
.
sš™_max_š™_timeo
);

199 
asoc
->
s¢m­
 = 
NULL
;

206 ià((
sk
->
sk_rcvbuf
/2è< 
SCTP_DEFAULT_MINWINDOW
)

207 
asoc
->
rwnd
 = 
SCTP_DEFAULT_MINWINDOW
;

209 
asoc
->
rwnd
 = 
sk
->
sk_rcvbuf
/2;

211 
asoc
->
a_rwnd
 =‡soc->
rwnd
;

213 
asoc
->
rwnd_ov”
 = 0;

214 
asoc
->
rwnd_´ess
 = 0;

217 
asoc
->
³”
.
rwnd
 = 
SCTP_DEFAULT_MAXWINDOW
;

220 
asoc
->
¢dbuf_u£d
 = 0;

223 
	`©omic_£t
(&
asoc
->
rmem_®loc
, 0);

225 
	`š™_wa™queue_h—d
(&
asoc
->
wa™
);

227 
asoc
->
c
.
my_vg
 = 
	`sùp_g’”©e_g
(
•
);

228 
asoc
->
³”
.
i
.
š™_g
 = 0;

229 
asoc
->
c
.
³”_vg
 = 0;

230 
asoc
->
c
.
my_‰ag
 = 0;

231 
asoc
->
c
.
³”_‰ag
 = 0;

232 
asoc
->
c
.
my_pÜt
 = 
•
->
ba£
.
bšd_addr
.
pÜt
;

234 
asoc
->
c
.
š™Ÿl_t¢
 = 
	`sùp_g’”©e_t¢
(
•
);

236 
asoc
->
Ãxt_t¢
 =‡soc->
c
.
š™Ÿl_t¢
;

238 
asoc
->
ù¢_ack_pošt
 =‡soc->
Ãxt_t¢
 - 1;

239 
asoc
->
adv_³”_ack_pošt
 =‡soc->
ù¢_ack_pošt
;

240 
asoc
->
highe¡_§cked
 =‡soc->
ù¢_ack_pošt
;

241 
asoc
->
Ï¡_cwr_t¢
 =‡soc->
ù¢_ack_pošt
;

242 
asoc
->
uÇck_d©a
 = 0;

254 
asoc
->
add_£rŸl
 =‡soc->
c
.
š™Ÿl_t¢
;

256 
	`INIT_LIST_HEAD
(&
asoc
->
add_chunk_li¡
);

257 
	`INIT_LIST_HEAD
(&
asoc
->
ascÚf_ack_li¡
);

260 
	`INIT_LIST_HEAD
(&
asoc
->
³”
.
Œª¥Üt_addr_li¡
);

261 
asoc
->
³”
.
Œª¥Üt_couÁ
 = 0;

274 
asoc
->
³”
.
§ck_Ãeded
 = 1;

275 
asoc
->
³”
.
§ck_út
 = 0;

276 
asoc
->
³”
.
§ck_g’”©iÚ
 = 1;

283 
asoc
->
³”
.
ascÚf_ÿ·bË
 = 0;

284 ià(
sùp_add_nßuth
)

285 
asoc
->
³”
.
ascÚf_ÿ·bË
 = 1;

288 
	`sùp_šq_š™
(&
asoc
->
ba£
.
šqueue
);

289 
	`sùp_šq_£t_th_hªdËr
(&
asoc
->
ba£
.
šqueue
, 
sùp_assoc_bh_rcv
);

292 
	`sùp_outq_š™
(
asoc
, &asoc->
outqueue
);

294 ià(!
	`sùp_uÍq_š™
(&
asoc
->
uÍq
,‡soc))

295 
ç_š™
;

297 
	`mem£t
(&
asoc
->
³”
.
t¢_m­
, 0, (
sùp_t¢m­
));

299 
asoc
->
Ãed_eúe
 = 0;

301 
asoc
->
assoc_id
 = 0;

306 
asoc
->
³”
.
v4_add»ss
 = 1;

307 ià(
asoc
->
ba£
.
sk
->
sk_çmy
 =ğ
PF_INET6
)

308 
asoc
->
³”
.
v6_add»ss
 = 1;

309 
	`INIT_LIST_HEAD
(&
asoc
->
asocs
);

311 
asoc
->
autoşo£
 = 
¥
->autoclose;

313 
asoc
->
deçuÉ_¡»am
 = 
¥
->default_stream;

314 
asoc
->
deçuÉ_µid
 = 
¥
->default_ppid;

315 
asoc
->
deçuÉ_æags
 = 
¥
->default_flags;

316 
asoc
->
deçuÉ_cÚ‹xt
 = 
¥
->default_context;

317 
asoc
->
deçuÉ_tim‘Şive
 = 
¥
->default_timetolive;

318 
asoc
->
deçuÉ_rcv_cÚ‹xt
 = 
¥
->default_rcv_context;

321 
	`INIT_LIST_HEAD
(&
asoc
->
’dpošt_sh¬ed_keys
);

322 
”r
 = 
	`sùp_auth_asoc_cİy_shkeys
(
•
, 
asoc
, 
gå
);

323 ià(
”r
)

324 
ç_š™
;

326 
asoc
->
aùive_key_id
 = 
•
->active_key_id;

327 
asoc
->
asoc_sh¬ed_key
 = 
NULL
;

329 
asoc
->
deçuÉ_hmac_id
 = 0;

331 ià(
•
->
auth_hmacs_li¡
)

332 
	`memıy
(
asoc
->
c
.
auth_hmacs
, 
•
->
auth_hmacs_li¡
,

333 
	`Áohs
(
•
->
auth_hmacs_li¡
->
·¿m_hdr
.
Ëngth
));

334 ià(
•
->
auth_chunk_li¡
)

335 
	`memıy
(
asoc
->
c
.
auth_chunks
, 
•
->
auth_chunk_li¡
,

336 
	`Áohs
(
•
->
auth_chunk_li¡
->
·¿m_hdr
.
Ëngth
));

339 
p
 = (
sùp_·¿mhdr_t
 *)
asoc
->
c
.
auth_¿ndom
;

340 
p
->
ty³
 = 
SCTP_PARAM_RANDOM
;

341 
p
->
Ëngth
 = 
	`htÚs
((
sùp_·¿mhdr_t
è+ 
SCTP_AUTH_RANDOM_LENGTH
);

342 
	`g‘_¿ndom_by‹s
(
p
+1, 
SCTP_AUTH_RANDOM_LENGTH
);

344  
asoc
;

346 
ç_š™
:

347 
	`sùp_’dpošt_put
(
asoc
->
•
);

348 
	`sock_put
(
asoc
->
ba£
.
sk
);

349  
NULL
;

350 
	}
}

353 
sùp_assocŸtiÚ
 *
	$sùp_assocŸtiÚ_Ãw
(cÚ¡ 
sùp_’dpošt
 *
•
,

354 cÚ¡ 
sock
 *
sk
,

355 
sùp_scİe_t
 
scİe
,

356 
gå_t
 
gå
)

358 
sùp_assocŸtiÚ
 *
asoc
;

360 
asoc
 = 
	`t_Ãw
(
sùp_assocŸtiÚ
, 
gå
);

361 ià(!
asoc
)

362 
ç
;

364 ià(!
	`sùp_assocŸtiÚ_š™
(
asoc
, 
•
, 
sk
, 
scİe
, 
gå
))

365 
ç_š™
;

367 
asoc
->
ba£
.
m®loûd
 = 1;

368 
	`SCTP_DBG_OBJCNT_INC
(
assoc
);

369 
	`SCTP_DEBUG_PRINTK
("C»©ed‡soø%p\n", 
asoc
);

371  
asoc
;

373 
ç_š™
:

374 
	`kä“
(
asoc
);

375 
ç
:

376  
NULL
;

377 
	}
}

382 
	$sùp_assocŸtiÚ_ä“
(
sùp_assocŸtiÚ
 *
asoc
)

384 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

385 
sùp_Œª¥Üt
 *
Œª¥Üt
;

386 
li¡_h—d
 *
pos
, *
‹mp
;

387 
i
;

392 ià(!
asoc
->
‹mp
) {

393 
	`li¡_d–
(&
asoc
->
asocs
);

398 ià(
	`sùp_¡yË
(
sk
, 
TCP
è&& 
	`sùp_s¡©e
(sk, 
LISTENING
))

399 
sk
->
sk_ack_backlog
--;

405 
asoc
->
ba£
.
d—d
 = 1;

408 
	`sùp_outq_ä“
(&
asoc
->
outqueue
);

411 
	`sùp_uÍq_ä“
(&
asoc
->
uÍq
);

414 
	`sùp_šq_ä“
(&
asoc
->
ba£
.
šqueue
);

416 
	`sùp_t¢m­_ä“
(&
asoc
->
³”
.
t¢_m­
);

419 
	`sùp_s¢m­_ä“
(
asoc
->
s¢m­
);

422 
	`sùp_bšd_addr_ä“
(&
asoc
->
ba£
.
bšd_addr
);

429 
i
 = 
SCTP_EVENT_TIMEOUT_NONE
; i < 
SCTP_NUM_TIMEOUT_TYPES
; ++i) {

430 ià(
	`tim”_³ndšg
(&
asoc
->
tim”s
[
i
]) &&

431 
	`d–_tim”
(&
asoc
->
tim”s
[
i
]))

432 
	`sùp_assocŸtiÚ_put
(
asoc
);

436 
	`kä“
(
asoc
->
³”
.
cook›
);

437 
	`kä“
(
asoc
->
³”
.
³”_¿ndom
);

438 
	`kä“
(
asoc
->
³”
.
³”_chunks
);

439 
	`kä“
(
asoc
->
³”
.
³”_hmacs
);

442 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
) {

443 
Œª¥Üt
 = 
	`li¡_’Œy
(
pos
, 
sùp_Œª¥Üt
, 
Œª¥Üts
);

444 
	`li¡_d–_rcu
(
pos
);

445 
	`sùp_Œª¥Üt_ä“
(
Œª¥Üt
);

448 
asoc
->
³”
.
Œª¥Üt_couÁ
 = 0;

450 
	`sùp_ascÚf_queue_‹¬down
(
asoc
);

453 
	`sùp_auth_de¡roy_keys
(&
asoc
->
’dpošt_sh¬ed_keys
);

456 
	`sùp_auth_key_put
(
asoc
->
asoc_sh¬ed_key
);

458 
	`sùp_assocŸtiÚ_put
(
asoc
);

459 
	}
}

462 
	$sùp_assocŸtiÚ_de¡roy
(
sùp_assocŸtiÚ
 *
asoc
)

464 
	`SCTP_ASSERT
(
asoc
->
ba£
.
d—d
, "Assoc is‚ot dead", );

466 
	`sùp_’dpošt_put
(
asoc
->
•
);

467 
	`sock_put
(
asoc
->
ba£
.
sk
);

469 ià(
asoc
->
assoc_id
 !ğ0 && !asoc->
bkup_£t
)

471 
	`¥š_lock_bh
(&
sùp_assocs_id_lock
);

472 
	`idr_»move
(&
sùp_assocs_id
, 
asoc
->
assoc_id
);

473 
	`¥š_uÆock_bh
(&
sùp_assocs_id_lock
);

476 
	`WARN_ON
(
	`©omic_»ad
(&
asoc
->
rmem_®loc
));

478 ià(
asoc
->
ba£
.
m®loûd
) {

479 
	`kä“
(
asoc
);

480 
	`SCTP_DBG_OBJCNT_DEC
(
assoc
);

482 
	}
}

485 
	$sùp_assoc_£t_´im¬y
(
sùp_assocŸtiÚ
 *
asoc
,

486 
sùp_Œª¥Üt
 *
Œª¥Üt
)

488 
chªgeov”
 = 0;

493 ià(
asoc
->
³”
.
´im¬y_·th
 !ğ
NULL
 &&

494 
asoc
->
³”
.
´im¬y_·th
 !ğ
Œª¥Üt
)

495 
chªgeov”
 = 1 ;

497 
asoc
->
³”
.
´im¬y_·th
 = 
Œª¥Üt
;

500 
	`memıy
(&
asoc
->
³”
.
´im¬y_addr
, &
Œª¥Üt
->
addr
,

501 (
sùp_addr
));

506 ià((
Œª¥Üt
->
¡©e
 =ğ
SCTP_ACTIVE
) ||

507 (
Œª¥Üt
->
¡©e
 =ğ
SCTP_UNKNOWN
))

508 
asoc
->
³”
.
aùive_·th
 = 
Œª¥Üt
;

524 ià(!
asoc
->
outqueue
.
out¡ªdšg_by‹s
 && !asoc->outqueue.
out_qËn
)

527 ià(
Œª¥Üt
->
ÿcc
.
chªgeov”_aùive
)

528 
Œª¥Üt
->
ÿcc
.
cyşšg_chªgeov”
 = 
chªgeov”
;

533 
Œª¥Üt
->
ÿcc
.
chªgeov”_aùive
 = 
chªgeov”
;

538 
Œª¥Üt
->
ÿcc
.
Ãxt_t¢_©_chªge
 = 
asoc
->
Ãxt_t¢
;

539 
	}
}

542 
	$sùp_assoc_rm_³”
(
sùp_assocŸtiÚ
 *
asoc
,

543 
sùp_Œª¥Üt
 *
³”
)

545 
li¡_h—d
 *
pos
;

546 
sùp_Œª¥Üt
 *
Œª¥Üt
;

548 
	`SCTP_DEBUG_PRINTK_IPADDR
("sctp_assoc_rm_peer:association %p‡ddr: ",

550 
asoc
,

551 (&
³”
->
addr
),

552 
	`Áohs
(
³”
->
addr
.
v4
.
sš_pÜt
));

557 ià(
asoc
->
³”
.
»Œª_·th
 ==…eer)

558 
	`sùp_assoc_upd©e_»Œª_·th
(
asoc
);

561 
	`li¡_d–_rcu
(&
³”
->
Œª¥Üts
);

564 
pos
 = 
asoc
->
³”
.
Œª¥Üt_addr_li¡
.
Ãxt
;

565 
Œª¥Üt
 = 
	`li¡_’Œy
(
pos
, 
sùp_Œª¥Üt
, 
Œª¥Üts
);

568 ià(
asoc
->
³”
.
´im¬y_·th
 ==…eer)

569 
	`sùp_assoc_£t_´im¬y
(
asoc
, 
Œª¥Üt
);

570 ià(
asoc
->
³”
.
aùive_·th
 ==…eer)

571 
asoc
->
³”
.
aùive_·th
 = 
Œª¥Üt
;

572 ià(
asoc
->
³”
.
»Œª_·th
 ==…eer)

573 
asoc
->
³”
.
»Œª_·th
 = 
Œª¥Üt
;

574 ià(
asoc
->
³”
.
Ï¡_d©a_äom
 ==…eer)

575 
asoc
->
³”
.
Ï¡_d©a_äom
 = 
Œª¥Üt
;

582 ià(
asoc
->
š™_Ï¡_£Á_to
 =ğ
³”
)

583 
asoc
->
š™_Ï¡_£Á_to
 = 
NULL
;

590 ià(
asoc
->
shutdown_Ï¡_£Á_to
 =ğ
³”
)

591 
asoc
->
shutdown_Ï¡_£Á_to
 = 
NULL
;

596 ià(
asoc
->
add_Ï¡_ascÚf
 &&

597 
asoc
->
add_Ï¡_ascÚf
->
Œª¥Üt
 =ğ
³”
)

598 
asoc
->
add_Ï¡_ascÚf
->
Œª¥Üt
 = 
NULL
;

603 ià(!
	`li¡_em±y
(&
³”
->
Œªsm™‹d
)) {

604 
sùp_Œª¥Üt
 *
aùive
 = 
asoc
->
³”
.
aùive_·th
;

605 
sùp_chunk
 *
ch
;

608 
	`li¡_fÜ_—ch_’Œy
(
ch
, &
³”
->
Œªsm™‹d
,

609 
Œªsm™‹d_li¡
) {

610 
ch
->
Œª¥Üt
 = 
NULL
;

611 
ch
->
¹t_š_´og»ss
 = 0;

614 
	`li¡_¥liû__š™
(&
³”
->
Œªsm™‹d
,

615 &
aùive
->
Œªsm™‹d
);

621 ià(!
	`tim”_³ndšg
(&
aùive
->
T3_¹x_tim”
))

622 ià(!
	`mod_tim”
(&
aùive
->
T3_¹x_tim”
,

623 
jiff›s
 + 
aùive
->
¹o
))

624 
	`sùp_Œª¥Üt_hŞd
(
aùive
);

627 
asoc
->
³”
.
Œª¥Üt_couÁ
--;

629 
	`sùp_Œª¥Üt_ä“
(
³”
);

630 
	}
}

633 
sùp_Œª¥Üt
 *
	$sùp_assoc_add_³”
(
sùp_assocŸtiÚ
 *
asoc
,

634 cÚ¡ 
sùp_addr
 *
addr
,

635 cÚ¡ 
gå_t
 
gå
,

636 cÚ¡ 
³”_¡©e
)

638 
sùp_Œª¥Üt
 *
³”
;

639 
sùp_sock
 *
¥
;

640 
pÜt
;

642 
¥
 = 
	`sùp_sk
(
asoc
->
ba£
.
sk
);

645 
pÜt
 = 
	`Áohs
(
addr
->
v4
.
sš_pÜt
);

647 
	`SCTP_DEBUG_PRINTK_IPADDR
("sctp_assoc_add_peer:association %p‡ddr: ",

649 
asoc
,

650 
addr
,

651 
pÜt
,

652 
³”_¡©e
);

655 ià(0 =ğ
asoc
->
³”
.
pÜt
)

656 
asoc
->
³”
.
pÜt
 =…ort;

659 
³”
 = 
	`sùp_assoc_lookup_·ddr
(
asoc
, 
addr
);

660 ià(
³”
) {

665 ià(
³”
->
¡©e
 =ğ
SCTP_UNKNOWN
) {

666 
³”
->
¡©e
 = 
SCTP_ACTIVE
;

668  
³”
;

671 
³”
 = 
	`sùp_Œª¥Üt_Ãw
(
addr
, 
gå
);

672 ià(!
³”
)

673  
NULL
;

675 
	`sùp_Œª¥Üt_£t_owÃr
(
³”
, 
asoc
);

680 
³”
->
hbš‹rv®
 = 
asoc
->hbinterval;

683 
³”
->
·thmaxrxt
 = 
asoc
->pathmaxrxt;

686 
³”
->
pf_»Œªs
 = 
asoc
->pf_retrans;

691 
³”
->
§ckd–ay
 = 
asoc
->sackdelay;

692 
³”
->
§ckäeq
 = 
asoc
->sackfreq;

697 
³”
->
·¿m_æags
 = 
asoc
->param_flags;

699 
	`sùp_Œª¥Üt_rou‹
(
³”
, 
NULL
, 
¥
);

702 ià(
³”
->
·¿m_æags
 & 
SPP_PMTUD_DISABLE
) {

703 ià(
asoc
->
·thmtu
)

704 
³”
->
·thmtu
 = 
asoc
->pathmtu;

706 
³”
->
·thmtu
 = 
SCTP_DEFAULT_MAXSEGMENT
;

714 ià(
asoc
->
·thmtu
)

715 
asoc
->
·thmtu
 = 
	`mš_t
(, 
³”
->pathmtu,‡soc->pathmtu);

717 
asoc
->
·thmtu
 = 
³”
->pathmtu;

719 
	`SCTP_DEBUG_PRINTK
("sctp_assoc_add_peer:association %p PMTU seto "

720 "%d\n", 
asoc
,‡soc->
·thmtu
);

721 
³”
->
pmtu_³ndšg
 = 0;

723 
asoc
->
äag_pošt
 = 
	`sùp_äag_pošt
×soc,‡soc->
·thmtu
);

728 
	`sùp_·ck‘_š™
(&
³”
->
·ck‘
,…“r, 
asoc
->
ba£
.
bšd_addr
.
pÜt
,

729 
asoc
->
³”
.
pÜt
);

741 
³”
->
cwnd
 = 
	`mš
(4*
asoc
->
·thmtu
, 
	`max_t
(
__u32
, 2*asoc->pathmtu, 4380));

747 
³”
->
s¡h»sh
 = 
SCTP_DEFAULT_MAXWINDOW
;

749 
³”
->
·¹Ÿl_by‹s_acked
 = 0;

750 
³”
->
æight_size
 = 0;

751 
³”
->
bur¡_lim™ed
 = 0;

754 
³”
->
¹o
 = 
asoc
->
¹o_š™Ÿl
;

757 
³”
->
¡©e
 = 
³”_¡©e
;

760 
	`li¡_add__rcu
(&
³”
->
Œª¥Üts
, &
asoc
->³”.
Œª¥Üt_addr_li¡
);

761 
asoc
->
³”
.
Œª¥Üt_couÁ
++;

764 ià(!
asoc
->
³”
.
´im¬y_·th
) {

765 
	`sùp_assoc_£t_´im¬y
(
asoc
, 
³”
);

766 
asoc
->
³”
.
»Œª_·th
 =…eer;

769 ià(
asoc
->
³”
.
aùive_·th
 =ğasoc->³”.
»Œª_·th
 &&

770 
³”
->
¡©e
 !ğ
SCTP_UNCONFIRMED
) {

771 
asoc
->
³”
.
»Œª_·th
 =…eer;

774  
³”
;

775 
	}
}

778 
	$sùp_assoc_d–_³”
(
sùp_assocŸtiÚ
 *
asoc
,

779 cÚ¡ 
sùp_addr
 *
addr
)

781 
li¡_h—d
 *
pos
;

782 
li¡_h—d
 *
‹mp
;

783 
sùp_Œª¥Üt
 *
Œª¥Üt
;

785 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
) {

786 
Œª¥Üt
 = 
	`li¡_’Œy
(
pos
, 
sùp_Œª¥Üt
, 
Œª¥Üts
);

787 ià(
	`sùp_cmp_addr_exaù
(
addr
, &
Œª¥Üt
->
addr
)) {

789 
	`sùp_assoc_rm_³”
(
asoc
, 
Œª¥Üt
);

793 
	}
}

796 
sùp_Œª¥Üt
 *
	$sùp_assoc_lookup_·ddr
(

797 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

798 cÚ¡ 
sùp_addr
 *
add»ss
)

800 
sùp_Œª¥Üt
 *
t
;

804 
	`li¡_fÜ_—ch_’Œy
(
t
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

805 
Œª¥Üts
) {

806 ià(
	`sùp_cmp_addr_exaù
(
add»ss
, &
t
->
addr
))

807  
t
;

810  
NULL
;

811 
	}
}

814 
	$sùp_assoc_d–_nÚ´im¬y_³”s
(
sùp_assocŸtiÚ
 *
asoc
,

815 
sùp_Œª¥Üt
 *
´im¬y
)

817 
sùp_Œª¥Üt
 *
‹mp
;

818 
sùp_Œª¥Üt
 *
t
;

820 
	`li¡_fÜ_—ch_’Œy_§ã
(
t
, 
‹mp
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

821 
Œª¥Üts
) {

823 ià(
t
 !ğ
´im¬y
)

824 
	`sùp_assoc_rm_³”
(
asoc
, 
t
);

828 
	}
}

834 
	$sùp_assoc_cÚŒŞ_Œª¥Üt
(
sùp_assocŸtiÚ
 *
asoc
,

835 
sùp_Œª¥Üt
 *
Œª¥Üt
,

836 
sùp_Œª¥Üt_cmd_t
 
commªd
,

837 
sùp_¢_”rÜ_t
 
”rÜ
)

839 
sùp_Œª¥Üt
 *
t
 = 
NULL
;

840 
sùp_Œª¥Üt
 *
fœ¡
;

841 
sùp_Œª¥Üt
 *
£cÚd
;

842 
sùp_uÍev’t
 *
ev’t
;

843 
sockaddr_¡Üage
 
addr
;

844 
¥c_¡©e
 = 0;

845 
boŞ
 
uÍ_nÙify
 = 
Œue
;

848 
commªd
) {

849 
SCTP_TRANSPORT_UP
:

854 ià(
SCTP_UNCONFIRMED
 =ğ
Œª¥Üt
->
¡©e
 &&

855 
SCTP_HEARTBEAT_SUCCESS
 =ğ
”rÜ
)

856 
¥c_¡©e
 = 
SCTP_ADDR_CONFIRMED
;

858 
¥c_¡©e
 = 
SCTP_ADDR_AVAILABLE
;

863 ià(
Œª¥Üt
->
¡©e
 =ğ
SCTP_PF
) {

864 
uÍ_nÙify
 = 
çl£
;

865 
Œª¥Üt
->
cwnd
 = 1;

867 
Œª¥Üt
->
¡©e
 = 
SCTP_ACTIVE
;

870 
SCTP_TRANSPORT_DOWN
:

875 ià(
Œª¥Üt
->
¡©e
 !ğ
SCTP_UNCONFIRMED
)

876 
Œª¥Üt
->
¡©e
 = 
SCTP_INACTIVE
;

878 
	`d¡_»Ëa£
(
Œª¥Üt
->
d¡
);

879 
Œª¥Üt
->
d¡
 = 
NULL
;

882 
¥c_¡©e
 = 
SCTP_ADDR_UNREACHABLE
;

885 
SCTP_TRANSPORT_PF
:

886 
Œª¥Üt
->
¡©e
 = 
SCTP_PF
;

887 
uÍ_nÙify
 = 
çl£
;

897 ià(
uÍ_nÙify
) {

898 
	`mem£t
(&
addr
, 0, (
sockaddr_¡Üage
));

899 
	`memıy
(&
addr
, &
Œª¥Üt
->
addr
,

900 
Œª¥Üt
->
af_¥ecific
->
sockaddr_Ën
);

901 
ev’t
 = 
	`sùp_uÍev’t_make_³”_addr_chªge
(
asoc
, &
addr
,

902 0, 
¥c_¡©e
, 
”rÜ
, 
GFP_ATOMIC
);

903 ià(
ev’t
)

904 
	`sùp_uÍq__ev’t
(&
asoc
->
uÍq
, 
ev’t
);

915 
fœ¡
 = 
NULL
; 
£cÚd
 = NULL;

917 
	`li¡_fÜ_—ch_’Œy
(
t
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

918 
Œª¥Üts
) {

920 ià((
t
->
¡©e
 =ğ
SCTP_INACTIVE
) ||

921 (
t
->
¡©e
 =ğ
SCTP_UNCONFIRMED
) ||

922 (
t
->
¡©e
 =ğ
SCTP_PF
))

924 ià(!
fœ¡
 || 
t
->
Ï¡_time_h—rd
.
tv64
 > first->last_time_heard.tv64) {

925 
£cÚd
 = 
fœ¡
;

926 
fœ¡
 = 
t
;

928 ià(!
£cÚd
 || 
t
->
Ï¡_time_h—rd
.
tv64
 > second->last_time_heard.tv64)

929 
£cÚd
 = 
t
;

942 ià(((
asoc
->
³”
.
´im¬y_·th
->
¡©e
 =ğ
SCTP_ACTIVE
) ||

943 (
asoc
->
³”
.
´im¬y_·th
->
¡©e
 =ğ
SCTP_UNKNOWN
)) &&

944 
fœ¡
 !ğ
asoc
->
³”
.
´im¬y_·th
) {

945 
£cÚd
 = 
fœ¡
;

946 
fœ¡
 = 
asoc
->
³”
.
´im¬y_·th
;

952 ià(!
fœ¡
) {

953 
fœ¡
 = 
asoc
->
³”
.
´im¬y_·th
;

954 
£cÚd
 = 
asoc
->
³”
.
´im¬y_·th
;

958 
asoc
->
³”
.
aùive_·th
 = 
fœ¡
;

959 
asoc
->
³”
.
»Œª_·th
 = 
£cÚd
;

960 
	}
}

963 
	$sùp_assocŸtiÚ_hŞd
(
sùp_assocŸtiÚ
 *
asoc
)

965 
	`©omic_šc
(&
asoc
->
ba£
.
»fút
);

966 
	}
}

971 
	$sùp_assocŸtiÚ_put
(
sùp_assocŸtiÚ
 *
asoc
)

973 ià(
	`©omic_dec_ªd_‹¡
(&
asoc
->
ba£
.
»fút
))

974 
	`sùp_assocŸtiÚ_de¡roy
(
asoc
);

975 
	}
}

980 
__u32
 
	$sùp_assocŸtiÚ_g‘_Ãxt_t¢
(
sùp_assocŸtiÚ
 *
asoc
)

987 
__u32
 
»tv®
 = 
asoc
->
Ãxt_t¢
;

988 
asoc
->
Ãxt_t¢
++;

989 
asoc
->
uÇck_d©a
++;

991  
»tv®
;

992 
	}
}

997 
	$sùp_cmp_addr_exaù
(cÚ¡ 
sùp_addr
 *
ss1
,

998 cÚ¡ 
sùp_addr
 *
ss2
)

1000 
sùp_af
 *
af
;

1002 
af
 = 
	`sùp_g‘_af_¥ecific
(
ss1
->
§
.
§_çmy
);

1003 ià(
	`uÆik–y
(!
af
))

1006  
af
->
	`cmp_addr
(
ss1
, 
ss2
);

1007 
	}
}

1013 
sùp_chunk
 *
	$sùp_g‘_eúe_´•’d
(
sùp_assocŸtiÚ
 *
asoc
)

1015 
sùp_chunk
 *
chunk
;

1020 ià(
asoc
->
Ãed_eúe
)

1021 
chunk
 = 
	`sùp_make_eúe
(
asoc
,‡soc->
Ï¡_eúe_t¢
);

1023 
chunk
 = 
NULL
;

1025  
chunk
;

1026 
	}
}

1031 
sùp_Œª¥Üt
 *
	$sùp_assoc_lookup_t¢
(
sùp_assocŸtiÚ
 *
asoc
,

1032 
__u32
 
t¢
)

1034 
sùp_Œª¥Üt
 *
aùive
;

1035 
sùp_Œª¥Üt
 *
m©ch
;

1036 
sùp_Œª¥Üt
 *
Œª¥Üt
;

1037 
sùp_chunk
 *
chunk
;

1038 
__be32
 
key
 = 
	`htÚl
(
t¢
);

1040 
m©ch
 = 
NULL
;

1057 
aùive
 = 
asoc
->
³”
.
aùive_·th
;

1059 
	`li¡_fÜ_—ch_’Œy
(
chunk
, &
aùive
->
Œªsm™‹d
,

1060 
Œªsm™‹d_li¡
) {

1062 ià(
key
 =ğ
chunk
->
subh
.
d©a_hdr
->
t¢
) {

1063 
m©ch
 = 
aùive
;

1064 
out
;

1069 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

1070 
Œª¥Üts
) {

1072 ià(
Œª¥Üt
 =ğ
aùive
)

1074 
	`li¡_fÜ_—ch_’Œy
(
chunk
, &
Œª¥Üt
->
Œªsm™‹d
,

1075 
Œªsm™‹d_li¡
) {

1076 ià(
key
 =ğ
chunk
->
subh
.
d©a_hdr
->
t¢
) {

1077 
m©ch
 = 
Œª¥Üt
;

1078 
out
;

1082 
out
:

1083  
m©ch
;

1084 
	}
}

1087 
sùp_Œª¥Üt
 *
	$sùp_assoc_is_m©ch
(
sùp_assocŸtiÚ
 *
asoc
,

1088 cÚ¡ 
sùp_addr
 *
Ïddr
,

1089 cÚ¡ 
sùp_addr
 *
·ddr
)

1091 
sùp_Œª¥Üt
 *
Œª¥Üt
;

1093 ià((
	`htÚs
(
asoc
->
ba£
.
bšd_addr
.
pÜt
è=ğ
Ïddr
->
v4
.
sš_pÜt
) &&

1094 (
	`htÚs
(
asoc
->
³”
.
pÜt
è=ğ
·ddr
->
v4
.
sš_pÜt
)) {

1095 
Œª¥Üt
 = 
	`sùp_assoc_lookup_·ddr
(
asoc
, 
·ddr
);

1096 ià(!
Œª¥Üt
)

1097 
out
;

1099 ià(
	`sùp_bšd_addr_m©ch
(&
asoc
->
ba£
.
bšd_addr
, 
Ïddr
,

1100 
	`sùp_sk
(
asoc
->
ba£
.
sk
)))

1101 
out
;

1103 
Œª¥Üt
 = 
NULL
;

1105 
out
:

1106  
Œª¥Üt
;

1107 
	}
}

1110 
	$sùp_assoc_bh_rcv
(
wÜk_¡ruù
 *
wÜk
)

1112 
sùp_assocŸtiÚ
 *
asoc
 =

1113 
	`cÚš”_of
(
wÜk
, 
sùp_assocŸtiÚ
,

1114 
ba£
.
šqueue
.
immedŸ‹
);

1115 
sùp_’dpošt
 *
•
;

1116 
sùp_chunk
 *
chunk
;

1117 
sock
 *
sk
;

1118 
sùp_šq
 *
šqueue
;

1119 
¡©e
;

1120 
sùp_subty³_t
 
subty³
;

1121 
”rÜ
 = 0;

1124 
•
 = 
asoc
->ep;

1125 
sk
 = 
asoc
->
ba£
.sk;

1127 
šqueue
 = &
asoc
->
ba£
.inqueue;

1128 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

1129 
NULL
 !ğ(
chunk
 = 
	`sùp_šq_pİ
(
šqueue
))) {

1130 
¡©e
 = 
asoc
->state;

1131 
subty³
 = 
	`SCTP_ST_CHUNK
(
chunk
->
chunk_hdr
->
ty³
);

1140 ià(
	`sùp_auth_»cv_cid
(
subty³
.
chunk
, 
asoc
è&& !chunk->
auth
)

1146 ià(
	`sùp_chunk_is_d©a
(
chunk
))

1147 
asoc
->
³”
.
Ï¡_d©a_äom
 = 
chunk
->
Œª¥Üt
;

1149 
	`SCTP_INC_STATS
(
SCTP_MIB_INCTRLCHUNKS
);

1151 ià(
chunk
->
Œª¥Üt
)

1152 
chunk
->
Œª¥Üt
->
Ï¡_time_h—rd
.
tv64
 = 
jiff›s
;

1155 
”rÜ
 = 
	`sùp_do_sm
(
SCTP_EVENT_T_CHUNK
, 
subty³
,

1156 
¡©e
, 
•
, 
asoc
, 
chunk
, 
GFP_ATOMIC
);

1161 ià(
asoc
->
ba£
.
d—d
)

1165 ià(
”rÜ
 && 
chunk
)

1166 
chunk
->
pdisÿrd
 = 1;

1168 
	`sùp_assocŸtiÚ_put
(
asoc
);

1169 
	}
}

1172 
	$sùp_assoc_mig¿‹
(
sùp_assocŸtiÚ
 *
assoc
, 
sock
 *
Ãwsk
)

1174 
sùp_sock
 *
Ãw¥
 = 
	`sùp_sk
(
Ãwsk
);

1175 
sock
 *
Şdsk
 = 
assoc
->
ba£
.
sk
;

1180 
	`li¡_d–_š™
(&
assoc
->
asocs
);

1183 ià(
	`sùp_¡yË
(
Şdsk
, 
TCP
))

1184 
Şdsk
->
sk_ack_backlog
--;

1187 
	`sùp_’dpošt_put
(
assoc
->
•
);

1188 
	`sock_put
(
assoc
->
ba£
.
sk
);

1191 
assoc
->
•
 = 
Ãw¥
->ep;

1192 
	`sùp_’dpošt_hŞd
(
assoc
->
•
);

1195 
assoc
->
ba£
.
sk
 = 
Ãwsk
;

1196 
	`sock_hŞd
(
assoc
->
ba£
.
sk
);

1199 
	`sùp_’dpošt_add_asoc
(
Ãw¥
->
•
, 
assoc
);

1200 
	}
}

1203 
	$sùp_assoc_upd©e
(
sùp_assocŸtiÚ
 *
asoc
,

1204 
sùp_assocŸtiÚ
 *
Ãw
)

1206 
sùp_Œª¥Üt
 *
Œªs
;

1207 
li¡_h—d
 *
pos
, *
‹mp
;

1210 
asoc
->
c
 = 
Ãw
->c;

1211 
asoc
->
³”
.
rwnd
 = 
Ãw
->peer.rwnd;

1212 
asoc
->
³”
.
§ck_Ãeded
 = 
Ãw
->peer.sack_needed;

1213 
asoc
->
³”
.
i
 = 
Ãw
->peer.i;

1214 
	`sùp_t¢m­_š™
(&
asoc
->
³”
.
t¢_m­
, 
SCTP_TSN_MAP_INITIAL
,

1215 
asoc
->
³”
.
i
.
š™Ÿl_t¢
, 
GFP_ATOMIC
);

1218 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
) {

1219 
Œªs
 = 
	`li¡_’Œy
(
pos
, 
sùp_Œª¥Üt
, 
Œª¥Üts
);

1220 ià(!
	`sùp_assoc_lookup_·ddr
(
Ãw
, &
Œªs
->
addr
)) {

1221 
	`sùp_assoc_rm_³”
(
asoc
, 
Œªs
);

1225 ià(
asoc
->
¡©e
 >ğ
SCTP_STATE_ESTABLISHED
)

1226 
	`sùp_Œª¥Üt_»£t
(
Œªs
);

1234 ià(
asoc
->
¡©e
 >ğ
SCTP_STATE_ESTABLISHED
) {

1235 
asoc
->
Ãxt_t¢
 = 
Ãw
->next_tsn;

1236 
asoc
->
ù¢_ack_pošt
 = 
Ãw
->ctsn_ack_point;

1237 
asoc
->
adv_³”_ack_pošt
 = 
Ãw
->adv_peer_ack_point;

1242 
	`sùp_s¢m­_ş—r
(
asoc
->
s¢m­
);

1248 
	`sùp_uÍq_æush
(&
asoc
->
uÍq
);

1254 
asoc
->
ov”®l_”rÜ_couÁ
 = 0;

1258 
	`li¡_fÜ_—ch_’Œy
(
Œªs
, &
Ãw
->
³”
.
Œª¥Üt_addr_li¡
,

1259 
Œª¥Üts
) {

1260 ià(!
	`sùp_assoc_lookup_·ddr
(
asoc
, &
Œªs
->
addr
))

1261 
	`sùp_assoc_add_³”
(
asoc
, &
Œªs
->
addr
,

1262 
GFP_ATOMIC
, 
Œªs
->
¡©e
);

1265 
asoc
->
ù¢_ack_pošt
 =‡soc->
Ãxt_t¢
 - 1;

1266 
asoc
->
adv_³”_ack_pošt
 =‡soc->
ù¢_ack_pošt
;

1267 ià(!
asoc
->
s¢m­
) {

1269 
asoc
->
s¢m­
 = 
Ãw
->ssnmap;

1270 
Ãw
->
s¢m­
 = 
NULL
;

1273 ià(!
asoc
->
assoc_id
) {

1277 
	`sùp_assoc_£t_id
(
asoc
, 
GFP_ATOMIC
);

1284 
	`kä“
(
asoc
->
³”
.
³”_¿ndom
);

1285 
asoc
->
³”
.
³”_¿ndom
 = 
Ãw
->peer.peer_random;

1286 
Ãw
->
³”
.
³”_¿ndom
 = 
NULL
;

1288 
	`kä“
(
asoc
->
³”
.
³”_chunks
);

1289 
asoc
->
³”
.
³”_chunks
 = 
Ãw
->peer.peer_chunks;

1290 
Ãw
->
³”
.
³”_chunks
 = 
NULL
;

1292 
	`kä“
(
asoc
->
³”
.
³”_hmacs
);

1293 
asoc
->
³”
.
³”_hmacs
 = 
Ãw
->peer.peer_hmacs;

1294 
Ãw
->
³”
.
³”_hmacs
 = 
NULL
;

1296 
	`sùp_auth_key_put
(
asoc
->
asoc_sh¬ed_key
);

1297 
	`sùp_auth_asoc_š™_aùive_key
(
asoc
, 
GFP_ATOMIC
);

1298 
	}
}

1305 
	$sùp_assoc_upd©e_»Œª_·th
(
sùp_assocŸtiÚ
 *
asoc
)

1307 
sùp_Œª¥Üt
 *
t
, *
Ãxt
;

1308 
li¡_h—d
 *
h—d
 = &
asoc
->
³”
.
Œª¥Üt_addr_li¡
;

1309 
li¡_h—d
 *
pos
;

1311 ià(
asoc
->
³”
.
Œª¥Üt_couÁ
 == 1)

1315 
t
 = 
asoc
->
³”
.
»Œª_·th
;

1316 
pos
 = &
t
->
Œª¥Üts
;

1317 
Ãxt
 = 
NULL
;

1321 ià(
pos
->
Ãxt
 =ğ
h—d
)

1322 
pos
 = 
h—d
->
Ãxt
;

1324 
pos
 =…os->
Ãxt
;

1326 
t
 = 
	`li¡_’Œy
(
pos
, 
sùp_Œª¥Üt
, 
Œª¥Üts
);

1332 ià(
t
 =ğ
asoc
->
³”
.
»Œª_·th
) {

1333 
t
 = 
Ãxt
;

1339 ià((
t
->
¡©e
 =ğ
SCTP_ACTIVE
) ||

1340 (
t
->
¡©e
 =ğ
SCTP_UNKNOWN
)) {

1346 ià(
t
->
¡©e
 !ğ
SCTP_UNCONFIRMED
 && !
Ãxt
)

1347 
Ãxt
 = 
t
;

1351 ià(
t
)

1352 
asoc
->
³”
.
»Œª_·th
 = 
t
;

1354 
t
 = 
asoc
->
³”
.
»Œª_·th
;

1356 
	`SCTP_DEBUG_PRINTK_IPADDR
("sctp_assoc_update_retran_path:association"

1359 
asoc
,

1360 (&
t
->
addr
),

1361 
	`Áohs
(
t
->
addr
.
v4
.
sš_pÜt
));

1362 
	}
}

1365 
sùp_Œª¥Üt
 *
	$sùp_assoc_choo£_®‹r_Œª¥Üt
(

1366 
sùp_assocŸtiÚ
 *
asoc
, 
sùp_Œª¥Üt
 *
Ï¡_£Á_to
)

1372 ià(!
Ï¡_£Á_to
)

1373  
asoc
->
³”
.
aùive_·th
;

1375 ià(
Ï¡_£Á_to
 =ğ
asoc
->
³”
.
»Œª_·th
)

1376 
	`sùp_assoc_upd©e_»Œª_·th
(
asoc
);

1377  
asoc
->
³”
.
»Œª_·th
;

1379 
	}
}

1384 
	$sùp_assoc_sync_pmtu
(
sùp_assocŸtiÚ
 *
asoc
)

1386 
sùp_Œª¥Üt
 *
t
;

1387 
__u32
 
pmtu
 = 0;

1389 ià(!
asoc
)

1393 
	`li¡_fÜ_—ch_’Œy
(
t
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

1394 
Œª¥Üts
) {

1395 ià(
t
->
pmtu_³ndšg
 &&->
d¡
) {

1396 
	`sùp_Œª¥Üt_upd©e_pmtu
(
t
, 
	`d¡_mtu
Ñ->
d¡
));

1397 
t
->
pmtu_³ndšg
 = 0;

1399 ià(!
pmtu
 || (
t
->
·thmtu
 <…mtu))

1400 
pmtu
 = 
t
->
·thmtu
;

1403 ià(
pmtu
) {

1404 
asoc
->
·thmtu
 = 
pmtu
;

1405 
asoc
->
äag_pošt
 = 
	`sùp_äag_pošt
×soc, 
pmtu
);

1408 
	`SCTP_DEBUG_PRINTK
("%s:‡soc:%p,…mtu:%d, frag_point:%d\n",

1409 
__func__
, 
asoc
,‡soc->
·thmtu
,‡soc->
äag_pošt
);

1410 
	}
}

1413 
šlše
 
	$sùp_³”_Ãeds_upd©e
(
sùp_assocŸtiÚ
 *
asoc
)

1415 
asoc
->
¡©e
) {

1416 
SCTP_STATE_ESTABLISHED
:

1417 
SCTP_STATE_SHUTDOWN_PENDING
:

1418 
SCTP_STATE_SHUTDOWN_RECEIVED
:

1419 
SCTP_STATE_SHUTDOWN_SENT
:

1420 ià((
asoc
->
rwnd
 >‡soc->
a_rwnd
) &&

1421 ((
asoc
->
rwnd
 -‡soc->
a_rwnd
è>ğ
	`max_t
(
__u32
,

1422 (
asoc
->
ba£
.
sk
->
sk_rcvbuf
 >> 
sùp_rwnd_upd_shiá
),

1423 
asoc
->
·thmtu
)))

1430 
	}
}

1433 
	$sùp_assoc_rwnd_šü—£
(
sùp_assocŸtiÚ
 *
asoc
, 
Ën
)

1435 
sùp_chunk
 *
§ck
;

1436 
tim”_li¡
 *
tim”
;

1438 ià(
asoc
->
rwnd_ov”
) {

1439 ià(
asoc
->
rwnd_ov”
 >ğ
Ën
) {

1440 
asoc
->
rwnd_ov”
 -ğ
Ën
;

1442 
asoc
->
rwnd
 +ğ(
Ën
 -‡soc->
rwnd_ov”
);

1443 
asoc
->
rwnd_ov”
 = 0;

1446 
asoc
->
rwnd
 +ğ
Ën
;

1454 ià(
asoc
->
rwnd_´ess
 &&‡soc->
rwnd
 >=‡soc->rwnd_press) {

1455 
chªge
 = 
	`mš
(
asoc
->
·thmtu
,‡soc->
rwnd_´ess
);

1456 
asoc
->
rwnd
 +ğ
chªge
;

1457 
asoc
->
rwnd_´ess
 -ğ
chªge
;

1460 
	`SCTP_DEBUG_PRINTK
("%s:‡soc %p„wnd increased by %do (%u, %u) "

1461 "- %u\n", 
__func__
, 
asoc
, 
Ën
,‡soc->
rwnd
,

1462 
asoc
->
rwnd_ov”
,‡soc->
a_rwnd
);

1469 ià(
	`sùp_³”_Ãeds_upd©e
(
asoc
)) {

1470 
asoc
->
a_rwnd
 =‡soc->
rwnd
;

1471 
	`SCTP_DEBUG_PRINTK
("%s: Sending window update SACK-‡soc: %p "

1472 "rwnd: %u‡_rwnd: %u\n", 
__func__
,

1473 
asoc
,‡soc->
rwnd
,‡soc->
a_rwnd
);

1474 
§ck
 = 
	`sùp_make_§ck
(
asoc
);

1475 ià(!
§ck
)

1478 
asoc
->
³”
.
§ck_Ãeded
 = 0;

1480 
	`sùp_outq_
(&
asoc
->
outqueue
, 
§ck
);

1483 
tim”
 = &
asoc
->
tim”s
[
SCTP_EVENT_TIMEOUT_SACK
];

1484 ià(
	`tim”_³ndšg
(
tim”
è&& 
	`d–_tim”
(timer))

1485 
	`sùp_assocŸtiÚ_put
(
asoc
);

1487 
	}
}

1490 
	$sùp_assoc_rwnd_deü—£
(
sùp_assocŸtiÚ
 *
asoc
, 
Ën
)

1492 
rx_couÁ
;

1493 
ov”
 = 0;

1495 
	`SCTP_ASSERT
(
asoc
->
rwnd
, "rwnd zero", );

1496 
	`SCTP_ASSERT
(!
asoc
->
rwnd_ov”
, "rwnd_over‚ot zero", );

1498 ià(
asoc
->
•
->
rcvbuf_pŞicy
)

1499 
rx_couÁ
 = 
	`©omic_»ad
(&
asoc
->
rmem_®loc
);

1501 
rx_couÁ
 = 
	`©omic_»ad
(&
asoc
->
ba£
.
sk
->
sk_rmem_®loc
);

1508 ià(
rx_couÁ
 >ğ
asoc
->
ba£
.
sk
->
sk_rcvbuf
)

1509 
ov”
 = 1;

1511 ià(
asoc
->
rwnd
 >ğ
Ën
) {

1512 
asoc
->
rwnd
 -ğ
Ën
;

1513 ià(
ov”
) {

1514 
asoc
->
rwnd_´ess
 +ğasoc->
rwnd
;

1515 
asoc
->
rwnd
 = 0;

1518 
asoc
->
rwnd_ov”
 = 
Ën
 -‡soc->
rwnd
;

1519 
asoc
->
rwnd
 = 0;

1521 
	`SCTP_DEBUG_PRINTK
("%s:‡soc %p„wnd decreased by %do (%u, %u, %u)\n",

1522 
__func__
, 
asoc
, 
Ën
,‡soc->
rwnd
,

1523 
asoc
->
rwnd_ov”
,‡soc->
rwnd_´ess
);

1524 
	}
}

1529 
	$sùp_assoc_£t_bšd_addr_äom_•
(
sùp_assocŸtiÚ
 *
asoc
,

1530 
sùp_scİe_t
 
scİe
, 
gå_t
 
gå
)

1532 
æags
;

1537 
æags
 = (
PF_INET6
 =ğ
asoc
->
ba£
.
sk
->
sk_çmy
è? 
SCTP_ADDR6_ALLOWED
 : 0;

1538 ià(
asoc
->
³”
.
v4_add»ss
)

1539 
æags
 |ğ
SCTP_ADDR4_PEERSUPP
;

1540 ià(
asoc
->
³”
.
v6_add»ss
)

1541 
æags
 |ğ
SCTP_ADDR6_PEERSUPP
;

1543  
	`sùp_bšd_addr_cİy
(&
asoc
->
ba£
.
bšd_addr
,

1544 &
asoc
->
•
->
ba£
.
bšd_addr
,

1545 
scİe
, 
gå
, 
æags
);

1546 
	}
}

1549 
	$sùp_assoc_£t_bšd_addr_äom_cook›
(
sùp_assocŸtiÚ
 *
asoc
,

1550 
sùp_cook›
 *
cook›
,

1551 
gå_t
 
gå
)

1553 
v¬_size2
 = 
	`Áohs
(
cook›
->
³”_š™
->
chunk_hdr
.
Ëngth
);

1554 
v¬_size3
 = 
cook›
->
¿w_addr_li¡_Ën
;

1555 
__u8
 *
¿w
 = (__u8 *)
cook›
->
³”_š™
 + 
v¬_size2
;

1557  
	`sùp_¿w_to_bšd_addrs
(&
asoc
->
ba£
.
bšd_addr
, 
¿w
, 
v¬_size3
,

1558 
asoc
->
•
->
ba£
.
bšd_addr
.
pÜt
, 
gå
);

1559 
	}
}

1562 
	$sùp_assoc_lookup_Ïddr
(
sùp_assocŸtiÚ
 *
asoc
,

1563 cÚ¡ 
sùp_addr
 *
Ïddr
)

1565 
found
 = 0;

1567 ià((
asoc
->
ba£
.
bšd_addr
.
pÜt
 =ğ
	`Áohs
(
Ïddr
->
v4
.
sš_pÜt
)) &&

1568 
	`sùp_bšd_addr_m©ch
(&
asoc
->
ba£
.
bšd_addr
, 
Ïddr
,

1569 
	`sùp_sk
(
asoc
->
ba£
.
sk
)))

1570 
found
 = 1;

1572  
found
;

1573 
	}
}

1576 
	$sùp_assoc_£t_id
(
sùp_assocŸtiÚ
 *
asoc
, 
gå_t
 
gå
)

1578 
assoc_id
;

1579 
”rÜ
 = 0;

1582 ià(
asoc
->
assoc_id
)

1583  
”rÜ
;

1584 
»Œy
:

1585 ià(
	`uÆik–y
(!
	`idr_´e_g‘
(&
sùp_assocs_id
, 
gå
)))

1586  -
ENOMEM
;

1588 
	`¥š_lock_bh
(&
sùp_assocs_id_lock
);

1589 
”rÜ
 = 
	`idr_g‘_Ãw_above
(&
sùp_assocs_id
, (*)
asoc
,

1590 
idr_low
, &
assoc_id
);

1591 ià(!
”rÜ
) {

1592 
idr_low
 = 
assoc_id
 + 1;

1593 ià(
idr_low
 =ğ
INT_MAX
)

1594 
idr_low
 = 1;

1596 
	`¥š_uÆock_bh
(&
sùp_assocs_id_lock
);

1597 ià(
”rÜ
 =ğ-
EAGAIN
)

1598 
»Œy
;

1599 ià(
”rÜ
)

1600  
”rÜ
;

1602 
asoc
->
assoc_id
 = (
sùp_assoc_t
)‡ssoc_id;

1603  
”rÜ
;

1604 
	}
}

1607 
	$sùp_assoc_ä“_ascÚf_queue
(
sùp_assocŸtiÚ
 *
asoc
)

1609 
sùp_chunk
 *
ascÚf
;

1610 
sùp_chunk
 *
tmp
;

1612 
	`li¡_fÜ_—ch_’Œy_§ã
(
ascÚf
, 
tmp
, &
asoc
->
add_chunk_li¡
, 
li¡
) {

1613 
	`li¡_d–_š™
(&
ascÚf
->
li¡
);

1614 
	`sùp_chunk_ä“
(
ascÚf
);

1616 
	}
}

1619 
	$sùp_assoc_ä“_ascÚf_acks
(
sùp_assocŸtiÚ
 *
asoc
)

1621 
sùp_chunk
 *
ack
;

1622 
sùp_chunk
 *
tmp
;

1624 
	`li¡_fÜ_—ch_’Œy_§ã
(
ack
, 
tmp
, &
asoc
->
ascÚf_ack_li¡
,

1625 
Œªsm™‹d_li¡
) {

1626 
	`li¡_d–_š™
(&
ack
->
Œªsm™‹d_li¡
);

1627 
	`sùp_chunk_ä“
(
ack
);

1629 
	}
}

1632 
	$sùp_assoc_ş—n_ascÚf_ack_ÿche
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

1634 
sùp_chunk
 *
ack
;

1635 
sùp_chunk
 *
tmp
;

1640 
	`li¡_fÜ_—ch_’Œy_§ã
(
ack
, 
tmp
, &
asoc
->
ascÚf_ack_li¡
,

1641 
Œªsm™‹d_li¡
) {

1642 ià(
ack
->
subh
.
add_hdr
->
£rŸl
 ==

1643 
	`htÚl
(
asoc
->
³”
.
add_£rŸl
))

1646 
	`li¡_d–_š™
(&
ack
->
Œªsm™‹d_li¡
);

1647 
	`sùp_chunk_ä“
(
ack
);

1649 
	}
}

1652 
sùp_chunk
 *
	$sùp_assoc_lookup_ascÚf_ack
(

1653 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1654 
__be32
 
£rŸl
)

1656 
sùp_chunk
 *
ack
;

1661 
	`li¡_fÜ_—ch_’Œy
(
ack
, &
asoc
->
ascÚf_ack_li¡
, 
Œªsm™‹d_li¡
) {

1662 ià(
ack
->
subh
.
add_hdr
->
£rŸl
 == serial) {

1663 
	`sùp_chunk_hŞd
(
ack
);

1664  
ack
;

1668  
NULL
;

1669 
	}
}

1671 
	$sùp_ascÚf_queue_‹¬down
(
sùp_assocŸtiÚ
 *
asoc
)

1674 
	`sùp_assoc_ä“_ascÚf_acks
(
asoc
);

1677 
	`sùp_assoc_ä“_ascÚf_queue
(
asoc
);

1680 ià(
asoc
->
add_Ï¡_ascÚf
)

1681 
	`sùp_chunk_ä“
(
asoc
->
add_Ï¡_ascÚf
);

1682 
	}
}

	@auth.c

37 
	~<lšux/ty³s.h
>

38 
	~<lšux/üy±o.h
>

39 
	~<lšux/sÿ‰”li¡.h
>

40 
	~<Ãt/sùp/sùp.h
>

41 
	~<Ãt/sùp/auth.h
>

43 
sùp_hmac
 
	gsùp_hmac_li¡
[
SCTP_AUTH_NUM_HMACS
] = {

46 .
hmac_id
 = 
SCTP_AUTH_HMAC_ID_RESERVED_0
,

49 .
	ghmac_id
 = 
SCTP_AUTH_HMAC_ID_SHA1
,

50 .
	ghmac_Çme
="hmac(sha1)",

51 .
	ghmac_Ën
 = 
SCTP_SHA1_SIG_SIZE
,

55 .
	ghmac_id
 = 
SCTP_AUTH_HMAC_ID_RESERVED_2
,

57 #ià
defšed
 (
CONFIG_CRYPTO_SHA256
è|| defšed (
CONFIG_CRYPTO_SHA256_MODULE
)

59 .
	ghmac_id
 = 
SCTP_AUTH_HMAC_ID_SHA256
,

60 .
	ghmac_Çme
="hmac(sha256)",

61 .
	ghmac_Ën
 = 
SCTP_SHA256_SIG_SIZE
,

67 
	$sùp_auth_key_put
(
sùp_auth_by‹s
 *
key
)

69 ià(!
key
)

72 ià(
	`©omic_dec_ªd_‹¡
(&
key
->
»fút
)) {

73 
	`kä“
(
key
);

74 
	`SCTP_DBG_OBJCNT_DEC
(
keys
);

76 
	}
}

79 
sùp_auth_by‹s
 *
	$sùp_auth_ü—‹_key
(
__u32
 
key_Ën
, 
gå_t
 
gå
)

81 
sùp_auth_by‹s
 *
key
;

84 ià((
INT_MAX
 - 
key_Ën
è< (
sùp_auth_by‹s
))

85  
NULL
;

88 
key
 = 
	`km®loc
((
sùp_auth_by‹s
è+ 
key_Ën
, 
gå
);

89 ià(!
key
)

90  
NULL
;

92 
key
->
Ën
 = 
key_Ën
;

93 
	`©omic_£t
(&
key
->
»fút
, 1);

94 
	`SCTP_DBG_OBJCNT_INC
(
keys
);

96  
key
;

97 
	}
}

100 
sùp_sh¬ed_key
 *
	$sùp_auth_shkey_ü—‹
(
__u16
 
key_id
, 
gå_t
 
gå
)

102 
sùp_sh¬ed_key
 *
Ãw
;

105 
Ãw
 = 
	`kz®loc
((
sùp_sh¬ed_key
), 
gå
);

106 ià(!
Ãw
)

107  
NULL
;

109 
	`INIT_LIST_HEAD
(&
Ãw
->
key_li¡
);

110 
Ãw
->
key_id
 = key_id;

112  
Ãw
;

113 
	}
}

116 
	$sùp_auth_shkey_ä“
(
sùp_sh¬ed_key
 *
sh_key
)

118 
	`BUG_ON
(!
	`li¡_em±y
(&
sh_key
->
key_li¡
));

119 
	`sùp_auth_key_put
(
sh_key
->
key
);

120 
sh_key
->
key
 = 
NULL
;

121 
	`kä“
(
sh_key
);

122 
	}
}

127 
	$sùp_auth_de¡roy_keys
(
li¡_h—d
 *
keys
)

129 
sùp_sh¬ed_key
 *
•_key
;

130 
sùp_sh¬ed_key
 *
tmp
;

132 ià(
	`li¡_em±y
(
keys
))

135 
	`key_fÜ_—ch_§ã
(
•_key
, 
tmp
, 
keys
) {

136 
	`li¡_d–_š™
(&
•_key
->
key_li¡
);

137 
	`sùp_auth_shkey_ä“
(
•_key
);

139 
	}
}

157 
	$sùp_auth_com·»_veùÜs
(
sùp_auth_by‹s
 *
veùÜ1
,

158 
sùp_auth_by‹s
 *
veùÜ2
)

160 
diff
;

161 
i
;

162 cÚ¡ 
__u8
 *
lÚg”
;

164 
diff
 = 
veùÜ1
->
Ën
 - 
veùÜ2
->len;

165 ià(
diff
) {

166 
lÚg”
 = (
diff
 > 0è? 
veùÜ1
->
d©a
 : 
veùÜ2
->data;

172 
i
 = 0; i < 
	`abs
(
diff
); i++ ) {

173 ià(
lÚg”
[
i
] != 0)

174  
diff
;

179  
	`memcmp
(
veùÜ1
->
d©a
, 
veùÜ2
->d©a, veùÜ1->
Ën
);

180 
	}
}

193 
sùp_auth_by‹s
 *
	$sùp_auth_make_key_veùÜ
(

194 
sùp_¿ndom_·¿m_t
 *
¿ndom
,

195 
sùp_chunks_·¿m_t
 *
chunks
,

196 
sùp_hmac_®go_·¿m_t
 *
hmacs
,

197 
gå_t
 
gå
)

199 
sùp_auth_by‹s
 *
Ãw
;

200 
__u32
 
Ën
;

201 
__u32
 
off£t
 = 0;

203 
Ën
 = 
	`Áohs
(
¿ndom
->
·¿m_hdr
.
Ëngth
è+‚tohs(
hmacs
->param_hdr.length);

204 ià(
chunks
)

205 
Ën
 +ğ
	`Áohs
(
chunks
->
·¿m_hdr
.
Ëngth
);

207 
Ãw
 = 
	`km®loc
((
sùp_auth_by‹s
è+ 
Ën
, 
gå
);

208 ià(!
Ãw
)

209  
NULL
;

211 
Ãw
->
Ën
 =†en;

213 
	`memıy
(
Ãw
->
d©a
, 
¿ndom
, 
	`Áohs
Ôªdom->
·¿m_hdr
.
Ëngth
));

214 
off£t
 +ğ
	`Áohs
(
¿ndom
->
·¿m_hdr
.
Ëngth
);

216 ià(
chunks
) {

217 
	`memıy
(
Ãw
->
d©a
 + 
off£t
, 
chunks
,

218 
	`Áohs
(
chunks
->
·¿m_hdr
.
Ëngth
));

219 
off£t
 +ğ
	`Áohs
(
chunks
->
·¿m_hdr
.
Ëngth
);

222 
	`memıy
(
Ãw
->
d©a
 + 
off£t
, 
hmacs
, 
	`Áohs
(hmacs->
·¿m_hdr
.
Ëngth
));

224  
Ãw
;

225 
	}
}

229 
sùp_auth_by‹s
 *
	$sùp_auth_make_loÿl_veùÜ
(

230 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

231 
gå_t
 
gå
)

233  
	`sùp_auth_make_key_veùÜ
(

234 (
sùp_¿ndom_·¿m_t
*)
asoc
->
c
.
auth_¿ndom
,

235 (
sùp_chunks_·¿m_t
*)
asoc
->
c
.
auth_chunks
,

236 (
sùp_hmac_®go_·¿m_t
*)
asoc
->
c
.
auth_hmacs
,

237 
gå
);

238 
	}
}

241 
sùp_auth_by‹s
 *
	$sùp_auth_make_³”_veùÜ
(

242 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

243 
gå_t
 
gå
)

245  
	`sùp_auth_make_key_veùÜ
(
asoc
->
³”
.
³”_¿ndom
,

246 
asoc
->
³”
.
³”_chunks
,

247 
asoc
->
³”
.
³”_hmacs
,

248 
gå
);

249 
	}
}

261 
sùp_auth_by‹s
 *
	$sùp_auth_asoc_£t_£ü‘
(

262 
sùp_sh¬ed_key
 *
•_key
,

263 
sùp_auth_by‹s
 *
fœ¡_veùÜ
,

264 
sùp_auth_by‹s
 *
Ï¡_veùÜ
,

265 
gå_t
 
gå
)

267 
sùp_auth_by‹s
 *
£ü‘
;

268 
__u32
 
off£t
 = 0;

269 
__u32
 
auth_Ën
;

271 
auth_Ën
 = 
fœ¡_veùÜ
->
Ën
 + 
Ï¡_veùÜ
->len;

272 ià(
•_key
->
key
)

273 
auth_Ën
 +ğ
•_key
->
key
->
Ën
;

275 
£ü‘
 = 
	`sùp_auth_ü—‹_key
(
auth_Ën
, 
gå
);

276 ià(!
£ü‘
)

277  
NULL
;

279 ià(
•_key
->
key
) {

280 
	`memıy
(
£ü‘
->
d©a
, 
•_key
->
key
->d©a,ƒp_key->key->
Ën
);

281 
off£t
 +ğ
•_key
->
key
->
Ën
;

284 
	`memıy
(
£ü‘
->
d©a
 + 
off£t
, 
fœ¡_veùÜ
->d©a, fœ¡_veùÜ->
Ën
);

285 
off£t
 +ğ
fœ¡_veùÜ
->
Ën
;

287 
	`memıy
(
£ü‘
->
d©a
 + 
off£t
, 
Ï¡_veùÜ
->d©a,†a¡_veùÜ->
Ën
);

289  
£ü‘
;

290 
	}
}

295 
sùp_auth_by‹s
 *
	$sùp_auth_asoc_ü—‹_£ü‘
(

296 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

297 
sùp_sh¬ed_key
 *
•_key
,

298 
gå_t
 
gå
)

300 
sùp_auth_by‹s
 *
loÿl_key_veùÜ
;

301 
sùp_auth_by‹s
 *
³”_key_veùÜ
;

302 
sùp_auth_by‹s
 *
fœ¡_veùÜ
,

303 *
Ï¡_veùÜ
;

304 
sùp_auth_by‹s
 *
£ü‘
 = 
NULL
;

305 
cmp
;

320 
loÿl_key_veùÜ
 = 
	`sùp_auth_make_loÿl_veùÜ
(
asoc
, 
gå
);

321 
³”_key_veùÜ
 = 
	`sùp_auth_make_³”_veùÜ
(
asoc
, 
gå
);

323 ià(!
³”_key_veùÜ
 || !
loÿl_key_veùÜ
)

324 
out
;

339 
cmp
 = 
	`sùp_auth_com·»_veùÜs
(
loÿl_key_veùÜ
,

340 
³”_key_veùÜ
);

341 ià(
cmp
 < 0) {

342 
fœ¡_veùÜ
 = 
loÿl_key_veùÜ
;

343 
Ï¡_veùÜ
 = 
³”_key_veùÜ
;

345 
fœ¡_veùÜ
 = 
³”_key_veùÜ
;

346 
Ï¡_veùÜ
 = 
loÿl_key_veùÜ
;

349 
£ü‘
 = 
	`sùp_auth_asoc_£t_£ü‘
(
•_key
, 
fœ¡_veùÜ
, 
Ï¡_veùÜ
,

350 
gå
);

351 
out
:

352 
	`kä“
(
loÿl_key_veùÜ
);

353 
	`kä“
(
³”_key_veùÜ
);

355  
£ü‘
;

356 
	}
}

362 
	$sùp_auth_asoc_cİy_shkeys
(cÚ¡ 
sùp_’dpošt
 *
•
,

363 
sùp_assocŸtiÚ
 *
asoc
,

364 
gå_t
 
gå
)

366 
sùp_sh¬ed_key
 *
sh_key
;

367 
sùp_sh¬ed_key
 *
Ãw
;

369 
	`BUG_ON
(!
	`li¡_em±y
(&
asoc
->
’dpošt_sh¬ed_keys
));

371 
	`key_fÜ_—ch
(
sh_key
, &
•
->
’dpošt_sh¬ed_keys
) {

372 
Ãw
 = 
	`sùp_auth_shkey_ü—‹
(
sh_key
->
key_id
, 
gå
);

373 ià(!
Ãw
)

374 
nomem
;

376 
Ãw
->
key
 = 
sh_key
->key;

377 
	`sùp_auth_key_hŞd
(
Ãw
->
key
);

378 
	`li¡_add
(&
Ãw
->
key_li¡
, &
asoc
->
’dpošt_sh¬ed_keys
);

383 
nomem
:

384 
	`sùp_auth_de¡roy_keys
(&
asoc
->
’dpošt_sh¬ed_keys
);

385  -
ENOMEM
;

386 
	}
}

392 
	$sùp_auth_asoc_š™_aùive_key
(
sùp_assocŸtiÚ
 *
asoc
, 
gå_t
 
gå
)

394 
sùp_auth_by‹s
 *
£ü‘
;

395 
sùp_sh¬ed_key
 *
•_key
;

400 ià(!
sùp_auth_’abË
 || !
asoc
->
³”
.
auth_ÿ·bË
)

408 
•_key
 = 
	`sùp_auth_g‘_shkey
(
asoc
,‡soc->
aùive_key_id
);

409 
	`BUG_ON
(!
•_key
);

411 
£ü‘
 = 
	`sùp_auth_asoc_ü—‹_£ü‘
(
asoc
, 
•_key
, 
gå
);

412 ià(!
£ü‘
)

413  -
ENOMEM
;

415 
	`sùp_auth_key_put
(
asoc
->
asoc_sh¬ed_key
);

416 
asoc
->
asoc_sh¬ed_key
 = 
£ü‘
;

419 
	}
}

423 
sùp_sh¬ed_key
 *
	$sùp_auth_g‘_shkey
(

424 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

425 
__u16
 
key_id
)

427 
sùp_sh¬ed_key
 *
key
;

430 
	`key_fÜ_—ch
(
key
, &
asoc
->
’dpošt_sh¬ed_keys
) {

431 ià(
key
->
key_id
 == key_id)

432  
key
;

435  
NULL
;

436 
	}
}

445 
	$sùp_auth_š™_hmacs
(
sùp_’dpošt
 *
•
, 
gå_t
 
gå
)

447 
üy±o_hash
 *
tfm
 = 
NULL
;

448 
__u16
 
id
;

451 ià(!
sùp_auth_’abË
) {

452 
•
->
auth_hmacs
 = 
NULL
;

456 ià(
•
->
auth_hmacs
)

460 
•
->
auth_hmacs
 = 
	`kz®loc
(

461 (
üy±o_hash
 *è* 
SCTP_AUTH_NUM_HMACS
,

462 
gå
);

463 ià(!
•
->
auth_hmacs
)

464  -
ENOMEM
;

466 
id
 = 0; id < 
SCTP_AUTH_NUM_HMACS
; id++) {

473 ià(!
sùp_hmac_li¡
[
id
].
hmac_Çme
)

477 ià(
•
->
auth_hmacs
[
id
])

481 
tfm
 = 
	`üy±o_®loc_hash
(
sùp_hmac_li¡
[
id
].
hmac_Çme
, 0,

482 
CRYPTO_ALG_ASYNC
);

483 ià(
	`IS_ERR
(
tfm
))

484 
out_”r
;

486 
•
->
auth_hmacs
[
id
] = 
tfm
;

491 
out_”r
:

493 
	`sùp_auth_de¡roy_hmacs
(
•
->
auth_hmacs
);

494  -
ENOMEM
;

495 
	}
}

498 
	$sùp_auth_de¡roy_hmacs
(
üy±o_hash
 *
auth_hmacs
[])

500 
i
;

502 ià(!
auth_hmacs
)

505 
i
 = 0; i < 
SCTP_AUTH_NUM_HMACS
; i++)

507 ià(
auth_hmacs
[
i
])

508 
	`üy±o_ä“_hash
(
auth_hmacs
[
i
]);

510 
	`kä“
(
auth_hmacs
);

511 
	}
}

514 
sùp_hmac
 *
	$sùp_auth_g‘_hmac
(
__u16
 
hmac_id
)

516  &
sùp_hmac_li¡
[
hmac_id
];

517 
	}
}

522 
sùp_hmac
 *
	$sùp_auth_asoc_g‘_hmac
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

524 
sùp_hmac_®go_·¿m
 *
hmacs
;

525 
__u16
 
n_–t
;

526 
__u16
 
id
 = 0;

527 
i
;

530 ià(
asoc
->
deçuÉ_hmac_id
)

531  &
sùp_hmac_li¡
[
asoc
->
deçuÉ_hmac_id
];

536 
hmacs
 = 
asoc
->
³”
.
³”_hmacs
;

537 ià(!
hmacs
)

538  
NULL
;

540 
n_–t
 = (
	`Áohs
(
hmacs
->
·¿m_hdr
.
Ëngth
è- (
sùp_·¿mhdr_t
)) >> 1;

541 
i
 = 0; i < 
n_–t
; i++) {

542 
id
 = 
	`Áohs
(
hmacs
->
hmac_ids
[
i
]);

545 ià(
id
 > 
SCTP_AUTH_HMAC_ID_MAX
) {

546 
id
 = 0;

555 ià(!
sùp_hmac_li¡
[
id
].
hmac_Çme
) {

556 
id
 = 0;

563 ià(
id
 == 0)

564  
NULL
;

566  &
sùp_hmac_li¡
[
id
];

567 
	}
}

569 
	$__sùp_auth_fšd_hmacid
(
__be16
 *
hmacs
, 
n_–ts
, __be16 
hmac_id
)

571 
found
 = 0;

572 
i
;

574 
i
 = 0; i < 
n_–ts
; i++) {

575 ià(
hmac_id
 =ğ
hmacs
[
i
]) {

576 
found
 = 1;

581  
found
;

582 
	}
}

585 
	$sùp_auth_asoc_v”ify_hmac_id
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

586 
__be16
 
hmac_id
)

588 
sùp_hmac_®go_·¿m
 *
hmacs
;

589 
__u16
 
n_–t
;

591 ià(!
asoc
)

594 
hmacs
 = (
sùp_hmac_®go_·¿m
 *)
asoc
->
c
.
auth_hmacs
;

595 
n_–t
 = (
	`Áohs
(
hmacs
->
·¿m_hdr
.
Ëngth
è- (
sùp_·¿mhdr_t
)) >> 1;

597  
	`__sùp_auth_fšd_hmacid
(
hmacs
->
hmac_ids
, 
n_–t
, 
hmac_id
);

598 
	}
}

606 
	$sùp_auth_asoc_£t_deçuÉ_hmac
(
sùp_assocŸtiÚ
 *
asoc
,

607 
sùp_hmac_®go_·¿m
 *
hmacs
)

609 
sùp_’dpošt
 *
•
;

610 
__u16
 
id
;

611 
i
;

612 
n_·¿ms
;

615 ià(
asoc
->
deçuÉ_hmac_id
)

618 
n_·¿ms
 = (
	`Áohs
(
hmacs
->
·¿m_hdr
.
Ëngth
)

619 - (
sùp_·¿mhdr_t
)) >> 1;

620 
•
 = 
asoc
->ep;

621 
i
 = 0; i < 
n_·¿ms
; i++) {

622 
id
 = 
	`Áohs
(
hmacs
->
hmac_ids
[
i
]);

625 ià(
id
 > 
SCTP_AUTH_HMAC_ID_MAX
)

629 ià(
•
->
auth_hmacs
[
id
]) {

630 
asoc
->
deçuÉ_hmac_id
 = 
id
;

634 
	}
}

638 
	$__sùp_auth_cid
(
sùp_cid_t
 
chunk
, 
sùp_chunks_·¿m
 *
·¿m
)

640 
Ën
;

641 
found
 = 0;

642 
i
;

644 ià(!
·¿m
 ||…¬am->
·¿m_hdr
.
Ëngth
 == 0)

647 
Ën
 = 
	`Áohs
(
·¿m
->
·¿m_hdr
.
Ëngth
è- (
sùp_·¿mhdr_t
);

655 
i
 = 0; !
found
 && i < 
Ën
; i++) {

656 
·¿m
->
chunks
[
i
]) {

657 
SCTP_CID_INIT
:

658 
SCTP_CID_INIT_ACK
:

659 
SCTP_CID_SHUTDOWN_COMPLETE
:

660 
SCTP_CID_AUTH
:

664 ià(
·¿m
->
chunks
[
i
] =ğ
chunk
)

665 
found
 = 1;

670  
found
;

671 
	}
}

674 
	$sùp_auth_£nd_cid
(
sùp_cid_t
 
chunk
, cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

676 ià(!
sùp_auth_’abË
 || !
asoc
 || !asoc->
³”
.
auth_ÿ·bË
)

679  
	`__sùp_auth_cid
(
chunk
, 
asoc
->
³”
.
³”_chunks
);

680 
	}
}

683 
	$sùp_auth_»cv_cid
(
sùp_cid_t
 
chunk
, cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

685 ià(!
sùp_auth_’abË
 || !
asoc
)

688  
	`__sùp_auth_cid
(
chunk
,

689 (
sùp_chunks_·¿m
 *)
asoc
->
c
.
auth_chunks
);

690 
	}
}

701 
	$sùp_auth_ÿlcuÏ‹_hmac
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

702 
sk_buff
 *
skb
,

703 
sùp_auth_chunk
 *
auth
,

704 
gå_t
 
gå
)

706 
sÿ‰”li¡
 
sg
;

707 
hash_desc
 
desc
;

708 
sùp_auth_by‹s
 *
asoc_key
;

709 
__u16
 
key_id
, 
hmac_id
;

710 
__u8
 *
dige¡
;

711 *
’d
;

712 
ä“_key
 = 0;

718 
key_id
 = 
	`Áohs
(
auth
->
auth_hdr
.
shkey_id
);

719 
hmac_id
 = 
	`Áohs
(
auth
->
auth_hdr
.hmac_id);

721 ià(
key_id
 =ğ
asoc
->
aùive_key_id
)

722 
asoc_key
 = 
asoc
->
asoc_sh¬ed_key
;

724 
sùp_sh¬ed_key
 *
•_key
;

726 
•_key
 = 
	`sùp_auth_g‘_shkey
(
asoc
, 
key_id
);

727 ià(!
•_key
)

730 
asoc_key
 = 
	`sùp_auth_asoc_ü—‹_£ü‘
(
asoc
, 
•_key
, 
gå
);

731 ià(!
asoc_key
)

734 
ä“_key
 = 1;

738 
’d
 = 
	`skb__poš‹r
(
skb
);

739 
	`sg_š™_Úe
(&
sg
, 
auth
, 
’d
 - (*)auth);

741 
desc
.
tfm
 = 
asoc
->
•
->
auth_hmacs
[
hmac_id
];

742 
desc
.
æags
 = 0;

744 
dige¡
 = 
auth
->
auth_hdr
.
hmac
;

745 ià(
	`üy±o_hash_£tkey
(
desc
.
tfm
, &
asoc_key
->
d©a
[0],‡soc_key->
Ën
))

746 
ä“
;

748 
	`üy±o_hash_dige¡
(&
desc
, &
sg
, sg.
Ëngth
, 
dige¡
);

750 
ä“
:

751 ià(
ä“_key
)

752 
	`sùp_auth_key_put
(
asoc_key
);

753 
	}
}

758 
	$sùp_auth_•_add_chunkid
(
sùp_’dpošt
 *
•
, 
__u8
 
chunk_id
)

760 
sùp_chunks_·¿m
 *
p
 = 
•
->
auth_chunk_li¡
;

761 
__u16
 
nchunks
;

762 
__u16
 
·¿m_Ën
;

765 ià(
	`__sùp_auth_cid
(
chunk_id
, 
p
))

769 
·¿m_Ën
 = 
	`Áohs
(
p
->
·¿m_hdr
.
Ëngth
);

770 
nchunks
 = 
·¿m_Ën
 - (
sùp_·¿mhdr_t
);

771 ià(
nchunks
 =ğ
SCTP_NUM_CHUNK_TYPES
)

772  -
EINVAL
;

774 
p
->
chunks
[
nchunks
] = 
chunk_id
;

775 
p
->
·¿m_hdr
.
Ëngth
 = 
	`htÚs
(
·¿m_Ën
 + 1);

777 
	}
}

780 
	$sùp_auth_•_£t_hmacs
(
sùp_’dpošt
 *
•
,

781 
sùp_hmaÿlgo
 *
hmacs
)

783 
has_sha1
 = 0;

784 
__u16
 
id
;

785 
i
;

790 
i
 = 0; i < 
hmacs
->
shmac_num_id’ts
; i++) {

791 
id
 = 
hmacs
->
shmac_id’ts
[
i
];

793 ià(
id
 > 
SCTP_AUTH_HMAC_ID_MAX
)

794  -
EOPNOTSUPP
;

796 ià(
SCTP_AUTH_HMAC_ID_SHA1
 =ğ
id
)

797 
has_sha1
 = 1;

799 ià(!
sùp_hmac_li¡
[
id
].
hmac_Çme
)

800  -
EOPNOTSUPP
;

803 ià(!
has_sha1
)

804  -
EINVAL
;

806 
	`memıy
(
•
->
auth_hmacs_li¡
->
hmac_ids
, &
hmacs
->
shmac_id’ts
[0],

807 
hmacs
->
shmac_num_id’ts
 * (
__u16
));

808 
•
->
auth_hmacs_li¡
->
·¿m_hdr
.
Ëngth
 = 
	`htÚs
((
sùp_·¿mhdr_t
) +

809 
hmacs
->
shmac_num_id’ts
 * (
__u16
));

811 
	}
}

817 
	$sùp_auth_£t_key
(
sùp_’dpošt
 *
•
,

818 
sùp_assocŸtiÚ
 *
asoc
,

819 
sùp_authkey
 *
auth_key
)

821 
sùp_sh¬ed_key
 *
cur_key
 = 
NULL
;

822 
sùp_auth_by‹s
 *
key
;

823 
li¡_h—d
 *
sh_keys
;

824 
»¶aû
 = 0;

829 ià(
asoc
)

830 
sh_keys
 = &
asoc
->
’dpošt_sh¬ed_keys
;

832 
sh_keys
 = &
•
->
’dpošt_sh¬ed_keys
;

834 
	`key_fÜ_—ch
(
cur_key
, 
sh_keys
) {

835 ià(
cur_key
->
key_id
 =ğ
auth_key
->
sÿ_keynumb”
) {

836 
»¶aû
 = 1;

844 ià(!
»¶aû
) {

845 
cur_key
 = 
	`sùp_auth_shkey_ü—‹
(
auth_key
->
sÿ_keynumb”
,

846 
GFP_KERNEL
);

847 ià(!
cur_key
)

848  -
ENOMEM
;

852 
key
 = 
	`sùp_auth_ü—‹_key
(
auth_key
->
sÿ_keyËngth
, 
GFP_KERNEL
);

853 ià(!
key
)

854 
nomem
;

856 
	`memıy
(
key
->
d©a
, &
auth_key
->
sÿ_key
[0],‡uth_key->
sÿ_keyËngth
);

862 ià(
»¶aû
)

863 
	`sùp_auth_key_put
(
cur_key
->
key
);

865 
	`li¡_add
(&
cur_key
->
key_li¡
, 
sh_keys
);

867 
cur_key
->
key
 = key;

868 
	`sùp_auth_key_hŞd
(
key
);

871 
nomem
:

872 ià(!
»¶aû
)

873 
	`sùp_auth_shkey_ä“
(
cur_key
);

875  -
ENOMEM
;

876 
	}
}

878 
	$sùp_auth_£t_aùive_key
(
sùp_’dpošt
 *
•
,

879 
sùp_assocŸtiÚ
 *
asoc
,

880 
__u16
 
key_id
)

882 
sùp_sh¬ed_key
 *
key
;

883 
li¡_h—d
 *
sh_keys
;

884 
found
 = 0;

887 ià(
asoc
)

888 
sh_keys
 = &
asoc
->
’dpošt_sh¬ed_keys
;

890 
sh_keys
 = &
•
->
’dpošt_sh¬ed_keys
;

892 
	`key_fÜ_—ch
(
key
, 
sh_keys
) {

893 ià(
key
->
key_id
 == key_id) {

894 
found
 = 1;

899 ià(!
found
)

900  -
EINVAL
;

902 ià(
asoc
) {

903 
asoc
->
aùive_key_id
 = 
key_id
;

904 
	`sùp_auth_asoc_š™_aùive_key
(
asoc
, 
GFP_KERNEL
);

906 
•
->
aùive_key_id
 = 
key_id
;

909 
	}
}

911 
	$sùp_auth_d–_key_id
(
sùp_’dpošt
 *
•
,

912 
sùp_assocŸtiÚ
 *
asoc
,

913 
__u16
 
key_id
)

915 
sùp_sh¬ed_key
 *
key
;

916 
li¡_h—d
 *
sh_keys
;

917 
found
 = 0;

922 ià(
asoc
) {

923 ià(
asoc
->
aùive_key_id
 =ğ
key_id
)

924  -
EINVAL
;

926 
sh_keys
 = &
asoc
->
’dpošt_sh¬ed_keys
;

928 ià(
•
->
aùive_key_id
 =ğ
key_id
)

929  -
EINVAL
;

931 
sh_keys
 = &
•
->
’dpošt_sh¬ed_keys
;

934 
	`key_fÜ_—ch
(
key
, 
sh_keys
) {

935 ià(
key
->
key_id
 == key_id) {

936 
found
 = 1;

941 ià(!
found
)

942  -
EINVAL
;

945 
	`li¡_d–_š™
(&
key
->
key_li¡
);

946 
	`sùp_auth_shkey_ä“
(
key
);

949 
	}
}

	@auth.h

37 #iâdeà
__sùp_auth_h__


38 
	#__sùp_auth_h__


	)

40 
	~<lšux/li¡.h
>

41 
	~<lšux/üy±o.h
>

43 
	gsùp_’dpošt
;

44 
	gsùp_assocŸtiÚ
;

45 
	gsùp_authkey
;

46 
	gsùp_hmaÿlgo
;

52 
	ssùp_hmac
 {

53 
__u16
 
	mhmac_id
;

54 *
	mhmac_Çme
;

55 
__u16
 
	mhmac_Ën
;

62 
	ssùp_auth_by‹s
 {

63 
©omic_t
 
	m»fút
;

64 
__u32
 
	mËn
;

65 
__u8
 
	md©a
[];

69 
	ssùp_sh¬ed_key
 {

70 
li¡_h—d
 
	mkey_li¡
;

71 
__u16
 
	mkey_id
;

72 
sùp_auth_by‹s
 *
	mkey
;

75 
	#key_fÜ_—ch
(
__key
, 
__li¡_h—d
) \

76 
	`li¡_fÜ_—ch_’Œy
(
__key
, 
__li¡_h—d
, 
key_li¡
)

	)

78 
	#key_fÜ_—ch_§ã
(
__key
, 
__tmp
, 
__li¡_h—d
) \

79 
	`li¡_fÜ_—ch_’Œy_§ã
(
__key
, 
__tmp
, 
__li¡_h—d
, 
key_li¡
)

	)

81 
šlše
 
	$sùp_auth_key_hŞd
(
sùp_auth_by‹s
 *
key
)

83 ià(!
key
)

86 
	`©omic_šc
(&
key
->
»fút
);

87 
	}
}

89 
sùp_auth_key_put
(
sùp_auth_by‹s
 *
key
);

90 
sùp_sh¬ed_key
 *
sùp_auth_shkey_ü—‹
(
__u16
 
key_id
, 
gå_t
 
gå
);

91 
sùp_auth_de¡roy_keys
(
li¡_h—d
 *
keys
);

92 
sùp_auth_asoc_š™_aùive_key
(
sùp_assocŸtiÚ
 *
asoc
, 
gå_t
 
gå
);

93 
sùp_sh¬ed_key
 *
sùp_auth_g‘_shkey
(

94 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

95 
__u16
 
key_id
);

96 
sùp_auth_asoc_cİy_shkeys
(cÚ¡ 
sùp_’dpošt
 *
•
,

97 
sùp_assocŸtiÚ
 *
asoc
,

98 
gå_t
 
gå
);

99 
sùp_auth_š™_hmacs
(
sùp_’dpošt
 *
•
, 
gå_t
 
gå
);

100 
sùp_auth_de¡roy_hmacs
(
üy±o_hash
 *
auth_hmacs
[]);

101 
sùp_hmac
 *
sùp_auth_g‘_hmac
(
__u16
 
hmac_id
);

102 
sùp_hmac
 *
sùp_auth_asoc_g‘_hmac
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
);

103 
sùp_auth_asoc_£t_deçuÉ_hmac
(
sùp_assocŸtiÚ
 *
asoc
,

104 
sùp_hmac_®go_·¿m
 *
hmacs
);

105 
sùp_auth_asoc_v”ify_hmac_id
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

106 
__be16
 
hmac_id
);

107 
sùp_auth_£nd_cid
(
sùp_cid_t
 
chunk
, cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
);

108 
sùp_auth_»cv_cid
(
sùp_cid_t
 
chunk
, cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
);

109 
sùp_auth_ÿlcuÏ‹_hmac
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

110 
sk_buff
 *
skb
,

111 
sùp_auth_chunk
 *
auth
, 
gå_t
 
gå
);

114 
sùp_auth_•_add_chunkid
(
sùp_’dpošt
 *
•
, 
__u8
 
chunk_id
);

115 
sùp_auth_•_£t_hmacs
(
sùp_’dpošt
 *
•
,

116 
sùp_hmaÿlgo
 *
hmacs
);

117 
sùp_auth_£t_key
(
sùp_’dpošt
 *
•
,

118 
sùp_assocŸtiÚ
 *
asoc
,

119 
sùp_authkey
 *
auth_key
);

120 
sùp_auth_£t_aùive_key
(
sùp_’dpošt
 *
•
,

121 
sùp_assocŸtiÚ
 *
asoc
,

122 
__u16
 
key_id
);

123 
sùp_auth_d–_key_id
(
sùp_’dpošt
 *
•
,

124 
sùp_assocŸtiÚ
 *
asoc
,

125 
__u16
 
key_id
);

	@bind_addr.c

45 
	~<lšux/ty³s.h
>

46 
	~<lšux/š.h
>

47 
	~<Ãt/sock.h
>

48 
	~<Ãt/v6.h
>

49 
	~<Ãt/if_š‘6.h
>

50 
	~<Ãt/sùp/sùp.h
>

51 
	~<Ãt/sùp/sm.h
>

54 
sùp_cİy_Úe_addr
Ğ
sùp_bšd_addr
 *,

55 
sùp_addr
 *,

56 
sùp_scİe_t
 
scİe
,

57 
gå_t
 
gå
,

58 
æags
);

59 
sùp_bšd_addr_ş—n
(
sùp_bšd_addr
 *);

66 
	$sùp_bšd_addr_cİy
(
sùp_bšd_addr
 *
de¡
,

67 cÚ¡ 
sùp_bšd_addr
 *
¤c
,

68 
sùp_scİe_t
 
scİe
, 
gå_t
 
gå
,

69 
æags
)

71 
sùp_sockaddr_’Œy
 *
addr
;

72 
”rÜ
 = 0;

75 
de¡
->
pÜt
 = 
¤c
->port;

78 
	`li¡_fÜ_—ch_’Œy
(
addr
, &
¤c
->
add»ss_li¡
, 
li¡
) {

79 
”rÜ
 = 
	`sùp_cİy_Úe_addr
(
de¡
, &
addr
->
a
, 
scİe
,

80 
gå
, 
æags
);

81 ià(
”rÜ
 < 0)

82 
out
;

89 ià(
	`li¡_em±y
(&
de¡
->
add»ss_li¡
è&& (
SCTP_SCOPE_GLOBAL
 =ğ
scİe
)) {

90 
	`li¡_fÜ_—ch_’Œy
(
addr
, &
¤c
->
add»ss_li¡
, 
li¡
) {

91 
”rÜ
 = 
	`sùp_cİy_Úe_addr
(
de¡
, &
addr
->
a
,

92 
SCTP_SCOPE_LINK
, 
gå
,

93 
æags
);

94 ià(
”rÜ
 < 0)

95 
out
;

99 
out
:

100 ià(
”rÜ
)

101 
	`sùp_bšd_addr_ş—n
(
de¡
);

103  
”rÜ
;

104 
	}
}

111 
	$sùp_bšd_addr_dup
(
sùp_bšd_addr
 *
de¡
,

112 cÚ¡ 
sùp_bšd_addr
 *
¤c
,

113 
gå_t
 
gå
)

115 
sùp_sockaddr_’Œy
 *
addr
;

116 
”rÜ
 = 0;

119 
de¡
->
pÜt
 = 
¤c
->port;

121 
	`li¡_fÜ_—ch_’Œy
(
addr
, &
¤c
->
add»ss_li¡
, 
li¡
) {

122 
”rÜ
 = 
	`sùp_add_bšd_addr
(
de¡
, &
addr
->
a
, 1, 
gå
);

123 ià(
”rÜ
 < 0)

127  
”rÜ
;

128 
	}
}

133 
	$sùp_bšd_addr_š™
(
sùp_bšd_addr
 *
bp
, 
__u16
 
pÜt
)

135 
bp
->
m®loûd
 = 0;

137 
	`INIT_LIST_HEAD
(&
bp
->
add»ss_li¡
);

138 
bp
->
pÜt
 =…ort;

139 
	}
}

142 
	$sùp_bšd_addr_ş—n
(
sùp_bšd_addr
 *
bp
)

144 
sùp_sockaddr_’Œy
 *
addr
, *
‹mp
;

147 
	`li¡_fÜ_—ch_’Œy_§ã
(
addr
, 
‹mp
, &
bp
->
add»ss_li¡
, 
li¡
) {

148 
	`li¡_d–_rcu
(&
addr
->
li¡
);

149 
	`ÿÎ_rcu
(&
addr
->
rcu
, 
sùp_loÿl_addr_ä“
);

150 
	`SCTP_DBG_OBJCNT_DEC
(
addr
);

152 
	}
}

155 
	$sùp_bšd_addr_ä“
(
sùp_bšd_addr
 *
bp
)

158 
	`sùp_bšd_addr_ş—n
(
bp
);

160 ià(
bp
->
m®loûd
) {

161 
	`kä“
(
bp
);

162 
	`SCTP_DBG_OBJCNT_DEC
(
bšd_addr
);

164 
	}
}

167 
	$sùp_add_bšd_addr
(
sùp_bšd_addr
 *
bp
, 
sùp_addr
 *
Ãw
,

168 
__u8
 
addr_¡©e
, 
gå_t
 
gå
)

170 
sùp_sockaddr_’Œy
 *
addr
;

173 
addr
 = 
	`t_Ãw
(
sùp_sockaddr_’Œy
, 
gå
);

174 ià(!
addr
)

175  -
ENOMEM
;

177 
	`memıy
(&
addr
->
a
, 
Ãw
, (*new));

182 ià(!
addr
->
a
.
v4
.
sš_pÜt
)

183 
addr
->
a
.
v4
.
sš_pÜt
 = 
	`htÚs
(
bp
->
pÜt
);

185 
addr
->
¡©e
 = 
addr_¡©e
;

186 
addr
->
v®id
 = 1;

188 
	`INIT_LIST_HEAD
(&
addr
->
li¡
);

189 
	`INIT_RCU_HEAD
(&
addr
->
rcu
);

194 
	`li¡_add__rcu
(&
addr
->
li¡
, &
bp
->
add»ss_li¡
);

195 
	`SCTP_DBG_OBJCNT_INC
(
addr
);

198 
	}
}

203 
	$sùp_d–_bšd_addr
(
sùp_bšd_addr
 *
bp
, 
sùp_addr
 *
d–_addr
)

205 
sùp_sockaddr_’Œy
 *
addr
, *
‹mp
;

206 
found
 = 0;

211 
	`li¡_fÜ_—ch_’Œy_§ã
(
addr
, 
‹mp
, &
bp
->
add»ss_li¡
, 
li¡
) {

212 ià(
	`sùp_cmp_addr_exaù
(&
addr
->
a
, 
d–_addr
)) {

214 
found
 = 1;

215 
addr
->
v®id
 = 0;

216 
	`li¡_d–_rcu
(&
addr
->
li¡
);

221 ià(
found
) {

222 
	`ÿÎ_rcu
(&
addr
->
rcu
, 
sùp_loÿl_addr_ä“
);

223 
	`SCTP_DBG_OBJCNT_DEC
(
addr
);

227  -
EINVAL
;

228 
	}
}

235 
sùp_·¿ms
 
	$sùp_bšd_addrs_to_¿w
(cÚ¡ 
sùp_bšd_addr
 *
bp
,

236 *
addrs_Ën
,

237 
gå_t
 
gå
)

239 
sùp_·¿ms
 
add½¬ms
;

240 
sùp_·¿ms
 
»tv®
;

241 
add½¬ms_Ën
;

242 
sùp_addr_·¿m
 
¿waddr
;

243 
Ën
;

244 
sùp_sockaddr_’Œy
 *
addr
;

245 
li¡_h—d
 *
pos
;

246 
sùp_af
 *
af
;

248 
add½¬ms_Ën
 = 0;

249 
Ën
 = 0;

252 
	`li¡_fÜ_—ch
(
pos
, &
bp
->
add»ss_li¡
) {

253 
Ën
 +ğ(
sùp_addr_·¿m
);

259 ià(
Ën
 =ğ(
sùp_addr_·¿m
)) {

260 
»tv®
.
v
 = 
NULL
;

261 
’d_¿w
;

264 
»tv®
.
v
 = 
	`km®loc
(
Ën
, 
gå
);

265 ià(!
»tv®
.
v
)

266 
’d_¿w
;

268 
add½¬ms
 = 
»tv®
;

270 
	`li¡_fÜ_—ch_’Œy
(
addr
, &
bp
->
add»ss_li¡
, 
li¡
) {

271 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
a
.
v4
.
sš_çmy
);

272 
Ën
 = 
af
->
	`to_addr_·¿m
(&
addr
->
a
, &
¿waddr
);

273 
	`memıy
(
add½¬ms
.
v
, &
¿waddr
, 
Ën
);

274 
add½¬ms
.
v
 +ğ
Ën
;

275 
add½¬ms_Ën
 +ğ
Ën
;

278 
’d_¿w
:

279 *
addrs_Ën
 = 
add½¬ms_Ën
;

280  
»tv®
;

281 
	}
}

287 
	$sùp_¿w_to_bšd_addrs
(
sùp_bšd_addr
 *
bp
, 
__u8
 *
¿w_addr_li¡
,

288 
addrs_Ën
, 
__u16
 
pÜt
, 
gå_t
 
gå
)

290 
sùp_addr_·¿m
 *
¿waddr
;

291 
sùp_·¿mhdr
 *
·¿m
;

292 
sùp_addr
 
addr
;

293 
»tv®
 = 0;

294 
Ën
;

295 
sùp_af
 *
af
;

298 
addrs_Ën
) {

299 
·¿m
 = (
sùp_·¿mhdr
 *)
¿w_addr_li¡
;

300 
¿waddr
 = (
sùp_addr_·¿m
 *)
¿w_addr_li¡
;

302 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`·¿m_ty³2af
(
·¿m
->
ty³
));

303 ià(
	`uÆik–y
(!
af
)) {

304 
»tv®
 = -
EINVAL
;

305 
	`sùp_bšd_addr_ş—n
(
bp
);

309 
af
->
	`äom_addr_·¿m
(&
addr
, 
¿waddr
, 
	`htÚs
(
pÜt
), 0);

310 
»tv®
 = 
	`sùp_add_bšd_addr
(
bp
, &
addr
, 
SCTP_ADDR_SRC
, 
gå
);

311 ià(
»tv®
) {

313 
	`sùp_bšd_addr_ş—n
(
bp
);

317 
Ën
 = 
	`Áohs
(
·¿m
->
Ëngth
);

318 
addrs_Ën
 -ğ
Ën
;

319 
¿w_addr_li¡
 +ğ
Ën
;

322  
»tv®
;

323 
	}
}

330 
	$sùp_bšd_addr_m©ch
(
sùp_bšd_addr
 *
bp
,

331 cÚ¡ 
sùp_addr
 *
addr
,

332 
sùp_sock
 *
İt
)

334 
sùp_sockaddr_’Œy
 *
Ïddr
;

335 
m©ch
 = 0;

337 
	`rcu_»ad_lock
();

338 
	`li¡_fÜ_—ch_’Œy_rcu
(
Ïddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

339 ià(!
Ïddr
->
v®id
)

341 ià(
İt
->
pf
->
	`cmp_addr
(&
Ïddr
->
a
, 
addr
, opt)) {

342 
m©ch
 = 1;

346 
	`rcu_»ad_uÆock
();

348  
m©ch
;

349 
	}
}

354 
	$sùp_bšd_addr_cÚæiù
(
sùp_bšd_addr
 *
bp
,

355 cÚ¡ 
sùp_addr
 *
addr
,

356 
sùp_sock
 *
bp_¥
,

357 
sùp_sock
 *
addr_¥
)

359 
sùp_sockaddr_’Œy
 *
Ïddr
;

360 
cÚæiù
 = 0;

361 
sùp_sock
 *
¥
;

367 ià(
	`sùp_İt2sk
(
bp_¥
)->
sk_çmy
 =ğ
AF_INET6
)

368 
¥
 = 
bp_¥
;

369 ià(
	`sùp_İt2sk
(
addr_¥
)->
sk_çmy
 =ğ
AF_INET6
)

370 
¥
 = 
addr_¥
;

372 
¥
 = 
bp_¥
;

374 
	`rcu_»ad_lock
();

375 
	`li¡_fÜ_—ch_’Œy_rcu
(
Ïddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

376 ià(!
Ïddr
->
v®id
)

379 
cÚæiù
 = 
¥
->
pf
->
	`cmp_addr
(&
Ïddr
->
a
, 
addr
, sp);

380 ià(
cÚæiù
)

383 
	`rcu_»ad_uÆock
();

385  
cÚæiù
;

386 
	}
}

389 
	$sùp_bšd_addr_¡©e
(cÚ¡ 
sùp_bšd_addr
 *
bp
,

390 cÚ¡ 
sùp_addr
 *
addr
)

392 
sùp_sockaddr_’Œy
 *
Ïddr
;

393 
sùp_af
 *
af
;

394 
¡©e
 = -1;

396 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§
.
§_çmy
);

397 ià(
	`uÆik–y
(!
af
))

398  
¡©e
;

400 
	`rcu_»ad_lock
();

401 
	`li¡_fÜ_—ch_’Œy_rcu
(
Ïddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

402 ià(!
Ïddr
->
v®id
)

404 ià(
af
->
	`cmp_addr
(&
Ïddr
->
a
, 
addr
)) {

405 
¡©e
 = 
Ïddr
->state;

409 
	`rcu_»ad_uÆock
();

411  
¡©e
;

412 
	}
}

417 
sùp_addr
 *
	$sùp_fšd_unm©ch_addr
(
sùp_bšd_addr
 *
bp
,

418 cÚ¡ 
sùp_addr
 *
addrs
,

419 
addrút
,

420 
sùp_sock
 *
İt
)

422 
sùp_sockaddr_’Œy
 *
Ïddr
;

423 
sùp_addr
 *
addr
;

424 *
addr_buf
;

425 
sùp_af
 *
af
;

426 
i
;

432 
	`li¡_fÜ_—ch_’Œy
(
Ïddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

433 
addr_buf
 = (
sùp_addr
 *)
addrs
;

434 
i
 = 0; i < 
addrút
; i++) {

435 
addr
 = (
sùp_addr
 *)
addr_buf
;

436 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
v4
.
sš_çmy
);

437 ià(!
af
)

440 ià(
İt
->
pf
->
	`cmp_addr
(&
Ïddr
->
a
, 
addr
, opt))

443 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

445 ià(
i
 =ğ
addrút
)

446  &
Ïddr
->
a
;

449  
NULL
;

450 
	}
}

453 
	$sùp_cİy_Úe_addr
(
sùp_bšd_addr
 *
de¡
,

454 
sùp_addr
 *
addr
,

455 
sùp_scİe_t
 
scİe
, 
gå_t
 
gå
,

456 
æags
)

458 
”rÜ
 = 0;

460 ià(
	`sùp_is_ªy
(
NULL
, 
addr
)) {

461 
”rÜ
 = 
	`sùp_cİy_loÿl_addr_li¡
(
de¡
, 
scİe
, 
gå
, 
æags
);

462 } ià(
	`sùp_š_scİe
(
addr
, 
scİe
)) {

467 ià((((
AF_INET
 =ğ
addr
->
§
.
§_çmy
) &&

468 (
æags
 & 
SCTP_ADDR4_PEERSUPP
))) ||

469 (((
AF_INET6
 =ğ
addr
->
§
.
§_çmy
) &&

470 (
æags
 & 
SCTP_ADDR6_ALLOWED
) &&

471 (
æags
 & 
SCTP_ADDR6_PEERSUPP
))))

472 
”rÜ
 = 
	`sùp_add_bšd_addr
(
de¡
, 
addr
, 
SCTP_ADDR_SRC
, 
gå
);

475  
”rÜ
;

476 
	}
}

479 
	$sùp_is_ªy
(
sock
 *
sk
, cÚ¡ 
sùp_addr
 *
addr
)

481 
çm
 = 0;

482 
sùp_af
 *
af
;

485 ià(
addr
->
§
.
§_çmy
 !ğ
AF_UNSPEC
)

486 
çm
 = 
addr
->
§
.
§_çmy
;

487 ià(
sk
)

488 
çm
 = 
sk
->
sk_çmy
;

490 
af
 = 
	`sùp_g‘_af_¥ecific
(
çm
);

491 ià(!
af
)

494  
af
->
	`is_ªy
(
addr
);

495 
	}
}

498 
	$sùp_š_scİe
(cÚ¡ 
sùp_addr
 *
addr
, 
sùp_scİe_t
 
scİe
)

500 
sùp_scİe_t
 
addr_scİe
 = 
	`sùp_scİe
(
addr
);

505 ià(
SCTP_SCOPE_UNUSABLE
 =ğ
addr_scİe
)

516 
sùp_scİe_pŞicy
) {

517 
SCTP_SCOPE_POLICY_DISABLE
:

519 
SCTP_SCOPE_POLICY_ENABLE
:

520 ià(
addr_scİe
 <ğ
scİe
)

523 
SCTP_SCOPE_POLICY_PRIVATE
:

524 ià(
addr_scİe
 <ğ
scİe
 || 
SCTP_SCOPE_PRIVATE
 ==‡ddr_scope)

527 
SCTP_SCOPE_POLICY_LINK
:

528 ià(
addr_scİe
 <ğ
scİe
 || 
SCTP_SCOPE_LINK
 ==‡ddr_scope)

536 
	}
}

543 
sùp_scİe_t
 
	$sùp_scİe
(cÚ¡ 
sùp_addr
 *
addr
)

545 
sùp_af
 *
af
;

547 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§
.
§_çmy
);

548 ià(!
af
)

549  
SCTP_SCOPE_UNUSABLE
;

551  
af
->
	`scİe
((
sùp_addr
 *)
addr
);

552 
	}
}

	@checksum.h

45 
	~<lšux/ty³s.h
>

46 
	~<Ãt/sùp/sùp.h
>

47 
	~<lšux/üc32c.h
>

49 
šlše
 
__u32
 
	$sùp_üc32c
(
__u32
 
üc
, 
u8
 *
bufãr
, 
u16
 
Ëngth
)

51  
	`üc32c
(
üc
, 
bufãr
, 
Ëngth
);

52 
	}
}

54 
šlše
 
__u32
 
	$sùp_¡¬t_cksum
(
__u8
 *
bufãr
, 
__u16
 
Ëngth
)

56 
__u32
 
üc
 = ~(__u32)0;

57 
__u8
 
z”o
[(
__u32
)] = {0};

64 
üc
 = 
	`sùp_üc32c
(üc, 
bufãr
, (
sùphdr
è- (
__u32
));

67 
üc
 = 
	`sùp_üc32c
(üc, 
z”o
, (
__u32
));

70 
üc
 = 
	`sùp_üc32c
(üc, &
bufãr
[(
sùphdr
)],

71 
Ëngth
 - (
sùphdr
));

72  
üc
;

73 
	}
}

75 
šlše
 
__u32
 
	$sùp_upd©e_cksum
(
__u8
 *
bufãr
, 
__u16
 
Ëngth
, 
__u32
 
üc32
)

77  
	`sùp_üc32c
(
üc32
, 
bufãr
, 
Ëngth
);

78 
	}
}

80 
šlše
 
__Ë32
 
	$sùp_’d_cksum
(
__be32
 
üc32
)

82  
	`ıu_to_Ë32
(~
üc32
);

83 
	}
}

	@chunk.c

40 
	~<lšux/ty³s.h
>

41 
	~<lšux/k”Ãl.h
>

42 
	~<lšux/Ãt.h
>

43 
	~<lšux/š‘.h
>

44 
	~<lšux/skbuff.h
>

45 
	~<Ãt/sock.h
>

46 
	~<Ãt/sùp/sùp.h
>

47 
	~<Ãt/sùp/sm.h
>

54 
	$sùp_d©amsg_š™
(
sùp_d©amsg
 *
msg
)

56 
	`©omic_£t
(&
msg
->
»fút
, 1);

57 
msg
->
£nd_çed
 = 0;

58 
msg
->
£nd_”rÜ
 = 0;

59 
msg
->
ÿn_abªdÚ
 = 0;

60 
msg
->
ÿn_d–ay
 = 1;

61 
msg
->
expœes_©
 = 0;

62 
	`INIT_LIST_HEAD
(&
msg
->
chunks
);

63 
	}
}

66 
SCTP_STATIC
 
sùp_d©amsg
 *
	$sùp_d©amsg_Ãw
(
gå_t
 
gå
)

68 
sùp_d©amsg
 *
msg
;

69 
msg
 = 
	`km®loc
((
sùp_d©amsg
), 
gå
);

70 ià(
msg
) {

71 
	`sùp_d©amsg_š™
(
msg
);

72 
	`SCTP_DBG_OBJCNT_INC
(
d©amsg
);

74  
msg
;

75 
	}
}

77 
	$sùp_d©amsg_ä“
(
sùp_d©amsg
 *
msg
)

79 
sùp_chunk
 *
chunk
;

84 
	`li¡_fÜ_—ch_’Œy
(
chunk
, &
msg
->
chunks
, 
äag_li¡
)

85 
	`sùp_chunk_ä“
(
chunk
);

87 
	`sùp_d©amsg_put
(
msg
);

88 
	}
}

91 
	$sùp_d©amsg_de¡roy
(
sùp_d©amsg
 *
msg
)

93 
li¡_h—d
 *
pos
, *
‹mp
;

94 
sùp_chunk
 *
chunk
;

95 
sùp_sock
 *
¥
;

96 
sùp_uÍev’t
 *
ev
;

97 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

98 
”rÜ
 = 0, 
nÙify
;

101 
nÙify
 = 
msg
->
£nd_çed
 ? -1 : 0;

104 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
msg
->
chunks
) {

105 
	`li¡_d–_š™
(
pos
);

106 
chunk
 = 
	`li¡_’Œy
(
pos
, 
sùp_chunk
, 
äag_li¡
);

108 ià(
nÙify
 < 0) {

109 
asoc
 = 
chunk
->asoc;

110 ià(
msg
->
£nd_”rÜ
)

111 
”rÜ
 = 
msg
->
£nd_”rÜ
;

113 
”rÜ
 = 
asoc
->
outqueue
.error;

115 
¥
 = 
	`sùp_sk
(
asoc
->
ba£
.
sk
);

116 
nÙify
 = 
	`sùp_uÍev’t_ty³_’abËd
(
SCTP_SEND_FAILED
,

117 &
¥
->
subsüibe
);

121 ià(
nÙify
 > 0) {

122 
£Á
;

123 ià(
chunk
->
has_t¢
)

124 
£Á
 = 
SCTP_DATA_SENT
;

126 
£Á
 = 
SCTP_DATA_UNSENT
;

128 
ev
 = 
	`sùp_uÍev’t_make_£nd_çed
(
asoc
, 
chunk
, 
£Á
,

129 
”rÜ
, 
GFP_ATOMIC
);

130 ià(
ev
)

131 
	`sùp_uÍq__ev’t
(&
asoc
->
uÍq
, 
ev
);

134 
	`sùp_chunk_put
(
chunk
);

137 
	`SCTP_DBG_OBJCNT_DEC
(
d©amsg
);

138 
	`kä“
(
msg
);

139 
	}
}

142 
	$sùp_d©amsg_hŞd
(
sùp_d©amsg
 *
msg
)

144 
	`©omic_šc
(&
msg
->
»fút
);

145 
	}
}

148 
	$sùp_d©amsg_put
(
sùp_d©amsg
 *
msg
)

150 ià(
	`©omic_dec_ªd_‹¡
(&
msg
->
»fút
))

151 
	`sùp_d©amsg_de¡roy
(
msg
);

152 
	}
}

155 
	$sùp_d©amsg_assign
(
sùp_d©amsg
 *
msg
, 
sùp_chunk
 *
chunk
)

157 
	`sùp_d©amsg_hŞd
(
msg
);

158 
chunk
->
msg
 = msg;

159 
	}
}

169 
sùp_d©amsg
 *
	$sùp_d©amsg_äom_u£r
(
sùp_assocŸtiÚ
 *
asoc
,

170 
sùp_¢drcvšfo
 *
sšfo
,

171 
msghdr
 *
msgh
, 
msg_Ën
)

173 
max
, 
whŞe
, 
i
, 
off£t
, 
ov”
, 
”r
;

174 
Ën
, 
fœ¡_Ën
;

175 
max_d©a
;

176 
sùp_chunk
 *
chunk
;

177 
sùp_d©amsg
 *
msg
;

178 
li¡_h—d
 *
pos
, *
‹mp
;

179 
__u8
 
äag
;

181 
msg
 = 
	`sùp_d©amsg_Ãw
(
GFP_KERNEL
);

182 ià(!
msg
)

183  
NULL
;

188 ià(
sšfo
->
sšfo_tim‘Şive
) {

190 
msg
->
expœes_©
 = 
jiff›s
 +

191 
	`m£cs_to_jiff›s
(
sšfo
->
sšfo_tim‘Şive
);

192 
msg
->
ÿn_abªdÚ
 = 1;

193 
	`SCTP_DEBUG_PRINTK
("%s: msg:%pƒxpires_at: %ld jiffies:%ld\n",

194 
__func__
, 
msg
, msg->
expœes_©
, 
jiff›s
);

200 
max_d©a
 = 
asoc
->
·thmtu
 -

201 
	`sùp_sk
(
asoc
->
ba£
.
sk
)->
pf
->
af
->
Ãt_h—d”_Ën
 -

202 (
sùphdr
è- (
sùp_d©a_chunk
);

204 
max
 = 
asoc
->
äag_pošt
;

209 ià(
	`sùp_auth_£nd_cid
(
SCTP_CID_DATA
, 
asoc
)) {

210 
sùp_hmac
 *
hmac_desc
 = 
	`sùp_auth_asoc_g‘_hmac
(
asoc
);

212 ià(
hmac_desc
)

213 
max_d©a
 -ğ
	`WORD_ROUND
((
sùp_auth_chunk_t
) +

214 
hmac_desc
->
hmac_Ën
);

218 ià(
max
 > 
max_d©a
)

219 
max
 = 
max_d©a
;

221 
whŞe
 = 0;

222 
fœ¡_Ën
 = 
max
;

230 ià(
	`tim”_³ndšg
(&
asoc
->
tim”s
[
SCTP_EVENT_TIMEOUT_SACK
]) &&

231 
asoc
->
outqueue
.
out_qËn
 == 0 &&

232 
	`li¡_em±y
(&
asoc
->
outqueue
.
»Œªsm™
) &&

233 
msg_Ën
 > 
max
)

234 
max_d©a
 -ğ
	`WORD_ROUND
((
sùp_§ck_chunk_t
));

237 ià(
asoc
->
¡©e
 < 
SCTP_STATE_COOKIE_ECHOED
)

238 
max_d©a
 -ğ
SCTP_ARBITRARY_COOKIE_ECHO_LEN
;

241 ià(
fœ¡_Ën
 > 
max_d©a
)

242 
fœ¡_Ën
 = 
max_d©a
;

245 ià(
msg_Ën
 >ğ
fœ¡_Ën
) {

246 
msg_Ën
 -ğ
fœ¡_Ën
;

247 
whŞe
 = 1;

248 
msg
->
ÿn_d–ay
 = 0;

252 
whŞe
 +ğ
msg_Ën
 / 
max
;

253 
ov”
 = 
msg_Ën
 % 
max
;

254 
off£t
 = 0;

256 ià((
whŞe
 > 1è|| (whŞ&& 
ov”
))

257 
	`SCTP_INC_STATS_USER
(
SCTP_MIB_FRAGUSRMSGS
);

260 
i
=0, 
Ën
=
fœ¡_Ën
; i < 
whŞe
; i++) {

261 
äag
 = 
SCTP_DATA_MIDDLE_FRAG
;

263 ià(0 =ğ
i
)

264 
äag
 |ğ
SCTP_DATA_FIRST_FRAG
;

266 ià((
i
 =ğ(
whŞe
 - 1)è&& !
ov”
)

267 
äag
 |ğ
SCTP_DATA_LAST_FRAG
;

269 
chunk
 = 
	`sùp_make_d©aäag_em±y
(
asoc
, 
sšfo
, 
Ën
, 
äag
, 0);

271 ià(!
chunk
)

272 
”rout
;

273 
”r
 = 
	`sùp_u£r_addto_chunk
(
chunk
, 
off£t
, 
Ën
, 
msgh
->
msg_iov
);

274 ià(
”r
 < 0)

275 
”rout
;

277 
off£t
 +ğ
Ën
;

280 
	`__skb_puÎ
(
chunk
->
skb
, (
__u8
 *)chunk->
chunk_hdr


281 - (
__u8
 *)
chunk
->
skb
->
d©a
);

283 
	`sùp_d©amsg_assign
(
msg
, 
chunk
);

284 
	`li¡_add_
(&
chunk
->
äag_li¡
, &
msg
->
chunks
);

289 ià(0 =ğ
i
)

290 
Ën
 = 
max
;

294 ià(
ov”
) {

295 ià(!
whŞe
)

296 
äag
 = 
SCTP_DATA_NOT_FRAG
;

298 
äag
 = 
SCTP_DATA_LAST_FRAG
;

300 
chunk
 = 
	`sùp_make_d©aäag_em±y
(
asoc
, 
sšfo
, 
ov”
, 
äag
, 0);

302 ià(!
chunk
)

303 
”rout
;

305 
”r
 = 
	`sùp_u£r_addto_chunk
(
chunk
, 
off£t
, 
ov”
,
msgh
->
msg_iov
);

308 
	`__skb_puÎ
(
chunk
->
skb
, (
__u8
 *)chunk->
chunk_hdr


309 - (
__u8
 *)
chunk
->
skb
->
d©a
);

310 ià(
”r
 < 0)

311 
”rout
;

313 
	`sùp_d©amsg_assign
(
msg
, 
chunk
);

314 
	`li¡_add_
(&
chunk
->
äag_li¡
, &
msg
->
chunks
);

317  
msg
;

319 
”rout
:

320 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
msg
->
chunks
) {

321 
	`li¡_d–_š™
(
pos
);

322 
chunk
 = 
	`li¡_’Œy
(
pos
, 
sùp_chunk
, 
äag_li¡
);

323 
	`sùp_chunk_ä“
(
chunk
);

325 
	`sùp_d©amsg_put
(
msg
);

326  
NULL
;

327 
	}
}

330 
	$sùp_chunk_abªdÚed
(
sùp_chunk
 *
chunk
)

332 
sùp_d©amsg
 *
msg
 = 
chunk
->msg;

334 ià(!
msg
->
ÿn_abªdÚ
)

337 ià(
	`time_aá”
(
jiff›s
, 
msg
->
expœes_©
))

341 
	}
}

344 
	$sùp_chunk_ç
(
sùp_chunk
 *
chunk
, 
”rÜ
)

346 
chunk
->
msg
->
£nd_çed
 = 1;

347 
chunk
->
msg
->
£nd_”rÜ
 = 
”rÜ
;

348 
	}
}

	@command.c

41 
	~<lšux/ty³s.h
>

42 
	~<Ãt/sùp/sùp.h
>

43 
	~<Ãt/sùp/sm.h
>

46 
	$sùp_š™_cmd_£q
(
sùp_cmd_£q_t
 *
£q
)

48 
	`mem£t
(
£q
, 0, (
sùp_cmd_£q_t
));

50 
	}
}

55 
	$sùp_add_cmd_sf
(
sùp_cmd_£q_t
 *
£q
, 
sùp_v”b_t
 
v”b
, 
sùp_¬g_t
 
obj
)

57 
	`BUG_ON
(
£q
->
Ãxt_ä“_¦Ù
 >ğ
SCTP_MAX_NUM_COMMANDS
);

59 
£q
->
cmds
[£q->
Ãxt_ä“_¦Ù
].
v”b
 = verb;

60 
£q
->
cmds
[£q->
Ãxt_ä“_¦Ù
++].
obj
 = obj;

61 
	}
}

66 
sùp_cmd_t
 *
	$sùp_Ãxt_cmd
(
sùp_cmd_£q_t
 *
£q
)

68 
sùp_cmd_t
 *
»tv®
 = 
NULL
;

70 ià(
£q
->
Ãxt_cmd
 < seq->
Ãxt_ä“_¦Ù
)

71 
»tv®
 = &
£q
->
cmds
[£q->
Ãxt_cmd
++];

73  
»tv®
;

74 
	}
}

	@command.h

39 #iâdeà
__Ãt_sùp_commªd_h__


40 
	#__Ãt_sùp_commªd_h__


	)

42 
	~<Ãt/sùp/cÚ¡ªts.h
>

43 
	~<Ãt/sùp/¡ruùs.h
>

47 
	mSCTP_CMD_NOP
 = 0,

48 
	mSCTP_CMD_NEW_ASOC
,

49 
	mSCTP_CMD_DELETE_TCB
,

50 
	mSCTP_CMD_NEW_STATE
,

51 
	mSCTP_CMD_REPORT_TSN
,

52 
	mSCTP_CMD_GEN_SACK
,

53 
	mSCTP_CMD_PROCESS_SACK
,

54 
	mSCTP_CMD_GEN_INIT_ACK
,

55 
	mSCTP_CMD_PEER_INIT
,

56 
	mSCTP_CMD_GEN_COOKIE_ECHO
,

57 
	mSCTP_CMD_CHUNK_ULP
,

58 
	mSCTP_CMD_EVENT_ULP
,

59 
	mSCTP_CMD_REPLY
,

60 
	mSCTP_CMD_SEND_PKT
,

61 
	mSCTP_CMD_RETRAN
,

62 
	mSCTP_CMD_ECN_CE
,

63 
	mSCTP_CMD_ECN_ECNE
,

64 
	mSCTP_CMD_ECN_CWR
,

65 
	mSCTP_CMD_TIMER_START
,

66 
	mSCTP_CMD_TIMER_START_ONCE
,

67 
	mSCTP_CMD_TIMER_RESTART
,

68 
	mSCTP_CMD_TIMER_STOP
,

69 
	mSCTP_CMD_INIT_CHOOSE_TRANSPORT
,

70 
	mSCTP_CMD_INIT_COUNTER_RESET
,

71 
	mSCTP_CMD_INIT_COUNTER_INC
,

72 
	mSCTP_CMD_INIT_RESTART
,

73 
	mSCTP_CMD_COOKIEECHO_RESTART
,

74 
	mSCTP_CMD_INIT_FAILED
,

75 
	mSCTP_CMD_REPORT_DUP
,

76 
	mSCTP_CMD_STRIKE
,

77 
	mSCTP_CMD_HB_TIMERS_START
,

78 
	mSCTP_CMD_HB_TIMER_UPDATE
,

79 
	mSCTP_CMD_HB_TIMERS_STOP
,

80 
	mSCTP_CMD_TRANSPORT_HB_SENT
,

81 
	mSCTP_CMD_TRANSPORT_IDLE
,

82 
	mSCTP_CMD_TRANSPORT_ON
,

83 
	mSCTP_CMD_REPORT_ERROR
,

84 
	mSCTP_CMD_REPORT_BAD_TAG
,

85 
	mSCTP_CMD_PROCESS_CTSN
,

86 
	mSCTP_CMD_ASSOC_FAILED
,

87 
	mSCTP_CMD_DISCARD_PACKET
,

88 
	mSCTP_CMD_GEN_SHUTDOWN
,

89 
	mSCTP_CMD_UPDATE_ASSOC
,

90 
	mSCTP_CMD_PURGE_OUTQUEUE
,

91 
	mSCTP_CMD_SETUP_T2
,

92 
	mSCTP_CMD_RTO_PENDING
,

93 
	mSCTP_CMD_PART_DELIVER
,

94 
	mSCTP_CMD_RENEGE
,

95 
	mSCTP_CMD_SETUP_T4
,

96 
	mSCTP_CMD_PROCESS_OPERR
,

97 
	mSCTP_CMD_REPORT_FWDTSN
,

98 
	mSCTP_CMD_PROCESS_FWDTSN
,

99 
	mSCTP_CMD_CLEAR_INIT_TAG
,

100 
	mSCTP_CMD_DEL_NON_PRIMARY
,

101 
	mSCTP_CMD_T3_RTX_TIMERS_STOP
,

102 
	mSCTP_CMD_FORCE_PRIM_RETRAN
,

103 
	mSCTP_CMD_SET_SK_ERR
,

104 
	mSCTP_CMD_ASSOC_CHANGE
,

105 
	mSCTP_CMD_ADAPTATION_IND
,

106 
	mSCTP_CMD_ASSOC_SHKEY
,

107 
	mSCTP_CMD_T1_RETRAN
,

108 
	mSCTP_CMD_UPDATE_INITTAG
,

109 
	mSCTP_CMD_SEND_MSG
,

110 
	mSCTP_CMD_SEND_NEXT_ASCONF
,

111 
	mSCTP_CMD_PURGE_ASCONF_QUEUE
,

112 
	mSCTP_CMD_SET_ASOC
,

113 
	mSCTP_CMD_LAST


114 } 
	tsùp_v”b_t
;

121 
	#SCTP_MAX_NUM_COMMANDS
 14

	)

124 
__s32
 
	mi32
;

125 
__u32
 
	mu32
;

126 
__be32
 
	mbe32
;

127 
__u16
 
	mu16
;

128 
__u8
 
	mu8
;

129 
	m”rÜ
;

130 
__be16
 
	m”r
;

131 
sùp_¡©e_t
 
	m¡©e
;

132 
sùp_ev’t_timeout_t
 
	mto
;

133 
sùp_chunk
 *
	mchunk
;

134 
sùp_assocŸtiÚ
 *
	masoc
;

135 
sùp_Œª¥Üt
 *
	mŒª¥Üt
;

136 
sùp_bšd_addr
 *
	mbp
;

137 
sùp_š™_chunk_t
 *
	mš™
;

138 
sùp_uÍev’t
 *
	muÍev’t
;

139 
sùp_·ck‘
 *
	m·ck‘
;

140 
sùp_§ckhdr_t
 *
	m§ckh
;

141 
sùp_d©amsg
 *
	mmsg
;

142 } 
	tsùp_¬g_t
;

156 
	#SCTP_ARG_CONSTRUCTOR
(
Çme
, 
ty³
, 
–t
) \

157 
šlše
 
sùp_¬g_t
 \

158 
SCTP_
## 
	`Çme
 (
ty³
 
¬g
) \

159 { 
sùp_¬g_t
 
»tv®
;\

160 
	`mem£t
(&
»tv®
, 0, (
sùp_¬g_t
));\

161 
»tv®
.
–t
 = 
¬g
;\

162  
»tv®
;\

163 }

	)

165 
	$SCTP_ARG_CONSTRUCTOR
(
I32
, 
__s32
, 
i32
)

166 
	$SCTP_ARG_CONSTRUCTOR
(
U32
, 
__u32
, 
u32
)

167 
	$SCTP_ARG_CONSTRUCTOR
(
BE32
, 
__be32
, 
be32
)

168 
	$SCTP_ARG_CONSTRUCTOR
(
U16
, 
__u16
, 
u16
)

169 
	$SCTP_ARG_CONSTRUCTOR
(
U8
, 
__u8
, 
u8
)

170 
	$SCTP_ARG_CONSTRUCTOR
(
ERROR
, , 
”rÜ
)

171 
	$SCTP_ARG_CONSTRUCTOR
(
PERR
, 
__be16
, 
”r
)

172 
	$SCTP_ARG_CONSTRUCTOR
(
STATE
, 
sùp_¡©e_t
, 
¡©e
)

173 
	$SCTP_ARG_CONSTRUCTOR
(
TO
, 
sùp_ev’t_timeout_t
, 
to
)

174 
	$SCTP_ARG_CONSTRUCTOR
(
CHUNK
, 
sùp_chunk
 *, 
chunk
)

175 
	$SCTP_ARG_CONSTRUCTOR
(
ASOC
, 
sùp_assocŸtiÚ
 *, 
asoc
)

176 
	$SCTP_ARG_CONSTRUCTOR
(
TRANSPORT
, 
sùp_Œª¥Üt
 *, 
Œª¥Üt
)

177 
	$SCTP_ARG_CONSTRUCTOR
(
BA
, 
sùp_bšd_addr
 *, 
bp
)

178 
	$SCTP_ARG_CONSTRUCTOR
(
PEER_INIT
, 
sùp_š™_chunk_t
 *, 
š™
)

179 
	$SCTP_ARG_CONSTRUCTOR
(
ULPEVENT
, 
sùp_uÍev’t
 *, 
uÍev’t
)

180 
	$SCTP_ARG_CONSTRUCTOR
(
PACKET
, 
sùp_·ck‘
 *, 
·ck‘
)

181 
	$SCTP_ARG_CONSTRUCTOR
(
SACKH
, 
sùp_§ckhdr_t
 *, 
§ckh
)

182 
	$SCTP_ARG_CONSTRUCTOR
(
DATAMSG
, 
sùp_d©amsg
 *, 
msg
)

184 
šlše
 
sùp_¬g_t
 
	$SCTP_FORCE
()

186  
	`SCTP_I32
(1);

187 
	}
}

189 
šlše
 
sùp_¬g_t
 
	$SCTP_NOFORCE
()

191  
	`SCTP_I32
(0);

192 
	}
}

194 
šlše
 
sùp_¬g_t
 
	$SCTP_NULL
()

196 
sùp_¬g_t
 
»tv®
;

197 
	`mem£t
(&
»tv®
, 0, (
sùp_¬g_t
));

198  
»tv®
;

199 
	}
}

202 
sùp_¬g_t
 
	mobj
;

203 
sùp_v”b_t
 
	mv”b
;

204 } 
	tsùp_cmd_t
;

207 
sùp_cmd_t
 
	mcmds
[
SCTP_MAX_NUM_COMMANDS
];

208 
__u8
 
	mÃxt_ä“_¦Ù
;

209 
__u8
 
	mÃxt_cmd
;

210 } 
	tsùp_cmd_£q_t
;

216 
sùp_š™_cmd_£q
(
sùp_cmd_£q_t
 *
£q
);

223 
sùp_add_cmd_sf
(
sùp_cmd_£q_t
 *
£q
, 
sùp_v”b_t
 
v”b
, 
sùp_¬g_t
 
obj
);

228 
sùp_cmd_t
 *
sùp_Ãxt_cmd
(
sùp_cmd_£q_t
 *
£q
);

	@constants.h

47 #iâdeà
__sùp_cÚ¡ªts_h__


48 
	#__sùp_cÚ¡ªts_h__


	)

50 
	~<lšux/sùp.h
>

51 
	~<lšux/v6.h
>

52 
	~<Ãt/sùp/u£r.h
>

53 
	~<Ãt/tı_¡©es.h
>

56 ’um { 
	mSCTP_MAX_STREAM
 = 0xffff };

57 ’um { 
	mSCTP_DEFAULT_OUTSTREAMS
 = 10 };

58 ’um { 
	mSCTP_DEFAULT_INSTREAMS
 = 
SCTP_MAX_STREAM
 };

63 
	#SCTP_CID_BASE_MAX
 
SCTP_CID_SHUTDOWN_COMPLETE


	)

65 
	#SCTP_NUM_BASE_CHUNK_TYPES
 (
SCTP_CID_BASE_MAX
 + 1)

	)

67 
	#SCTP_NUM_ADDIP_CHUNK_TYPES
 2

	)

69 
	#SCTP_NUM_PRSCTP_CHUNK_TYPES
 1

	)

71 
	#SCTP_NUM_AUTH_CHUNK_TYPES
 1

	)

73 
	#SCTP_NUM_CHUNK_TYPES
 (
SCTP_NUM_BASE_CHUNK_TYPES
 + \

74 
SCTP_NUM_ADDIP_CHUNK_TYPES
 +\

75 
SCTP_NUM_PRSCTP_CHUNK_TYPES
 +\

76 
SCTP_NUM_AUTH_CHUNK_TYPES
)

	)

81 
	mSCTP_EVENT_T_CHUNK
 = 1,

82 
	mSCTP_EVENT_T_TIMEOUT
,

83 
	mSCTP_EVENT_T_OTHER
,

84 
	mSCTP_EVENT_T_PRIMITIVE


86 } 
	tsùp_ev’t_t
;

93 
	mSCTP_EVENT_TIMEOUT_NONE
 = 0,

94 
	mSCTP_EVENT_TIMEOUT_T1_COOKIE
,

95 
	mSCTP_EVENT_TIMEOUT_T1_INIT
,

96 
	mSCTP_EVENT_TIMEOUT_T2_SHUTDOWN
,

97 
	mSCTP_EVENT_TIMEOUT_T3_RTX
,

98 
	mSCTP_EVENT_TIMEOUT_T4_RTO
,

99 
	mSCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
,

100 
	mSCTP_EVENT_TIMEOUT_HEARTBEAT
,

101 
	mSCTP_EVENT_TIMEOUT_SACK
,

102 
	mSCTP_EVENT_TIMEOUT_AUTOCLOSE
,

103 } 
	tsùp_ev’t_timeout_t
;

105 
	#SCTP_EVENT_TIMEOUT_MAX
 
SCTP_EVENT_TIMEOUT_AUTOCLOSE


	)

106 
	#SCTP_NUM_TIMEOUT_TYPES
 (
SCTP_EVENT_TIMEOUT_MAX
 + 1)

	)

109 
	mSCTP_EVENT_NO_PENDING_TSN
 = 0,

110 
	mSCTP_EVENT_ICMP_PROTO_UNREACH
,

111 } 
	tsùp_ev’t_Ùh”_t
;

113 
	#SCTP_EVENT_OTHER_MAX
 
SCTP_EVENT_ICMP_PROTO_UNREACH


	)

114 
	#SCTP_NUM_OTHER_TYPES
 (
SCTP_EVENT_OTHER_MAX
 + 1)

	)

118 
	mSCTP_PRIMITIVE_ASSOCIATE
 = 0,

119 
	mSCTP_PRIMITIVE_SHUTDOWN
,

120 
	mSCTP_PRIMITIVE_ABORT
,

121 
	mSCTP_PRIMITIVE_SEND
,

122 
	mSCTP_PRIMITIVE_REQUESTHEARTBEAT
,

123 
	mSCTP_PRIMITIVE_ASCONF
,

124 } 
	tsùp_ev’t_´im™ive_t
;

126 
	#SCTP_EVENT_PRIMITIVE_MAX
 
SCTP_PRIMITIVE_ASCONF


	)

127 
	#SCTP_NUM_PRIMITIVE_TYPES
 (
SCTP_EVENT_PRIMITIVE_MAX
 + 1)

	)

136 
sùp_cid_t
 
	mchunk
;

137 
sùp_ev’t_timeout_t
 
	mtimeout
;

138 
sùp_ev’t_Ùh”_t
 
	mÙh”
;

139 
sùp_ev’t_´im™ive_t
 
	m´im™ive
;

140 } 
	tsùp_subty³_t
;

142 
	#SCTP_SUBTYPE_CONSTRUCTOR
(
_Çme
, 
_ty³
, 
_–t
) \

143 
šlše
 
sùp_subty³_t
 \

144 
SCTP_ST_
## 
	`_Çme
 (
_ty³
 
_¬g
) \

145 { 
sùp_subty³_t
 
_»tv®
; _»tv®.
_–t
 = 
_¬g
;  _»tv®; }

	)

147 
	$SCTP_SUBTYPE_CONSTRUCTOR
(
CHUNK
, 
sùp_cid_t
, 
chunk
)

148 
	$SCTP_SUBTYPE_CONSTRUCTOR
(
TIMEOUT
, 
sùp_ev’t_timeout_t
, 
timeout
)

149 
	$SCTP_SUBTYPE_CONSTRUCTOR
(
OTHER
, 
sùp_ev’t_Ùh”_t
, 
Ùh”
)

150 
	$SCTP_SUBTYPE_CONSTRUCTOR
(
PRIMITIVE
, 
sùp_ev’t_´im™ive_t
, 
´im™ive
)

153 
	#sùp_chunk_is_d©a
(
a
è×->
chunk_hdr
->
ty³
 =ğ
SCTP_CID_DATA
)

	)

156 
	#SCTP_DATA_SNDSIZE
(
c
è(()(()(c->
chunk_’d
)\

157 - ()(
c
->
chunk_hdr
)\

158 - (
sùp_d©a_chunk_t
)))

	)

163 
SCTP_IERROR_NO_ERROR
 = 0,

164 
SCTP_IERROR_BASE
 = 1000,

165 
SCTP_IERROR_NO_COOKIE
,

166 
SCTP_IERROR_BAD_SIG
,

167 
SCTP_IERROR_STALE_COOKIE
,

168 
SCTP_IERROR_NOMEM
,

169 
SCTP_IERROR_MALFORMED
,

170 
SCTP_IERROR_BAD_TAG
,

171 
SCTP_IERROR_BIG_GAP
,

172 
SCTP_IERROR_DUP_TSN
,

173 
SCTP_IERROR_HIGH_TSN
,

174 
SCTP_IERROR_IGNORE_TSN
,

175 
SCTP_IERROR_NO_DATA
,

176 
SCTP_IERROR_BAD_STREAM
,

177 
SCTP_IERROR_BAD_PORTS
,

178 
SCTP_IERROR_AUTH_BAD_HMAC
,

179 
SCTP_IERROR_AUTH_BAD_KEYID
,

180 
SCTP_IERROR_PROTO_VIOLATION
,

181 
SCTP_IERROR_ERROR
,

182 
SCTP_IERROR_ABORT
,

183 } 
	tsùp_›¼Ü_t
;

190 
SCTP_STATE_CLOSED
 = 0,

191 
SCTP_STATE_COOKIE_WAIT
 = 1,

192 
SCTP_STATE_COOKIE_ECHOED
 = 2,

193 
SCTP_STATE_ESTABLISHED
 = 3,

194 
SCTP_STATE_SHUTDOWN_PENDING
 = 4,

195 
SCTP_STATE_SHUTDOWN_SENT
 = 5,

196 
SCTP_STATE_SHUTDOWN_RECEIVED
 = 6,

197 
SCTP_STATE_SHUTDOWN_ACK_SENT
 = 7,

199 } 
	tsùp_¡©e_t
;

201 
	#SCTP_STATE_MAX
 
SCTP_STATE_SHUTDOWN_ACK_SENT


	)

202 
	#SCTP_STATE_NUM_STATES
 (
SCTP_STATE_MAX
 + 1)

	)

221 
SCTP_SS_CLOSED
 = 
TCP_CLOSE
,

222 
SCTP_SS_LISTENING
 = 
TCP_LISTEN
,

223 
SCTP_SS_ESTABLISHING
 = 
TCP_SYN_SENT
,

224 
SCTP_SS_ESTABLISHED
 = 
TCP_ESTABLISHED
,

225 
SCTP_SS_CLOSING
 = 
TCP_CLOSING
,

226 } 
	tsùp_sock_¡©e_t
;

229 cÚ¡ *
	`sùp_úame
(cÚ¡ 
sùp_subty³_t
);

230 cÚ¡ *
	`sùp_Úame
(cÚ¡ 
sùp_subty³_t
);

231 cÚ¡ *
	`sùp_Šame
(cÚ¡ 
sùp_subty³_t
);

232 cÚ¡ *
	`sùp_²ame
(cÚ¡ 
sùp_subty³_t
);

235 cÚ¡ *cÚ¡ 
sùp_¡©e_tbl
[];

236 cÚ¡ *cÚ¡ 
sùp_ev‰y³_tbl
[];

237 cÚ¡ *cÚ¡ 
sùp_¡©us_tbl
[];

240 ’um { 
SCTP_MAX_CHUNK_LEN
 = ((1<<16è- (
__u32
)) };

245 ’um { 
SCTP_ARBITRARY_COOKIE_ECHO_LEN
 = 200 };

257 
	#SCTP_TSN_MAP_INITIAL
 
BITS_PER_LONG


	)

258 
	#SCTP_TSN_MAP_INCREMENT
 
SCTP_TSN_MAP_INITIAL


	)

259 
	#SCTP_TSN_MAP_SIZE
 4096

	)

266 ’um { 
SCTP_MIN_PMTU
 = 576 };

267 ’um { 
SCTP_MAX_DUP_TSNS
 = 16 };

268 ’um { 
SCTP_MAX_GABS
 = 16 };

271 
	#SCTP_DEFAULT_TIMEOUT_HEARTBEAT
 (30*1000)

	)

274 
	#SCTP_DEFAULT_TIMEOUT_SACK
 (200)

	)

282 
	#SCTP_RTO_INITIAL
 (3 * 1000)

	)

283 
	#SCTP_RTO_MIN
 (1 * 1000)

	)

284 
	#SCTP_RTO_MAX
 (60 * 1000)

	)

286 
	#SCTP_RTO_ALPHA
 3

	)

287 
	#SCTP_RTO_BETA
 2

	)

290 
	#SCTP_DEFAULT_MAX_BURST
 4

	)

292 
	#SCTP_CLOCK_GRANULARITY
 1

	)

294 
	#SCTP_DEFAULT_COOKIE_LIFE
 (60 * 1000è

	)

296 
	#SCTP_DEFAULT_MINWINDOW
 1500

	)

297 
	#SCTP_DEFAULT_MAXWINDOW
 65535

	)

298 
	#SCTP_DEFAULT_RWND_SHIFT
 4

	)

302 
	#SCTP_DEFAULT_MAXSEGMENT
 1500

	)

305 
	#SCTP_DEFAULT_MINSEGMENT
 512

	)

306 
	#SCTP_HOW_MANY_SECRETS
 2

	)

307 
	#SCTP_SECRET_SIZE
 32

	)

309 
	#SCTP_SIGNATURE_SIZE
 20

	)

311 
	#SCTP_COOKIE_MULTIPLE
 32

	)

319 
SCTP_XMIT_OK
,

320 
SCTP_XMIT_PMTU_FULL
,

321 
SCTP_XMIT_RWND_FULL
,

322 
SCTP_XMIT_NAGLE_DELAY
,

323 } 
	tsùp_xm™_t
;

327 
SCTP_TRANSPORT_UP
,

328 
SCTP_TRANSPORT_DOWN
,

329 
SCTP_TRANSPORT_PF
,

330 } 
	tsùp_Œª¥Üt_cmd_t
;

340 
SCTP_SCOPE_GLOBAL
,

341 
SCTP_SCOPE_PRIVATE
,

342 
SCTP_SCOPE_LINK
,

343 
SCTP_SCOPE_LOOPBACK
,

344 
SCTP_SCOPE_UNUSABLE
,

345 } 
	tsùp_scİe_t
;

348 
SCTP_SCOPE_POLICY_DISABLE
,

349 
SCTP_SCOPE_POLICY_ENABLE
,

350 
SCTP_SCOPE_POLICY_PRIVATE
,

351 
SCTP_SCOPE_POLICY_LINK
,

352 } 
	tsùp_scİe_pŞicy_t
;

360 
	#IS_IPV4_UNUSABLE_ADDRESS
(
a
) \

361 ((
	`htÚl
(
INADDR_BROADCAST
è=ğ
a
) || \

362 
	`v4_is_muÉiÿ¡
(
a
) || \

363 
	`v4_is_z”Ú‘
(
a
) || \

364 
	`v4_is_‹¡_198
(
a
) || \

365 
	`v4_is_ªyÿ¡_6to4
(
a
))

	)

368 
	#SCTP_ADDR6_ALLOWED
 0x00000001

	)

370 
	#SCTP_ADDR4_PEERSUPP
 0x00000002

	)

372 
	#SCTP_ADDR6_PEERSUPP
 0x00000004

	)

377 
SCTP_RTXR_T3_RTX
,

378 
SCTP_RTXR_FAST_RTX
,

379 
SCTP_RTXR_PMTUD
,

380 
SCTP_RTXR_T1_RTX
,

381 } 
	tsùp_»Œªsm™_»asÚ_t
;

385 
SCTP_LOWER_CWND_T3_RTX
,

386 
SCTP_LOWER_CWND_FAST_RTX
,

387 
SCTP_LOWER_CWND_ECNE
,

388 
SCTP_LOWER_CWND_INACTIVE
,

389 } 
	tsùp_low”_cwnd_t
;

409 
SCTP_AUTH_HMAC_ID_RESERVED_0
,

410 
SCTP_AUTH_HMAC_ID_SHA1
,

411 
SCTP_AUTH_HMAC_ID_RESERVED_2
,

412 #ià
	`defšed
 (
CONFIG_CRYPTO_SHA256
è|| defšed (
CONFIG_CRYPTO_SHA256_MODULE
)

413 
SCTP_AUTH_HMAC_ID_SHA256
,

415 
__SCTP_AUTH_HMAC_MAX


418 
	#SCTP_AUTH_HMAC_ID_MAX
 
__SCTP_AUTH_HMAC_MAX
 - 1

	)

419 
	#SCTP_AUTH_NUM_HMACS
 
__SCTP_AUTH_HMAC_MAX


	)

420 
	#SCTP_SHA1_SIG_SIZE
 20

	)

421 
	#SCTP_SHA256_SIG_SIZE
 32

	)

427 
	#SCTP_NUM_NOAUTH_CHUNKS
 4

	)

428 
	#SCTP_AUTH_MAX_CHUNKS
 (
SCTP_NUM_CHUNK_TYPES
 - 
SCTP_NUM_NOAUTH_CHUNKS
)

	)

433 
	#SCTP_AUTH_RANDOM_LENGTH
 32

	)

	@debug.c

48 
	~<Ãt/sùp/sùp.h
>

50 #ià
SCTP_DEBUG


51 
	gsùp_debug_æag
 = 1;

55 cÚ¡ *cÚ¡ 
	gsùp_cid_tbl
[
SCTP_NUM_BASE_CHUNK_TYPES
] = {

74 cÚ¡ *
	$sùp_úame
(cÚ¡ 
sùp_subty³_t
 
cid
)

76 ià(
cid
.
chunk
 <ğ
SCTP_CID_BASE_MAX
)

77  
sùp_cid_tbl
[
cid
.
chunk
];

79 
cid
.
chunk
) {

80 
SCTP_CID_ASCONF
:

83 
SCTP_CID_ASCONF_ACK
:

86 
SCTP_CID_FWD_TSN
:

89 
SCTP_CID_AUTH
:

97 
	}
}

100 cÚ¡ *cÚ¡ 
	gsùp_¡©e_tbl
[
SCTP_STATE_NUM_STATES
] = {

113 cÚ¡ *cÚ¡ 
	gsùp_ev‰y³_tbl
[] = {

122 cÚ¡ *cÚ¡ 
	gsùp_¡©us_tbl
[] = {

135 cÚ¡ *cÚ¡ 
	gsùp_´im™ive_tbl
[
SCTP_NUM_PRIMITIVE_TYPES
] = {

145 cÚ¡ *
	$sùp_²ame
(cÚ¡ 
sùp_subty³_t
 
id
)

147 ià(
id
.
´im™ive
 <ğ
SCTP_EVENT_PRIMITIVE_MAX
)

148  
sùp_´im™ive_tbl
[
id
.
´im™ive
];

150 
	}
}

152 cÚ¡ *cÚ¡ 
	gsùp_Ùh”_tbl
[] = {

158 cÚ¡ *
	$sùp_Úame
(cÚ¡ 
sùp_subty³_t
 
id
)

160 ià(
id
.
Ùh”
 <ğ
SCTP_EVENT_OTHER_MAX
)

161  
sùp_Ùh”_tbl
[
id
.
Ùh”
];

163 
	}
}

165 cÚ¡ *cÚ¡ 
	gsùp_tim”_tbl
[] = {

179 cÚ¡ *
	$sùp_Šame
(cÚ¡ 
sùp_subty³_t
 
id
)

181 ià(
id
.
timeout
 <ğ
SCTP_EVENT_TIMEOUT_MAX
)

182  
sùp_tim”_tbl
[
id
.
timeout
];

184 
	}
}

	@endpointola.c

48 
	~<lšux/ty³s.h
>

49 
	~<lšux/¦ab.h
>

50 
	~<lšux/š.h
>

51 
	~<lšux/¿ndom.h
>

52 
	~<lšux/üy±o.h
>

53 
	~<Ãt/sock.h
>

54 
	~<Ãt/v6.h
>

55 
	~<Ãt/sùp/sùp.h
>

56 
	~<Ãt/sùp/sm.h
>

59 
sùp_’dpošt_bh_rcv
(
wÜk_¡ruù
 *
wÜk
);

64 
sùp_’dpošt
 *
	$sùp_’dpošt_š™
(
sùp_’dpošt
 *
•
,

65 
sock
 *
sk
,

66 
gå_t
 
gå
)

68 
sùp_hmac_®go_·¿m
 *
auth_hmacs
 = 
NULL
;

69 
sùp_chunks_·¿m
 *
auth_chunks
 = 
NULL
;

70 
sùp_sh¬ed_key
 *
nuÎ_key
;

71 
”r
;

73 
•
->
dige¡
 = 
	`kz®loc
(
SCTP_SIGNATURE_SIZE
, 
gå
);

74 ià(!
•
->
dige¡
)

75  
NULL
;

77 ià(
sùp_auth_’abË
) {

82 
auth_hmacs
 = 
	`kz®loc
((
sùp_hmac_®go_·¿m_t
) +

83 (
__u16
è* 
SCTP_AUTH_NUM_HMACS
, 
gå
);

84 ià(!
auth_hmacs
)

85 
nomem
;

87 
auth_chunks
 = 
	`kz®loc
((
sùp_chunks_·¿m_t
) +

88 
SCTP_NUM_CHUNK_TYPES
, 
gå
);

89 ià(!
auth_chunks
)

90 
nomem
;

97 
auth_hmacs
->
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_HMAC_ALGO
;

98 
auth_hmacs
->
·¿m_hdr
.
Ëngth
 =

99 
	`htÚs
((
sùp_·¿mhdr_t
) + 2);

100 
auth_hmacs
->
hmac_ids
[0] = 
	`htÚs
(
SCTP_AUTH_HMAC_ID_SHA1
);

103 
auth_chunks
->
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_CHUNKS
;

104 
auth_chunks
->
·¿m_hdr
.
Ëngth
 = 
	`htÚs
((
sùp_·¿mhdr_t
));

109 ià(
sùp_add_’abË
) {

110 
auth_chunks
->
chunks
[0] = 
SCTP_CID_ASCONF
;

111 
auth_chunks
->
chunks
[1] = 
SCTP_CID_ASCONF_ACK
;

112 
auth_chunks
->
·¿m_hdr
.
Ëngth
 =

113 
	`htÚs
((
sùp_·¿mhdr_t
) + 2);

119 
•
->
ba£
.
ty³
 = 
SCTP_EP_TYPE_SOCKET
;

122 
	`©omic_£t
(&
•
->
ba£
.
»fút
, 1);

123 
•
->
ba£
.
d—d
 = 0;

124 
•
->
ba£
.
m®loûd
 = 1;

127 
	`sùp_šq_š™
(&
•
->
ba£
.
šqueue
);

130 
	`sùp_šq_£t_th_hªdËr
(&
•
->
ba£
.
šqueue
, 
sùp_’dpošt_bh_rcv
);

133 
	`sùp_bšd_addr_š™
(&
•
->
ba£
.
bšd_addr
, 0);

136 
•
->
ba£
.
sk
 = sk;

137 
	`sock_hŞd
(
•
->
ba£
.
sk
);

140 
	`INIT_LIST_HEAD
(&
•
->
asocs
);

143 
•
->
¢dbuf_pŞicy
 = 
sùp_¢dbuf_pŞicy
;

145 
sk
->
sk_d©a_»ady
 = 
sùp_d©a_»ady
;

146 
sk
->
sk_wr™e_¥aû
 = 
sùp_wr™e_¥aû
;

147 
	`sock_£t_æag
(
sk
, 
SOCK_USE_WRITE_QUEUE
);

150 
•
->
rcvbuf_pŞicy
 = 
sùp_rcvbuf_pŞicy
;

153 
	`g‘_¿ndom_by‹s
(&
•
->
£ü‘_key
[0], 
SCTP_SECRET_SIZE
);

154 
•
->
Ï¡_key
 =ƒp->
cu¼’t_key
 = 0;

155 
•
->
key_chªged_©
 = 
jiff›s
;

158 
	`INIT_LIST_HEAD
(&
•
->
’dpošt_sh¬ed_keys
);

159 
nuÎ_key
 = 
	`sùp_auth_shkey_ü—‹
(0, 
GFP_KERNEL
);

160 ià(!
nuÎ_key
)

161 
nomem
;

163 
	`li¡_add
(&
nuÎ_key
->
key_li¡
, &
•
->
’dpošt_sh¬ed_keys
);

166 
”r
 = 
	`sùp_auth_š™_hmacs
(
•
, 
gå
);

167 ià(
”r
)

168 
nomem_hmacs
;

173 
•
->
auth_hmacs_li¡
 = 
auth_hmacs
;

174 
•
->
auth_chunk_li¡
 = 
auth_chunks
;

176  
•
;

178 
nomem_hmacs
:

179 
	`sùp_auth_de¡roy_keys
(&
•
->
’dpošt_sh¬ed_keys
);

180 
nomem
:

182 
	`kä“
(
auth_hmacs
);

183 
	`kä“
(
auth_chunks
);

184 
	`kä“
(
•
->
dige¡
);

185  
NULL
;

187 
	}
}

192 
sùp_’dpošt
 *
	$sùp_’dpošt_Ãw
(
sock
 *
sk
, 
gå_t
 
gå
)

194 
sùp_’dpošt
 *
•
;

197 
•
 = 
	`t_Ãw
(
sùp_’dpošt
, 
gå
);

198 ià(!
•
)

199 
ç
;

200 ià(!
	`sùp_’dpošt_š™
(
•
, 
sk
, 
gå
))

201 
ç_š™
;

202 
•
->
ba£
.
m®loûd
 = 1;

203 
	`SCTP_DBG_OBJCNT_INC
(
•
);

204  
•
;

206 
ç_š™
:

207 
	`kä“
(
•
);

208 
ç
:

209  
NULL
;

210 
	}
}

213 
	$sùp_’dpošt_add_asoc
(
sùp_’dpošt
 *
•
, 
sùp_assocŸtiÚ
 *
asoc
)

215 
sock
 *
sk
 = 
•
->
ba£
.sk;

221 ià(
asoc
->
‹mp
)

225 
	`li¡_add_
(&
asoc
->
asocs
, &
•
->asocs);

228 ià(
	`sùp_¡yË
(
sk
, 
TCP
è&& 
	`sùp_s¡©e
(sk, 
LISTENING
))

229 
sk
->
sk_ack_backlog
++;

230 
	}
}

235 
	$sùp_’dpošt_ä“
(
sùp_’dpošt
 *
•
)

237 
•
->
ba£
.
d—d
 = 1;

239 
•
->
ba£
.
sk
->
sk_¡©e
 = 
SCTP_SS_CLOSED
;

242 
	`sùp_unhash_’dpošt
(
•
);

244 
	`sùp_’dpošt_put
(
•
);

245 
	}
}

248 
	$sùp_’dpošt_de¡roy
(
sùp_’dpošt
 *
•
)

250 
	`SCTP_ASSERT
(
•
->
ba£
.
d—d
, "Endpoint is‚ot dead", );

253 
	`üy±o_ä“_hash
(
	`sùp_sk
(
•
->
ba£
.
sk
)->
hmac
);

256 
	`kä“
(
•
->
dige¡
);

261 
	`sùp_auth_de¡roy_keys
(&
•
->
’dpošt_sh¬ed_keys
);

262 
	`kä“
(
•
->
auth_hmacs_li¡
);

263 
	`kä“
(
•
->
auth_chunk_li¡
);

266 
	`sùp_auth_de¡roy_hmacs
(
•
->
auth_hmacs
);

269 
	`sùp_šq_ä“
(&
•
->
ba£
.
šqueue
);

270 
	`sùp_bšd_addr_ä“
(&
•
->
ba£
.
bšd_addr
);

273 ià(
	`sùp_sk
(
•
->
ba£
.
sk
)->
bšd_hash
)

274 
	`sùp_put_pÜt
(
•
->
ba£
.
sk
);

277 ià(
•
->
ba£
.
sk
)

278 
	`sock_put
(
•
->
ba£
.
sk
);

281 ià(
•
->
ba£
.
m®loûd
) {

282 
	`kä“
(
•
);

283 
	`SCTP_DBG_OBJCNT_DEC
(
•
);

285 
	}
}

288 
	$sùp_’dpošt_hŞd
(
sùp_’dpošt
 *
•
)

290 
	`©omic_šc
(&
•
->
ba£
.
»fút
);

291 
	}
}

296 
	$sùp_’dpošt_put
(
sùp_’dpošt
 *
•
)

298 ià(
	`©omic_dec_ªd_‹¡
(&
•
->
ba£
.
»fút
))

299 
	`sùp_’dpošt_de¡roy
(
•
);

300 
	}
}

303 
sùp_’dpošt
 *
	$sùp_’dpošt_is_m©ch
(
sùp_’dpošt
 *
•
,

304 cÚ¡ 
sùp_addr
 *
Ïddr
)

306 
sùp_’dpošt
 *
»tv®
 = 
NULL
;

308 ià(
	`htÚs
(
•
->
ba£
.
bšd_addr
.
pÜt
è=ğ
Ïddr
->
v4
.
sš_pÜt
) {

309 ià(
	`sùp_bšd_addr_m©ch
(&
•
->
ba£
.
bšd_addr
, 
Ïddr
,

310 
	`sùp_sk
(
•
->
ba£
.
sk
)))

311 
»tv®
 = 
•
;

314  
»tv®
;

315 
	}
}

321 
sùp_assocŸtiÚ
 *
	$__sùp_’dpošt_lookup_assoc
(

322 cÚ¡ 
sùp_’dpošt
 *
•
,

323 cÚ¡ 
sùp_addr
 *
·ddr
,

324 
sùp_Œª¥Üt
 **
Œª¥Üt
)

326 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

327 
sùp_Œª¥Üt
 *
t
 = 
NULL
;

328 
sùp_hashbuck‘
 *
h—d
;

329 
sùp_•_commÚ
 *
•b
;

330 
hli¡_node
 *
node
;

331 
hash
;

332 
½Üt
;

334 *
Œª¥Üt
 = 
NULL
;

335 
½Üt
 = 
	`Áohs
(
·ddr
->
v4
.
sš_pÜt
);

337 
hash
 = 
	`sùp_assoc_hashâ
(
•
->
ba£
.
bšd_addr
.
pÜt
, 
½Üt
);

338 
h—d
 = &
sùp_assoc_hashbË
[
hash
];

339 
	`»ad_lock
(&
h—d
->
lock
);

340 
	`sùp_fÜ_—ch_h’Œy
(
•b
, 
node
, &
h—d
->
chaš
) {

341 
asoc
 = 
	`sùp_assoc
(
•b
);

342 ià(
asoc
->
•
 !ğ• || 
½Üt
 !ğasoc->
³”
.
pÜt
)

343 
Ãxt
;

345 
t
 = 
	`sùp_assoc_lookup_·ddr
(
asoc
, 
·ddr
);

346 ià(
t
) {

347 *
Œª¥Üt
 = 
t
;

350 
Ãxt
:

351 
asoc
 = 
NULL
;

353 
	`»ad_uÆock
(&
h—d
->
lock
);

354  
asoc
;

355 
	}
}

358 
sùp_assocŸtiÚ
 *
	$sùp_’dpošt_lookup_assoc
(

359 cÚ¡ 
sùp_’dpošt
 *
•
,

360 cÚ¡ 
sùp_addr
 *
·ddr
,

361 
sùp_Œª¥Üt
 **
Œª¥Üt
)

363 
sùp_assocŸtiÚ
 *
asoc
;

365 
	`sùp_loÿl_bh_di§bË
();

366 
asoc
 = 
	`__sùp_’dpošt_lookup_assoc
(
•
, 
·ddr
, 
Œª¥Üt
);

367 
	`sùp_loÿl_bh_’abË
();

369  
asoc
;

370 
	}
}

375 
	$sùp_’dpošt_is_³–ed_off
(
sùp_’dpošt
 *
•
,

376 cÚ¡ 
sùp_addr
 *
·ddr
)

378 
sùp_sockaddr_’Œy
 *
addr
;

379 
sùp_bšd_addr
 *
bp
;

381 
bp
 = &
•
->
ba£
.
bšd_addr
;

385 
	`li¡_fÜ_—ch_’Œy
(
addr
, &
bp
->
add»ss_li¡
, 
li¡
) {

386 ià(
	`sùp_has_assocŸtiÚ
(&
addr
->
a
, 
·ddr
))

391 
	}
}

396 
	$sùp_’dpošt_bh_rcv
(
wÜk_¡ruù
 *
wÜk
)

398 
sùp_’dpošt
 *
•
 =

399 
	`cÚš”_of
(
wÜk
, 
sùp_’dpošt
,

400 
ba£
.
šqueue
.
immedŸ‹
);

401 
sùp_assocŸtiÚ
 *
asoc
;

402 
sock
 *
sk
;

403 
sùp_Œª¥Üt
 *
Œª¥Üt
;

404 
sùp_chunk
 *
chunk
;

405 
sùp_šq
 *
šqueue
;

406 
sùp_subty³_t
 
subty³
;

407 
sùp_¡©e_t
 
¡©e
;

408 
”rÜ
 = 0;

409 
fœ¡_time
 = 1;

411 ià(
•
->
ba£
.
d—d
)

414 
asoc
 = 
NULL
;

415 
šqueue
 = &
•
->
ba£
.inqueue;

416 
sk
 = 
•
->
ba£
.sk;

418 
NULL
 !ğ(
chunk
 = 
	`sùp_šq_pİ
(
šqueue
))) {

419 
subty³
 = 
	`SCTP_ST_CHUNK
(
chunk
->
chunk_hdr
->
ty³
);

424 ià(
fœ¡_time
 && (
subty³
.
chunk
 =ğ
SCTP_CID_AUTH
)) {

425 
sùp_chunkhdr
 *
Ãxt_hdr
;

427 
Ãxt_hdr
 = 
	`sùp_šq_³ek
(
šqueue
);

428 ià(!
Ãxt_hdr
)

429 
nÜm®
;

436 ià(
Ãxt_hdr
->
ty³
 =ğ
SCTP_CID_COOKIE_ECHO
) {

437 
chunk
->
auth_chunk
 = 
	`skb_şÚe
(chunk->
skb
,

438 
GFP_ATOMIC
);

439 
chunk
->
auth
 = 1;

443 
nÜm®
:

450 ià(
NULL
 =ğ
chunk
->
asoc
) {

451 
asoc
 = 
	`sùp_’dpošt_lookup_assoc
(
•
,

452 
	`sùp_sourû
(
chunk
),

453 &
Œª¥Üt
);

454 
chunk
->
asoc
 =‡soc;

455 
chunk
->
Œª¥Üt
 =ransport;

458 
¡©e
 = 
asoc
 ?‡soc->¡©: 
SCTP_STATE_CLOSED
;

459 ià(
	`sùp_auth_»cv_cid
(
subty³
.
chunk
, 
asoc
è&& !chunk->
auth
)

465 ià(
asoc
 && 
	`sùp_chunk_is_d©a
(
chunk
))

466 
asoc
->
³”
.
Ï¡_d©a_äom
 = 
chunk
->
Œª¥Üt
;

468 
	`SCTP_INC_STATS
(
SCTP_MIB_INCTRLCHUNKS
);

470 ià(
chunk
->
Œª¥Üt
)

471 
chunk
->
Œª¥Üt
->
Ï¡_time_h—rd
.
tv64
 = 
jiff›s
;

473 
”rÜ
 = 
	`sùp_do_sm
(
SCTP_EVENT_T_CHUNK
, 
subty³
, 
¡©e
,

474 
•
, 
asoc
, 
chunk
, 
GFP_ATOMIC
);

476 ià(
”rÜ
 && 
chunk
)

477 
chunk
->
pdisÿrd
 = 1;

482 ià(!
	`sùp_sk
(
sk
)->
•
)

485 ià(
fœ¡_time
)

486 
fœ¡_time
 = 0;

488 
	}
}

	@input.c

51 
	~<lšux/ty³s.h
>

52 
	~<lšux/li¡.h
>

53 
	~<lšux/sock‘.h
>

54 
	~<lšux/.h
>

55 
	~<lšux/time.h
>

56 
	~<Ãt/.h
>

57 
	~<Ãt/icmp.h
>

58 
	~<Ãt/¢mp.h
>

59 
	~<Ãt/sock.h
>

60 
	~<Ãt/xäm.h
>

61 
	~<Ãt/sùp/sùp.h
>

62 
	~<Ãt/sùp/sm.h
>

63 
	~<Ãt/sùp/checksum.h
>

64 
	~<Ãt/Ãt_Çme¥aû.h
>

67 
sùp_rcv_oÙb
(
sk_buff
 *);

68 
sùp_assocŸtiÚ
 *
__sùp_rcv_lookup
(
sk_buff
 *
skb
,

69 cÚ¡ 
sùp_addr
 *
Ïddr
,

70 cÚ¡ 
sùp_addr
 *
·ddr
,

71 
sùp_Œª¥Üt
 **
Œª¥Ü
);

72 
sùp_’dpošt
 *
__sùp_rcv_lookup_’dpošt
(cÚ¡ 
sùp_addr
 *
Ïddr
);

73 
sùp_assocŸtiÚ
 *
__sùp_lookup_assocŸtiÚ
(

74 cÚ¡ 
sùp_addr
 *
loÿl
,

75 cÚ¡ 
sùp_addr
 *
³”
,

76 
sùp_Œª¥Üt
 **
±
);

78 
sùp_add_backlog
(
sock
 *
sk
, 
sk_buff
 *
skb
);

82 
šlše
 
	$sùp_rcv_checksum
(
sk_buff
 *
skb
)

84 
sùphdr
 *
sh
 = 
	`sùp_hdr
(
skb
);

85 
__Ë32
 
cmp
 = 
sh
->
checksum
;

86 
sk_buff
 *
li¡
;

87 
__Ë32
 
v®
;

88 
__u32
 
tmp
 = 
	`sùp_¡¬t_cksum
((
__u8
 *)
sh
, 
	`skb_h—dËn
(
skb
));

90 
	`skb_w®k_äags
(
skb
, 
li¡
)

91 
tmp
 = 
	`sùp_upd©e_cksum
((
__u8
 *)
li¡
->
d©a
, 
	`skb_h—dËn
(list),

92 
tmp
);

94 
v®
 = 
	`sùp_’d_cksum
(
tmp
);

96 ià(
v®
 !ğ
cmp
) {

98 
	`SCTP_INC_STATS_BH
(
SCTP_MIB_CHECKSUMERRORS
);

102 
	}
}

104 
	ssùp_šput_cb
 {

106 
š‘_skb_·rm
 
	mh4
;

107 #ià
defšed
(
CONFIG_IPV6
è|| defšed (
CONFIG_IPV6_MODULE
)

108 
š‘6_skb_·rm
 
	mh6
;

110 } 
	mh—d”
;

111 
sùp_chunk
 *
	mchunk
;

113 
	#SCTP_INPUT_CB
(
__skb
è((
sùp_šput_cb
 *)&((__skb)->
cb
[0]))

	)

118 
	$sùp_rcv
(
sk_buff
 *
skb
)

120 
sock
 *
sk
;

121 
sùp_assocŸtiÚ
 *
asoc
;

122 
sùp_’dpošt
 *
•
 = 
NULL
;

123 
sùp_•_commÚ
 *
rcvr
;

124 
sùp_Œª¥Üt
 *
Œª¥Üt
 = 
NULL
;

125 
sùp_chunk
 *
chunk
;

126 
sùphdr
 *
sh
;

127 
sùp_addr
 
¤c
;

128 
sùp_addr
 
de¡
;

129 
çmy
;

130 
sùp_af
 *
af
;

132 ià(
skb
->
pkt_ty³
!=
PACKET_HOST
)

133 
disÿrd_™
;

135 
	`SCTP_INC_STATS_BH
(
SCTP_MIB_INSCTPPACKS
);

137 ià(
	`skb_lš—rize
(
skb
))

138 
disÿrd_™
;

140 
sh
 = 
	`sùp_hdr
(
skb
);

143 
	`__skb_puÎ
(
skb
, 
	`skb_Œª¥Üt_off£t
(skb));

144 ià(
skb
->
Ën
 < (
sùphdr
))

145 
disÿrd_™
;

146 ià(!
sùp_checksum_di§bË
 && !
	`skb_csum_uÂeûs§ry
(
skb
) &&

147 
	`sùp_rcv_checksum
(
skb
) < 0)

148 
disÿrd_™
;

150 
	`skb_puÎ
(
skb
, (
sùphdr
));

153 ià(
skb
->
Ën
 < (
sùp_chunkhdr
))

154 
disÿrd_™
;

156 
çmy
 = 
	`v”2af
(
	`_hdr
(
skb
)->
v”siÚ
);

157 
af
 = 
	`sùp_g‘_af_¥ecific
(
çmy
);

158 ià(
	`uÆik–y
(!
af
))

159 
disÿrd_™
;

162 
af
->
	`äom_skb
(&
¤c
, 
skb
, 1);

163 
af
->
	`äom_skb
(&
de¡
, 
skb
, 0);

176 ià(!
af
->
	`addr_v®id
(&
¤c
, 
NULL
, 
skb
) ||

177 !
af
->
	`addr_v®id
(&
de¡
, 
NULL
, 
skb
))

178 
disÿrd_™
;

180 
asoc
 = 
	`__sùp_rcv_lookup
(
skb
, &
¤c
, &
de¡
, &
Œª¥Üt
);

182 ià(!
asoc
)

183 
•
 = 
	`__sùp_rcv_lookup_’dpošt
(&
de¡
);

186 
rcvr
 = 
asoc
 ? &asoc->
ba£
 : &
•
->base;

187 
sk
 = 
rcvr
->sk;

193 ià(
sk
->
sk_bound_dev_if
 && (sk->sk_bound_dev_ià!ğ
af
->
	`skb_iif
(
skb
)))

195 ià(
asoc
) {

196 
	`sùp_assocŸtiÚ_put
(
asoc
);

197 
asoc
 = 
NULL
;

199 
	`sùp_’dpošt_put
(
•
);

200 
•
 = 
NULL
;

202 
sk
 = 
	`sùp_g‘_ùl_sock
();

203 
•
 = 
	`sùp_sk
(
sk
)->ep;

204 
	`sùp_’dpošt_hŞd
(
•
);

205 
rcvr
 = &
•
->
ba£
;

216 ià(!
asoc
) {

217 ià(
	`sùp_rcv_oÙb
(
skb
)) {

218 
	`SCTP_INC_STATS_BH
(
SCTP_MIB_OUTOFBLUES
);

219 
disÿrd_»Ëa£
;

223 ià(!
	`xäm_pŞicy_check
(
sk
, 
XFRM_POLICY_IN
, 
skb
, 
çmy
))

224 
disÿrd_»Ëa£
;

225 
	`nf_»£t
(
skb
);

227 ià(
	`sk_f‹r
(
sk
, 
skb
))

228 
disÿrd_»Ëa£
;

231 
chunk
 = 
	`sùp_chunkify
(
skb
, 
asoc
, 
sk
);

232 ià(!
chunk
)

233 
disÿrd_»Ëa£
;

234 
	`SCTP_INPUT_CB
(
skb
)->
chunk
 = chunk;

237 
chunk
->
rcvr
 =„cvr;

240 
chunk
->
sùp_hdr
 = 
sh
;

243 
	`sùp_š™_addrs
(
chunk
, &
¤c
, &
de¡
);

246 
chunk
->
Œª¥Üt
 =ransport;

252 
	`sùp_bh_lock_sock
(
sk
);

254 ià(
sk
 !ğ
rcvr
->sk) {

262 
	`sùp_bh_uÆock_sock
(
sk
);

263 
sk
 = 
rcvr
->sk;

264 
	`sùp_bh_lock_sock
(
sk
);

267 ià(
	`sock_owÃd_by_u£r
(
sk
)) {

268 ià(
	`sùp_add_backlog
(
sk
, 
skb
)) {

269 
	`sùp_bh_uÆock_sock
(
sk
);

270 
	`sùp_chunk_ä“
(
chunk
);

271 
skb
 = 
NULL
;

272 
disÿrd_»Ëa£
;

274 
	`SCTP_INC_STATS_BH
(
SCTP_MIB_IN_PKT_BACKLOG
);

276 
	`SCTP_INC_STATS_BH
(
SCTP_MIB_IN_PKT_SOFTIRQ
);

277 
	`sùp_šq_push
(&
chunk
->
rcvr
->
šqueue
, chunk);

280 
	`sùp_bh_uÆock_sock
(
sk
);

283 ià(
asoc
)

284 
	`sùp_assocŸtiÚ_put
(
asoc
);

286 
	`sùp_’dpošt_put
(
•
);

290 
disÿrd_™
:

291 
	`SCTP_INC_STATS_BH
(
SCTP_MIB_IN_PKT_DISCARDS
);

292 
	`kä“_skb
(
skb
);

295 
disÿrd_»Ëa£
:

297 ià(
asoc
)

298 
	`sùp_assocŸtiÚ_put
(
asoc
);

300 
	`sùp_’dpošt_put
(
•
);

302 
disÿrd_™
;

303 
	}
}

310 
	$sùp_backlog_rcv
(
sock
 *
sk
, 
sk_buff
 *
skb
)

312 
sùp_chunk
 *
chunk
 = 
	`SCTP_INPUT_CB
(
skb
)->chunk;

313 
sùp_šq
 *
šqueue
 = &
chunk
->
rcvr
->inqueue;

314 
sùp_•_commÚ
 *
rcvr
 = 
NULL
;

315 
backloged
 = 0;

317 
rcvr
 = 
chunk
->rcvr;

323 ià(
rcvr
->
d—d
) {

324 
	`sùp_chunk_ä“
(
chunk
);

325 
dÚe
;

328 ià(
	`uÆik–y
(
rcvr
->
sk
 != sk)) {

340 
sk
 = 
rcvr
->sk;

341 
	`sùp_bh_lock_sock
(
sk
);

343 ià(
	`sock_owÃd_by_u£r
(
sk
)) {

344 ià(
	`sk_add_backlog
(
sk
, 
skb
))

345 
	`sùp_chunk_ä“
(
chunk
);

347 
backloged
 = 1;

349 
	`sùp_šq_push
(
šqueue
, 
chunk
);

351 
	`sùp_bh_uÆock_sock
(
sk
);

354 ià(
backloged
)

357 
	`sùp_šq_push
(
šqueue
, 
chunk
);

360 
dÚe
:

362 ià(
SCTP_EP_TYPE_ASSOCIATION
 =ğ
rcvr
->
ty³
)

363 
	`sùp_assocŸtiÚ_put
(
	`sùp_assoc
(
rcvr
));

364 ià(
SCTP_EP_TYPE_SOCKET
 =ğ
rcvr
->
ty³
)

365 
	`sùp_’dpošt_put
(
	`sùp_•
(
rcvr
));

367 
	`BUG
();

370 
	}
}

372 
	$sùp_add_backlog
(
sock
 *
sk
, 
sk_buff
 *
skb
)

374 
sùp_chunk
 *
chunk
 = 
	`SCTP_INPUT_CB
(
skb
)->chunk;

375 
sùp_•_commÚ
 *
rcvr
 = 
chunk
->rcvr;

376 
»t
;

378 
»t
 = 
	`sk_add_backlog
(
sk
, 
skb
);

379 ià(!
»t
) {

384 ià(
SCTP_EP_TYPE_ASSOCIATION
 =ğ
rcvr
->
ty³
)

385 
	`sùp_assocŸtiÚ_hŞd
(
	`sùp_assoc
(
rcvr
));

386 ià(
SCTP_EP_TYPE_SOCKET
 =ğ
rcvr
->
ty³
)

387 
	`sùp_’dpošt_hŞd
(
	`sùp_•
(
rcvr
));

389 
	`BUG
();

391  
»t
;

393 
	}
}

396 
	$sùp_icmp_äag_Ãeded
(
sock
 *
sk
, 
sùp_assocŸtiÚ
 *
asoc
,

397 
sùp_Œª¥Üt
 *
t
, 
__u32
 
pmtu
)

399 ià(!
t
 || (t->
·thmtu
 <ğ
pmtu
))

402 ià(
	`sock_owÃd_by_u£r
(
sk
)) {

403 
asoc
->
pmtu_³ndšg
 = 1;

404 
t
->
pmtu_³ndšg
 = 1;

408 ià(
t
->
·¿m_æags
 & 
SPP_PMTUD_ENABLE
) {

410 
	`sùp_Œª¥Üt_upd©e_pmtu
(
t
, 
pmtu
);

413 
	`sùp_assoc_sync_pmtu
(
asoc
);

422 
	`sùp_»Œªsm™
(&
asoc
->
outqueue
, 
t
, 
SCTP_RTXR_PMTUD
);

423 
	}
}

436 
	$sùp_icmp_´Ùo_uÄ—chabË
(
sock
 *
sk
,

437 
sùp_assocŸtiÚ
 *
asoc
,

438 
sùp_Œª¥Üt
 *
t
)

440 
	`SCTP_DEBUG_PRINTK
("%s\n", 
__func__
);

442 ià(
	`sock_owÃd_by_u£r
(
sk
)) {

443 ià(
	`tim”_³ndšg
(&
t
->
´Ùo_uÄ—ch_tim”
))

446 ià(!
	`mod_tim”
(&
t
->
´Ùo_uÄ—ch_tim”
,

447 
jiff›s
 + (
HZ
/20)))

448 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

452 ià(
	`tim”_³ndšg
(&
t
->
´Ùo_uÄ—ch_tim”
) &&

453 
	`d–_tim”
(&
t
->
´Ùo_uÄ—ch_tim”
))

454 
	`sùp_assocŸtiÚ_put
(
asoc
);

456 
	`sùp_do_sm
(
SCTP_EVENT_T_OTHER
,

457 
	`SCTP_ST_OTHER
(
SCTP_EVENT_ICMP_PROTO_UNREACH
),

458 
asoc
->
¡©e
,‡soc->
•
,‡soc, 
t
,

459 
GFP_ATOMIC
);

461 
	}
}

464 
sock
 *
	$sùp_”r_lookup
(
çmy
, 
sk_buff
 *
skb
,

465 
sùphdr
 *sctphdr,

466 
sùp_assocŸtiÚ
 **
­p
,

467 
sùp_Œª¥Üt
 **
p
)

469 
sùp_addr
 
§ddr
;

470 
sùp_addr
 
daddr
;

471 
sùp_af
 *
af
;

472 
sock
 *
sk
 = 
NULL
;

473 
sùp_assocŸtiÚ
 *
asoc
;

474 
sùp_Œª¥Üt
 *
Œª¥Üt
 = 
NULL
;

475 
sùp_š™_chunk
 *
chunkhdr
;

476 
__u32
 
vg
 = 
	`Áohl
(
sùphdr
->vtag);

477 
Ën
 = 
skb
->ËÀ- ((*)
sùphdr
 - (*)skb->
d©a
);

479 *
­p
 = 
NULL
; *
p
 = NULL;

481 
af
 = 
	`sùp_g‘_af_¥ecific
(
çmy
);

482 ià(
	`uÆik–y
(!
af
)) {

483  
NULL
;

487 
af
->
	`äom_skb
(&
§ddr
, 
skb
, 1);

488 
af
->
	`äom_skb
(&
daddr
, 
skb
, 0);

493 
asoc
 = 
	`__sùp_lookup_assocŸtiÚ
(&
§ddr
, &
daddr
, &
Œª¥Üt
);

494 ià(!
asoc
)

495  
NULL
;

497 
sk
 = 
asoc
->
ba£
.sk;

511 ià(
vg
 == 0) {

512 
chunkhdr
 = (
sùp_š™_chunk
 *)((*)
sùphdr


513 + (
sùphdr
));

514 ià(
Ën
 < (
sùphdr
è+ (
sùp_chunkhdr_t
)

515 + (
__be32
) ||

516 
chunkhdr
->
chunk_hdr
.
ty³
 !ğ
SCTP_CID_INIT
 ||

517 
	`Áohl
(
chunkhdr
->
š™_hdr
.
š™_g
è!ğ
asoc
->
c
.
my_vg
) {

518 
out
;

520 } ià(
vg
 !ğ
asoc
->
c
.
³”_vg
) {

521 
out
;

524 
	`sùp_bh_lock_sock
(
sk
);

529 ià(
	`sock_owÃd_by_u£r
(
sk
))

530 
	`NET_INC_STATS_BH
(&
š™_Ãt
, 
LINUX_MIB_LOCKDROPPEDICMPS
);

532 *
­p
 = 
asoc
;

533 *
p
 = 
Œª¥Üt
;

534  
sk
;

536 
out
:

537 ià(
asoc
)

538 
	`sùp_assocŸtiÚ_put
(
asoc
);

539  
NULL
;

540 
	}
}

543 
	$sùp_”r_fšish
(
sock
 *
sk
, 
sùp_assocŸtiÚ
 *
asoc
)

545 
	`sùp_bh_uÆock_sock
(
sk
);

546 ià(
asoc
)

547 
	`sùp_assocŸtiÚ_put
(
asoc
);

548 
	}
}

565 
	$sùp_v4_”r
(
sk_buff
 *
skb
, 
__u32
 
šfo
)

567 
hdr
 *
h
 = (hd¸*)
skb
->
d©a
;

568 cÚ¡ 
ihËn
 = 
h
->
ihl
 * 4;

569 cÚ¡ 
ty³
 = 
	`icmp_hdr
(
skb
)->type;

570 cÚ¡ 
code
 = 
	`icmp_hdr
(
skb
)->code;

571 
sock
 *
sk
;

572 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

573 
sùp_Œª¥Üt
 *
Œª¥Üt
;

574 
š‘_sock
 *
š‘
;

575 
sk_buff_d©a_t
 
§ve
, 
§vesùp
;

576 
”r
;

578 ià(
skb
->
Ën
 < 
ihËn
 + 8) {

579 
	`ICMP_INC_STATS_BH
(&
š™_Ãt
, 
ICMP_MIB_INERRORS
);

584 
§ve
 = 
skb
->
ÃtwÜk_h—d”
;

585 
§vesùp
 = 
skb
->
Œª¥Üt_h—d”
;

586 
	`skb_»£t_ÃtwÜk_h—d”
(
skb
);

587 
	`skb_£t_Œª¥Üt_h—d”
(
skb
, 
ihËn
);

588 
sk
 = 
	`sùp_”r_lookup
(
AF_INET
, 
skb
, 
	`sùp_hdr
(skb), &
asoc
, &
Œª¥Üt
);

590 
skb
->
ÃtwÜk_h—d”
 = 
§ve
;

591 
skb
->
Œª¥Üt_h—d”
 = 
§vesùp
;

592 ià(!
sk
) {

593 
	`ICMP_INC_STATS_BH
(&
š™_Ãt
, 
ICMP_MIB_INERRORS
);

600 
ty³
) {

601 
ICMP_PARAMETERPROB
:

602 
”r
 = 
EPROTO
;

604 
ICMP_DEST_UNREACH
:

605 ià(
code
 > 
NR_ICMP_UNREACH
)

606 
out_uÆock
;

609 ià(
ICMP_FRAG_NEEDED
 =ğ
code
) {

610 
	`sùp_icmp_äag_Ãeded
(
sk
, 
asoc
, 
Œª¥Üt
, 
šfo
);

611 
out_uÆock
;

614 ià(
ICMP_PROT_UNREACH
 =ğ
code
) {

615 
	`sùp_icmp_´Ùo_uÄ—chabË
(
sk
, 
asoc
,

616 
Œª¥Üt
);

617 
out_uÆock
;

620 
”r
 = 
icmp_”r_cÚv”t
[
code
].
”ºo
;

622 
ICMP_TIME_EXCEEDED
:

626 ià(
ICMP_EXC_FRAGTIME
 =ğ
code
)

627 
out_uÆock
;

629 
”r
 = 
EHOSTUNREACH
;

632 
out_uÆock
;

635 
š‘
 = 
	`š‘_sk
(
sk
);

636 ià(!
	`sock_owÃd_by_u£r
(
sk
è&& 
š‘
->
»cv”r
) {

637 
sk
->
sk_”r
 = 
”r
;

638 
sk
->
	`sk_”rÜ_»pÜt
(sk);

640 
sk
->
sk_”r_soá
 = 
”r
;

643 
out_uÆock
:

644 
	`sùp_”r_fšish
(
sk
, 
asoc
);

645 
	}
}

659 
	$sùp_rcv_oÙb
(
sk_buff
 *
skb
)

661 
sùp_chunkhdr_t
 *
ch
;

662 
__u8
 *
ch_’d
;

664 
ch
 = (
sùp_chunkhdr_t
 *è
skb
->
d©a
;

669 ià(
	`Áohs
(
ch
->
Ëngth
è< (
sùp_chunkhdr_t
))

672 
ch_’d
 = ((
__u8
 *)
ch
è+ 
	`WORD_ROUND
(
	`Áohs
(ch->
Ëngth
));

673 ià(
ch_’d
 > 
	`skb__poš‹r
(
skb
))

680 ià(
SCTP_CID_ABORT
 =ğ
ch
->
ty³
)

681 
disÿrd
;

687 ià(
SCTP_CID_SHUTDOWN_COMPLETE
 =ğ
ch
->
ty³
)

688 
disÿrd
;

695 ià(
SCTP_CID_INIT
 =ğ
ch
->
ty³
 && (*)ch !ğ
skb
->
d©a
)

696 
disÿrd
;

698 
ch
 = (
sùp_chunkhdr_t
 *è
ch_’d
;

699 } 
ch_’d
 < 
	`skb__poš‹r
(
skb
));

703 
disÿrd
:

705 
	}
}

708 
	$__sùp_hash_’dpošt
(
sùp_’dpošt
 *
•
)

710 
sùp_•_commÚ
 *
•b
;

711 
sùp_hashbuck‘
 *
h—d
;

713 
•b
 = &
•
->
ba£
;

715 
•b
->
hash’t
 = 
	`sùp_•_hashâ
Ópb->
bšd_addr
.
pÜt
);

716 
h—d
 = &
sùp_•_hashbË
[
•b
->
hash’t
];

718 
	`sùp_wr™e_lock
(&
h—d
->
lock
);

719 
	`hli¡_add_h—d
(&
•b
->
node
, &
h—d
->
chaš
);

720 
	`sùp_wr™e_uÆock
(&
h—d
->
lock
);

721 
	}
}

724 
	$sùp_hash_’dpošt
(
sùp_’dpošt
 *
•
)

726 
	`sùp_loÿl_bh_di§bË
();

727 
	`__sùp_hash_’dpošt
(
•
);

728 
	`sùp_loÿl_bh_’abË
();

729 
	}
}

732 
	$__sùp_unhash_’dpošt
(
sùp_’dpošt
 *
•
)

734 
sùp_hashbuck‘
 *
h—d
;

735 
sùp_•_commÚ
 *
•b
;

737 
•b
 = &
•
->
ba£
;

739 ià(
	`hli¡_unhashed
(&
•b
->
node
))

742 
•b
->
hash’t
 = 
	`sùp_•_hashâ
Ópb->
bšd_addr
.
pÜt
);

744 
h—d
 = &
sùp_•_hashbË
[
•b
->
hash’t
];

746 
	`sùp_wr™e_lock
(&
h—d
->
lock
);

747 
	`__hli¡_d–
(&
•b
->
node
);

748 
	`sùp_wr™e_uÆock
(&
h—d
->
lock
);

749 
	}
}

752 
	$sùp_unhash_’dpošt
(
sùp_’dpošt
 *
•
)

754 
	`sùp_loÿl_bh_di§bË
();

755 
	`__sùp_unhash_’dpošt
(
•
);

756 
	`sùp_loÿl_bh_’abË
();

757 
	}
}

760 
sùp_’dpošt
 *
	$__sùp_rcv_lookup_’dpošt
(cÚ¡ 
sùp_addr
 *
Ïddr
)

762 
sùp_hashbuck‘
 *
h—d
;

763 
sùp_•_commÚ
 *
•b
;

764 
sùp_’dpošt
 *
•
;

765 
hli¡_node
 *
node
;

766 
hash
;

768 
hash
 = 
	`sùp_•_hashâ
(
	`Áohs
(
Ïddr
->
v4
.
sš_pÜt
));

769 
h—d
 = &
sùp_•_hashbË
[
hash
];

770 
	`»ad_lock
(&
h—d
->
lock
);

771 
	`sùp_fÜ_—ch_h’Œy
(
•b
, 
node
, &
h—d
->
chaš
) {

772 
•
 = 
	`sùp_•
(
•b
);

773 ià(
	`sùp_’dpošt_is_m©ch
(
•
, 
Ïddr
))

774 
h™
;

777 
•
 = 
	`sùp_sk
((
	`sùp_g‘_ùl_sock
()))->ep;

779 
h™
:

780 
	`sùp_’dpošt_hŞd
(
•
);

781 
	`»ad_uÆock
(&
h—d
->
lock
);

782  
•
;

783 
	}
}

786 
	$__sùp_hash_e¡ablished
(
sùp_assocŸtiÚ
 *
asoc
)

788 
sùp_•_commÚ
 *
•b
;

789 
sùp_hashbuck‘
 *
h—d
;

791 
•b
 = &
asoc
->
ba£
;

794 
•b
->
hash’t
 = 
	`sùp_assoc_hashâ
Ópb->
bšd_addr
.
pÜt
, 
asoc
->
³”
.port);

796 
h—d
 = &
sùp_assoc_hashbË
[
•b
->
hash’t
];

798 
	`sùp_wr™e_lock
(&
h—d
->
lock
);

799 
	`hli¡_add_h—d
(&
•b
->
node
, &
h—d
->
chaš
);

800 
	`sùp_wr™e_uÆock
(&
h—d
->
lock
);

801 
	}
}

804 
	$sùp_hash_e¡ablished
(
sùp_assocŸtiÚ
 *
asoc
)

806 ià(
asoc
->
‹mp
)

809 
	`sùp_loÿl_bh_di§bË
();

810 
	`__sùp_hash_e¡ablished
(
asoc
);

811 
	`sùp_loÿl_bh_’abË
();

812 
	}
}

815 
	$__sùp_unhash_e¡ablished
(
sùp_assocŸtiÚ
 *
asoc
)

817 
sùp_hashbuck‘
 *
h—d
;

818 
sùp_•_commÚ
 *
•b
;

820 
•b
 = &
asoc
->
ba£
;

822 
•b
->
hash’t
 = 
	`sùp_assoc_hashâ
Ópb->
bšd_addr
.
pÜt
,

823 
asoc
->
³”
.
pÜt
);

825 
h—d
 = &
sùp_assoc_hashbË
[
•b
->
hash’t
];

827 
	`sùp_wr™e_lock
(&
h—d
->
lock
);

828 
	`__hli¡_d–
(&
•b
->
node
);

829 
	`sùp_wr™e_uÆock
(&
h—d
->
lock
);

830 
	}
}

833 
	$sùp_unhash_e¡ablished
(
sùp_assocŸtiÚ
 *
asoc
)

835 ià(
asoc
->
‹mp
)

838 
	`sùp_loÿl_bh_di§bË
();

839 
	`__sùp_unhash_e¡ablished
(
asoc
);

840 
	`sùp_loÿl_bh_’abË
();

841 
	}
}

844 
sùp_assocŸtiÚ
 *
	$__sùp_lookup_assocŸtiÚ
(

845 cÚ¡ 
sùp_addr
 *
loÿl
,

846 cÚ¡ 
sùp_addr
 *
³”
,

847 
sùp_Œª¥Üt
 **
±
)

849 
sùp_hashbuck‘
 *
h—d
;

850 
sùp_•_commÚ
 *
•b
;

851 
sùp_assocŸtiÚ
 *
asoc
;

852 
sùp_Œª¥Üt
 *
Œª¥Üt
;

853 
hli¡_node
 *
node
;

854 
hash
;

859 
hash
 = 
	`sùp_assoc_hashâ
(
	`Áohs
(
loÿl
->
v4
.
sš_pÜt
),‚tohs(
³”
->v4.sin_port));

860 
h—d
 = &
sùp_assoc_hashbË
[
hash
];

861 
	`»ad_lock
(&
h—d
->
lock
);

862 
	`sùp_fÜ_—ch_h’Œy
(
•b
, 
node
, &
h—d
->
chaš
) {

863 
asoc
 = 
	`sùp_assoc
(
•b
);

864 
Œª¥Üt
 = 
	`sùp_assoc_is_m©ch
(
asoc
, 
loÿl
, 
³”
);

865 ià(
Œª¥Üt
)

866 
h™
;

869 
	`»ad_uÆock
(&
h—d
->
lock
);

871  
NULL
;

873 
h™
:

874 *
±
 = 
Œª¥Üt
;

875 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

876 
	`»ad_uÆock
(&
h—d
->
lock
);

877  
asoc
;

878 
	}
}

881 
SCTP_STATIC


882 
sùp_assocŸtiÚ
 *
	$sùp_lookup_assocŸtiÚ
(cÚ¡ 
sùp_addr
 *
Ïddr
,

883 cÚ¡ 
sùp_addr
 *
·ddr
,

884 
sùp_Œª¥Üt
 **
Œª¥Ü
)

886 
sùp_assocŸtiÚ
 *
asoc
;

888 
	`sùp_loÿl_bh_di§bË
();

889 
asoc
 = 
	`__sùp_lookup_assocŸtiÚ
(
Ïddr
, 
·ddr
, 
Œª¥Ü
);

890 
	`sùp_loÿl_bh_’abË
();

892  
asoc
;

893 
	}
}

896 
	$sùp_has_assocŸtiÚ
(cÚ¡ 
sùp_addr
 *
Ïddr
,

897 cÚ¡ 
sùp_addr
 *
·ddr
)

899 
sùp_assocŸtiÚ
 *
asoc
;

900 
sùp_Œª¥Üt
 *
Œª¥Üt
;

902 ià((
asoc
 = 
	`sùp_lookup_assocŸtiÚ
(
Ïddr
, 
·ddr
, &
Œª¥Üt
))) {

903 
	`sùp_assocŸtiÚ_put
(
asoc
);

908 
	}
}

928 
sùp_assocŸtiÚ
 *
	$__sùp_rcv_š™_lookup
(
sk_buff
 *
skb
,

929 cÚ¡ 
sùp_addr
 *
Ïddr
, 
sùp_Œª¥Üt
 **
Œª¥Ü
)

931 
sùp_assocŸtiÚ
 *
asoc
;

932 
sùp_addr
 
addr
;

933 
sùp_addr
 *
·ddr
 = &
addr
;

934 
sùphdr
 *
sh
 = 
	`sùp_hdr
(
skb
);

935 
sùp_chunkhdr_t
 *
ch
;

936 
sùp_·¿ms
 
·¿ms
;

937 
sùp_š™_chunk_t
 *
š™
;

938 
sùp_Œª¥Üt
 *
Œª¥Üt
;

939 
sùp_af
 *
af
;

941 
ch
 = (
sùp_chunkhdr_t
 *è
skb
->
d©a
;

959 
š™
 = (
sùp_š™_chunk_t
 *)
skb
->
d©a
;

962 
	`sùp_w®k_·¿ms
(
·¿ms
, 
š™
, 
š™_hdr
.params) {

965 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`·¿m_ty³2af
(
·¿ms
.
p
->
ty³
));

966 ià(!
af
)

969 
af
->
	`äom_addr_·¿m
(
·ddr
, 
·¿ms
.
addr
, 
sh
->
sourû
, 0);

971 
asoc
 = 
	`__sùp_lookup_assocŸtiÚ
(
Ïddr
, 
·ddr
, &
Œª¥Üt
);

972 ià(
asoc
)

973  
asoc
;

976  
NULL
;

977 
	}
}

993 
sùp_assocŸtiÚ
 *
	$__sùp_rcv_ascÚf_lookup
(

994 
sùp_chunkhdr_t
 *
ch
,

995 cÚ¡ 
sùp_addr
 *
Ïddr
,

996 
__be16
 
³”_pÜt
,

997 
sùp_Œª¥Üt
 **
Œª¥Ü
)

999 
sùp_add_chunk_t
 *
ascÚf
 = (
sùp_add_chunk
 *)
ch
;

1000 
sùp_af
 *
af
;

1001 
sùp_addr_·¿m
 *
·¿m
;

1002 
sùp_addr
 
·ddr
;

1005 
·¿m
 = (
sùp_addr_·¿m
 *)(
ascÚf
 + 1);

1007 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`·¿m_ty³2af
(
·¿m
->
v4
.
·¿m_hdr
.
ty³
));

1008 ià(
	`uÆik–y
(!
af
))

1009  
NULL
;

1011 
af
->
	`äom_addr_·¿m
(&
·ddr
, 
·¿m
, 
³”_pÜt
, 0);

1013  
	`__sùp_lookup_assocŸtiÚ
(
Ïddr
, &
·ddr
, 
Œª¥Ü
);

1014 
	}
}

1026 
sùp_assocŸtiÚ
 *
	$__sùp_rcv_w®k_lookup
(
sk_buff
 *
skb
,

1027 cÚ¡ 
sùp_addr
 *
Ïddr
,

1028 
sùp_Œª¥Üt
 **
Œª¥Ü
)

1030 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

1031 
sùp_chunkhdr_t
 *
ch
;

1032 
have_auth
 = 0;

1033 
chunk_num
 = 1;

1034 
__u8
 *
ch_’d
;

1039 
ch
 = (
sùp_chunkhdr_t
 *è
skb
->
d©a
;

1042 ià(
	`Áohs
(
ch
->
Ëngth
è< (
sùp_chunkhdr_t
))

1045 
ch_’d
 = ((
__u8
 *)
ch
è+ 
	`WORD_ROUND
(
	`Áohs
(ch->
Ëngth
));

1046 ià(
ch_’d
 > 
	`skb__poš‹r
(
skb
))

1049 
ch
->
ty³
) {

1050 
SCTP_CID_AUTH
:

1051 
have_auth
 = 
chunk_num
;

1054 
SCTP_CID_COOKIE_ECHO
:

1062 ià(
have_auth
 =ğ1 && 
chunk_num
 == 2)

1063  
NULL
;

1066 
SCTP_CID_ASCONF
:

1067 ià(
have_auth
 || 
sùp_add_nßuth
)

1068 
asoc
 = 
	`__sùp_rcv_ascÚf_lookup
(
ch
, 
Ïddr
,

1069 
	`sùp_hdr
(
skb
)->
sourû
,

1070 
Œª¥Ü
);

1075 ià(
asoc
)

1078 
ch
 = (
sùp_chunkhdr_t
 *è
ch_’d
;

1079 
chunk_num
++;

1080 } 
ch_’d
 < 
	`skb__poš‹r
(
skb
));

1082  
asoc
;

1083 
	}
}

1091 
sùp_assocŸtiÚ
 *
	$__sùp_rcv_lookup_h¬d”
(
sk_buff
 *
skb
,

1092 cÚ¡ 
sùp_addr
 *
Ïddr
,

1093 
sùp_Œª¥Üt
 **
Œª¥Ü
)

1095 
sùp_chunkhdr_t
 *
ch
;

1097 
ch
 = (
sùp_chunkhdr_t
 *è
skb
->
d©a
;

1104 ià(
	`WORD_ROUND
(
	`Áohs
(
ch
->
Ëngth
)è> 
skb
->
Ën
)

1105  
NULL
;

1108 
ch
->
ty³
) {

1109 
SCTP_CID_INIT
:

1110 
SCTP_CID_INIT_ACK
:

1111  
	`__sùp_rcv_š™_lookup
(
skb
, 
Ïddr
, 
Œª¥Ü
);

1115  
	`__sùp_rcv_w®k_lookup
(
skb
, 
Ïddr
, 
Œª¥Ü
);

1120  
NULL
;

1121 
	}
}

1124 
sùp_assocŸtiÚ
 *
	$__sùp_rcv_lookup
(
sk_buff
 *
skb
,

1125 cÚ¡ 
sùp_addr
 *
·ddr
,

1126 cÚ¡ 
sùp_addr
 *
Ïddr
,

1127 
sùp_Œª¥Üt
 **
Œª¥Ü
)

1129 
sùp_assocŸtiÚ
 *
asoc
;

1131 
asoc
 = 
	`__sùp_lookup_assocŸtiÚ
(
Ïddr
, 
·ddr
, 
Œª¥Ü
);

1137 ià(!
asoc
)

1138 
asoc
 = 
	`__sùp_rcv_lookup_h¬d”
(
skb
, 
Ïddr
, 
Œª¥Ü
);

1140  
asoc
;

1141 
	}
}

	@inqueue.c

46 
	~<Ãt/sùp/sùp.h
>

47 
	~<Ãt/sùp/sm.h
>

48 
	~<lšux/š‹¼u±.h
>

51 
	$sùp_šq_š™
(
sùp_šq
 *
queue
)

53 
	`INIT_LIST_HEAD
(&
queue
->
š_chunk_li¡
);

54 
queue
->
š_´og»ss
 = 
NULL
;

57 
	`INIT_WORK
(&
queue
->
immedŸ‹
, 
NULL
);

59 
queue
->
m®loûd
 = 0;

60 
	}
}

63 
	$sùp_šq_ä“
(
sùp_šq
 *
queue
)

65 
sùp_chunk
 *
chunk
, *
tmp
;

68 
	`li¡_fÜ_—ch_’Œy_§ã
(
chunk
, 
tmp
, &
queue
->
š_chunk_li¡
, 
li¡
) {

69 
	`li¡_d–_š™
(&
chunk
->
li¡
);

70 
	`sùp_chunk_ä“
(
chunk
);

76 ià(
queue
->
š_´og»ss
) {

77 
	`sùp_chunk_ä“
(
queue
->
š_´og»ss
);

78 
queue
->
š_´og»ss
 = 
NULL
;

81 ià(
queue
->
m®loûd
) {

83 
	`kä“
(
queue
);

85 
	}
}

90 
	$sùp_šq_push
(
sùp_šq
 *
q
, 
sùp_chunk
 *
chunk
)

93 ià(
chunk
->
rcvr
->
d—d
) {

94 
	`sùp_chunk_ä“
(
chunk
);

103 
	`li¡_add_
(&
chunk
->
li¡
, &
q
->
š_chunk_li¡
);

104 
q
->
immedŸ‹
.
	`func
(&q->immediate);

105 
	}
}

108 
sùp_chunkhdr
 *
	$sùp_šq_³ek
(
sùp_šq
 *
queue
)

110 
sùp_chunk
 *
chunk
;

111 
sùp_chunkhdr_t
 *
ch
 = 
NULL
;

113 
chunk
 = 
queue
->
š_´og»ss
;

115 ià(
chunk
->
sšgËtÚ
 ||

116 
chunk
->
’d_of_·ck‘
 ||

117 
chunk
->
pdisÿrd
)

118  
NULL
;

120 
ch
 = (
sùp_chunkhdr_t
 *)
chunk
->
chunk_’d
;

122  
ch
;

123 
	}
}

131 
sùp_chunk
 *
	$sùp_šq_pİ
(
sùp_šq
 *
queue
)

133 
sùp_chunk
 *
chunk
;

134 
sùp_chunkhdr_t
 *
ch
 = 
NULL
;

140 ià((
chunk
 = 
queue
->
š_´og»ss
)) {

144 ià(
chunk
->
sšgËtÚ
 ||

145 
chunk
->
’d_of_·ck‘
 ||

146 
chunk
->
pdisÿrd
) {

147 
	`sùp_chunk_ä“
(
chunk
);

148 
chunk
 = 
queue
->
š_´og»ss
 = 
NULL
;

151 
ch
 = (
sùp_chunkhdr_t
 *è
chunk
->
chunk_’d
;

154 
	`skb_puÎ
(
chunk
->
skb
,

155 
chunk
->
chunk_’d
 - chunk->
skb
->
d©a
);

160 ià(
	`skb_h—dËn
(
chunk
->
skb
è< (
sùp_chunkhdr_t
)) {

161 
	`sùp_chunk_ä“
(
chunk
);

162 
chunk
 = 
queue
->
š_´og»ss
 = 
NULL
;

168 ià(!
chunk
) {

169 
li¡_h—d
 *
’Œy
;

172 ià(
	`li¡_em±y
(&
queue
->
š_chunk_li¡
))

173  
NULL
;

175 
’Œy
 = 
queue
->
š_chunk_li¡
.
Ãxt
;

176 
chunk
 = 
queue
->
š_´og»ss
 =

177 
	`li¡_’Œy
(
’Œy
, 
sùp_chunk
, 
li¡
);

178 
	`li¡_d–_š™
(
’Œy
);

181 
chunk
->
sšgËtÚ
 = 1;

182 
ch
 = (
sùp_chunkhdr_t
 *è
chunk
->
skb
->
d©a
;

183 
chunk
->
d©a_acû±ed
 = 0;

186 
chunk
->
chunk_hdr
 = 
ch
;

187 
chunk
->
chunk_’d
 = ((
__u8
 *)
ch
è+ 
	`WORD_ROUND
(
	`Áohs
(ch->
Ëngth
));

192 ià(
	`uÆik–y
(
	`skb_is_nÚlš—r
(
chunk
->
skb
))) {

193 ià(
chunk
->
chunk_’d
 > 
	`skb__poš‹r
(chunk->
skb
))

194 
chunk
->
chunk_’d
 = 
	`skb__poš‹r
(chunk->
skb
);

196 
	`skb_puÎ
(
chunk
->
skb
, (
sùp_chunkhdr_t
));

197 
chunk
->
subh
.
v
 = 
NULL
;

199 ià(
chunk
->
chunk_’d
 < 
	`skb__poš‹r
(chunk->
skb
)) {

201 
chunk
->
sšgËtÚ
 = 0;

202 } ià(
chunk
->
chunk_’d
 > 
	`skb__poš‹r
(chunk->
skb
)) {

213 
	`sùp_chunk_ä“
(
chunk
);

214 
chunk
 = 
queue
->
š_´og»ss
 = 
NULL
;

216  
NULL
;

221 
chunk
->
’d_of_·ck‘
 = 1;

224 
	`SCTP_DEBUG_PRINTK
("+++sctp_inq_pop+++ chunk %p[%s],"

225 "†’gth %d, skb->ËÀ%d\n",
chunk
,

226 
	`sùp_úame
(
	`SCTP_ST_CHUNK
(
chunk
->
chunk_hdr
->
ty³
)),

227 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
), chunk->
skb
->
Ën
);

228  
chunk
;

229 
	}
}

239 
	$sùp_šq_£t_th_hªdËr
(
sùp_šq
 *
q
, 
wÜk_func_t
 
ÿÎback
)

241 
	`INIT_WORK
(&
q
->
immedŸ‹
, 
ÿÎback
);

242 
	}
}

	@ipv6.c

50 
	~<lšux/moduË.h
>

51 
	~<lšux/”ºo.h
>

52 
	~<lšux/ty³s.h
>

53 
	~<lšux/sock‘.h
>

54 
	~<lšux/sockios.h
>

55 
	~<lšux/Ãt.h
>

56 
	~<lšux/š.h
>

57 
	~<lšux/š6.h
>

58 
	~<lšux/Ãtdeviû.h
>

59 
	~<lšux/š™.h
>

60 
	~<lšux/£c.h
>

62 
	~<lšux/v6.h
>

63 
	~<lšux/icmpv6.h
>

64 
	~<lšux/¿ndom.h
>

65 
	~<lšux/£q_fe.h
>

67 
	~<Ãt/´ÙocŞ.h
>

68 
	~<Ãt/ndisc.h
>

69 
	~<Ãt/.h
>

70 
	~<Ãt/v6.h
>

71 
	~<Ãt/Œª¥_v6.h
>

72 
	~<Ãt/addrcÚf.h
>

73 
	~<Ãt/6_rou‹.h
>

74 
	~<Ãt/š‘_commÚ.h
>

75 
	~<Ãt/š‘_eú.h
>

76 
	~<Ãt/sùp/sùp.h
>

78 
	~<asm/uacûss.h
>

80 
šlše
 
sùp_v6_addr_m©ch_Ën
(
sùp_addr
 *
s1
,

81 
sùp_addr
 *
s2
);

82 
sùp_v6_to_addr
(
sùp_addr
 *
addr
, 
š6_addr
 *
§ddr
,

83 
__be16
 
pÜt
);

84 
sùp_v6_cmp_addr
(cÚ¡ 
sùp_addr
 *
addr1
,

85 cÚ¡ 
sùp_addr
 *
addr2
);

93 
	$sùp_š‘6addr_ev’t
(
nÙif›r_block
 *
this
, 
ev
,

94 *
±r
)

96 
š‘6_içddr
 *
iç
 = (š‘6_içdd¸*)
±r
;

97 
sùp_sockaddr_’Œy
 *
addr
 = 
NULL
;

98 
sùp_sockaddr_’Œy
 *
‹mp
;

99 
found
 = 0;

101 
ev
) {

102 
NETDEV_UP
:

103 
addr
 = 
	`km®loc
((
sùp_sockaddr_’Œy
), 
GFP_ATOMIC
);

104 ià(
addr
) {

105 
addr
->
a
.
v6
.
sš6_çmy
 = 
AF_INET6
;

106 
addr
->
a
.
v6
.
sš6_pÜt
 = 0;

107 
	`v6_addr_cİy
(&
addr
->
a
.
v6
.
sš6_addr
, &
iç
->addr);

108 
addr
->
a
.
v6
.
sš6_scİe_id
 = 
iç
->
idev
->
dev
->
ifšdex
;

109 
addr
->
v®id
 = 1;

110 
	`¥š_lock_bh
(&
sùp_loÿl_addr_lock
);

111 
	`li¡_add__rcu
(&
addr
->
li¡
, &
sùp_loÿl_addr_li¡
);

112 
	`¥š_uÆock_bh
(&
sùp_loÿl_addr_lock
);

115 
NETDEV_DOWN
:

116 
	`¥š_lock_bh
(&
sùp_loÿl_addr_lock
);

117 
	`li¡_fÜ_—ch_’Œy_§ã
(
addr
, 
‹mp
,

118 &
sùp_loÿl_addr_li¡
, 
li¡
) {

119 ià(
addr
->
a
.
§
.
§_çmy
 =ğ
AF_INET6
 &&

120 
	`v6_addr_equ®
(&
addr
->
a
.
v6
.
sš6_addr
,

121 &
iç
->
addr
)) {

122 
found
 = 1;

123 
addr
->
v®id
 = 0;

124 
	`li¡_d–_rcu
(&
addr
->
li¡
);

128 
	`¥š_uÆock_bh
(&
sùp_loÿl_addr_lock
);

129 ià(
found
)

130 
	`ÿÎ_rcu
(&
addr
->
rcu
, 
sùp_loÿl_addr_ä“
);

134  
NOTIFY_DONE
;

135 
	}
}

137 
nÙif›r_block
 
	gsùp_š‘6addr_nÙif›r
 = {

138 .
nÙif›r_ÿÎ
 = 
sùp_š‘6addr_ev’t
,

142 
SCTP_STATIC
 
	$sùp_v6_”r
(
sk_buff
 *
skb
, 
š‘6_skb_·rm
 *
İt
,

143 
u8
 
ty³
, u8 
code
, 
off£t
, 
__be32
 
šfo
)

145 
š‘6_dev
 *
idev
;

146 
sock
 *
sk
;

147 
sùp_assocŸtiÚ
 *
asoc
;

148 
sùp_Œª¥Üt
 *
Œª¥Üt
;

149 
v6_pšfo
 *
Å
;

150 
sk_buff_d©a_t
 
§ve
, 
§vesùp
;

151 
”r
;

153 
idev
 = 
	`š6_dev_g‘
(
skb
->
dev
);

156 
§ve
 = 
skb
->
ÃtwÜk_h—d”
;

157 
§vesùp
 = 
skb
->
Œª¥Üt_h—d”
;

158 
	`skb_»£t_ÃtwÜk_h—d”
(
skb
);

159 
	`skb_£t_Œª¥Üt_h—d”
(
skb
, 
off£t
);

160 
sk
 = 
	`sùp_”r_lookup
(
AF_INET6
, 
skb
, 
	`sùp_hdr
(skb), &
asoc
, &
Œª¥Üt
);

162 
skb
->
ÃtwÜk_h—d”
 = 
§ve
;

163 
skb
->
Œª¥Üt_h—d”
 = 
§vesùp
;

164 ià(!
sk
) {

165 
	`ICMP6_INC_STATS_BH
(
	`dev_Ãt
(
skb
->
dev
), 
idev
, 
ICMP6_MIB_INERRORS
);

166 
out
;

173 
ty³
) {

174 
ICMPV6_PKT_TOOBIG
:

175 
	`sùp_icmp_äag_Ãeded
(
sk
, 
asoc
, 
Œª¥Üt
, 
	`Áohl
(
šfo
));

176 
out_uÆock
;

177 
ICMPV6_PARAMPROB
:

178 ià(
ICMPV6_UNK_NEXTHDR
 =ğ
code
) {

179 
	`sùp_icmp_´Ùo_uÄ—chabË
(
sk
, 
asoc
, 
Œª¥Üt
);

180 
out_uÆock
;

187 
Å
 = 
	`š‘6_sk
(
sk
);

188 
	`icmpv6_”r_cÚv”t
(
ty³
, 
code
, &
”r
);

189 ià(!
	`sock_owÃd_by_u£r
(
sk
è&& 
Å
->
»cv”r
) {

190 
sk
->
sk_”r
 = 
”r
;

191 
sk
->
	`sk_”rÜ_»pÜt
(sk);

193 
sk
->
sk_”r_soá
 = 
”r
;

196 
out_uÆock
:

197 
	`sùp_”r_fšish
(
sk
, 
asoc
);

198 
out
:

199 ià(
	`lik–y
(
idev
 !ğ
NULL
))

200 
	`š6_dev_put
(
idev
);

201 
	}
}

204 
	$sùp_v6_xm™
(
sk_buff
 *
skb
, 
sùp_Œª¥Üt
 *
Œª¥Üt
)

206 
sock
 *
sk
 = 
skb
->sk;

207 
v6_pšfo
 *
Å
 = 
	`š‘6_sk
(
sk
);

208 
æowi
 
æ
;

210 
	`mem£t
(&
æ
, 0, (fl));

212 
æ
.
´Ùo
 = 
sk
->
sk_´ÙocŞ
;

217 
	`v6_addr_cİy
(&
æ
.
æ6_d¡
, &
Œª¥Üt
->
addr
.
v6
.
sš6_addr
);

218 
	`v6_addr_cİy
(&
æ
.
æ6_¤c
, &
Œª¥Üt
->
§ddr
.
v6
.
sš6_addr
);

220 
æ
.
æ6_æowÏb–
 = 
Å
->
æow_Ïb–
;

221 
	`IP6_ECN_æow_xm™
(
sk
, 
æ
.
æ6_æowÏb–
);

222 ià(
	`v6_addr_ty³
(&
æ
.
æ6_¤c
è& 
IPV6_ADDR_LINKLOCAL
)

223 
æ
.
oif
 = 
Œª¥Üt
->
§ddr
.
v6
.
sš6_scİe_id
;

225 
æ
.
oif
 = 
sk
->
sk_bound_dev_if
;

227 ià(
Å
->
İt
 &&‚p->İt->
¤üt
) {

228 
¹0_hdr
 *
¹0
 = (¹0_hd¸*è
Å
->
İt
->
¤üt
;

229 
	`v6_addr_cİy
(&
æ
.
æ6_d¡
, 
¹0
->
addr
);

232 
	`SCTP_DEBUG_PRINTK
("%s: skb:%p,†en:%d, src:%pI6 dst:%pI6\n",

233 
__func__
, 
skb
, skb->
Ën
,

234 &
æ
.
æ6_¤c
, &æ.
æ6_d¡
);

236 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTSCTPPACKS
);

238 ià(!(
Œª¥Üt
->
·¿m_æags
 & 
SPP_PMTUD_ENABLE
))

239 
skb
->
loÿl_df
 = 1;

241  
	`6_xm™
(
sk
, 
skb
, &
æ
, 
Å
->
İt
, 0);

242 
	}
}

247 
d¡_’Œy
 *
	$sùp_v6_g‘_d¡
(
sùp_assocŸtiÚ
 *
asoc
,

248 
sùp_addr
 *
daddr
,

249 
sùp_addr
 *
§ddr
,

250 
æowi
 *
æ
,

251 
sock
 *
sk
)

253 
d¡_’Œy
 *
d¡
 = 
NULL
;

254 
sùp_bšd_addr
 *
bp
;

255 
sùp_sockaddr_’Œy
 *
Ïddr
;

256 
sùp_addr
 *
baddr
 = 
NULL
;

257 
sùp_addr
 
d¡_§ddr
;

258 
__u8
 
m©chËn
 = 0;

259 
__u8
 
bm©chËn
;

260 
sùp_scİe_t
 
scİe
;

261 
”r
 = 0;

263 
	`mem£t
(
æ
, 0, (
æowi
));

264 
	`v6_addr_cİy
(&
æ
->
æ6_d¡
, &
daddr
->
v6
.
sš6_addr
);

265 ià(
	`v6_addr_ty³
(&
daddr
->
v6
.
sš6_addr
è& 
IPV6_ADDR_LINKLOCAL
)

266 
æ
->
oif
 = 
daddr
->
v6
.
sš6_scİe_id
;

269 
	`SCTP_DEBUG_PRINTK
("%s: DST=%pI6 ", 
__func__
, &
æ
->
æ6_d¡
);

271 ià(
§ddr
) {

272 
	`v6_addr_cİy
(&
æ
->
æ6_¤c
, &
§ddr
->
v6
.
sš6_addr
);

273 
	`SCTP_DEBUG_PRINTK
("SRC=%pI6 - ", &
æ
->
æ6_¤c
);

276 
”r
 = 
	`6_d¡_lookup
(
sk
, &
d¡
, 
æ
);

277 ià(!
asoc
 || 
§ddr
)

278 
out
;

280 
bp
 = &
asoc
->
ba£
.
bšd_addr
;

281 
scİe
 = 
	`sùp_scİe
(
daddr
);

285 ià(!
”r
) {

289 
	`sùp_v6_to_addr
(&
d¡_§ddr
, &
æ
->
æ6_¤c
, 
	`htÚs
(
bp
->
pÜt
));

290 
	`rcu_»ad_lock
();

291 
	`li¡_fÜ_—ch_’Œy_rcu
(
Ïddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

292 ià(!
Ïddr
->
v®id
 || (Ïddr->
¡©e
 !ğ
SCTP_ADDR_SRC
))

296 ià((
Ïddr
->
a
.
§
.
§_çmy
 =ğ
AF_INET6
) &&

297 (
	`sùp_v6_cmp_addr
(&
d¡_§ddr
, &
Ïddr
->
a
))) {

298 
	`rcu_»ad_uÆock
();

299 
out
;

302 
	`rcu_»ad_uÆock
();

306 
	`d¡_»Ëa£
(
d¡
);

307 
d¡
 = 
NULL
;

313 
	`rcu_»ad_lock
();

314 
	`li¡_fÜ_—ch_’Œy_rcu
(
Ïddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

315 ià(!
Ïddr
->
v®id
 &&†addr->
¡©e
 !ğ
SCTP_ADDR_SRC
)

317 ià((
Ïddr
->
a
.
§
.
§_çmy
 =ğ
AF_INET6
) &&

318 (
scİe
 <ğ
	`sùp_scİe
(&
Ïddr
->
a
))) {

319 
bm©chËn
 = 
	`sùp_v6_addr_m©ch_Ën
(
daddr
, &
Ïddr
->
a
);

320 ià(!
baddr
 || (
m©chËn
 < 
bm©chËn
)) {

321 
baddr
 = &
Ïddr
->
a
;

322 
m©chËn
 = 
bm©chËn
;

326 
	`rcu_»ad_uÆock
();

327 ià(
baddr
) {

328 
	`v6_addr_cİy
(&
æ
->
æ6_¤c
, &
baddr
->
v6
.
sš6_addr
);

329 
”r
 = 
	`6_d¡_lookup
(
sk
, &
d¡
, 
æ
);

332 
out
:

333 ià(!
”r
) {

334 
¹6_šfo
 *
¹
;

335 
¹
 = (
¹6_šfo
 *)
d¡
;

336 
	`SCTP_DEBUG_PRINTK
("rt6_dst:%pI6„t6_src:%pI6\n",

337 &
¹
->
¹6i_d¡
.
addr
, &
æ
->
æ6_¤c
);

338  
d¡
;

340 
	`SCTP_DEBUG_PRINTK
("NO ROUTE\n");

341  
NULL
;

342 
	}
}

347 
šlše
 
	$sùp_v6_addr_m©ch_Ën
(
sùp_addr
 *
s1
,

348 
sùp_addr
 *
s2
)

350  
	`v6_addr_diff
(&
s1
->
v6
.
sš6_addr
, &
s2
->v6.sin6_addr);

351 
	}
}

356 
	$sùp_v6_g‘_§ddr
(
sùp_sock
 *
sk
,

357 
sùp_Œª¥Üt
 *
t
,

358 
sùp_addr
 *
daddr
,

359 
æowi
 *
æ
)

361 
sùp_addr
 *
§ddr
 = &
t
->saddr;

363 
	`SCTP_DEBUG_PRINTK
("%s:‡soc:%p dst:%p daddr:%pI6 ",

364 
__func__
, 
t
->
asoc
,->
d¡
, &
daddr
->
v6
.
sš6_addr
);

367 ià(
t
->
d¡
) {

368 
§ddr
->
v6
.
sš6_çmy
 = 
AF_INET6
;

369 
	`v6_addr_cİy
(&
§ddr
->
v6
.
sš6_addr
, &
æ
->
æ6_¤c
);

371 
	}
}

374 
	$sùp_v6_cİy_add¾i¡
(
li¡_h—d
 *
add¾i¡
,

375 
Ãt_deviû
 *
dev
)

377 
š‘6_dev
 *
š6_dev
;

378 
š‘6_içddr
 *
iå
;

379 
sùp_sockaddr_’Œy
 *
addr
;

381 
	`rcu_»ad_lock
();

382 ià((
š6_dev
 = 
	`__š6_dev_g‘
(
dev
)è=ğ
NULL
) {

383 
	`rcu_»ad_uÆock
();

387 
	`»ad_lock_bh
(&
š6_dev
->
lock
);

388 
iå
 = 
š6_dev
->
addr_li¡
; iå; iå = iå->
if_Ãxt
) {

390 
addr
 = 
	`t_Ãw
(
sùp_sockaddr_’Œy
, 
GFP_ATOMIC
);

391 ià(
addr
) {

392 
addr
->
a
.
v6
.
sš6_çmy
 = 
AF_INET6
;

393 
addr
->
a
.
v6
.
sš6_pÜt
 = 0;

394 
addr
->
a
.
v6
.
sš6_addr
 = 
iå
->addr;

395 
addr
->
a
.
v6
.
sš6_scİe_id
 = 
dev
->
ifšdex
;

396 
addr
->
v®id
 = 1;

397 
	`INIT_LIST_HEAD
(&
addr
->
li¡
);

398 
	`INIT_RCU_HEAD
(&
addr
->
rcu
);

399 
	`li¡_add_
(&
addr
->
li¡
, 
add¾i¡
);

403 
	`»ad_uÆock_bh
(&
š6_dev
->
lock
);

404 
	`rcu_»ad_uÆock
();

405 
	}
}

408 
	$sùp_v6_äom_skb
(
sùp_addr
 *
addr
,
sk_buff
 *
skb
,

409 
is_§ddr
)

411 *
äom
;

412 
__be16
 *
pÜt
;

413 
sùphdr
 *
sh
;

415 
pÜt
 = &
addr
->
v6
.
sš6_pÜt
;

416 
addr
->
v6
.
sš6_çmy
 = 
AF_INET6
;

417 
addr
->
v6
.
sš6_æowšfo
 = 0;

418 
addr
->
v6
.
sš6_scİe_id
 = ((
š‘6_skb_·rm
 *)
skb
->
cb
)->
iif
;

420 
sh
 = 
	`sùp_hdr
(
skb
);

421 ià(
is_§ddr
) {

422 *
pÜt
 = 
sh
->
sourû
;

423 
äom
 = &
	`v6_hdr
(
skb
)->
§ddr
;

425 *
pÜt
 = 
sh
->
de¡
;

426 
äom
 = &
	`v6_hdr
(
skb
)->
daddr
;

428 
	`v6_addr_cİy
(&
addr
->
v6
.
sš6_addr
, 
äom
);

429 
	}
}

432 
	$sùp_v6_äom_sk
(
sùp_addr
 *
addr
, 
sock
 *
sk
)

434 
addr
->
v6
.
sš6_çmy
 = 
AF_INET6
;

435 
addr
->
v6
.
sš6_pÜt
 = 0;

436 
addr
->
v6
.
sš6_addr
 = 
	`š‘6_sk
(
sk
)->
rcv_§ddr
;

437 
	}
}

440 
	$sùp_v6_to_sk_§ddr
(
sùp_addr
 *
addr
, 
sock
 *
sk
)

442 ià(
addr
->
§
.
§_çmy
 =ğ
AF_INET
 && 
	`sùp_sk
(
sk
)->
v4m­³d
) {

443 
	`š‘6_sk
(
sk
)->
rcv_§ddr
.
s6_addr32
[0] = 0;

444 
	`š‘6_sk
(
sk
)->
rcv_§ddr
.
s6_addr32
[1] = 0;

445 
	`š‘6_sk
(
sk
)->
rcv_§ddr
.
s6_addr32
[2] = 
	`htÚl
(0x0000ffff);

446 
	`š‘6_sk
(
sk
)->
rcv_§ddr
.
s6_addr32
[3] =

447 
addr
->
v4
.
sš_addr
.
s_addr
;

449 
	`š‘6_sk
(
sk
)->
rcv_§ddr
 = 
addr
->
v6
.
sš6_addr
;

451 
	}
}

454 
	$sùp_v6_to_sk_daddr
(
sùp_addr
 *
addr
, 
sock
 *
sk
)

456 ià(
addr
->
§
.
§_çmy
 =ğ
AF_INET
 && 
	`sùp_sk
(
sk
)->
v4m­³d
) {

457 
	`š‘6_sk
(
sk
)->
daddr
.
s6_addr32
[0] = 0;

458 
	`š‘6_sk
(
sk
)->
daddr
.
s6_addr32
[1] = 0;

459 
	`š‘6_sk
(
sk
)->
daddr
.
s6_addr32
[2] = 
	`htÚl
(0x0000ffff);

460 
	`š‘6_sk
(
sk
)->
daddr
.
s6_addr32
[3] = 
addr
->
v4
.
sš_addr
.
s_addr
;

462 
	`š‘6_sk
(
sk
)->
daddr
 = 
addr
->
v6
.
sš6_addr
;

464 
	}
}

467 
	$sùp_v6_äom_addr_·¿m
(
sùp_addr
 *
addr
,

468 
sùp_addr_·¿m
 *
·¿m
,

469 
__be16
 
pÜt
, 
iif
)

471 
addr
->
v6
.
sš6_çmy
 = 
AF_INET6
;

472 
addr
->
v6
.
sš6_pÜt
 = 
pÜt
;

473 
addr
->
v6
.
sš6_æowšfo
 = 0;

474 
	`v6_addr_cİy
(&
addr
->
v6
.
sš6_addr
, &
·¿m
->v6.addr);

475 
addr
->
v6
.
sš6_scİe_id
 = 
iif
;

476 
	}
}

481 
	$sùp_v6_to_addr_·¿m
(cÚ¡ 
sùp_addr
 *
addr
,

482 
sùp_addr_·¿m
 *
·¿m
)

484 
Ëngth
 = (
sùp_v6addr_·¿m_t
);

486 
·¿m
->
v6
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_IPV6_ADDRESS
;

487 
·¿m
->
v6
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
(length);

488 
	`v6_addr_cİy
(&
·¿m
->
v6
.
addr
, &addr->v6.
sš6_addr
);

490  
Ëngth
;

491 
	}
}

494 
	$sùp_v6_to_addr
(
sùp_addr
 *
addr
, 
š6_addr
 *
§ddr
,

495 
__be16
 
pÜt
)

497 
addr
->
§
.
§_çmy
 = 
AF_INET6
;

498 
addr
->
v6
.
sš6_pÜt
 = 
pÜt
;

499 
	`v6_addr_cİy
(&
addr
->
v6
.
sš6_addr
, 
§ddr
);

500 
	}
}

505 
	$sùp_v6_cmp_addr
(cÚ¡ 
sùp_addr
 *
addr1
,

506 cÚ¡ 
sùp_addr
 *
addr2
)

508 ià(
addr1
->
§
.
§_çmy
 !ğ
addr2
->sa.sa_family) {

509 ià(
addr1
->
§
.
§_çmy
 =ğ
AF_INET
 &&

510 
addr2
->
§
.
§_çmy
 =ğ
AF_INET6
 &&

511 
	`v6_addr_v4m­³d
(&
addr2
->
v6
.
sš6_addr
)) {

512 ià(
addr2
->
v6
.
sš6_pÜt
 =ğ
addr1
->
v4
.
sš_pÜt
 &&

513 
addr2
->
v6
.
sš6_addr
.
s6_addr32
[3] ==

514 
addr1
->
v4
.
sš_addr
.
s_addr
)

517 ià(
addr2
->
§
.
§_çmy
 =ğ
AF_INET
 &&

518 
addr1
->
§
.
§_çmy
 =ğ
AF_INET6
 &&

519 
	`v6_addr_v4m­³d
(&
addr1
->
v6
.
sš6_addr
)) {

520 ià(
addr1
->
v6
.
sš6_pÜt
 =ğ
addr2
->
v4
.
sš_pÜt
 &&

521 
addr1
->
v6
.
sš6_addr
.
s6_addr32
[3] ==

522 
addr2
->
v4
.
sš_addr
.
s_addr
)

527 ià(!
	`v6_addr_equ®
(&
addr1
->
v6
.
sš6_addr
, &
addr2
->v6.sin6_addr))

530 ià(
	`v6_addr_ty³
(&
addr1
->
v6
.
sš6_addr
è& 
IPV6_ADDR_LINKLOCAL
) {

531 ià(
addr1
->
v6
.
sš6_scİe_id
 && 
addr2
->v6.sin6_scope_id &&

532 (
addr1
->
v6
.
sš6_scİe_id
 !ğ
addr2
->v6.sin6_scope_id)) {

538 
	}
}

541 
	$sùp_v6_šaddr_ªy
(
sùp_addr
 *
addr
, 
__be16
 
pÜt
)

543 
	`mem£t
(
addr
, 0x00, (
sùp_addr
));

544 
addr
->
v6
.
sš6_çmy
 = 
AF_INET6
;

545 
addr
->
v6
.
sš6_pÜt
 = 
pÜt
;

546 
	}
}

549 
	$sùp_v6_is_ªy
(cÚ¡ 
sùp_addr
 *
addr
)

551  
	`v6_addr_ªy
(&
addr
->
v6
.
sš6_addr
);

552 
	}
}

555 
	$sùp_v6_avaabË
(
sùp_addr
 *
addr
, 
sùp_sock
 *
¥
)

557 
ty³
;

558 
š6_addr
 *
š6
 = (š6_add¸*)&
addr
->
v6
.
sš6_addr
;

560 
ty³
 = 
	`v6_addr_ty³
(
š6
);

561 ià(
IPV6_ADDR_ANY
 =ğ
ty³
)

563 ià(
ty³
 =ğ
IPV6_ADDR_MAPPED
) {

564 ià(
¥
 && !¥->
v4m­³d
)

566 ià(
¥
 && 
	`v6_Úly_sock
(
	`sùp_İt2sk
(sp)))

568 
	`sùp_v6_m­_v4
(
addr
);

569  
	`sùp_g‘_af_¥ecific
(
AF_INET
)->
	`avaabË
(
addr
, 
¥
);

571 ià(!(
ty³
 & 
IPV6_ADDR_UNICAST
))

574  
	`v6_chk_addr
(&
š™_Ãt
, 
š6
, 
NULL
, 0);

575 
	}
}

584 
	$sùp_v6_addr_v®id
(
sùp_addr
 *
addr
,

585 
sùp_sock
 *
¥
,

586 cÚ¡ 
sk_buff
 *
skb
)

588 
»t
 = 
	`v6_addr_ty³
(&
addr
->
v6
.
sš6_addr
);

591 ià(
»t
 =ğ
IPV6_ADDR_MAPPED
) {

595 ià(!
¥
 || !¥->
v4m­³d
)

597 ià(
¥
 && 
	`v6_Úly_sock
(
	`sùp_İt2sk
(sp)))

599 
	`sùp_v6_m­_v4
(
addr
);

600  
	`sùp_g‘_af_¥ecific
(
AF_INET
)->
	`addr_v®id
(
addr
, 
¥
, 
skb
);

604 ià(!(
»t
 & 
IPV6_ADDR_UNICAST
))

608 
	}
}

611 
sùp_scİe_t
 
	$sùp_v6_scİe
(
sùp_addr
 *
addr
)

613 
v6scİe
;

614 
sùp_scİe_t
 
»tv®
;

620 
v6scİe
 = 
	`v6_addr_scİe
(&
addr
->
v6
.
sš6_addr
);

621 
v6scİe
) {

622 
IFA_HOST
:

623 
»tv®
 = 
SCTP_SCOPE_LOOPBACK
;

625 
IFA_LINK
:

626 
»tv®
 = 
SCTP_SCOPE_LINK
;

628 
IFA_SITE
:

629 
»tv®
 = 
SCTP_SCOPE_PRIVATE
;

632 
»tv®
 = 
SCTP_SCOPE_GLOBAL
;

636  
»tv®
;

637 
	}
}

640 
sock
 *
	$sùp_v6_ü—‹_acû±_sk
(
sock
 *
sk
,

641 
sùp_assocŸtiÚ
 *
asoc
)

643 
sock
 *
Ãwsk
;

644 
v6_pšfo
 *
ÃwÅ
, *
Å
 = 
	`š‘6_sk
(
sk
);

645 
sùp6_sock
 *
Ãwsùp6sk
;

647 
Ãwsk
 = 
	`sk_®loc
(
	`sock_Ãt
(
sk
), 
PF_INET6
, 
GFP_KERNEL
, sk->
sk_´Ù
);

648 ià(!
Ãwsk
)

649 
out
;

651 
	`sock_š™_d©a
(
NULL
, 
Ãwsk
);

653 
	`sùp_cİy_sock
(
Ãwsk
, 
sk
, 
asoc
);

654 
	`sock_»£t_æag
(
sk
, 
SOCK_ZAPPED
);

656 
Ãwsùp6sk
 = (
sùp6_sock
 *)
Ãwsk
;

657 
	`š‘_sk
(
Ãwsk
)->
pš‘6
 = &
Ãwsùp6sk
->
š‘6
;

659 
	`sùp_sk
(
Ãwsk
)->
v4m­³d
 = sùp_sk(
sk
)->v4mapped;

661 
ÃwÅ
 = 
	`š‘6_sk
(
Ãwsk
);

663 
	`memıy
(
ÃwÅ
, 
Å
, (
v6_pšfo
));

668 
	`sùp_v6_to_sk_daddr
(&
asoc
->
³”
.
´im¬y_addr
, 
Ãwsk
);

670 
	`sk_»fút_debug_šc
(
Ãwsk
);

672 ià(
Ãwsk
->
sk_´Ù
->
	`š™
(newsk)) {

673 
	`sk_commÚ_»Ëa£
(
Ãwsk
);

674 
Ãwsk
 = 
NULL
;

677 
out
:

678  
Ãwsk
;

679 
	}
}

682 
	$sùp_v6_addr_v4m­
(
sùp_sock
 *
¥
, 
sùp_addr
 *
addr
)

684 ià(
¥
->
v4m­³d
 && 
AF_INET
 =ğ
addr
->
§
.
§_çmy
)

685 
	`sùp_v4_m­_v6
(
addr
);

686 
	}
}

689 
	$sùp_v6_skb_iif
(cÚ¡ 
sk_buff
 *
skb
)

691 
š‘6_skb_·rm
 *
İt
 = (š‘6_skb_·rm *è
skb
->
cb
;

692  
İt
->
iif
;

693 
	}
}

696 
	$sùp_v6_is_û
(cÚ¡ 
sk_buff
 *
skb
)

698  *((
__u32
 *)(
	`v6_hdr
(
skb
))è& 
	`htÚl
(1 << 20);

699 
	}
}

702 
	$sùp_v6_£q_dump_addr
(
£q_fe
 *
£q
, 
sùp_addr
 *
addr
)

704 
	`£q_´štf
(
£q
, "%pI6 ", &
addr
->
v6
.
sš6_addr
);

705 
	}
}

707 
	$sùp_v6_eú_ÿ·bË
(
sock
 *
sk
)

709 
	`š‘6_sk
(
sk
)->
tşass
 |ğ
INET_ECN_ECT_0
;

710 
	}
}

713 
	$sùp_š‘6_msgÇme
(*
msgÇme
, *
addr_Ën
)

715 
sockaddr_š6
 *
sš6
;

717 
sš6
 = (
sockaddr_š6
 *)
msgÇme
;

718 
sš6
->
sš6_çmy
 = 
AF_INET6
;

719 
sš6
->
sš6_æowšfo
 = 0;

720 
sš6
->
sš6_scİe_id
 = 0;

721 *
addr_Ën
 = (
sockaddr_š6
);

722 
	}
}

725 
	$sùp_š‘6_ev’t_msgÇme
(
sùp_uÍev’t
 *
ev’t
,

726 *
msgÇme
, *
add¾’
)

728 
sockaddr_š6
 *
sš6
, *
sš6äom
;

730 ià(
msgÇme
) {

731 
sùp_addr
 *
addr
;

732 
sùp_assocŸtiÚ
 *
asoc
;

734 
asoc
 = 
ev’t
->asoc;

735 
	`sùp_š‘6_msgÇme
(
msgÇme
, 
add¾’
);

736 
sš6
 = (
sockaddr_š6
 *)
msgÇme
;

737 
sš6
->
sš6_pÜt
 = 
	`htÚs
(
asoc
->
³”
.
pÜt
);

738 
addr
 = &
asoc
->
³”
.
´im¬y_addr
;

745 ià(
	`sùp_sk
(
asoc
->
ba£
.
sk
)->
v4m­³d
 &&

746 
AF_INET
 =ğ
addr
->
§
.
§_çmy
) {

747 
	`sùp_v4_m­_v6
((
sùp_addr
 *)
sš6
);

748 
sš6
->
sš6_addr
.
s6_addr32
[3] =

749 
addr
->
v4
.
sš_addr
.
s_addr
;

753 
sš6äom
 = &
asoc
->
³”
.
´im¬y_addr
.
v6
;

754 
	`v6_addr_cİy
(&
sš6
->
sš6_addr
, &
sš6äom
->sin6_addr);

755 ià(
	`v6_addr_ty³
(&
sš6
->
sš6_addr
è& 
IPV6_ADDR_LINKLOCAL
)

756 
sš6
->
sš6_scİe_id
 = 
sš6äom
->sin6_scope_id;

758 
	}
}

761 
	$sùp_š‘6_skb_msgÇme
(
sk_buff
 *
skb
, *
msgÇme
,

762 *
addr_Ën
)

764 
sùphdr
 *
sh
;

765 
sockaddr_š6
 *
sš6
;

767 ià(
msgÇme
) {

768 
	`sùp_š‘6_msgÇme
(
msgÇme
, 
addr_Ën
);

769 
sš6
 = (
sockaddr_š6
 *)
msgÇme
;

770 
sh
 = 
	`sùp_hdr
(
skb
);

771 
sš6
->
sš6_pÜt
 = 
sh
->
sourû
;

774 ià(
	`sùp_sk
(
skb
->
sk
)->
v4m­³d
 &&

775 
	`_hdr
(
skb
)->
v”siÚ
 == 4) {

776 
	`sùp_v4_m­_v6
((
sùp_addr
 *)
sš6
);

777 
sš6
->
sš6_addr
.
s6_addr32
[3] = 
	`_hdr
(
skb
)->
§ddr
;

782 
	`v6_addr_cİy
(&
sš6
->
sš6_addr
, &
	`v6_hdr
(
skb
)->
§ddr
);

783 ià(
	`v6_addr_ty³
(&
sš6
->
sš6_addr
è& 
IPV6_ADDR_LINKLOCAL
) {

784 
sùp_uÍev’t
 *
ev
 = 
	`sùp_skb2ev’t
(
skb
);

785 
sš6
->
sš6_scİe_id
 = 
ev
->
iif
;

788 
	}
}

791 
	$sùp_š‘6_af_suµÜ‹d
(
§_çmy_t
 
çmy
, 
sùp_sock
 *
¥
)

793 
çmy
) {

794 
AF_INET6
:

797 
AF_INET
:

798 ià(!
	`__v6_Úly_sock
(
	`sùp_İt2sk
(
¥
)))

803 
	}
}

809 
	$sùp_š‘6_cmp_addr
(cÚ¡ 
sùp_addr
 *
addr1
,

810 cÚ¡ 
sùp_addr
 *
addr2
,

811 
sùp_sock
 *
İt
)

813 
sùp_af
 *
af1
, *
af2
;

814 
sock
 *
sk
 = 
	`sùp_İt2sk
(
İt
);

816 
af1
 = 
	`sùp_g‘_af_¥ecific
(
addr1
->
§
.
§_çmy
);

817 
af2
 = 
	`sùp_g‘_af_¥ecific
(
addr2
->
§
.
§_çmy
);

819 ià(!
af1
 || !
af2
)

823 ià(
	`__v6_Úly_sock
(
sk
è&& 
af1
 !ğ
af2
)

827 ià(
	`sùp_is_ªy
(
sk
, 
addr1
è|| sùp_is_ªy(sk, 
addr2
))

830 ià(
addr1
->
§
.
§_çmy
 !ğ
addr2
->sa.sa_family)

833  
af1
->
	`cmp_addr
(
addr1
, 
addr2
);

834 
	}
}

839 
	$sùp_š‘6_bšd_v”ify
(
sùp_sock
 *
İt
, 
sùp_addr
 *
addr
)

841 
sùp_af
 *
af
;

844 ià(
addr
->
§
.
§_çmy
 !ğ
AF_INET6
)

845 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§
.
§_çmy
);

847 
ty³
 = 
	`v6_addr_ty³
(&
addr
->
v6
.
sš6_addr
);

848 
Ãt_deviû
 *
dev
;

850 ià(
ty³
 & 
IPV6_ADDR_LINKLOCAL
) {

851 ià(!
addr
->
v6
.
sš6_scİe_id
)

853 
dev
 = 
	`dev_g‘_by_šdex
(&
š™_Ãt
, 
addr
->
v6
.
sš6_scİe_id
);

854 ià(!
dev
)

856 ià(!
	`v6_chk_addr
(&
š™_Ãt
, &
addr
->
v6
.
sš6_addr
,

857 
dev
, 0)) {

858 
	`dev_put
(
dev
);

861 
	`dev_put
(
dev
);

862 } ià(
ty³
 =ğ
IPV6_ADDR_MAPPED
) {

863 ià(!
İt
->
v4m­³d
)

867 
af
 = 
İt
->
pf
->af;

869  
af
->
	`avaabË
(
addr
, 
İt
);

870 
	}
}

875 
	$sùp_š‘6_£nd_v”ify
(
sùp_sock
 *
İt
, 
sùp_addr
 *
addr
)

877 
sùp_af
 *
af
 = 
NULL
;

880 ià(
addr
->
§
.
§_çmy
 !ğ
AF_INET6
)

881 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§
.
§_çmy
);

883 
ty³
 = 
	`v6_addr_ty³
(&
addr
->
v6
.
sš6_addr
);

884 
Ãt_deviû
 *
dev
;

886 ià(
ty³
 & 
IPV6_ADDR_LINKLOCAL
) {

887 ià(!
addr
->
v6
.
sš6_scİe_id
)

889 
dev
 = 
	`dev_g‘_by_šdex
(&
š™_Ãt
, 
addr
->
v6
.
sš6_scİe_id
);

890 ià(!
dev
)

892 
	`dev_put
(
dev
);

894 
af
 = 
İt
->
pf
->af;

897  
af
 !ğ
NULL
;

898 
	}
}

906 
	$sùp_š‘6_suµÜ‹d_addrs
(cÚ¡ 
sùp_sock
 *
İt
,

907 
__be16
 *
ty³s
)

909 
ty³s
[0] = 
SCTP_PARAM_IPV6_ADDRESS
;

910 ià(!
İt
 || !
	`v6_Úly_sock
(
	`sùp_İt2sk
(opt))) {

911 
ty³s
[1] = 
SCTP_PARAM_IPV4_ADDRESS
;

915 
	}
}

917 cÚ¡ 
´Ùo_İs
 
	gš‘6_£q·ck‘_İs
 = {

918 .
çmy
 = 
PF_INET6
,

919 .
	gowÃr
 = 
THIS_MODULE
,

920 .
	g»Ëa£
 = 
š‘6_»Ëa£
,

921 .
	gbšd
 = 
š‘6_bšd
,

922 .
	gcÚÃù
 = 
š‘_dg¿m_cÚÃù
,

923 .
	gsock‘·œ
 = 
sock_no_sock‘·œ
,

924 .
	gacû±
 = 
š‘_acû±
,

925 .
	gg‘Çme
 = 
š‘6_g‘Çme
,

926 .
	gpŞl
 = 
sùp_pŞl
,

927 .
	gioùl
 = 
š‘6_ioùl
,

928 .
	gli¡’
 = 
sùp_š‘_li¡’
,

929 .
	gshutdown
 = 
š‘_shutdown
,

930 .
	g£tsockİt
 = 
sock_commÚ_£tsockİt
,

931 .
	gg‘sockİt
 = 
sock_commÚ_g‘sockİt
,

932 .
	g£ndmsg
 = 
š‘_£ndmsg
,

933 .
	g»cvmsg
 = 
sock_commÚ_»cvmsg
,

934 .
	gmm­
 = 
sock_no_mm­
,

935 #ifdeà
CONFIG_COMPAT


936 .
	gcom·t_£tsockİt
 = 
com·t_sock_commÚ_£tsockİt
,

937 .
	gcom·t_g‘sockİt
 = 
com·t_sock_commÚ_g‘sockİt
,

941 
š‘_´Ùosw
 
	gsùpv6_£q·ck‘_´Ùosw
 = {

942 .
ty³
 = 
SOCK_SEQPACKET
,

943 .
	g´ÙocŞ
 = 
IPPROTO_SCTP
,

944 .
	g´Ù
 = &
sùpv6_´Ù
,

945 .
	gİs
 = &
š‘6_£q·ck‘_İs
,

946 .
	gno_check
 = 0,

947 .
	gæags
 = 
SCTP_PROTOSW_FLAG


949 
š‘_´Ùosw
 
	gsùpv6_¡»am_´Ùosw
 = {

950 .
ty³
 = 
SOCK_STREAM
,

951 .
	g´ÙocŞ
 = 
IPPROTO_SCTP
,

952 .
	g´Ù
 = &
sùpv6_´Ù
,

953 .
	gİs
 = &
š‘6_£q·ck‘_İs
,

954 .
	gno_check
 = 0,

955 .
	gæags
 = 
SCTP_PROTOSW_FLAG
,

958 
	$sùp6_rcv
(
sk_buff
 *
skb
)

960  
	`sùp_rcv
(
skb
) ? -1 : 0;

961 
	}
}

963 cÚ¡ 
š‘6_´ÙocŞ
 
	gsùpv6_´ÙocŞ
 = {

964 .
hªdËr
 = 
sùp6_rcv
,

965 .
	g”r_hªdËr
 = 
sùp_v6_”r
,

966 .
	gæags
 = 
INET6_PROTO_NOPOLICY
 | 
INET6_PROTO_FINAL
,

969 
sùp_af
 
	gsùp_af_š‘6
 = {

970 .
§_çmy
 = 
AF_INET6
,

971 .
	gsùp_xm™
 = 
sùp_v6_xm™
,

972 .
	g£tsockİt
 = 
v6_£tsockİt
,

973 .
	gg‘sockİt
 = 
v6_g‘sockİt
,

974 .
	gg‘_d¡
 = 
sùp_v6_g‘_d¡
,

975 .
	gg‘_§ddr
 = 
sùp_v6_g‘_§ddr
,

976 .
	gcİy_add¾i¡
 = 
sùp_v6_cİy_add¾i¡
,

977 .
	gäom_skb
 = 
sùp_v6_äom_skb
,

978 .
	gäom_sk
 = 
sùp_v6_äom_sk
,

979 .
	gto_sk_§ddr
 = 
sùp_v6_to_sk_§ddr
,

980 .
	gto_sk_daddr
 = 
sùp_v6_to_sk_daddr
,

981 .
	gäom_addr_·¿m
 = 
sùp_v6_äom_addr_·¿m
,

982 .
	gto_addr_·¿m
 = 
sùp_v6_to_addr_·¿m
,

983 .
	gcmp_addr
 = 
sùp_v6_cmp_addr
,

984 .
	gscİe
 = 
sùp_v6_scİe
,

985 .
	gaddr_v®id
 = 
sùp_v6_addr_v®id
,

986 .
	gšaddr_ªy
 = 
sùp_v6_šaddr_ªy
,

987 .
	gis_ªy
 = 
sùp_v6_is_ªy
,

988 .
	gavaabË
 = 
sùp_v6_avaabË
,

989 .
	gskb_iif
 = 
sùp_v6_skb_iif
,

990 .
	gis_û
 = 
sùp_v6_is_û
,

991 .
	g£q_dump_addr
 = 
sùp_v6_£q_dump_addr
,

992 .
	geú_ÿ·bË
 = 
sùp_v6_eú_ÿ·bË
,

993 .
	gÃt_h—d”_Ën
 = (
v6hdr
),

994 .
	gsockaddr_Ën
 = (
sockaddr_š6
),

995 #ifdeà
CONFIG_COMPAT


996 .
	gcom·t_£tsockİt
 = 
com·t_v6_£tsockİt
,

997 .
	gcom·t_g‘sockİt
 = 
com·t_v6_g‘sockİt
,

1001 
sùp_pf
 
	gsùp_pf_š‘6
 = {

1002 .
ev’t_msgÇme
 = 
sùp_š‘6_ev’t_msgÇme
,

1003 .
	gskb_msgÇme
 = 
sùp_š‘6_skb_msgÇme
,

1004 .
	gaf_suµÜ‹d
 = 
sùp_š‘6_af_suµÜ‹d
,

1005 .
	gcmp_addr
 = 
sùp_š‘6_cmp_addr
,

1006 .
	gbšd_v”ify
 = 
sùp_š‘6_bšd_v”ify
,

1007 .
	g£nd_v”ify
 = 
sùp_š‘6_£nd_v”ify
,

1008 .
	gsuµÜ‹d_addrs
 = 
sùp_š‘6_suµÜ‹d_addrs
,

1009 .
	gü—‹_acû±_sk
 = 
sùp_v6_ü—‹_acû±_sk
,

1010 .
	gaddr_v4m­
 = 
sùp_v6_addr_v4m­
,

1011 .
	gaf
 = &
sùp_af_š‘6
,

1015 
	$sùp_v6_pf_š™
()

1018 
	`sùp_»gi¡”_pf
(&
sùp_pf_š‘6
, 
PF_INET6
);

1021 
	`sùp_»gi¡”_af
(&
sùp_af_š‘6
);

1022 
	}
}

1024 
	$sùp_v6_pf_ex™
()

1026 
	`li¡_d–
(&
sùp_af_š‘6
.
li¡
);

1027 
	}
}

1030 
	$sùp_v6_´Ùosw_š™
()

1032 
rc
;

1034 
rc
 = 
	`´Ùo_»gi¡”
(&
sùpv6_´Ù
, 1);

1035 ià(
rc
)

1036  
rc
;

1039 
	`š‘6_»gi¡”_´Ùosw
(&
sùpv6_£q·ck‘_´Ùosw
);

1040 
	`š‘6_»gi¡”_´Ùosw
(&
sùpv6_¡»am_´Ùosw
);

1043 
	}
}

1045 
	$sùp_v6_´Ùosw_ex™
()

1047 
	`š‘6_uÄegi¡”_´Ùosw
(&
sùpv6_£q·ck‘_´Ùosw
);

1048 
	`š‘6_uÄegi¡”_´Ùosw
(&
sùpv6_¡»am_´Ùosw
);

1049 
	`´Ùo_uÄegi¡”
(&
sùpv6_´Ù
);

1050 
	}
}

1054 
	$sùp_v6_add_´ÙocŞ
()

1057 
	`»gi¡”_š‘6addr_nÙif›r
(&
sùp_š‘6addr_nÙif›r
);

1059 ià(
	`š‘6_add_´ÙocŞ
(&
sùpv6_´ÙocŞ
, 
IPPROTO_SCTP
) < 0)

1060  -
EAGAIN
;

1063 
	}
}

1066 
	$sùp_v6_d–_´ÙocŞ
()

1068 
	`š‘6_d–_´ÙocŞ
(&
sùpv6_´ÙocŞ
, 
IPPROTO_SCTP
);

1069 
	`uÄegi¡”_š‘6addr_nÙif›r
(&
sùp_š‘6addr_nÙif›r
);

1070 
	}
}

	@net_namespace.h

4 #iâdeà
__NET_NET_NAMESPACE_H


5 
	#__NET_NET_NAMESPACE_H


	)

7 
	~<lšux/©omic.h
>

8 
	~<lšux/wÜkqueue.h
>

9 
	~<lšux/li¡.h
>

10 
	~<lšux/sysùl.h
>

12 
	~<Ãt/ÃŠs/cÜe.h
>

13 
	~<Ãt/ÃŠs/mib.h
>

14 
	~<Ãt/ÃŠs/unix.h
>

15 
	~<Ãt/ÃŠs/·ck‘.h
>

16 
	~<Ãt/ÃŠs/v4.h
>

17 
	~<Ãt/ÃŠs/v6.h
>

18 
	~<Ãt/ÃŠs/sùp.h
>

19 
	~<Ãt/ÃŠs/dcı.h
>

20 
	~<Ãt/ÃŠs/x_bËs.h
>

21 #ià
defšed
(
CONFIG_NF_CONNTRACK
è|| defšed(
CONFIG_NF_CONNTRACK_MODULE
)

22 
	~<Ãt/ÃŠs/cÚÁ¿ck.h
>

24 
	~<Ãt/ÃŠs/xäm.h
>

26 
	gu£r_Çme¥aû
;

27 
	g´oc_dœ_’Œy
;

28 
	gÃt_deviû
;

29 
	gsock
;

30 
	gùl_bË_h—d”
;

31 
	gÃt_g’”ic
;

32 
	gsock
;

33 
	gÃŠs_vs
;

36 
	#NETDEV_HASHBITS
 8

	)

37 
	#NETDEV_HASHENTRIES
 (1 << 
NETDEV_HASHBITS
)

	)

39 
	sÃt
 {

40 
©omic_t
 
	m·ssive
;

43 
©omic_t
 
	mcouÁ
;

46 #ifdeà
NETNS_REFCNT_DEBUG


47 
©omic_t
 
	mu£_couÁ
;

51 
¥šlock_t
 
	mruËs_mod_lock
;

53 
li¡_h—d
 
	mli¡
;

54 
li¡_h—d
 
	mş—nup_li¡
;

55 
li¡_h—d
 
	mex™_li¡
;

57 
u£r_Çme¥aû
 *
	mu£r_ns
;

59 
	m´oc_šum
;

61 
´oc_dœ_’Œy
 *
	m´oc_Ãt
;

62 
´oc_dœ_’Œy
 *
	m´oc_Ãt_¡©
;

64 #ifdeà
CONFIG_SYSCTL


65 
ùl_bË_£t
 
	msysùls
;

68 
sock
 *
	m¹Æ
;

69 
sock
 *
	mg’l_sock
;

71 
li¡_h—d
 
	mdev_ba£_h—d
;

72 
hli¡_h—d
 *
	mdev_Çme_h—d
;

73 
hli¡_h—d
 *
	mdev_šdex_h—d
;

74 
	mdev_ba£_£q
;

75 
	mifšdex
;

78 
li¡_h—d
 
	mruËs_İs
;

81 
Ãt_deviû
 *
	mloİback_dev
;

82 
ÃŠs_cÜe
 
	mcÜe
;

83 
ÃŠs_mib
 
	mmib
;

84 
ÃŠs_·ck‘
 
	m·ck‘
;

85 
ÃŠs_unix
 
	munx
;

86 
ÃŠs_v4
 
	mv4
;

87 #ià
IS_ENABLED
(
CONFIG_IPV6
)

88 
ÃŠs_v6
 
	mv6
;

90 #ià
defšed
(
CONFIG_IP_SCTP
è|| defšed(
CONFIG_IP_SCTP_MODULE
)

91 
ÃŠs_sùp
 
	msùp
;

93 #ià
defšed
(
CONFIG_IP_DCCP
è|| defšed(
CONFIG_IP_DCCP_MODULE
)

94 
ÃŠs_dcı
 
	mdcı
;

96 #ifdeà
CONFIG_NETFILTER


97 
ÃŠs_xt
 
	mxt
;

98 #ià
defšed
(
CONFIG_NF_CONNTRACK
è|| defšed(
CONFIG_NF_CONNTRACK_MODULE
)

99 
ÃŠs_ù
 
	mù
;

101 #ià
IS_ENABLED
(
CONFIG_NF_DEFRAG_IPV6
)

102 
ÃŠs_nf_äag
 
	mnf_äag
;

104 
sock
 *
	mnâl
;

105 
sock
 *
	mnâl_¡ash
;

107 #ifdeà
CONFIG_WEXT_CORE


108 
sk_buff_h—d
 
	mwext_Æev’ts
;

110 
Ãt_g’”ic
 
__rcu
 *
	mg’
;

113 #ifdeà
CONFIG_XFRM


114 
ÃŠs_xäm
 
	mxäm
;

116 
ÃŠs_vs
 *
	mvs
;

117 
sock
 *
	mdŸg_Æsk
;

118 
©omic_t
 
	m¹_g’id
;

127 
	#LOOPBACK_IFINDEX
 1

	)

129 
	~<lšux/£q_fe_Ãt.h
>

132 
Ãt
 
š™_Ãt
;

134 #ifdeà
CONFIG_NET_NS


135 
Ãt
 *
cİy_Ãt_ns
(
æags
,

136 
u£r_Çme¥aû
 *
u£r_ns
, 
Ãt
 *
Şd_Ãt
);

139 
	~<lšux/sched.h
>

140 
	~<lšux/n¥roxy.h
>

141 
šlše
 
Ãt
 *
	$cİy_Ãt_ns
(
æags
,

142 
u£r_Çme¥aû
 *
u£r_ns
, 
Ãt
 *
Şd_Ãt
)

144 ià(
æags
 & 
CLONE_NEWNET
)

145  
	`ERR_PTR
(-
EINVAL
);

146  
Şd_Ãt
;

147 
	}
}

151 
li¡_h—d
 
Ãt_Çme¥aû_li¡
;

153 
Ãt
 *
g‘_Ãt_ns_by_pid
(
pid_t
 
pid
);

154 
Ãt
 *
g‘_Ãt_ns_by_fd
(
pid
);

156 #ifdeà
CONFIG_NET_NS


157 
__put_Ãt
(
Ãt
 *net);

159 
šlše
 
Ãt
 *
	$g‘_Ãt
(
Ãt
 *net)

161 
	`©omic_šc
(&
Ãt
->
couÁ
);

162  
Ãt
;

163 
	}
}

165 
šlše
 
Ãt
 *
	$maybe_g‘_Ãt
(
Ãt
 *net)

172 ià(!
	`©omic_šc_nÙ_z”o
(&
Ãt
->
couÁ
))

173 
Ãt
 = 
NULL
;

174  
Ãt
;

175 
	}
}

177 
šlše
 
	$put_Ãt
(
Ãt
 *net)

179 ià(
	`©omic_dec_ªd_‹¡
(&
Ãt
->
couÁ
))

180 
	`__put_Ãt
(
Ãt
);

181 
	}
}

183 
šlše


184 
	$Ãt_eq
(cÚ¡ 
Ãt
 *
Ãt1
, cÚ¡ Ãˆ*
Ãt2
)

186  
Ãt1
 =ğ
Ãt2
;

187 
	}
}

189 
Ãt_drİ_ns
(*);

193 
šlše
 
Ãt
 *
	$g‘_Ãt
(
Ãt
 *net)

195  
Ãt
;

196 
	}
}

198 
šlše
 
	$put_Ãt
(
Ãt
 *net)

200 
	}
}

202 
šlše
 
Ãt
 *
	$maybe_g‘_Ãt
(
Ãt
 *net)

204  
Ãt
;

205 
	}
}

207 
šlše


208 
	$Ãt_eq
(cÚ¡ 
Ãt
 *
Ãt1
, cÚ¡ Ãˆ*
Ãt2
)

211 
	}
}

213 
	#Ãt_drİ_ns
 
NULL


	)

217 #ifdeà
NETNS_REFCNT_DEBUG


218 
šlše
 
Ãt
 *
	$hŞd_Ãt
(
Ãt
 *net)

220 ià(
Ãt
)

221 
	`©omic_šc
(&
Ãt
->
u£_couÁ
);

222  
Ãt
;

223 
	}
}

225 
šlše
 
	$»Ëa£_Ãt
(
Ãt
 *net)

227 ià(
Ãt
)

228 
	`©omic_dec
(&
Ãt
->
u£_couÁ
);

229 
	}
}

231 
šlše
 
Ãt
 *
	$hŞd_Ãt
(
Ãt
 *net)

233  
Ãt
;

234 
	}
}

236 
šlše
 
	$»Ëa£_Ãt
(
Ãt
 *net)

238 
	}
}

241 #ifdeà
CONFIG_NET_NS


243 
šlše
 
	$wr™e_²‘
(
Ãt
 **
²‘
, net *net)

245 *
²‘
 = 
Ãt
;

246 
	}
}

248 
šlše
 
Ãt
 *
	$»ad_²‘
(
Ãt
 * cÚ¡ *
²‘
)

250  *
²‘
;

251 
	}
}

255 
	#wr™e_²‘
(
²‘
, 
Ãt
èdØ{ ()Ò‘);} 0)

	)

256 
	#»ad_²‘
(
²‘
è(&
š™_Ãt
)

	)

260 
	#fÜ_—ch_Ãt
(
VAR
) \

261 
	`li¡_fÜ_—ch_’Œy
(
VAR
, &
Ãt_Çme¥aû_li¡
, 
li¡
)

	)

263 
	#fÜ_—ch_Ãt_rcu
(
VAR
) \

264 
	`li¡_fÜ_—ch_’Œy_rcu
(
VAR
, &
Ãt_Çme¥aû_li¡
, 
li¡
)

	)

266 #ifdeà
CONFIG_NET_NS


267 
	#__Ãt_š™


	)

268 
	#__Ãt_ex™


	)

269 
	#__Ãt_š™d©a


	)

270 
	#__Ãt_š™cÚ¡


	)

272 
	#__Ãt_š™
 
__š™


	)

273 
	#__Ãt_ex™
 
__ex™_»fok


	)

274 
	#__Ãt_š™d©a
 
__š™d©a


	)

275 
	#__Ãt_š™cÚ¡
 
__š™cÚ¡


	)

278 
	s³º‘_İ”©iÚs
 {

279 
li¡_h—d
 
	mli¡
;

280 (*
	mš™
)(
Ãt
 *
	mÃt
);

281 (*
	mex™
)(
Ãt
 *
	mÃt
);

282 (*
	mex™_b©ch
)(
li¡_h—d
 *
	mÃt_ex™_li¡
);

283 *
	mid
;

284 
size_t
 
	msize
;

306 
»gi¡”_³º‘_subsys
(
³º‘_İ”©iÚs
 *);

307 
uÄegi¡”_³º‘_subsys
(
³º‘_İ”©iÚs
 *);

308 
»gi¡”_³º‘_deviû
(
³º‘_İ”©iÚs
 *);

309 
uÄegi¡”_³º‘_deviû
(
³º‘_İ”©iÚs
 *);

311 
	gùl_bË
;

312 
	gùl_bË_h—d”
;

314 #ifdeà
CONFIG_SYSCTL


315 
Ãt_sysùl_š™
();

316 
ùl_bË_h—d”
 *
»gi¡”_Ãt_sysùl
(
Ãt
 *net,

317 cÚ¡ *
·th
, 
ùl_bË
 *
bË
);

318 
uÄegi¡”_Ãt_sysùl_bË
(
ùl_bË_h—d”
 *
h—d”
);

320 
šlše
 
	$Ãt_sysùl_š™
(è{  0; 
	}
}

321 
šlše
 
ùl_bË_h—d”
 *
	$»gi¡”_Ãt_sysùl
(
Ãt
 *net,

322 cÚ¡ *
·th
, 
ùl_bË
 *
bË
)

324  
NULL
;

325 
	}
}

326 
šlše
 
	$uÄegi¡”_Ãt_sysùl_bË
(
ùl_bË_h—d”
 *
h—d”
)

328 
	}
}

331 
šlše
 
	$¹_g’id
(
Ãt
 *net)

333  
	`©omic_»ad
(&
Ãt
->
¹_g’id
);

334 
	}
}

336 
šlše
 
	$¹_g’id_bump
(
Ãt
 *net)

338 
	`©omic_šc
(&
Ãt
->
¹_g’id
);

339 
	}
}

	@objcnt.c

41 
	~<lšux/k”Ãl.h
>

42 
	~<Ãt/sùp/sùp.h
>

51 
SCTP_DBG_OBJCNT
(
sock
);

52 
SCTP_DBG_OBJCNT
(
•
);

53 
SCTP_DBG_OBJCNT
(
Œª¥Üt
);

54 
SCTP_DBG_OBJCNT
(
assoc
);

55 
SCTP_DBG_OBJCNT
(
bšd_addr
);

56 
SCTP_DBG_OBJCNT
(
bšd_buck‘
);

57 
SCTP_DBG_OBJCNT
(
chunk
);

58 
SCTP_DBG_OBJCNT
(
addr
);

59 
SCTP_DBG_OBJCNT
(
s¢m­
);

60 
SCTP_DBG_OBJCNT
(
d©amsg
);

61 
SCTP_DBG_OBJCNT
(
keys
);

66 
sùp_dbg_objút_’Œy_t
 
	gsùp_dbg_objút
[] = {

67 
SCTP_DBG_OBJCNT_ENTRY
(
sock
),

68 
SCTP_DBG_OBJCNT_ENTRY
(
•
),

69 
SCTP_DBG_OBJCNT_ENTRY
(
assoc
),

70 
SCTP_DBG_OBJCNT_ENTRY
(
Œª¥Üt
),

71 
SCTP_DBG_OBJCNT_ENTRY
(
chunk
),

72 
SCTP_DBG_OBJCNT_ENTRY
(
bšd_addr
),

73 
SCTP_DBG_OBJCNT_ENTRY
(
bšd_buck‘
),

74 
SCTP_DBG_OBJCNT_ENTRY
(
addr
),

75 
SCTP_DBG_OBJCNT_ENTRY
(
s¢m­
),

76 
SCTP_DBG_OBJCNT_ENTRY
(
d©amsg
),

77 
SCTP_DBG_OBJCNT_ENTRY
(
keys
),

84 
	$sùp_objút_£q_show
(
£q_fe
 *
£q
, *
v
)

86 
i
, 
Ën
;

88 
i
 = ()*(
loff_t
 *)
v
;

89 
	`£q_´štf
(
£q
, "%s: %d%n", 
sùp_dbg_objút
[
i
].
Ïb–
,

90 
	`©omic_»ad
(
sùp_dbg_objút
[
i
].
couÁ”
), &
Ën
);

91 
	`£q_´štf
(
£q
, "%*s\n", 127 - 
Ën
, "");

93 
	}
}

95 *
	$sùp_objút_£q_¡¬t
(
£q_fe
 *
£q
, 
loff_t
 *
pos
)

97  (*
pos
 >ğ
	`ARRAY_SIZE
(
sùp_dbg_objút
)è? 
NULL
 : (*)pos;

98 
	}
}

100 
	$sùp_objút_£q_¡İ
(
£q_fe
 *
£q
, *
v
)

102 
	}
}

104 * 
	$sùp_objút_£q_Ãxt
(
£q_fe
 *
£q
, *
v
, 
loff_t
 *
pos
)

106 ++*
pos
;

107  (*
pos
 >ğ
	`ARRAY_SIZE
(
sùp_dbg_objút
)è? 
NULL
 : (*)pos;

108 
	}
}

110 cÚ¡ 
£q_İ”©iÚs
 
	gsùp_objút_£q_İs
 = {

111 .
¡¬t
 = 
sùp_objút_£q_¡¬t
,

112 .
	gÃxt
 = 
sùp_objút_£q_Ãxt
,

113 .
	g¡İ
 = 
sùp_objút_£q_¡İ
,

114 .
	gshow
 = 
sùp_objút_£q_show
,

117 
	$sùp_objút_£q_İ’
(
šode
 *šode, 
fe
 *file)

119  
	`£q_İ’
(
fe
, &
sùp_objút_£q_İs
);

120 
	}
}

122 cÚ¡ 
fe_İ”©iÚs
 
	gsùp_objút_İs
 = {

123 .
İ’
 = 
sùp_objút_£q_İ’
,

124 .
	g»ad
 = 
£q_»ad
,

125 .
	gÎ£ek
 = 
£q_l£ek
,

126 .
	g»Ëa£
 = 
£q_»Ëa£
,

130 
	$sùp_dbg_objút_š™
()

132 
´oc_dœ_’Œy
 *
’t
;

134 
’t
 = 
	`´oc_ü—‹
("sctp_dbg_objcnt", 0,

135 
´oc_Ãt_sùp
, &
sùp_objút_İs
);

136 ià(!
’t
)

137 
	`´štk
(
KERN_WARNING


139 
	}
}

142 
	$sùp_dbg_objút_ex™
()

144 
	`»move_´oc_’Œy
("sùp_dbg_objút", 
´oc_Ãt_sùp
);

145 
	}
}

	@output.c

44 
	~<lšux/ty³s.h
>

45 
	~<lšux/k”Ãl.h
>

46 
	~<lšux/wa™.h
>

47 
	~<lšux/time.h
>

48 
	~<lšux/.h
>

49 
	~<lšux/v6.h
>

50 
	~<lšux/š™.h
>

51 
	~<Ãt/š‘_eú.h
>

52 
	~<Ãt/.h
>

53 
	~<Ãt/icmp.h
>

54 
	~<Ãt/Ãt_Çme¥aû.h
>

56 
	~<lšux/sock‘.h
>

57 
	~<Ãt/sock.h
>

59 
	~<Ãt/sùp/sùp.h
>

60 
	~<Ãt/sùp/sm.h
>

61 
	~<Ãt/sùp/checksum.h
>

64 
sùp_xm™_t
 
sùp_·ck‘_ÿn_­³nd_d©a
(
sùp_·ck‘
 *
·ck‘
,

65 
sùp_chunk
 *
chunk
);

66 
sùp_·ck‘_­³nd_d©a
(
sùp_·ck‘
 *
·ck‘
,

67 
sùp_chunk
 *
chunk
);

68 
sùp_xm™_t
 
sùp_·ck‘_wl_f™
(
sùp_·ck‘
 *
·ck‘
,

69 
sùp_chunk
 *
chunk
,

70 
u16
 
chunk_Ën
);

72 
	$sùp_·ck‘_»£t
(
sùp_·ck‘
 *
·ck‘
)

74 
·ck‘
->
size
 =…ack‘->
ov”h—d
;

75 
·ck‘
->
has_cook›_echo
 = 0;

76 
·ck‘
->
has_§ck
 = 0;

77 
·ck‘
->
has_d©a
 = 0;

78 
·ck‘
->
has_auth
 = 0;

79 
·ck‘
->
äagok
 = 0;

80 
·ck‘
->
auth
 = 
NULL
;

81 
	}
}

86 
sùp_·ck‘
 *
	$sùp_·ck‘_cÚfig
(
sùp_·ck‘
 *
·ck‘
,

87 
__u32
 
vg
, 
eú_ÿ·bË
)

89 
sùp_chunk
 *
chunk
 = 
NULL
;

91 
	`SCTP_DEBUG_PRINTK
("%s:…ack‘:%°vg:0x%x\n", 
__func__
,

92 
·ck‘
, 
vg
);

94 
·ck‘
->
vg
 = vtag;

96 ià(
eú_ÿ·bË
 && 
	`sùp_·ck‘_em±y
(
·ck‘
)) {

97 
chunk
 = 
	`sùp_g‘_eúe_´•’d
(
·ck‘
->
Œª¥Üt
->
asoc
);

102 ià(
chunk
)

103 
	`sùp_·ck‘_­³nd_chunk
(
·ck‘
, 
chunk
);

106  
·ck‘
;

107 
	}
}

110 
sùp_·ck‘
 *
	$sùp_·ck‘_š™
(
sùp_·ck‘
 *
·ck‘
,

111 
sùp_Œª¥Üt
 *
Œª¥Üt
,

112 
__u16
 
¥Üt
, __u16 
dpÜt
)

114 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

115 
size_t
 
ov”h—d
;

117 
	`SCTP_DEBUG_PRINTK
("%s:…ack‘:%°Œª¥Üt:%p\n", 
__func__
,

118 
·ck‘
, 
Œª¥Üt
);

120 
·ck‘
->
Œª¥Üt
 =ransport;

121 
·ck‘
->
sourû_pÜt
 = 
¥Üt
;

122 
·ck‘
->
de¡š©iÚ_pÜt
 = 
dpÜt
;

123 
	`INIT_LIST_HEAD
(&
·ck‘
->
chunk_li¡
);

124 ià(
asoc
) {

125 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
asoc
->
ba£
.
sk
);

126 
ov”h—d
 = 
¥
->
pf
->
af
->
Ãt_h—d”_Ën
;

128 
ov”h—d
 = (
v6hdr
);

130 
ov”h—d
 +ğ(
sùphdr
);

131 
·ck‘
->
ov”h—d
 = overhead;

132 
	`sùp_·ck‘_»£t
(
·ck‘
);

133 
·ck‘
->
vg
 = 0;

134 
·ck‘
->
m®loûd
 = 0;

135  
·ck‘
;

136 
	}
}

139 
	$sùp_·ck‘_ä“
(
sùp_·ck‘
 *
·ck‘
)

141 
sùp_chunk
 *
chunk
, *
tmp
;

143 
	`SCTP_DEBUG_PRINTK
("%s:…ack‘:%p\n", 
__func__
, 
·ck‘
);

145 
	`li¡_fÜ_—ch_’Œy_§ã
(
chunk
, 
tmp
, &
·ck‘
->
chunk_li¡
, 
li¡
) {

146 
	`li¡_d–_š™
(&
chunk
->
li¡
);

147 
	`sùp_chunk_ä“
(
chunk
);

150 ià(
·ck‘
->
m®loûd
)

151 
	`kä“
(
·ck‘
);

152 
	}
}

161 
sùp_xm™_t
 
	$sùp_·ck‘_Œªsm™_chunk
(
sùp_·ck‘
 *
·ck‘
,

162 
sùp_chunk
 *
chunk
,

163 
Úe_·ck‘
)

165 
sùp_xm™_t
 
»tv®
;

166 
”rÜ
 = 0;

168 
	`SCTP_DEBUG_PRINTK
("%s:…ack‘:%°chunk:%p\n", 
__func__
,

169 
·ck‘
, 
chunk
);

171 (
»tv®
 = (
	`sùp_·ck‘_­³nd_chunk
(
·ck‘
, 
chunk
)))) {

172 
SCTP_XMIT_PMTU_FULL
:

173 ià(!
·ck‘
->
has_cook›_echo
) {

174 
”rÜ
 = 
	`sùp_·ck‘_Œªsm™
(
·ck‘
);

175 ià(
”rÜ
 < 0)

176 
chunk
->
skb
->
sk
->
sk_”r
 = -
”rÜ
;

181 ià(!
Úe_·ck‘
)

182 
»tv®
 = 
	`sùp_·ck‘_­³nd_chunk
(
·ck‘
,

183 
chunk
);

187 
SCTP_XMIT_RWND_FULL
:

188 
SCTP_XMIT_OK
:

189 
SCTP_XMIT_NAGLE_DELAY
:

193  
»tv®
;

194 
	}
}

197 
sùp_xm™_t
 
	$sùp_·ck‘_bundË_auth
(
sùp_·ck‘
 *
pkt
,

198 
sùp_chunk
 *
chunk
)

200 
sùp_assocŸtiÚ
 *
asoc
 = 
pkt
->
Œª¥Üt
->asoc;

201 
sùp_chunk
 *
auth
;

202 
sùp_xm™_t
 
»tv®
 = 
SCTP_XMIT_OK
;

205 ià(!
asoc
)

206  
»tv®
;

211 ià(
chunk
->
chunk_hdr
->
ty³
 =ğ
SCTP_CID_AUTH
 || 
pkt
->
has_auth
)

212  
»tv®
;

217 ià(!
chunk
->
auth
)

218  
»tv®
;

220 
auth
 = 
	`sùp_make_auth
(
asoc
);

221 ià(!
auth
)

222  
»tv®
;

224 
»tv®
 = 
	`sùp_·ck‘_­³nd_chunk
(
pkt
, 
auth
);

226  
»tv®
;

227 
	}
}

230 
sùp_xm™_t
 
	$sùp_·ck‘_bundË_§ck
(
sùp_·ck‘
 *
pkt
,

231 
sùp_chunk
 *
chunk
)

233 
sùp_xm™_t
 
»tv®
 = 
SCTP_XMIT_OK
;

238 ià(
	`sùp_chunk_is_d©a
(
chunk
è&& !
pkt
->
has_§ck
 &&

239 !
pkt
->
has_cook›_echo
) {

240 
sùp_assocŸtiÚ
 *
asoc
;

241 
tim”_li¡
 *
tim”
;

242 
asoc
 = 
pkt
->
Œª¥Üt
->asoc;

243 
tim”
 = &
asoc
->
tim”s
[
SCTP_EVENT_TIMEOUT_SACK
];

246 ià(
	`tim”_³ndšg
(
tim”
)) {

247 
sùp_chunk
 *
§ck
;

249 ià(
pkt
->
Œª¥Üt
->
§ck_g’”©iÚ
 !=

250 
pkt
->
Œª¥Üt
->
asoc
->
³”
.
§ck_g’”©iÚ
)

251  
»tv®
;

253 
asoc
->
a_rwnd
 =‡soc->
rwnd
;

254 
§ck
 = 
	`sùp_make_§ck
(
asoc
);

255 ià(
§ck
) {

256 
»tv®
 = 
	`sùp_·ck‘_­³nd_chunk
(
pkt
, 
§ck
);

257 
asoc
->
³”
.
§ck_Ãeded
 = 0;

258 ià(
	`d–_tim”
(
tim”
))

259 
	`sùp_assocŸtiÚ_put
(
asoc
);

263  
»tv®
;

264 
	}
}

269 
sùp_xm™_t
 
	$sùp_·ck‘_­³nd_chunk
(
sùp_·ck‘
 *
·ck‘
,

270 
sùp_chunk
 *
chunk
)

272 
sùp_xm™_t
 
»tv®
 = 
SCTP_XMIT_OK
;

273 
__u16
 
chunk_Ën
 = 
	`WORD_ROUND
(
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
));

275 
	`SCTP_DEBUG_PRINTK
("%s:…ack‘:%°chunk:%p\n", 
__func__
, 
·ck‘
,

276 
chunk
);

282 ià(
	`sùp_chunk_is_d©a
(
chunk
)) {

283 
»tv®
 = 
	`sùp_·ck‘_ÿn_­³nd_d©a
(
·ck‘
, 
chunk
);

284 ià(
»tv®
 !ğ
SCTP_XMIT_OK
)

285 
fšish
;

289 
»tv®
 = 
	`sùp_·ck‘_bundË_auth
(
·ck‘
, 
chunk
);

290 ià(
»tv®
 !ğ
SCTP_XMIT_OK
)

291 
fšish
;

294 
»tv®
 = 
	`sùp_·ck‘_bundË_§ck
(
·ck‘
, 
chunk
);

295 ià(
»tv®
 !ğ
SCTP_XMIT_OK
)

296 
fšish
;

299 
»tv®
 = 
	`sùp_·ck‘_wl_f™
(
·ck‘
, 
chunk
, 
chunk_Ën
);

300 ià(
»tv®
 !ğ
SCTP_XMIT_OK
)

301 
fšish
;

304 
chunk
->
chunk_hdr
->
ty³
) {

305 
SCTP_CID_DATA
:

307 
	`sùp_·ck‘_­³nd_d©a
(
·ck‘
, 
chunk
);

309 
·ck‘
->
has_§ck
 = 1;

311 
·ck‘
->
has_auth
 = 1;

313 
·ck‘
->
has_d©a
 = 1;

315 
chunk
->
£Á_©
 = 
jiff›s
;

317 
SCTP_CID_COOKIE_ECHO
:

318 
·ck‘
->
has_cook›_echo
 = 1;

321 
SCTP_CID_SACK
:

322 
·ck‘
->
has_§ck
 = 1;

325 
SCTP_CID_AUTH
:

326 
·ck‘
->
has_auth
 = 1;

327 
·ck‘
->
auth
 = 
chunk
;

332 
	`li¡_add_
(&
chunk
->
li¡
, &
·ck‘
->
chunk_li¡
);

333 
·ck‘
->
size
 +ğ
chunk_Ën
;

334 
chunk
->
Œª¥Üt
 = 
·ck‘
->transport;

335 
fšish
:

336  
»tv®
;

337 
	}
}

339 
	$sùp_·ck‘_»Ëa£_owÃr
(
sk_buff
 *
skb
)

341 
	`sk_ä“
(
skb
->
sk
);

342 
	}
}

344 
	$sùp_·ck‘_£t_owÃr_w
(
sk_buff
 *
skb
, 
sock
 *
sk
)

346 
	`skb_Üphª
(
skb
);

347 
skb
->
sk
 = sk;

348 
skb
->
de¡ruùÜ
 = 
sùp_·ck‘_»Ëa£_owÃr
;

355 
	`©omic_šc
(&
sk
->
sk_wmem_®loc
);

356 
	}
}

363 
	$sùp_·ck‘_Œªsm™
(
sùp_·ck‘
 *
·ck‘
)

365 
sùp_Œª¥Üt
 *

 = 
·ck‘
->
Œª¥Üt
;

366 
sùp_assocŸtiÚ
 *
asoc
 = 

->asoc;

367 
sùphdr
 *
sh
;

368 
sk_buff
 *
nskb
;

369 
sùp_chunk
 *
chunk
, *
tmp
;

370 
sock
 *
sk
;

371 
”r
 = 0;

372 
·ddšg
;

373 
__u8
 
has_d©a
 = 0;

374 
d¡_’Œy
 *
d¡
 = 

->dst;

375 *
auth
 = 
NULL
;

376 
__u32
 
cksum_buf_Ën
 = (
sùphdr
);

378 
	`SCTP_DEBUG_PRINTK
("%s:…ack‘:%p\n", 
__func__
, 
·ck‘
);

381 ià(
	`li¡_em±y
(&
·ck‘
->
chunk_li¡
))

382  
”r
;

385 
chunk
 = 
	`li¡_’Œy
(
·ck‘
->
chunk_li¡
.
Ãxt
, 
sùp_chunk
, 
li¡
);

386 
sk
 = 
chunk
->
skb
->sk;

389 
nskb
 = 
	`®loc_skb
(
·ck‘
->
size
 + 
LL_MAX_HEADER
, 
GFP_ATOMIC
);

390 ià(!
nskb
)

391 
nomem
;

394 
	`skb_»£rve
(
nskb
, 
·ck‘
->
ov”h—d
 + 
LL_MAX_HEADER
);

399 
	`sùp_·ck‘_£t_owÃr_w
(
nskb
, 
sk
);

402 ià(!
d¡
 || (d¡->
obsŞ‘e
 > 1)) {

403 
	`d¡_»Ëa£
(
d¡
);

404 
	`sùp_Œª¥Üt_rou‹
(

, 
NULL
, 
	`sùp_sk
(
sk
));

405 ià(
asoc
 && (asoc->
·¿m_æags
 & 
SPP_PMTUD_ENABLE
)) {

406 
	`sùp_assoc_sync_pmtu
(
asoc
);

409 
d¡
 = 
	`d¡_şÚe
(

->dst);

410 
	`skb_d¡_£t
(
nskb
, 
d¡
);

411 ià(!
d¡
)

412 
no_rou‹
;

415 
sh
 = (
sùphdr
 *)
	`skb_push
(
nskb
, (sctphdr));

416 
	`skb_»£t_Œª¥Üt_h—d”
(
nskb
);

417 
sh
->
sourû
 = 
	`htÚs
(
·ck‘
->
sourû_pÜt
);

418 
sh
->
de¡
 = 
	`htÚs
(
·ck‘
->
de¡š©iÚ_pÜt
);

428 
sh
->
vg
 = 
	`htÚl
(
·ck‘
->vtag);

429 
sh
->
checksum
 = 0;

450 
	`SCTP_DEBUG_PRINTK
("***sctp_transmit_packet***\n");

451 
	`li¡_fÜ_—ch_’Œy_§ã
(
chunk
, 
tmp
, &
·ck‘
->
chunk_li¡
, 
li¡
) {

452 
	`li¡_d–_š™
(&
chunk
->
li¡
);

453 ià(
	`sùp_chunk_is_d©a
(
chunk
)) {

461 ià(!

->
¹o_³ndšg
) {

462 
chunk
->
¹t_š_´og»ss
 = 1;

463 

->
¹o_³ndšg
 = 1;

465 
has_d©a
 = 1;

468 
·ddšg
 = 
	`WORD_ROUND
(
chunk
->
skb
->
Ën
) - chunk->skb->len;

469 ià(
·ddšg
)

470 
	`mem£t
(
	`skb_put
(
chunk
->
skb
, 
·ddšg
), 0,…adding);

476 ià(
chunk
 =ğ
·ck‘
->
auth
)

477 
auth
 = 
	`skb__poš‹r
(
nskb
);

479 
cksum_buf_Ën
 +ğ
chunk
->
skb
->
Ën
;

480 
	`memıy
(
	`skb_put
(
nskb
, 
chunk
->
skb
->
Ën
),

481 
chunk
->
skb
->
d©a
, chunk->skb->
Ën
);

483 
	`SCTP_DEBUG_PRINTK
("%s %p[%s] %s 0x%x, %s %d, %s %d, %s %d\n",

484 "*** Chunk", 
chunk
,

485 
	`sùp_úame
(
	`SCTP_ST_CHUNK
(

486 
chunk
->
chunk_hdr
->
ty³
)),

487 
chunk
->
has_t¢
 ? "TSN" : "No TSN",

488 
chunk
->
has_t¢
 ?

489 
	`Áohl
(
chunk
->
subh
.
d©a_hdr
->
t¢
) : 0,

490 "Ëngth", 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
),

491 "chunk->skb->Ën", 
chunk
->
skb
->
Ën
,

492 "¹t_š_´og»ss", 
chunk
->
¹t_š_´og»ss
);

499 ià(!
	`sùp_chunk_is_d©a
(
chunk
))

500 
	`sùp_chunk_ä“
(
chunk
);

512 ià(
auth
)

513 
	`sùp_auth_ÿlcuÏ‹_hmac
(
asoc
, 
nskb
,

514 (
sùp_auth_chunk
 *)
auth
,

515 
GFP_ATOMIC
);

524 ià(!
sùp_checksum_di§bË
 &&

525 !(
d¡
->
dev
->
ã©u»s
 & (
NETIF_F_NO_CSUM
 | 
NETIF_F_SCTP_CSUM
))) {

526 
__u32
 
üc32
 = 
	`sùp_¡¬t_cksum
((
__u8
 *)
sh
, 
cksum_buf_Ën
);

531 
sh
->
checksum
 = 
	`sùp_’d_cksum
(
üc32
);

533 ià(
d¡
->
dev
->
ã©u»s
 & 
NETIF_F_SCTP_CSUM
) {

535 
nskb
->
_summed
 = 
CHECKSUM_PARTIAL
;

536 
nskb
->
csum_¡¬t
 = (
	`skb_Œª¥Üt_h—d”
(nskb) -

537 
nskb
->
h—d
);

538 
nskb
->
csum_off£t
 = 
	`off£tof
(
sùphdr
, 
checksum
);

540 
nskb
->
_summed
 = 
CHECKSUM_UNNECESSARY
;

556 (*

->
af_¥ecific
->
eú_ÿ·bË
)(
nskb
->
sk
);

564 ià(
asoc
 &&‡soc->
³”
.
Ï¡_£Á_to
 !ğ

) {

568 
asoc
->
³”
.
Ï¡_£Á_to
 = 

;

571 ià(
has_d©a
) {

572 
tim”_li¡
 *
tim”
;

573 
timeout
;

576 ià(
	`sùp_¡©e
(
asoc
, 
ESTABLISHED
è&&‡soc->
autoşo£
) {

577 
tim”
 = &
asoc
->
tim”s
[
SCTP_EVENT_TIMEOUT_AUTOCLOSE
];

578 
timeout
 = 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_AUTOCLOSE
];

580 ià(!
	`mod_tim”
(
tim”
, 
jiff›s
 + 
timeout
))

581 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

585 
	`SCTP_DEBUG_PRINTK
("***sctp_transmit_packet*** skb†en %d\n",

586 
nskb
->
Ën
);

588 
nskb
->
loÿl_df
 = 
·ck‘
->
äagok
;

589 (*

->
af_¥ecific
->
sùp_xm™
)(
nskb
,p);

591 
out
:

592 
	`sùp_·ck‘_»£t
(
·ck‘
);

593  
”r
;

594 
no_rou‹
:

595 
	`kä“_skb
(
nskb
);

596 
	`IP_INC_STATS_BH
(&
š™_Ãt
, 
IPSTATS_MIB_OUTNOROUTES
);

606 
”r
:

611 
	`li¡_fÜ_—ch_’Œy_§ã
(
chunk
, 
tmp
, &
·ck‘
->
chunk_li¡
, 
li¡
) {

612 
	`li¡_d–_š™
(&
chunk
->
li¡
);

613 ià(!
	`sùp_chunk_is_d©a
(
chunk
))

614 
	`sùp_chunk_ä“
(
chunk
);

616 
out
;

617 
nomem
:

618 
”r
 = -
ENOMEM
;

619 
”r
;

620 
	}
}

627 
sùp_xm™_t
 
	$sùp_·ck‘_ÿn_­³nd_d©a
(
sùp_·ck‘
 *
·ck‘
,

628 
sùp_chunk
 *
chunk
)

630 
sùp_xm™_t
 
»tv®
 = 
SCTP_XMIT_OK
;

631 
size_t
 
d©asize
, 
rwnd
, 
šæight
, 
æight_size
;

632 
sùp_Œª¥Üt
 *
Œª¥Üt
 = 
·ck‘
->transport;

633 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

634 
sùp_outq
 *
q
 = &
asoc
->
outqueue
;

649 
rwnd
 = 
asoc
->
³”
.rwnd;

650 
šæight
 = 
q
->
out¡ªdšg_by‹s
;

651 
æight_size
 = 
Œª¥Üt
->flight_size;

653 
d©asize
 = 
	`sùp_d©a_size
(
chunk
);

655 ià(
d©asize
 > 
rwnd
) {

656 ià(
šæight
 > 0) {

660 
»tv®
 = 
SCTP_XMIT_RWND_FULL
;

661 
fšish
;

677 ià(
chunk
->
ç¡_»Œªsm™
 !ğ
SCTP_NEED_FRTX
)

678 ià(
æight_size
 >ğ
Œª¥Üt
->
cwnd
) {

679 
»tv®
 = 
SCTP_XMIT_RWND_FULL
;

680 
fšish
;

688 ià(!
	`sùp_sk
(
asoc
->
ba£
.
sk
)->
nod–ay
 && 
	`sùp_·ck‘_em±y
(
·ck‘
) &&

689 
šæight
 && 
	`sùp_¡©e
(
asoc
, 
ESTABLISHED
)) {

690 
max
 = 
Œª¥Üt
->
·thmtu
 - 
·ck‘
->
ov”h—d
;

691 
Ën
 = 
chunk
->
skb
->ËÀ+ 
q
->
out_qËn
;

699 ià((
Ën
 < 
max
è&& 
chunk
->
msg
->
ÿn_d–ay
) {

700 
»tv®
 = 
SCTP_XMIT_NAGLE_DELAY
;

701 
fšish
;

705 
fšish
:

706  
»tv®
;

707 
	}
}

710 
	$sùp_·ck‘_­³nd_d©a
(
sùp_·ck‘
 *
·ck‘
,

711 
sùp_chunk
 *
chunk
)

713 
sùp_Œª¥Üt
 *
Œª¥Üt
 = 
·ck‘
->transport;

714 
size_t
 
d©asize
 = 
	`sùp_d©a_size
(
chunk
);

715 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

716 
u32
 
rwnd
 = 
asoc
->
³”
.rwnd;

719 
Œª¥Üt
->
æight_size
 +ğ
d©asize
;

722 
asoc
->
outqueue
.
out¡ªdšg_by‹s
 +ğ
d©asize
;

725 ià(
d©asize
 < 
rwnd
)

726 
rwnd
 -ğ
d©asize
;

728 
rwnd
 = 0;

730 
asoc
->
³”
.
rwnd
 =„wnd;

732 ià(!
asoc
->
³”
.
´sùp_ÿ·bË
)

733 
chunk
->
msg
->
ÿn_abªdÚ
 = 0;

734 
	`sùp_chunk_assign_t¢
(
chunk
);

735 
	`sùp_chunk_assign_s¢
(
chunk
);

736 
	}
}

738 
sùp_xm™_t
 
	$sùp_·ck‘_wl_f™
(
sùp_·ck‘
 *
·ck‘
,

739 
sùp_chunk
 *
chunk
,

740 
u16
 
chunk_Ën
)

742 
size_t
 
psize
;

743 
size_t
 
pmtu
;

744 
too_big
;

745 
sùp_xm™_t
 
»tv®
 = 
SCTP_XMIT_OK
;

747 
psize
 = 
·ck‘
->
size
;

748 
pmtu
 = ((
·ck‘
->
Œª¥Üt
->
asoc
) ?

749 (
·ck‘
->
Œª¥Üt
->
asoc
->
·thmtu
) :

750 (
·ck‘
->
Œª¥Üt
->
·thmtu
));

752 
too_big
 = (
psize
 + 
chunk_Ën
 > 
pmtu
);

755 ià(
too_big
) {

764 ià(
	`sùp_·ck‘_em±y
(
·ck‘
è|| !
	`sùp_chunk_is_d©a
(
chunk
) ||

765 (!
·ck‘
->
has_d©a
 && 
chunk
->
auth
)) {

770 
·ck‘
->
äagok
 = 1;

772 
»tv®
 = 
SCTP_XMIT_PMTU_FULL
;

776  
»tv®
;

777 
	}
}

	@outqueue.c

49 
	~<lšux/ty³s.h
>

50 
	~<lšux/li¡.h
>

51 
	~<lšux/sock‘.h
>

52 
	~<lšux/.h
>

53 
	~<Ãt/sock.h
>

55 
	~<Ãt/sùp/sùp.h
>

56 
	~<Ãt/sùp/sm.h
>

59 
sùp_acked
(
sùp_§ckhdr
 *
§ck
, 
__u32
 
t¢
);

60 
sùp_check_Œªsm™‹d
(
sùp_outq
 *
q
,

61 
li¡_h—d
 *
Œªsm™‹d_queue
,

62 
sùp_Œª¥Üt
 *
Œª¥Üt
,

63 
sùp_§ckhdr
 *
§ck
,

64 
__u32
 *
highe¡_Ãw_t¢
);

66 
sùp_m¬k_missšg
(
sùp_outq
 *
q
,

67 
li¡_h—d
 *
Œªsm™‹d_queue
,

68 
sùp_Œª¥Üt
 *
Œª¥Üt
,

69 
__u32
 
highe¡_Ãw_t¢
,

70 
couÁ_of_Ãwacks
);

72 
sùp_g’”©e_fwdt¢
(
sùp_outq
 *
q
, 
__u32
 
§ck_ù¢
);

74 
sùp_outq_æush
(
sùp_outq
 *
q
, 
¹x_timeout
);

77 
šlše
 
	$sùp_outq_h—d_d©a
(
sùp_outq
 *
q
,

78 
sùp_chunk
 *
ch
)

80 
	`li¡_add
(&
ch
->
li¡
, &
q
->
out_chunk_li¡
);

81 
q
->
out_qËn
 +ğ
ch
->
skb
->
Ën
;

83 
	}
}

86 
šlše
 
sùp_chunk
 *
	$sùp_outq_dequeue_d©a
(
sùp_outq
 *
q
)

88 
sùp_chunk
 *
ch
 = 
NULL
;

90 ià(!
	`li¡_em±y
(&
q
->
out_chunk_li¡
)) {

91 
li¡_h—d
 *
’Œy
 = 
q
->
out_chunk_li¡
.
Ãxt
;

93 
ch
 = 
	`li¡_’Œy
(
’Œy
, 
sùp_chunk
, 
li¡
);

94 
	`li¡_d–_š™
(
’Œy
);

95 
q
->
out_qËn
 -ğ
ch
->
skb
->
Ën
;

97  
ch
;

98 
	}
}

100 
šlše
 
	$sùp_outq__d©a
(
sùp_outq
 *
q
,

101 
sùp_chunk
 *
ch
)

103 
	`li¡_add_
(&
ch
->
li¡
, &
q
->
out_chunk_li¡
);

104 
q
->
out_qËn
 +ğ
ch
->
skb
->
Ën
;

106 
	}
}

114 
šlše
 
	$sùp_ÿcc_sk_3_1_d
(
sùp_Œª¥Üt
 *
´im¬y
,

115 
sùp_Œª¥Üt
 *
Œª¥Üt
,

116 
couÁ_of_Ãwacks
)

118 ià(
couÁ_of_Ãwacks
 >=2 && 
Œª¥Üt
 !ğ
´im¬y
)

121 
	}
}

130 
šlše
 
	$sùp_ÿcc_sk_3_1_f
(
sùp_Œª¥Üt
 *
Œª¥Üt
,

131 
couÁ_of_Ãwacks
)

133 ià(
couÁ_of_Ãwacks
 < 2 &&

134 (
Œª¥Üt
 && !Œª¥Üt->
ÿcc
.
ÿcc_§w_Ãwack
))

137 
	}
}

146 
šlše
 
	$sùp_ÿcc_sk_3_1
(
sùp_Œª¥Üt
 *
´im¬y
,

147 
sùp_Œª¥Üt
 *
Œª¥Üt
,

148 
couÁ_of_Ãwacks
)

150 ià(!
´im¬y
->
ÿcc
.
cyşšg_chªgeov”
) {

151 ià(
	`sùp_ÿcc_sk_3_1_d
(
´im¬y
, 
Œª¥Üt
, 
couÁ_of_Ãwacks
))

153 ià(
	`sùp_ÿcc_sk_3_1_f
(
Œª¥Üt
, 
couÁ_of_Ãwacks
))

158 
	}
}

167 
šlše
 
	$sùp_ÿcc_sk_3_2
(
sùp_Œª¥Üt
 *
´im¬y
, 
__u32
 
t¢
)

169 ià(
´im¬y
->
ÿcc
.
cyşšg_chªgeov”
 &&

170 
	`TSN_É
(
t¢
, 
´im¬y
->
ÿcc
.
Ãxt_t¢_©_chªge
))

173 
	}
}

189 
šlše
 
	$sùp_ÿcc_sk
(
sùp_Œª¥Üt
 *
´im¬y
,

190 
sùp_Œª¥Üt
 *
Œª¥Üt
,

191 
couÁ_of_Ãwacks
,

192 
__u32
 
t¢
)

194 ià(
´im¬y
->
ÿcc
.
chªgeov”_aùive
 &&

195 (
	`sùp_ÿcc_sk_3_1
(
´im¬y
, 
Œª¥Üt
, 
couÁ_of_Ãwacks
)

196 || 
	`sùp_ÿcc_sk_3_2
(
´im¬y
, 
t¢
)))

199 
	}
}

205 
	$sùp_outq_š™
(
sùp_assocŸtiÚ
 *
asoc
, 
sùp_outq
 *
q
)

207 
q
->
asoc
 =‡soc;

208 
	`INIT_LIST_HEAD
(&
q
->
out_chunk_li¡
);

209 
	`INIT_LIST_HEAD
(&
q
->
cÚŒŞ_chunk_li¡
);

210 
	`INIT_LIST_HEAD
(&
q
->
»Œªsm™
);

211 
	`INIT_LIST_HEAD
(&
q
->
§cked
);

212 
	`INIT_LIST_HEAD
(&
q
->
abªdÚed
);

214 
q
->
ç¡_¹x
 = 0;

215 
q
->
out¡ªdšg_by‹s
 = 0;

216 
q
->
em±y
 = 1;

217 
q
->
cÜk
 = 0;

219 
q
->
m®loûd
 = 0;

220 
q
->
out_qËn
 = 0;

221 
	}
}

225 
	$sùp_outq_‹¬down
(
sùp_outq
 *
q
)

227 
sùp_Œª¥Üt
 *
Œª¥Üt
;

228 
li¡_h—d
 *
lchunk
, *
‹mp
;

229 
sùp_chunk
 *
chunk
, *
tmp
;

232 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, &
q
->
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

233 
Œª¥Üts
) {

234 (
lchunk
 = 
	`sùp_li¡_dequeue
(&
Œª¥Üt
->
Œªsm™‹d
)è!ğ
NULL
) {

235 
chunk
 = 
	`li¡_’Œy
(
lchunk
, 
sùp_chunk
,

236 
Œªsm™‹d_li¡
);

238 
	`sùp_chunk_ç
(
chunk
, 
q
->
”rÜ
);

239 
	`sùp_chunk_ä“
(
chunk
);

244 
	`li¡_fÜ_—ch_§ã
(
lchunk
, 
‹mp
, &
q
->
§cked
) {

245 
	`li¡_d–_š™
(
lchunk
);

246 
chunk
 = 
	`li¡_’Œy
(
lchunk
, 
sùp_chunk
,

247 
Œªsm™‹d_li¡
);

248 
	`sùp_chunk_ç
(
chunk
, 
q
->
”rÜ
);

249 
	`sùp_chunk_ä“
(
chunk
);

253 
	`li¡_fÜ_—ch_§ã
(
lchunk
, 
‹mp
, &
q
->
»Œªsm™
) {

254 
	`li¡_d–_š™
(
lchunk
);

255 
chunk
 = 
	`li¡_’Œy
(
lchunk
, 
sùp_chunk
,

256 
Œªsm™‹d_li¡
);

257 
	`sùp_chunk_ç
(
chunk
, 
q
->
”rÜ
);

258 
	`sùp_chunk_ä“
(
chunk
);

262 
	`li¡_fÜ_—ch_§ã
(
lchunk
, 
‹mp
, &
q
->
abªdÚed
) {

263 
	`li¡_d–_š™
(
lchunk
);

264 
chunk
 = 
	`li¡_’Œy
(
lchunk
, 
sùp_chunk
,

265 
Œªsm™‹d_li¡
);

266 
	`sùp_chunk_ç
(
chunk
, 
q
->
”rÜ
);

267 
	`sùp_chunk_ä“
(
chunk
);

271 (
chunk
 = 
	`sùp_outq_dequeue_d©a
(
q
)è!ğ
NULL
) {

274 
	`sùp_chunk_ç
(
chunk
, 
q
->
”rÜ
);

275 
	`sùp_chunk_ä“
(
chunk
);

278 
q
->
”rÜ
 = 0;

281 
	`li¡_fÜ_—ch_’Œy_§ã
(
chunk
, 
tmp
, &
q
->
cÚŒŞ_chunk_li¡
, 
li¡
) {

282 
	`li¡_d–_š™
(&
chunk
->
li¡
);

283 
	`sùp_chunk_ä“
(
chunk
);

285 
	}
}

288 
	$sùp_outq_ä“
(
sùp_outq
 *
q
)

291 
	`sùp_outq_‹¬down
(
q
);

294 ià(
q
->
m®loûd
)

295 
	`kä“
(
q
);

296 
	}
}

299 
	$sùp_outq_
(
sùp_outq
 *
q
, 
sùp_chunk
 *
chunk
)

301 
”rÜ
 = 0;

303 
	`SCTP_DEBUG_PRINTK
("sctp_outq_tail(%p, %p[%s])\n",

304 
q
, 
chunk
, chunk && chunk->
chunk_hdr
 ?

305 
	`sùp_úame
(
	`SCTP_ST_CHUNK
(
chunk
->
chunk_hdr
->
ty³
))

311 ià(
SCTP_CID_DATA
 =ğ
chunk
->
chunk_hdr
->
ty³
) {

321 
q
->
asoc
->
¡©e
) {

322 
SCTP_STATE_EMPTY
:

323 
SCTP_STATE_CLOSED
:

324 
SCTP_STATE_SHUTDOWN_PENDING
:

325 
SCTP_STATE_SHUTDOWN_SENT
:

326 
SCTP_STATE_SHUTDOWN_RECEIVED
:

327 
SCTP_STATE_SHUTDOWN_ACK_SENT
:

329 
”rÜ
 = -
ESHUTDOWN
;

333 
	`SCTP_DEBUG_PRINTK
("outqueueing (%p, %p[%s])\n",

334 
q
, 
chunk
, chunk && chunk->
chunk_hdr
 ?

335 
	`sùp_úame
(
	`SCTP_ST_CHUNK
(
chunk
->
chunk_hdr
->
ty³
))

338 
	`sùp_outq__d©a
(
q
, 
chunk
);

339 ià(
chunk
->
chunk_hdr
->
æags
 & 
SCTP_DATA_UNORDERED
)

340 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTUNORDERCHUNKS
);

342 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTORDERCHUNKS
);

343 
q
->
em±y
 = 0;

347 
	`li¡_add_
(&
chunk
->
li¡
, &
q
->
cÚŒŞ_chunk_li¡
);

348 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

351 ià(
”rÜ
 < 0)

352  
”rÜ
;

354 ià(!
q
->
cÜk
)

355 
”rÜ
 = 
	`sùp_outq_æush
(
q
, 0);

357  
”rÜ
;

358 
	}
}

363 
	$sùp_š£¹_li¡
(
li¡_h—d
 *
h—d
, li¡_h—d *
Ãw
)

365 
li¡_h—d
 *
pos
;

366 
sùp_chunk
 *
nchunk
, *
lchunk
;

367 
__u32
 
Á¢
, 
É¢
;

368 
dÚe
 = 0;

370 
nchunk
 = 
	`li¡_’Œy
(
Ãw
, 
sùp_chunk
, 
Œªsm™‹d_li¡
);

371 
Á¢
 = 
	`Áohl
(
nchunk
->
subh
.
d©a_hdr
->
t¢
);

373 
	`li¡_fÜ_—ch
(
pos
, 
h—d
) {

374 
lchunk
 = 
	`li¡_’Œy
(
pos
, 
sùp_chunk
, 
Œªsm™‹d_li¡
);

375 
É¢
 = 
	`Áohl
(
lchunk
->
subh
.
d©a_hdr
->
t¢
);

376 ià(
	`TSN_É
(
Á¢
, 
É¢
)) {

377 
	`li¡_add
(
Ãw
, 
pos
->
´ev
);

378 
dÚe
 = 1;

382 ià(!
dÚe
)

383 
	`li¡_add_
(
Ãw
, 
h—d
);

384 
	}
}

387 
	$sùp_»Œªsm™_m¬k
(
sùp_outq
 *
q
,

388 
sùp_Œª¥Üt
 *
Œª¥Üt
,

389 
__u8
 
»asÚ
)

391 
li¡_h—d
 *
lchunk
, *
Éemp
;

392 
sùp_chunk
 *
chunk
;

395 
	`li¡_fÜ_—ch_§ã
(
lchunk
, 
Éemp
, &
Œª¥Üt
->
Œªsm™‹d
) {

396 
chunk
 = 
	`li¡_’Œy
(
lchunk
, 
sùp_chunk
,

397 
Œªsm™‹d_li¡
);

400 ià(
	`sùp_chunk_abªdÚed
(
chunk
)) {

401 
	`li¡_d–_š™
(
lchunk
);

402 
	`sùp_š£¹_li¡
(&
q
->
abªdÚed
, 
lchunk
);

409 ià(!
chunk
->
t¢_g­_acked
) {

410 ià(
chunk
->
Œª¥Üt
)

411 
chunk
->
Œª¥Üt
->
æight_size
 -=

412 
	`sùp_d©a_size
(
chunk
);

413 
q
->
out¡ªdšg_by‹s
 -ğ
	`sùp_d©a_size
(
chunk
);

414 
q
->
asoc
->
³”
.
rwnd
 +ğ
	`sùp_d©a_size
(
chunk
);

423 ià((
»asÚ
 =ğ
SCTP_RTXR_FAST_RTX
 &&

424 (
chunk
->
ç¡_»Œªsm™
 =ğ
SCTP_NEED_FRTX
)) ||

425 (
»asÚ
 !ğ
SCTP_RTXR_FAST_RTX
 && !
chunk
->
t¢_g­_acked
)) {

434 
q
->
asoc
->
³”
.
rwnd
 +ğ
	`sùp_d©a_size
(
chunk
);

435 
q
->
out¡ªdšg_by‹s
 -ğ
	`sùp_d©a_size
(
chunk
);

436 ià(
chunk
->
Œª¥Üt
)

437 
Œª¥Üt
->
æight_size
 -ğ
	`sùp_d©a_size
(
chunk
);

444 
chunk
->
t¢_missšg_»pÜt
 = 0;

452 ià(
chunk
->
¹t_š_´og»ss
) {

453 
chunk
->
¹t_š_´og»ss
 = 0;

454 
Œª¥Üt
->
¹o_³ndšg
 = 0;

460 
	`li¡_d–_š™
(
lchunk
);

461 
	`sùp_š£¹_li¡
(&
q
->
»Œªsm™
, 
lchunk
);

465 
	`SCTP_DEBUG_PRINTK
("%s:ransport: %p,„eason: %d, "

467 "pba: %d\n", 
__func__
,

468 
Œª¥Üt
, 
»asÚ
,

469 
Œª¥Üt
->
cwnd
,¿n¥Üt->
s¡h»sh
,

470 
Œª¥Üt
->
æight_size
,

471 
Œª¥Üt
->
·¹Ÿl_by‹s_acked
);

473 
	}
}

478 
	$sùp_»Œªsm™
(
sùp_outq
 *
q
, 
sùp_Œª¥Üt
 *
Œª¥Üt
,

479 
sùp_»Œªsm™_»asÚ_t
 
»asÚ
)

481 
”rÜ
 = 0;

483 
»asÚ
) {

484 
SCTP_RTXR_T3_RTX
:

485 
	`SCTP_INC_STATS
(
SCTP_MIB_T3_RETRANSMITS
);

486 
	`sùp_Œª¥Üt_low”_cwnd
(
Œª¥Üt
, 
SCTP_LOWER_CWND_T3_RTX
);

490 ià(
Œª¥Üt
 =ğŒª¥Üt->
asoc
->
³”
.
»Œª_·th
)

491 
	`sùp_assoc_upd©e_»Œª_·th
(
Œª¥Üt
->
asoc
);

492 
Œª¥Üt
->
asoc
->
¹x_d©a_chunks
 +=

493 
Œª¥Üt
->
asoc
->
uÇck_d©a
;

495 
SCTP_RTXR_FAST_RTX
:

496 
	`SCTP_INC_STATS
(
SCTP_MIB_FAST_RETRANSMITS
);

497 
	`sùp_Œª¥Üt_low”_cwnd
(
Œª¥Üt
, 
SCTP_LOWER_CWND_FAST_RTX
);

498 
q
->
ç¡_¹x
 = 1;

500 
SCTP_RTXR_PMTUD
:

501 
	`SCTP_INC_STATS
(
SCTP_MIB_PMTUD_RETRANSMITS
);

503 
SCTP_RTXR_T1_RTX
:

504 
	`SCTP_INC_STATS
(
SCTP_MIB_T1_RETRANSMITS
);

505 
Œª¥Üt
->
asoc
->
š™_»Œ›s
++;

508 
	`BUG
();

511 
	`sùp_»Œªsm™_m¬k
(
q
, 
Œª¥Üt
, 
»asÚ
);

517 ià(
»asÚ
 =ğ
SCTP_RTXR_T3_RTX
)

518 
	`sùp_g’”©e_fwdt¢
(
q
, q->
asoc
->
ù¢_ack_pošt
);

524 ià(
»asÚ
 !ğ
SCTP_RTXR_FAST_RTX
)

525 
”rÜ
 = 
	`sùp_outq_æush
(
q
, 1);

527 ià(
”rÜ
)

528 
q
->
asoc
->
ba£
.
sk
->
sk_”r
 = -
”rÜ
;

529 
	}
}

539 
	$sùp_outq_æush_¹x
(
sùp_outq
 *
q
, 
sùp_·ck‘
 *
pkt
,

540 
¹x_timeout
, *
¡¬t_tim”
)

542 
li¡_h—d
 *
lqueue
;

543 
sùp_Œª¥Üt
 *
Œª¥Üt
 = 
pkt
->transport;

544 
sùp_xm™_t
 
¡©us
;

545 
sùp_chunk
 *
chunk
, *
chunk1
;

546 
sùp_assocŸtiÚ
 *
asoc
;

547 
ç¡_¹x
;

548 
”rÜ
 = 0;

549 
tim”
 = 0;

550 
dÚe
 = 0;

552 
asoc
 = 
q
->asoc;

553 
lqueue
 = &
q
->
»Œªsm™
;

554 
ç¡_¹x
 = 
q
->fast_rtx;

579 
	`li¡_fÜ_—ch_’Œy_§ã
(
chunk
, 
chunk1
, 
lqueue
, 
Œªsm™‹d_li¡
) {

581 ià(
	`sùp_chunk_abªdÚed
(
chunk
)) {

582 
	`li¡_d–_š™
(&
chunk
->
Œªsm™‹d_li¡
);

583 
	`sùp_š£¹_li¡
(&
q
->
abªdÚed
,

584 &
chunk
->
Œªsm™‹d_li¡
);

593 ià(
chunk
->
t¢_g­_acked
) {

594 
	`li¡_d–
(&
chunk
->
Œªsm™‹d_li¡
);

595 
	`li¡_add_
(&
chunk
->
Œªsm™‹d_li¡
,

596 &
Œª¥Üt
->
Œªsm™‹d
);

603 ià(
ç¡_¹x
 && !
chunk
->
ç¡_»Œªsm™
)

606 
»do
:

608 
¡©us
 = 
	`sùp_·ck‘_­³nd_chunk
(
pkt
, 
chunk
);

610 
¡©us
) {

611 
SCTP_XMIT_PMTU_FULL
:

612 ià(!
pkt
->
has_d©a
 && !pkt->
has_cook›_echo
) {

619 
	`sùp_·ck‘_Œªsm™
(
pkt
);

620 
»do
;

624 
”rÜ
 = 
	`sùp_·ck‘_Œªsm™
(
pkt
);

630 ià(
¹x_timeout
 || 
ç¡_¹x
)

631 
dÚe
 = 1;

633 
»do
;

638 
SCTP_XMIT_RWND_FULL
:

640 
”rÜ
 = 
	`sùp_·ck‘_Œªsm™
(
pkt
);

645 
dÚe
 = 1;

648 
SCTP_XMIT_NAGLE_DELAY
:

650 
”rÜ
 = 
	`sùp_·ck‘_Œªsm™
(
pkt
);

653 
dÚe
 = 1;

660 
	`li¡_d–
(&
chunk
->
Œªsm™‹d_li¡
);

661 
	`li¡_add_
(&
chunk
->
Œªsm™‹d_li¡
,

662 &
Œª¥Üt
->
Œªsm™‹d
);

667 ià(
chunk
->
ç¡_»Œªsm™
 =ğ
SCTP_NEED_FRTX
)

668 
chunk
->
ç¡_»Œªsm™
 = 
SCTP_DONT_FRTX
;

670 
q
->
em±y
 = 0;

675 ià(!
”rÜ
 && !
tim”
)

676 
tim”
 = 1;

678 ià(
dÚe
)

687 ià(
¹x_timeout
 || 
ç¡_¹x
) {

688 
	`li¡_fÜ_—ch_’Œy
(
chunk1
, 
lqueue
, 
Œªsm™‹d_li¡
) {

689 ià(
chunk1
->
ç¡_»Œªsm™
 =ğ
SCTP_NEED_FRTX
)

690 
chunk1
->
ç¡_»Œªsm™
 = 
SCTP_DONT_FRTX
;

694 *
¡¬t_tim”
 = 
tim”
;

697 ià(
ç¡_¹x
)

698 
q
->
ç¡_¹x
 = 0;

700  
”rÜ
;

701 
	}
}

704 
	$sùp_outq_uncÜk
(
sùp_outq
 *
q
)

706 
”rÜ
 = 0;

707 ià(
q
->
cÜk
)

708 
q
->
cÜk
 = 0;

709 
”rÜ
 = 
	`sùp_outq_æush
(
q
, 0);

710  
”rÜ
;

711 
	}
}

723 
	$sùp_outq_æush
(
sùp_outq
 *
q
, 
¹x_timeout
)

725 
sùp_·ck‘
 *
·ck‘
;

726 
sùp_·ck‘
 
sšgËtÚ
;

727 
sùp_assocŸtiÚ
 *
asoc
 = 
q
->asoc;

728 
__u16
 
¥Üt
 = 
asoc
->
ba£
.
bšd_addr
.
pÜt
;

729 
__u16
 
dpÜt
 = 
asoc
->
³”
.
pÜt
;

730 
__u32
 
vg
 = 
asoc
->
³”
.
i
.
š™_g
;

731 
sùp_Œª¥Üt
 *
Œª¥Üt
 = 
NULL
;

732 
sùp_Œª¥Üt
 *
Ãw_Œª¥Üt
;

733 
sùp_chunk
 *
chunk
, *
tmp
;

734 
sùp_xm™_t
 
¡©us
;

735 
”rÜ
 = 0;

736 
¡¬t_tim”
 = 0;

737 
Úe_·ck‘
 = 0;

740 
li¡_h—d
 
Œª¥Üt_li¡
;

741 
li¡_h—d
 *
É¿n¥Üt
;

743 
	`INIT_LIST_HEAD
(&
Œª¥Üt_li¡
);

744 
·ck‘
 = 
NULL
;

756 
	`li¡_fÜ_—ch_’Œy_§ã
(
chunk
, 
tmp
, &
q
->
cÚŒŞ_chunk_li¡
, 
li¡
) {

757 
	`li¡_d–_š™
(&
chunk
->
li¡
);

760 
Ãw_Œª¥Üt
 = 
chunk
->
Œª¥Üt
;

762 ià(!
Ãw_Œª¥Üt
) {

773 ià(
Œª¥Üt
 &&

774 
	`sùp_cmp_addr_exaù
(&
chunk
->
de¡
,

775 &
Œª¥Üt
->
addr
))

776 
Ãw_Œª¥Üt
 = 
Œª¥Üt
;

778 
Ãw_Œª¥Üt
 = 
	`sùp_assoc_lookup_·ddr
(
asoc
,

779 &
chunk
->
de¡
);

784 ià(!
Ãw_Œª¥Üt
)

785 
Ãw_Œª¥Üt
 = 
asoc
->
³”
.
aùive_·th
;

786 } ià((
Ãw_Œª¥Üt
->
¡©e
 =ğ
SCTP_INACTIVE
) ||

787 (
Ãw_Œª¥Üt
->
¡©e
 =ğ
SCTP_UNCONFIRMED
) ||

788 (
Ãw_Œª¥Üt
->
¡©e
 =ğ
SCTP_PF
)) {

802 ià(
chunk
->
chunk_hdr
->
ty³
 !ğ
SCTP_CID_HEARTBEAT
 &&

803 
chunk
->
chunk_hdr
->
ty³
 !ğ
SCTP_CID_HEARTBEAT_ACK
 &&

804 
chunk
->
chunk_hdr
->
ty³
 !ğ
SCTP_CID_ASCONF_ACK
)

805 
Ãw_Œª¥Üt
 = 
asoc
->
³”
.
aùive_·th
;

811 ià(
Ãw_Œª¥Üt
 !ğ
Œª¥Üt
) {

812 
Œª¥Üt
 = 
Ãw_Œª¥Üt
;

813 ià(
	`li¡_em±y
(&
Œª¥Üt
->
£nd_»ady
)) {

814 
	`li¡_add_
(&
Œª¥Üt
->
£nd_»ady
,

815 &
Œª¥Üt_li¡
);

817 
·ck‘
 = &
Œª¥Üt
->packet;

818 
	`sùp_·ck‘_cÚfig
(
·ck‘
, 
vg
,

819 
asoc
->
³”
.
eú_ÿ·bË
);

822 
chunk
->
chunk_hdr
->
ty³
) {

829 
SCTP_CID_INIT
:

830 
SCTP_CID_INIT_ACK
:

831 
SCTP_CID_SHUTDOWN_COMPLETE
:

832 
	`sùp_·ck‘_š™
(&
sšgËtÚ
, 
Œª¥Üt
, 
¥Üt
, 
dpÜt
);

833 
	`sùp_·ck‘_cÚfig
(&
sšgËtÚ
, 
vg
, 0);

834 
	`sùp_·ck‘_­³nd_chunk
(&
sšgËtÚ
, 
chunk
);

835 
”rÜ
 = 
	`sùp_·ck‘_Œªsm™
(&
sšgËtÚ
);

836 ià(
”rÜ
 < 0)

837  
”rÜ
;

840 
SCTP_CID_ABORT
:

841 ià(
	`sùp_‹¡_T_b™
(
chunk
)) {

842 
·ck‘
->
vg
 = 
asoc
->
c
.
my_vg
;

849 
SCTP_CID_HEARTBEAT_ACK
:

850 
SCTP_CID_SHUTDOWN_ACK
:

851 
SCTP_CID_COOKIE_ACK
:

852 
SCTP_CID_COOKIE_ECHO
:

853 
SCTP_CID_ERROR
:

854 
SCTP_CID_ECN_CWR
:

855 
SCTP_CID_ASCONF_ACK
:

856 
Úe_·ck‘
 = 1;

859 
SCTP_CID_SACK
:

860 
SCTP_CID_HEARTBEAT
:

861 
SCTP_CID_SHUTDOWN
:

862 
SCTP_CID_ECN_ECNE
:

863 
SCTP_CID_ASCONF
:

864 
SCTP_CID_FWD_TSN
:

865 
¡©us
 = 
	`sùp_·ck‘_Œªsm™_chunk
(
·ck‘
, 
chunk
,

866 
Úe_·ck‘
);

867 ià(
¡©us
 !ğ
SCTP_XMIT_OK
) {

869 
	`li¡_add
(&
chunk
->
li¡
, &
q
->
cÚŒŞ_chunk_li¡
);

870 } ià(
chunk
->
chunk_hdr
->
ty³
 =ğ
SCTP_CID_FWD_TSN
) {

875 
	`sùp_Œª¥Üt_»£t_tim”s
(
Œª¥Üt
);

881 
	`BUG
();

886 
asoc
->
¡©e
) {

887 
SCTP_STATE_COOKIE_ECHOED
:

891 ià(!
·ck‘
 || !·ck‘->
has_cook›_echo
)

895 
SCTP_STATE_ESTABLISHED
:

896 
SCTP_STATE_SHUTDOWN_PENDING
:

897 
SCTP_STATE_SHUTDOWN_RECEIVED
:

907 ià(!
	`li¡_em±y
(&
q
->
»Œªsm™
)) {

908 ià(
Œª¥Üt
 =ğ
asoc
->
³”
.
»Œª_·th
)

909 
»Œª
;

913 
Œª¥Üt
 = 
asoc
->
³”
.
»Œª_·th
;

915 ià(
	`li¡_em±y
(&
Œª¥Üt
->
£nd_»ady
)) {

916 
	`li¡_add_
(&
Œª¥Üt
->
£nd_»ady
,

917 &
Œª¥Üt_li¡
);

920 
·ck‘
 = &
Œª¥Üt
->packet;

921 
	`sùp_·ck‘_cÚfig
(
·ck‘
, 
vg
,

922 
asoc
->
³”
.
eú_ÿ·bË
);

923 
»Œª
:

924 
”rÜ
 = 
	`sùp_outq_æush_¹x
(
q
, 
·ck‘
,

925 
¹x_timeout
, &
¡¬t_tim”
);

927 ià(
¡¬t_tim”
)

928 
	`sùp_Œª¥Üt_»£t_tim”s
(
Œª¥Üt
);

933 ià(
·ck‘
->
has_cook›_echo
)

934 
sùp_æush_out
;

939 ià(!
	`li¡_em±y
(&
q
->
»Œªsm™
))

940 
sùp_æush_out
;

948 ià(
Œª¥Üt
)

949 
	`sùp_Œª¥Üt_bur¡_lim™ed
(
Œª¥Üt
);

952 (
chunk
 = 
	`sùp_outq_dequeue_d©a
(
q
)è!ğ
NULL
) {

956 ià(
chunk
->
sšfo
.
sšfo_¡»am
 >=

957 
asoc
->
c
.
sš™_num_o¡»ams
) {

960 
	`sùp_chunk_ç
(
chunk
, 
SCTP_ERROR_INV_STRM
);

961 
	`sùp_chunk_ä“
(
chunk
);

966 ià(
	`sùp_chunk_abªdÚed
(
chunk
)) {

967 
	`sùp_chunk_ç
(
chunk
, 0);

968 
	`sùp_chunk_ä“
(
chunk
);

975 
Ãw_Œª¥Üt
 = 
chunk
->
Œª¥Üt
;

976 ià(!
Ãw_Œª¥Üt
 ||

977 ((
Ãw_Œª¥Üt
->
¡©e
 =ğ
SCTP_INACTIVE
) ||

978 (
Ãw_Œª¥Üt
->
¡©e
 =ğ
SCTP_UNCONFIRMED
) ||

979 (
Ãw_Œª¥Üt
->
¡©e
 =ğ
SCTP_PF
)))

980 
Ãw_Œª¥Üt
 = 
asoc
->
³”
.
aùive_·th
;

983 ià(
Ãw_Œª¥Üt
 !ğ
Œª¥Üt
) {

984 
Œª¥Üt
 = 
Ãw_Œª¥Üt
;

989 ià(
	`li¡_em±y
(&
Œª¥Üt
->
£nd_»ady
)) {

990 
	`li¡_add_
(&
Œª¥Üt
->
£nd_»ady
,

991 &
Œª¥Üt_li¡
);

994 
·ck‘
 = &
Œª¥Üt
->packet;

995 
	`sùp_·ck‘_cÚfig
(
·ck‘
, 
vg
,

996 
asoc
->
³”
.
eú_ÿ·bË
);

1000 
	`sùp_Œª¥Üt_bur¡_lim™ed
(
Œª¥Üt
);

1003 
	`SCTP_DEBUG_PRINTK
("sctp_outq_flush(%p, %p[%s]), ",

1004 
q
, 
chunk
,

1005 
chunk
 && chunk->
chunk_hdr
 ?

1006 
	`sùp_úame
(
	`SCTP_ST_CHUNK
(

1007 
chunk
->
chunk_hdr
->
ty³
))

1010 
	`SCTP_DEBUG_PRINTK
("TX TSN 0x%x skb->head "

1012 
	`Áohl
(
chunk
->
subh
.
d©a_hdr
->
t¢
),

1013 
chunk
->
skb
 ?chunk->skb->
h—d
 : 
NULL
,

1014 
chunk
->
skb
 ?

1015 
	`©omic_»ad
(&
chunk
->
skb
->
u£rs
) : -1);

1018 
¡©us
 = 
	`sùp_·ck‘_Œªsm™_chunk
(
·ck‘
, 
chunk
, 0);

1020 
¡©us
) {

1021 
SCTP_XMIT_PMTU_FULL
:

1022 
SCTP_XMIT_RWND_FULL
:

1023 
SCTP_XMIT_NAGLE_DELAY
:

1027 
	`SCTP_DEBUG_PRINTK
("sctp_outq_flush: could "

1029 
	`Áohl
(
chunk
->
subh
.
d©a_hdr
->
t¢
),

1030 
¡©us
);

1031 
	`sùp_outq_h—d_d©a
(
q
, 
chunk
);

1032 
sùp_æush_out
;

1035 
SCTP_XMIT_OK
:

1039 
	`BUG
();

1052 
	`li¡_add_
(&
chunk
->
Œªsm™‹d_li¡
,

1053 &
Œª¥Üt
->
Œªsm™‹d
);

1055 
	`sùp_Œª¥Üt_»£t_tim”s
(
Œª¥Üt
);

1057 
q
->
em±y
 = 0;

1062 ià(
·ck‘
->
has_cook›_echo
)

1063 
sùp_æush_out
;

1072 
sùp_æush_out
:

1081 (
É¿n¥Üt
 = 
	`sùp_li¡_dequeue
(&
Œª¥Üt_li¡
)è!ğ
NULL
 ) {

1082 
sùp_Œª¥Üt
 *
t
 = 
	`li¡_’Œy
(
É¿n¥Üt
,

1083 
sùp_Œª¥Üt
,

1084 
£nd_»ady
);

1085 
·ck‘
 = &
t
->packet;

1086 ià(!
	`sùp_·ck‘_em±y
(
·ck‘
))

1087 
”rÜ
 = 
	`sùp_·ck‘_Œªsm™
(
·ck‘
);

1090 
	`sùp_Œª¥Üt_bur¡_»£t
(
t
);

1093  
”rÜ
;

1094 
	}
}

1097 
	$sùp_§ck_upd©e_uÇck_d©a
(
sùp_assocŸtiÚ
 *
assoc
,

1098 
sùp_§ckhdr
 *
§ck
)

1100 
sùp_§ck_v¬ŸbË_t
 *
äags
;

1101 
__u16
 
uÇck_d©a
;

1102 
i
;

1104 
uÇck_d©a
 = 
assoc
->
Ãxt_t¢
 -‡ssoc->
ù¢_ack_pošt
 - 1;

1106 
äags
 = 
§ck
->
v¬ŸbË
;

1107 
i
 = 0; i < 
	`Áohs
(
§ck
->
num_g­_ack_blocks
); i++) {

1108 
uÇck_d©a
 -ğ((
	`Áohs
(
äags
[
i
].
gab
.
’d
) -

1109 
	`Áohs
(
äags
[
i
].
gab
.
¡¬t
) + 1));

1112 
assoc
->
uÇck_d©a
 = unack_data;

1113 
	}
}

1120 
	$sùp_outq_§ck
(
sùp_outq
 *
q
, 
sùp_§ckhdr
 *
§ck
)

1122 
sùp_assocŸtiÚ
 *
asoc
 = 
q
->asoc;

1123 
sùp_Œª¥Üt
 *
Œª¥Üt
;

1124 
sùp_chunk
 *
tchunk
 = 
NULL
;

1125 
li¡_h—d
 *
lchunk
, *
Œª¥Üt_li¡
, *
‹mp
;

1126 
sùp_§ck_v¬ŸbË_t
 *
äags
 = 
§ck
->
v¬ŸbË
;

1127 
__u32
 
§ck_ù¢
, 
ù¢
, 
t¢
;

1128 
__u32
 
highe¡_t¢
, 
highe¡_Ãw_t¢
;

1129 
__u32
 
§ck_a_rwnd
;

1130 
out¡ªdšg
;

1131 
sùp_Œª¥Üt
 *
´im¬y
 = 
asoc
->
³”
.
´im¬y_·th
;

1132 
couÁ_of_Ãwacks
 = 0;

1133 
g­_ack_blocks
;

1134 
u8
 
accum_moved
 = 0;

1137 
Œª¥Üt_li¡
 = &
asoc
->
³”
.
Œª¥Üt_addr_li¡
;

1139 
§ck_ù¢
 = 
	`Áohl
(
§ck
->
cum_t¢_ack
);

1140 
g­_ack_blocks
 = 
	`Áohs
(
§ck
->
num_g­_ack_blocks
);

1159 ià(
´im¬y
->
ÿcc
.
chªgeov”_aùive
) {

1160 
u8
 
ş—r_cyşšg
 = 0;

1162 ià(
	`TSN_Ée
(
´im¬y
->
ÿcc
.
Ãxt_t¢_©_chªge
, 
§ck_ù¢
)) {

1163 
´im¬y
->
ÿcc
.
chªgeov”_aùive
 = 0;

1164 
ş—r_cyşšg
 = 1;

1167 ià(
ş—r_cyşšg
 || 
g­_ack_blocks
) {

1168 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, 
Œª¥Üt_li¡
,

1169 
Œª¥Üts
) {

1170 ià(
ş—r_cyşšg
)

1171 
Œª¥Üt
->
ÿcc
.
cyşšg_chªgeov”
 = 0;

1172 ià(
g­_ack_blocks
)

1173 
Œª¥Üt
->
ÿcc
.
ÿcc_§w_Ãwack
 = 0;

1179 
highe¡_t¢
 = 
§ck_ù¢
;

1180 ià(
g­_ack_blocks
)

1181 
highe¡_t¢
 +ğ
	`Áohs
(
äags
[
g­_ack_blocks
 - 1].
gab
.
’d
);

1183 ià(
	`TSN_É
(
asoc
->
highe¡_§cked
, 
highe¡_t¢
))

1184 
asoc
->
highe¡_§cked
 = 
highe¡_t¢
;

1186 
highe¡_Ãw_t¢
 = 
§ck_ù¢
;

1191 
	`sùp_check_Œªsm™‹d
(
q
, &q->
»Œªsm™
, 
NULL
, 
§ck
, &
highe¡_Ãw_t¢
);

1198 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, 
Œª¥Üt_li¡
, 
Œª¥Üts
) {

1199 
	`sùp_check_Œªsm™‹d
(
q
, &
Œª¥Üt
->
Œªsm™‹d
,

1200 
Œª¥Üt
, 
§ck
, &
highe¡_Ãw_t¢
);

1206 ià(
Œª¥Üt
->
ÿcc
.
ÿcc_§w_Ãwack
)

1207 
couÁ_of_Ãwacks
 ++;

1211 ià(
	`TSN_É
(
asoc
->
ù¢_ack_pošt
, 
§ck_ù¢
)) {

1212 
asoc
->
ù¢_ack_pošt
 = 
§ck_ù¢
;

1213 
accum_moved
 = 1;

1216 ià(
g­_ack_blocks
) {

1218 ià(
asoc
->
ç¡_»cov”y
 && 
accum_moved
)

1219 
highe¡_Ãw_t¢
 = 
highe¡_t¢
;

1221 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, 
Œª¥Üt_li¡
, 
Œª¥Üts
)

1222 
	`sùp_m¬k_missšg
(
q
, &
Œª¥Üt
->
Œªsm™‹d
,ransport,

1223 
highe¡_Ãw_t¢
, 
couÁ_of_Ãwacks
);

1227 
	`sùp_§ck_upd©e_uÇck_d©a
(
asoc
, 
§ck
);

1229 
ù¢
 = 
asoc
->
ù¢_ack_pošt
;

1232 
	`li¡_fÜ_—ch_§ã
(
lchunk
, 
‹mp
, &
q
->
§cked
) {

1233 
tchunk
 = 
	`li¡_’Œy
(
lchunk
, 
sùp_chunk
,

1234 
Œªsm™‹d_li¡
);

1235 
t¢
 = 
	`Áohl
(
tchunk
->
subh
.
d©a_hdr
->tsn);

1236 ià(
	`TSN_Ée
(
t¢
, 
ù¢
)) {

1237 
	`li¡_d–_š™
(&
tchunk
->
Œªsm™‹d_li¡
);

1238 
	`sùp_chunk_ä“
(
tchunk
);

1247 
§ck_a_rwnd
 = 
	`Áohl
(
§ck
->
a_rwnd
);

1248 
out¡ªdšg
 = 
q
->
out¡ªdšg_by‹s
;

1250 ià(
out¡ªdšg
 < 
§ck_a_rwnd
)

1251 
§ck_a_rwnd
 -ğ
out¡ªdšg
;

1253 
§ck_a_rwnd
 = 0;

1255 
asoc
->
³”
.
rwnd
 = 
§ck_a_rwnd
;

1257 
	`sùp_g’”©e_fwdt¢
(
q
, 
§ck_ù¢
);

1259 
	`SCTP_DEBUG_PRINTK
("%s: sack Cumulative TSN Ack is 0x%x.\n",

1260 
__func__
, 
§ck_ù¢
);

1261 
	`SCTP_DEBUG_PRINTK
("%s: Cumulative TSN Ack of‡ssociation, "

1263 
__func__
, 
asoc
, 
ù¢
,‡soc->
adv_³”_ack_pošt
);

1268 
q
->
em±y
 = (
	`li¡_em±y
(&q->
out_chunk_li¡
) &&

1269 
	`li¡_em±y
(&
q
->
»Œªsm™
));

1270 ià(!
q
->
em±y
)

1271 
fšish
;

1273 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, 
Œª¥Üt_li¡
, 
Œª¥Üts
) {

1274 
q
->
em±y
 = q->em±y && 
	`li¡_em±y
(&
Œª¥Üt
->
Œªsm™‹d
);

1275 ià(!
q
->
em±y
)

1276 
fšish
;

1279 
	`SCTP_DEBUG_PRINTK
("sack queue isƒmpty.\n");

1280 
fšish
:

1281  
q
->
em±y
;

1282 
	}
}

1285 
	$sùp_outq_is_em±y
(cÚ¡ 
sùp_outq
 *
q
)

1287  
q
->
em±y
;

1288 
	}
}

1304 
	$sùp_check_Œªsm™‹d
(
sùp_outq
 *
q
,

1305 
li¡_h—d
 *
Œªsm™‹d_queue
,

1306 
sùp_Œª¥Üt
 *
Œª¥Üt
,

1307 
sùp_§ckhdr
 *
§ck
,

1308 
__u32
 *
highe¡_Ãw_t¢_š_§ck
)

1310 
li¡_h—d
 *
lchunk
;

1311 
sùp_chunk
 *
tchunk
;

1312 
li¡_h—d
 
i¡
;

1313 
__u32
 
t¢
;

1314 
__u32
 
§ck_ù¢
;

1315 
__u32
 
¹t
;

1316 
__u8
 
»¡¬t_tim”
 = 0;

1317 
by‹s_acked
 = 0;

1318 
mig¿‹_by‹s
 = 0;

1322 #ià
SCTP_DEBUG


1323 
__u32
 
dbg_ack_t¢
 = 0;

1324 
__u32
 
dbg_Ï¡_ack_t¢
 = 0;

1325 
__u32
 
dbg_k•t_t¢
 = 0;

1326 
__u32
 
dbg_Ï¡_k•t_t¢
 = 0;

1332 
dbg_´t_¡©e
 = -1;

1335 
§ck_ù¢
 = 
	`Áohl
(
§ck
->
cum_t¢_ack
);

1337 
	`INIT_LIST_HEAD
(&
i¡
);

1340 
NULL
 !ğ(
lchunk
 = 
	`sùp_li¡_dequeue
(
Œªsm™‹d_queue
))) {

1341 
tchunk
 = 
	`li¡_’Œy
(
lchunk
, 
sùp_chunk
,

1342 
Œªsm™‹d_li¡
);

1344 ià(
	`sùp_chunk_abªdÚed
(
tchunk
)) {

1346 
	`sùp_š£¹_li¡
(&
q
->
abªdÚed
, 
lchunk
);

1351 ià(!
tchunk
->
t¢_g­_acked
) {

1352 ià(
tchunk
->
Œª¥Üt
)

1353 
tchunk
->
Œª¥Üt
->
æight_size
 -=

1354 
	`sùp_d©a_size
(
tchunk
);

1355 
q
->
out¡ªdšg_by‹s
 -ğ
	`sùp_d©a_size
(
tchunk
);

1360 
t¢
 = 
	`Áohl
(
tchunk
->
subh
.
d©a_hdr
->tsn);

1361 ià(
	`sùp_acked
(
§ck
, 
t¢
)) {

1367 ià(
Œª¥Üt
) {

1379 ià(!
tchunk
->
t¢_g­_acked
 &&

1380 
tchunk
->
¹t_š_´og»ss
) {

1381 
tchunk
->
¹t_š_´og»ss
 = 0;

1382 
¹t
 = 
jiff›s
 - 
tchunk
->
£Á_©
;

1383 
	`sùp_Œª¥Üt_upd©e_¹o
(
Œª¥Üt
,

1384 
¹t
);

1394 ià(!
tchunk
->
t¢_g­_acked
) {

1395 
tchunk
->
t¢_g­_acked
 = 1;

1396 *
highe¡_Ãw_t¢_š_§ck
 = 
t¢
;

1397 
by‹s_acked
 +ğ
	`sùp_d©a_size
(
tchunk
);

1398 ià(!
tchunk
->
Œª¥Üt
)

1399 
mig¿‹_by‹s
 +ğ
	`sùp_d©a_size
(
tchunk
);

1402 ià(
	`TSN_Ée
(
t¢
, 
§ck_ù¢
)) {

1412 
»¡¬t_tim”
 = 1;

1414 ià(!
tchunk
->
t¢_g­_acked
) {

1428 ià(
Œª¥Üt
 &&

1429 
§ck
->
num_g­_ack_blocks
 &&

1430 
q
->
asoc
->
³”
.
´im¬y_·th
->
ÿcc
.

1431 
chªgeov”_aùive
)

1432 
Œª¥Üt
->
ÿcc
.
ÿcc_§w_Ãwack


1436 
	`li¡_add_
(&
tchunk
->
Œªsm™‹d_li¡
,

1437 &
q
->
§cked
);

1454 
	`li¡_add_
(
lchunk
, &
i¡
);

1457 #ià
SCTP_DEBUG


1458 
dbg_´t_¡©e
) {

1460 ià(
dbg_Ï¡_ack_t¢
 + 1 =ğ
t¢
) {

1467 ià(
dbg_Ï¡_ack_t¢
 !ğ
dbg_ack_t¢
) {

1471 
	`SCTP_DEBUG_PRINTK
("-%08x",

1472 
dbg_Ï¡_ack_t¢
);

1476 
	`SCTP_DEBUG_PRINTK
(",%08x", 
t¢
);

1477 
dbg_ack_t¢
 = 
t¢
;

1481 ià(
dbg_Ï¡_k•t_t¢
 !ğ
dbg_k•t_t¢
) {

1483 
	`SCTP_DEBUG_PRINTK
("-%08x",

1484 
dbg_Ï¡_k•t_t¢
);

1487 
	`SCTP_DEBUG_PRINTK
("\n");

1493 
	`SCTP_DEBUG_PRINTK
("ACKed: %08x", 
t¢
);

1494 
dbg_´t_¡©e
 = 0;

1495 
dbg_ack_t¢
 = 
t¢
;

1498 
dbg_Ï¡_ack_t¢
 = 
t¢
;

1502 ià(
tchunk
->
t¢_g­_acked
) {

1503 
	`SCTP_DEBUG_PRINTK
("%s: Receiver„eneged on "

1505 
__func__
,

1506 
t¢
);

1507 
tchunk
->
t¢_g­_acked
 = 0;

1509 ià(
tchunk
->
Œª¥Üt
)

1510 
by‹s_acked
 -ğ
	`sùp_d©a_size
(
tchunk
);

1521 
»¡¬t_tim”
 = 1;

1524 
	`li¡_add_
(
lchunk
, &
i¡
);

1526 #ià
SCTP_DEBUG


1528 
dbg_´t_¡©e
) {

1530 ià(
dbg_Ï¡_k•t_t¢
 + 1 =ğ
t¢
)

1533 ià(
dbg_Ï¡_k•t_t¢
 !ğ
dbg_k•t_t¢
)

1534 
	`SCTP_DEBUG_PRINTK
("-%08x",

1535 
dbg_Ï¡_k•t_t¢
);

1537 
	`SCTP_DEBUG_PRINTK
(",%08x", 
t¢
);

1538 
dbg_k•t_t¢
 = 
t¢
;

1542 ià(
dbg_Ï¡_ack_t¢
 !ğ
dbg_ack_t¢
)

1543 
	`SCTP_DEBUG_PRINTK
("-%08x",

1544 
dbg_Ï¡_ack_t¢
);

1545 
	`SCTP_DEBUG_PRINTK
("\n");

1549 
	`SCTP_DEBUG_PRINTK
("KEPT: %08x",
t¢
);

1550 
dbg_´t_¡©e
 = 1;

1551 
dbg_k•t_t¢
 = 
t¢
;

1554 
dbg_Ï¡_k•t_t¢
 = 
t¢
;

1559 #ià
SCTP_DEBUG


1561 
dbg_´t_¡©e
) {

1563 ià(
dbg_Ï¡_ack_t¢
 !ğ
dbg_ack_t¢
) {

1564 
	`SCTP_DEBUG_PRINTK
("-%08x\n", 
dbg_Ï¡_ack_t¢
);

1566 
	`SCTP_DEBUG_PRINTK
("\n");

1571 ià(
dbg_Ï¡_k•t_t¢
 !ğ
dbg_k•t_t¢
) {

1572 
	`SCTP_DEBUG_PRINTK
("-%08x\n", 
dbg_Ï¡_k•t_t¢
);

1574 
	`SCTP_DEBUG_PRINTK
("\n");

1578 ià(
Œª¥Üt
) {

1579 ià(
by‹s_acked
) {

1580 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

1588 
by‹s_acked
 -ğ
mig¿‹_by‹s
;

1597 
Œª¥Üt
->
”rÜ_couÁ
 = 0;

1598 
Œª¥Üt
->
asoc
->
ov”®l_”rÜ_couÁ
 = 0;

1606 ià(
asoc
->
¡©e
 =ğ
SCTP_STATE_SHUTDOWN_PENDING
 &&

1607 
	`d–_tim”
(&
asoc
->
tim”s


1608 [
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
]))

1609 
	`sùp_assocŸtiÚ_put
(
asoc
);

1614 ià((
Œª¥Üt
->
¡©e
 =ğ
SCTP_INACTIVE
) ||

1615 (
Œª¥Üt
->
¡©e
 =ğ
SCTP_UNCONFIRMED
)) {

1616 
	`sùp_assoc_cÚŒŞ_Œª¥Üt
(

1617 
Œª¥Üt
->
asoc
,

1618 
Œª¥Üt
,

1619 
SCTP_TRANSPORT_UP
,

1620 
SCTP_RECEIVED_SACK
);

1623 
	`sùp_Œª¥Üt_¿i£_cwnd
(
Œª¥Üt
, 
§ck_ù¢
,

1624 
by‹s_acked
);

1626 
Œª¥Üt
->
æight_size
 -ğ
by‹s_acked
;

1627 ià(
Œª¥Üt
->
æight_size
 == 0)

1628 
Œª¥Üt
->
·¹Ÿl_by‹s_acked
 = 0;

1629 
q
->
out¡ªdšg_by‹s
 -ğ
by‹s_acked
 + 
mig¿‹_by‹s
;

1645 ià(!
q
->
asoc
->
³”
.
rwnd
 &&

1646 !
	`li¡_em±y
(&
i¡
) &&

1647 (
§ck_ù¢
+2 =ğ
q
->
asoc
->
Ãxt_t¢
) &&

1648 
q
->
asoc
->
¡©e
 < 
SCTP_STATE_SHUTDOWN_PENDING
) {

1649 
	`SCTP_DEBUG_PRINTK
("%s: SACK„eceived for zero "

1651 
__func__
, 
§ck_ù¢
);

1652 
q
->
asoc
->
ov”®l_”rÜ_couÁ
 = 0;

1653 
Œª¥Üt
->
”rÜ_couÁ
 = 0;

1663 ià(!
Œª¥Üt
->
æight_size
) {

1664 ià(
	`tim”_³ndšg
(&
Œª¥Üt
->
T3_¹x_tim”
) &&

1665 
	`d–_tim”
(&
Œª¥Üt
->
T3_¹x_tim”
)) {

1666 
	`sùp_Œª¥Üt_put
(
Œª¥Üt
);

1668 } ià(
»¡¬t_tim”
) {

1669 ià(!
	`mod_tim”
(&
Œª¥Üt
->
T3_¹x_tim”
,

1670 
jiff›s
 + 
Œª¥Üt
->
¹o
))

1671 
	`sùp_Œª¥Üt_hŞd
(
Œª¥Üt
);

1675 
	`li¡_¥liû
(&
i¡
, 
Œªsm™‹d_queue
);

1676 
	}
}

1679 
	$sùp_m¬k_missšg
(
sùp_outq
 *
q
,

1680 
li¡_h—d
 *
Œªsm™‹d_queue
,

1681 
sùp_Œª¥Üt
 *
Œª¥Üt
,

1682 
__u32
 
highe¡_Ãw_t¢_š_§ck
,

1683 
couÁ_of_Ãwacks
)

1685 
sùp_chunk
 *
chunk
;

1686 
__u32
 
t¢
;

1687 
do_ç¡_»Œªsm™
 = 0;

1688 
sùp_assocŸtiÚ
 *
asoc
 = 
q
->asoc;

1689 
sùp_Œª¥Üt
 *
´im¬y
 = 
asoc
->
³”
.
´im¬y_·th
;

1691 
	`li¡_fÜ_—ch_’Œy
(
chunk
, 
Œªsm™‹d_queue
, 
Œªsm™‹d_li¡
) {

1693 
t¢
 = 
	`Áohl
(
chunk
->
subh
.
d©a_hdr
->tsn);

1702 ià(
chunk
->
ç¡_»Œªsm™
 =ğ
SCTP_CAN_FRTX
 &&

1703 !
chunk
->
t¢_g­_acked
 &&

1704 
	`TSN_É
(
t¢
, 
highe¡_Ãw_t¢_š_§ck
)) {

1709 ià(!
Œª¥Üt
 || !
	`sùp_ÿcc_sk
(
´im¬y
,

1710 
chunk
->
Œª¥Üt
,

1711 
couÁ_of_Ãwacks
, 
t¢
)) {

1712 
chunk
->
t¢_missšg_»pÜt
++;

1714 
	`SCTP_DEBUG_PRINTK
(

1716 
__func__
, 
t¢
,

1717 
chunk
->
t¢_missšg_»pÜt
);

1727 ià(
chunk
->
t¢_missšg_»pÜt
 >= 3) {

1728 
chunk
->
ç¡_»Œªsm™
 = 
SCTP_NEED_FRTX
;

1729 
do_ç¡_»Œªsm™
 = 1;

1733 ià(
Œª¥Üt
) {

1734 ià(
do_ç¡_»Œªsm™
)

1735 
	`sùp_»Œªsm™
(
q
, 
Œª¥Üt
, 
SCTP_RTXR_FAST_RTX
);

1737 
	`SCTP_DEBUG_PRINTK
("%s:ransport: %p, cwnd: %d, "

1739 
__func__
, 
Œª¥Üt
,¿n¥Üt->
cwnd
,

1740 
Œª¥Üt
->
s¡h»sh
,¿n¥Üt->
æight_size
,

1741 
Œª¥Üt
->
·¹Ÿl_by‹s_acked
);

1743 
	}
}

1746 
	$sùp_acked
(
sùp_§ckhdr
 *
§ck
, 
__u32
 
t¢
)

1748 
i
;

1749 
sùp_§ck_v¬ŸbË_t
 *
äags
;

1750 
__u16
 
g­
;

1751 
__u32
 
ù¢
 = 
	`Áohl
(
§ck
->
cum_t¢_ack
);

1753 ià(
	`TSN_Ée
(
t¢
, 
ù¢
))

1754 
·ss
;

1768 
äags
 = 
§ck
->
v¬ŸbË
;

1769 
g­
 = 
t¢
 - 
ù¢
;

1770 
i
 = 0; i < 
	`Áohs
(
§ck
->
num_g­_ack_blocks
); ++i) {

1771 ià(
	`TSN_Ée
(
	`Áohs
(
äags
[
i
].
gab
.
¡¬t
), 
g­
) &&

1772 
	`TSN_Ée
(
g­
, 
	`Áohs
(
äags
[
i
].
gab
.
’d
)))

1773 
·ss
;

1777 
·ss
:

1779 
	}
}

1781 
šlše
 
	$sùp_g‘_sk_pos
(
sùp_fwdt¢_sk
 *
skli¡
,

1782 
nsks
, 
__be16
 
¡»am
)

1784 
i
;

1786 
i
 = 0; i < 
nsks
; i++) {

1787 ià(
skli¡
[
i
].
¡»am
 == stream)

1788  
i
;

1790  
i
;

1791 
	}
}

1794 
	$sùp_g’”©e_fwdt¢
(
sùp_outq
 *
q
, 
__u32
 
ù¢
)

1796 
sùp_assocŸtiÚ
 *
asoc
 = 
q
->asoc;

1797 
sùp_chunk
 *
á¢_chunk
 = 
NULL
;

1798 
sùp_fwdt¢_sk
 
á¢_sk_¬r
[10];

1799 
nsks
 = 0;

1800 
sk_pos
 = 0;

1801 
__u32
 
t¢
;

1802 
sùp_chunk
 *
chunk
;

1803 
li¡_h—d
 *
lchunk
, *
‹mp
;

1805 ià(!
asoc
->
³”
.
´sùp_ÿ·bË
)

1814 ià(
	`TSN_É
(
asoc
->
adv_³”_ack_pošt
, 
ù¢
))

1815 
asoc
->
adv_³”_ack_pošt
 = 
ù¢
;

1838 
	`li¡_fÜ_—ch_§ã
(
lchunk
, 
‹mp
, &
q
->
abªdÚed
) {

1839 
chunk
 = 
	`li¡_’Œy
(
lchunk
, 
sùp_chunk
,

1840 
Œªsm™‹d_li¡
);

1841 
t¢
 = 
	`Áohl
(
chunk
->
subh
.
d©a_hdr
->tsn);

1846 ià(
	`TSN_Ée
(
t¢
, 
ù¢
)) {

1847 
	`li¡_d–_š™
(
lchunk
);

1848 
	`sùp_chunk_ä“
(
chunk
);

1850 ià(
	`TSN_Ée
(
t¢
, 
asoc
->
adv_³”_ack_pošt
+1)) {

1851 
asoc
->
adv_³”_ack_pošt
 = 
t¢
;

1852 ià(
chunk
->
chunk_hdr
->
æags
 &

1853 
SCTP_DATA_UNORDERED
)

1855 
sk_pos
 = 
	`sùp_g‘_sk_pos
(&
á¢_sk_¬r
[0],

1856 
nsks
,

1857 
chunk
->
subh
.
d©a_hdr
->
¡»am
);

1858 
á¢_sk_¬r
[
sk_pos
].
¡»am
 =

1859 
chunk
->
subh
.
d©a_hdr
->
¡»am
;

1860 
á¢_sk_¬r
[
sk_pos
].
s¢
 =

1861 
chunk
->
subh
.
d©a_hdr
->
s¢
;

1862 ià(
sk_pos
 =ğ
nsks
)

1863 
nsks
++;

1864 ià(
nsks
 == 10)

1889 ià(
asoc
->
adv_³”_ack_pošt
 > 
ù¢
)

1890 
á¢_chunk
 = 
	`sùp_make_fwdt¢
(
asoc
,‡soc->
adv_³”_ack_pošt
,

1891 
nsks
, &
á¢_sk_¬r
[0]);

1893 ià(
á¢_chunk
) {

1894 
	`li¡_add_
(&
á¢_chunk
->
li¡
, &
q
->
cÚŒŞ_chunk_li¡
);

1895 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

1897 
	}
}

	@primitive.c

48 
	~<lšux/ty³s.h
>

49 
	~<lšux/li¡.h
>

50 
	~<lšux/sock‘.h
>

51 
	~<lšux/.h
>

52 
	~<lšux/time.h
>

53 
	~<Ãt/sock.h
>

54 
	~<Ãt/sùp/sùp.h
>

55 
	~<Ãt/sùp/sm.h
>

57 
	#DECLARE_PRIMITIVE
(
Çme
) \

59 
sùp_´im™ive_
 ## 
	`Çme
(
sùp_assocŸtiÚ
 *
asoc
, \

60 *
¬g
) { \

61 
”rÜ
 = 0; \

62 
sùp_ev’t_t
 
ev’t_ty³
; 
sùp_subty³_t
 
subty³
; \

63 
sùp_¡©e_t
 
¡©e
; \

64 
sùp_’dpošt
 *
•
; \

66 
ev’t_ty³
 = 
SCTP_EVENT_T_PRIMITIVE
; \

67 
subty³
 = 
	`SCTP_ST_PRIMITIVE
(
SCTP_PRIMITIVE_
 ## 
Çme
); \

68 
¡©e
 = 
asoc
 ?‡soc->¡©: 
SCTP_STATE_CLOSED
; \

69 
•
 = 
asoc
 ?‡soc->• : 
NULL
; \

71 
”rÜ
 = 
	`sùp_do_sm
(
ev’t_ty³
, 
subty³
, 
¡©e
, 
•
, 
asoc
, \

72 
¬g
, 
GFP_KERNEL
); \

73  
”rÜ
; \

74 }

	)

94 
	$DECLARE_PRIMITIVE
(
ASSOCIATE
)

110 
	`DECLARE_PRIMITIVE
(
SHUTDOWN
);

125 
	`DECLARE_PRIMITIVE
(
ABORT
);

184 
	`DECLARE_PRIMITIVE
(
SEND
);

206 
	`DECLARE_PRIMITIVE
(
REQUESTHEARTBEAT
);

219 
	`DECLARE_PRIMITIVE
(
ASCONF
);

	@probe.c

25 
	#´_fmt
(
fmt
è
KBUILD_MODNAME
 ": " 
	)
fmt

27 
	~<lšux/k”Ãl.h
>

28 
	~<lšux/k´obes.h
>

29 
	~<lšux/sock‘.h
>

30 
	~<lšux/sùp.h
>

31 
	~<lšux/´oc_fs.h
>

32 
	~<lšux/vm®loc.h
>

33 
	~<lšux/moduË.h
>

34 
	~<lšux/kfifo.h
>

35 
	~<lšux/time.h
>

36 
	~<Ãt/Ãt_Çme¥aû.h
>

38 
	~<Ãt/sùp/sùp.h
>

39 
	~<Ãt/sùp/sm.h
>

41 
MODULE_AUTHOR
("Wei Yongjun <yjwei@cn.fujitsu.com>");

42 
MODULE_DESCRIPTION
("SCTP snooper");

43 
MODULE_LICENSE
("GPL");

45 
pÜt
 
	g__»ad_mo¡ly
 = 0;

46 
MODULE_PARM_DESC
(
pÜt
, "Porto match (0=all)");

47 
moduË_·¿m
(
pÜt
, , 0);

49 
bufsize
 
	g__»ad_mo¡ly
 = 64 * 1024;

50 
MODULE_PARM_DESC
(
bufsize
, "Log buffer size (default 64k)");

51 
moduË_·¿m
(
bufsize
, , 0);

53 
fuÎ
 
	g__»ad_mo¡ly
 = 1;

54 
MODULE_PARM_DESC
(
fuÎ
, "Full†og (1=every‡ck…acket„eceived, 0=only cwnd changes)");

55 
moduË_·¿m
(
fuÎ
, , 0);

57 cÚ¡ 
	g´oúame
[] = "sctpprobe";

60 
kfifo
 
	mfifo
;

61 
¥šlock_t
 
	mlock
;

62 
wa™_queue_h—d_t
 
	mwa™
;

63 
time¥ec
 
	mt¡¬t
;

64 } 
	gsùpw
;

66 
	$´š
(cÚ¡ *
fmt
, ...)

68 
va_li¡
 
¬gs
;

69 
Ën
;

70 
tbuf
[256];

72 
	`va_¡¬t
(
¬gs
, 
fmt
);

73 
Ën
 = 
	`vsú´štf
(
tbuf
, Ñbuf), 
fmt
, 
¬gs
);

74 
	`va_’d
(
¬gs
);

76 
	`kfifo_š_locked
(&
sùpw
.
fifo
, 
tbuf
, 
Ën
, &sùpw.
lock
);

77 
	`wake_up
(&
sùpw
.
wa™
);

78 
	}
}

80 
	$sùµrobe_İ’
(
šode
 *šode, 
fe
 *file)

82 
	`kfifo_»£t
(&
sùpw
.
fifo
);

83 
	`g‘n¡imeofday
(&
sùpw
.
t¡¬t
);

86 
	}
}

88 
ssize_t
 
	$sùµrobe_»ad
(
fe
 *fe, 
__u£r
 *
buf
,

89 
size_t
 
Ën
, 
loff_t
 *
µos
)

91 
”rÜ
 = 0, 
út
 = 0;

92 *
tbuf
;

94 ià(!
buf
)

95  -
EINVAL
;

97 ià(
Ën
 == 0)

100 
tbuf
 = 
	`vm®loc
(
Ën
);

101 ià(!
tbuf
)

102  -
ENOMEM
;

104 
”rÜ
 = 
	`wa™_ev’t_š‹¼u±ibË
(
sùpw
.
wa™
,

105 
	`kfifo_Ën
(&
sùpw
.
fifo
) != 0);

106 ià(
”rÜ
)

107 
out_ä“
;

109 
út
 = 
	`kfifo_out_locked
(&
sùpw
.
fifo
, 
tbuf
, 
Ën
, &sùpw.
lock
);

110 
”rÜ
 = 
	`cİy_to_u£r
(
buf
, 
tbuf
, 
út
è? -
EFAULT
 : 0;

112 
out_ä“
:

113 
	`vä“
(
tbuf
);

115  
”rÜ
 ?ƒ¼Ü : 
út
;

116 
	}
}

118 cÚ¡ 
fe_İ”©iÚs
 
	gsùµrobe_fİs
 = {

119 .
owÃr
 = 
THIS_MODULE
,

120 .
	gİ’
 = 
sùµrobe_İ’
,

121 .
	g»ad
 = 
sùµrobe_»ad
,

122 .
	gÎ£ek
 = 
noİ_Î£ek
,

125 
sùp_di¥os™iÚ_t
 
	$jsùp_sf_—t_§ck
(
Ãt
 *net,

126 cÚ¡ 
sùp_’dpošt
 *
•
,

127 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

128 cÚ¡ 
sùp_subty³_t
 
ty³
,

129 *
¬g
,

130 
sùp_cmd_£q_t
 *
commªds
)

132 
sùp_Œª¥Üt
 *
¥
;

133 
__u32
 
lcwnd
 = 0;

134 
time¥ec
 
now
;

136 
¥
 = 
asoc
->
³”
.
´im¬y_·th
;

138 ià((
fuÎ
 || 
¥
->
cwnd
 !ğ
lcwnd
) &&

139 (!
pÜt
 || 
asoc
->
³”
.port ==…ort ||

140 
•
->
ba£
.
bšd_addr
.
pÜt
 ==…ort)) {

141 
lcwnd
 = 
¥
->
cwnd
;

143 
	`g‘n¡imeofday
(&
now
);

144 
now
 = 
	`time¥ec_sub
Òow, 
sùpw
.
t¡¬t
);

146 
	`´š
("%lu.%06lu ", (è
now
.
tv_£c
,

147 (è
now
.
tv_n£c
 / 
NSEC_PER_USEC
);

149 
	`´š
("%°%5d %5d %5d %8d %5d ", 
asoc
,

150 
•
->
ba£
.
bšd_addr
.
pÜt
, 
asoc
->
³”
.port,

151 
asoc
->
·thmtu
,‡soc->
³”
.
rwnd
,‡soc->
uÇck_d©a
);

153 
	`li¡_fÜ_—ch_’Œy
(
¥
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

154 
Œª¥Üts
) {

155 ià(
¥
 =ğ
asoc
->
³”
.
´im¬y_·th
)

156 
	`´š
("*");

158 ià(
¥
->
addr
.
§
.
§_çmy
 =ğ
AF_INET
)

159 
	`´š
("%pI4 ", &
¥
->
addr
.
v4
.
sš_addr
);

161 
	`´š
("%pI6 ", &
¥
->
addr
.
v6
.
sš6_addr
);

163 
	`´š
("%2u %8u %8u %8u %8u %8u ",

164 
¥
->
¡©e
, sp->
cwnd
, sp->
s¡h»sh
,

165 
¥
->
æight_size
, sp->
·¹Ÿl_by‹s_acked
,

166 
¥
->
·thmtu
);

168 
	`´š
("\n");

171 
	`j´obe_»tuº
();

173 
	}
}

175 
j´obe
 
	gsùp_»cv_´obe
 = {

176 .
kp
 = {

177 .
symbŞ_Çme
 = "sctp_sf_eat_sack_6_2",

179 .
	g’Œy
 = 
jsùp_sf_—t_§ck
,

182 
__š™
 
	$sùµrobe_š™
()

184 
»t
 = -
ENOMEM
;

186 
	`š™_wa™queue_h—d
(&
sùpw
.
wa™
);

187 
	`¥š_lock_š™
(&
sùpw
.
lock
);

188 ià(
	`kfifo_®loc
(&
sùpw
.
fifo
, 
bufsize
, 
GFP_KERNEL
))

189  
»t
;

191 ià(!
	`´oc_Ãt_fİs_ü—‹
(&
š™_Ãt
, 
´oúame
, 
S_IRUSR
,

192 &
sùµrobe_fİs
))

193 
ä“_kfifo
;

195 
»t
 = 
	`»gi¡”_j´obe
(&
sùp_»cv_´obe
);

196 ià(
»t
)

197 
»move_´oc
;

199 
	`´_šfo
("´ob»gi¡”ed (pÜt=%d)\n", 
pÜt
);

203 
»move_´oc
:

204 
	`´oc_Ãt_»move
(&
š™_Ãt
, 
´oúame
);

205 
ä“_kfifo
:

206 
	`kfifo_ä“
(&
sùpw
.
fifo
);

207  
»t
;

208 
	}
}

210 
__ex™
 
	$sùµrobe_ex™
()

212 
	`kfifo_ä“
(&
sùpw
.
fifo
);

213 
	`´oc_Ãt_»move
(&
š™_Ãt
, 
´oúame
);

214 
	`uÄegi¡”_j´obe
(&
sùp_»cv_´obe
);

215 
	}
}

217 
moduË_š™
(
sùµrobe_š™
);

218 
moduË_ex™
(
sùµrobe_ex™
);

	@proc.c

37 
	~<lšux/ty³s.h
>

38 
	~<lšux/£q_fe.h
>

39 
	~<lšux/š™.h
>

40 
	~<Ãt/sùp/sùp.h
>

41 
	~<Ãt/.h
>

43 
¢mp_mib
 
	gsùp_¢mp_li¡
[] = {

44 
SNMP_MIB_ITEM
("SùpCu¼E¡ab", 
SCTP_MIB_CURRESTAB
),

45 
SNMP_MIB_ITEM
("SùpAùiveE¡abs", 
SCTP_MIB_ACTIVEESTABS
),

46 
SNMP_MIB_ITEM
("SùpPassiveE¡abs", 
SCTP_MIB_PASSIVEESTABS
),

47 
SNMP_MIB_ITEM
("SùpAbÜ‹ds", 
SCTP_MIB_ABORTEDS
),

48 
SNMP_MIB_ITEM
("SùpShutdowns", 
SCTP_MIB_SHUTDOWNS
),

49 
SNMP_MIB_ITEM
("SùpOutOfBlues", 
SCTP_MIB_OUTOFBLUES
),

50 
SNMP_MIB_ITEM
("SùpChecksumE¼Üs", 
SCTP_MIB_CHECKSUMERRORS
),

51 
SNMP_MIB_ITEM
("SùpOutCŒlChunks", 
SCTP_MIB_OUTCTRLCHUNKS
),

52 
SNMP_MIB_ITEM
("SùpOutOrd”Chunks", 
SCTP_MIB_OUTORDERCHUNKS
),

53 
SNMP_MIB_ITEM
("SùpOutUnÜd”Chunks", 
SCTP_MIB_OUTUNORDERCHUNKS
),

54 
SNMP_MIB_ITEM
("SùpInCŒlChunks", 
SCTP_MIB_INCTRLCHUNKS
),

55 
SNMP_MIB_ITEM
("SùpInOrd”Chunks", 
SCTP_MIB_INORDERCHUNKS
),

56 
SNMP_MIB_ITEM
("SùpInUnÜd”Chunks", 
SCTP_MIB_INUNORDERCHUNKS
),

57 
SNMP_MIB_ITEM
("SùpF¿gU¤Msgs", 
SCTP_MIB_FRAGUSRMSGS
),

58 
SNMP_MIB_ITEM
("SùpR—smU¤Msgs", 
SCTP_MIB_REASMUSRMSGS
),

59 
SNMP_MIB_ITEM
("SùpOutSCTPPacks", 
SCTP_MIB_OUTSCTPPACKS
),

60 
SNMP_MIB_ITEM
("SùpInSCTPPacks", 
SCTP_MIB_INSCTPPACKS
),

61 
SNMP_MIB_ITEM
("SùpT1In™Expœeds", 
SCTP_MIB_T1_INIT_EXPIREDS
),

62 
SNMP_MIB_ITEM
("SùpT1Cook›Expœeds", 
SCTP_MIB_T1_COOKIE_EXPIREDS
),

63 
SNMP_MIB_ITEM
("SùpT2ShutdownExpœeds", 
SCTP_MIB_T2_SHUTDOWN_EXPIREDS
),

64 
SNMP_MIB_ITEM
("SùpT3RtxExpœeds", 
SCTP_MIB_T3_RTX_EXPIREDS
),

65 
SNMP_MIB_ITEM
("SùpT4RtoExpœeds", 
SCTP_MIB_T4_RTO_EXPIREDS
),

66 
SNMP_MIB_ITEM
("SùpT5ShutdownGu¬dExpœeds", 
SCTP_MIB_T5_SHUTDOWN_GUARD_EXPIREDS
),

67 
SNMP_MIB_ITEM
("SùpD–aySackExpœeds", 
SCTP_MIB_DELAY_SACK_EXPIREDS
),

68 
SNMP_MIB_ITEM
("SùpAutoşo£Expœeds", 
SCTP_MIB_AUTOCLOSE_EXPIREDS
),

69 
SNMP_MIB_ITEM
("SùpT3R‘¿nsm™s", 
SCTP_MIB_T3_RETRANSMITS
),

70 
SNMP_MIB_ITEM
("SùpPmtudR‘¿nsm™s", 
SCTP_MIB_PMTUD_RETRANSMITS
),

71 
SNMP_MIB_ITEM
("SùpFa¡R‘¿nsm™s", 
SCTP_MIB_FAST_RETRANSMITS
),

72 
SNMP_MIB_ITEM
("SùpInPktSoáœq", 
SCTP_MIB_IN_PKT_SOFTIRQ
),

73 
SNMP_MIB_ITEM
("SùpInPktBacklog", 
SCTP_MIB_IN_PKT_BACKLOG
),

74 
SNMP_MIB_ITEM
("SùpInPktDisÿrds", 
SCTP_MIB_IN_PKT_DISCARDS
),

75 
SNMP_MIB_ITEM
("SùpInD©aChunkDisÿrds", 
SCTP_MIB_IN_DATA_CHUNK_DISCARDS
),

76 
SNMP_MIB_SENTINEL


80 
	$sùp_¢mp_£q_show
(
£q_fe
 *
£q
, *
v
)

82 
i
;

84 
i
 = 0; 
sùp_¢mp_li¡
[i].
Çme
 !ğ
NULL
; i++)

85 
	`£q_´štf
(
£q
, "%-32s\t%ld\n", 
sùp_¢mp_li¡
[
i
].
Çme
,

86 
	`¢mp_fŞd_f›ld
((**)
sùp_¡©i¡ics
,

87 
sùp_¢mp_li¡
[
i
].
’Œy
));

90 
	}
}

93 
	$sùp_¢mp_£q_İ’
(
šode
 *šode, 
fe
 *file)

95  
	`sšgË_İ’
(
fe
, 
sùp_¢mp_£q_show
, 
NULL
);

96 
	}
}

98 cÚ¡ 
fe_İ”©iÚs
 
	gsùp_¢mp_£q_fİs
 = {

99 .
owÃr
 = 
THIS_MODULE
,

100 .
	gİ’
 = 
sùp_¢mp_£q_İ’
,

101 .
	g»ad
 = 
£q_»ad
,

102 .
	gÎ£ek
 = 
£q_l£ek
,

103 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

107 
__š™
 
	$sùp_¢mp_´oc_š™
()

109 
´oc_dœ_’Œy
 *
p
;

111 
p
 = 
	`´oc_ü—‹
("¢mp", 
S_IRUGO
, 
´oc_Ãt_sùp
, &
sùp_¢mp_£q_fİs
);

112 ià(!
p
)

113  -
ENOMEM
;

116 
	}
}

119 
	$sùp_¢mp_´oc_ex™
()

121 
	`»move_´oc_’Œy
("¢mp", 
´oc_Ãt_sùp
);

122 
	}
}

125 
	$sùp_£q_dump_loÿl_addrs
(
£q_fe
 *
£q
, 
sùp_•_commÚ
 *
•b
)

127 
sùp_assocŸtiÚ
 *
asoc
;

128 
sùp_sockaddr_’Œy
 *
Ïddr
;

129 
sùp_Œª¥Üt
 *
³”
;

130 
sùp_addr
 *
addr
, *
´im¬y
 = 
NULL
;

131 
sùp_af
 *
af
;

133 ià(
•b
->
ty³
 =ğ
SCTP_EP_TYPE_ASSOCIATION
) {

134 
asoc
 = 
	`sùp_assoc
(
•b
);

135 
³”
 = 
asoc
->³”.
´im¬y_·th
;

136 
´im¬y
 = &
³”
->
§ddr
;

139 
	`rcu_»ad_lock
();

140 
	`li¡_fÜ_—ch_’Œy_rcu
(
Ïddr
, &
•b
->
bšd_addr
.
add»ss_li¡
, 
li¡
) {

141 ià(!
Ïddr
->
v®id
)

144 
addr
 = &
Ïddr
->
a
;

145 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§
.
§_çmy
);

146 ià(
´im¬y
 && 
af
->
	`cmp_addr
(
addr
,…rimary)) {

147 
	`£q_´štf
(
£q
, "*");

149 
af
->
	`£q_dump_addr
(
£q
, 
addr
);

151 
	`rcu_»ad_uÆock
();

152 
	}
}

155 
	$sùp_£q_dump_»mÙe_addrs
(
£q_fe
 *
£q
, 
sùp_assocŸtiÚ
 *
assoc
)

157 
sùp_Œª¥Üt
 *
Œª¥Üt
;

158 
sùp_addr
 *
addr
, *
´im¬y
;

159 
sùp_af
 *
af
;

161 
´im¬y
 = &
assoc
->
³”
.
´im¬y_addr
;

162 
	`rcu_»ad_lock
();

163 
	`li¡_fÜ_—ch_’Œy_rcu
(
Œª¥Üt
, &
assoc
->
³”
.
Œª¥Üt_addr_li¡
,

164 
Œª¥Üts
) {

165 
addr
 = &
Œª¥Üt
->
addr
;

166 ià(
Œª¥Üt
->
d—d
)

169 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§
.
§_çmy
);

170 ià(
af
->
	`cmp_addr
(
addr
, 
´im¬y
)) {

171 
	`£q_´štf
(
£q
, "*");

173 
af
->
	`£q_dump_addr
(
£q
, 
addr
);

175 
	`rcu_»ad_uÆock
();

176 
	}
}

178 * 
	$sùp_•s_£q_¡¬t
(
£q_fe
 *
£q
, 
loff_t
 *
pos
)

180 ià(*
pos
 >ğ
sùp_•_hashsize
)

181  
NULL
;

183 ià(*
pos
 < 0)

184 *
pos
 = 0;

186 ià(*
pos
 == 0)

187 
	`£q_´štf
(
£q
, " ENDPT SOCK STY SST HBKT LPORT UID INODE LADDRS\n");

189  (*)
pos
;

190 
	}
}

192 
	$sùp_•s_£q_¡İ
(
£q_fe
 *
£q
, *
v
)

195 
	}
}

198 * 
	$sùp_•s_£q_Ãxt
(
£q_fe
 *
£q
, *
v
, 
loff_t
 *
pos
)

200 ià(++*
pos
 >ğ
sùp_•_hashsize
)

201  
NULL
;

203  
pos
;

204 
	}
}

208 
	$sùp_•s_£q_show
(
£q_fe
 *
£q
, *
v
)

210 
sùp_hashbuck‘
 *
h—d
;

211 
sùp_•_commÚ
 *
•b
;

212 
sùp_’dpošt
 *
•
;

213 
sock
 *
sk
;

214 
hli¡_node
 *
node
;

215 
hash
 = *(
loff_t
 *)
v
;

217 ià(
hash
 >ğ
sùp_•_hashsize
)

218  -
ENOMEM
;

220 
h—d
 = &
sùp_•_hashbË
[
hash
];

221 
	`sùp_loÿl_bh_di§bË
();

222 
	`»ad_lock
(&
h—d
->
lock
);

223 
	`sùp_fÜ_—ch_h’Œy
(
•b
, 
node
, &
h—d
->
chaš
) {

224 
•
 = 
	`sùp_•
(
•b
);

225 
sk
 = 
•b
->sk;

226 
	`£q_´štf
(
£q
, "%8°%8°%-3d %-3d %-4d %-5d %5d %5lu ", 
•
, 
sk
,

227 
	`sùp_sk
(
sk
)->
ty³
, sk->
sk_¡©e
, 
hash
,

228 
•b
->
bšd_addr
.
pÜt
,

229 
	`sock_i_uid
(
sk
), 
	`sock_i_šo
(sk));

231 
	`sùp_£q_dump_loÿl_addrs
(
£q
, 
•b
);

232 
	`£q_´štf
(
£q
, "\n");

234 
	`»ad_uÆock
(&
h—d
->
lock
);

235 
	`sùp_loÿl_bh_’abË
();

238 
	}
}

240 cÚ¡ 
£q_İ”©iÚs
 
	gsùp_•s_İs
 = {

241 .
¡¬t
 = 
sùp_•s_£q_¡¬t
,

242 .
	gÃxt
 = 
sùp_•s_£q_Ãxt
,

243 .
	g¡İ
 = 
sùp_•s_£q_¡İ
,

244 .
	gshow
 = 
sùp_•s_£q_show
,

249 
	$sùp_•s_£q_İ’
(
šode
 *šode, 
fe
 *file)

251  
	`£q_İ’
(
fe
, &
sùp_•s_İs
);

252 
	}
}

254 cÚ¡ 
fe_İ”©iÚs
 
	gsùp_•s_£q_fİs
 = {

255 .
İ’
 = 
sùp_•s_£q_İ’
,

256 .
	g»ad
 = 
£q_»ad
,

257 .
	gÎ£ek
 = 
£q_l£ek
,

258 .
	g»Ëa£
 = 
£q_»Ëa£
,

262 
__š™
 
	$sùp_•s_´oc_š™
()

264 
´oc_dœ_’Œy
 *
p
;

266 
p
 = 
	`´oc_ü—‹
("•s", 
S_IRUGO
, 
´oc_Ãt_sùp
, &
sùp_•s_£q_fİs
);

267 ià(!
p
)

268  -
ENOMEM
;

271 
	}
}

274 
	$sùp_•s_´oc_ex™
()

276 
	`»move_´oc_’Œy
("•s", 
´oc_Ãt_sùp
);

277 
	}
}

280 * 
	$sùp_assocs_£q_¡¬t
(
£q_fe
 *
£q
, 
loff_t
 *
pos
)

282 ià(*
pos
 >ğ
sùp_assoc_hashsize
)

283  
NULL
;

285 ià(*
pos
 < 0)

286 *
pos
 = 0;

288 ià(*
pos
 == 0)

289 
	`£q_´štf
(
£q
, " ASSOC SOCK STY SST ST HBKT "

294  (*)
pos
;

295 
	}
}

297 
	$sùp_assocs_£q_¡İ
(
£q_fe
 *
£q
, *
v
)

300 
	}
}

303 * 
	$sùp_assocs_£q_Ãxt
(
£q_fe
 *
£q
, *
v
, 
loff_t
 *
pos
)

305 ià(++*
pos
 >ğ
sùp_assoc_hashsize
)

306  
NULL
;

308  
pos
;

309 
	}
}

312 
	$sùp_assocs_£q_show
(
£q_fe
 *
£q
, *
v
)

314 
sùp_hashbuck‘
 *
h—d
;

315 
sùp_•_commÚ
 *
•b
;

316 
sùp_assocŸtiÚ
 *
assoc
;

317 
sock
 *
sk
;

318 
hli¡_node
 *
node
;

319 
hash
 = *(
loff_t
 *)
v
;

321 ià(
hash
 >ğ
sùp_assoc_hashsize
)

322  -
ENOMEM
;

324 
h—d
 = &
sùp_assoc_hashbË
[
hash
];

325 
	`sùp_loÿl_bh_di§bË
();

326 
	`»ad_lock
(&
h—d
->
lock
);

327 
	`sùp_fÜ_—ch_h’Œy
(
•b
, 
node
, &
h—d
->
chaš
) {

328 
assoc
 = 
	`sùp_assoc
(
•b
);

329 
sk
 = 
•b
->sk;

330 
	`£q_´štf
(
£q
,

333 
assoc
, 
sk
, 
	`sùp_sk
(sk)->
ty³
, sk->
sk_¡©e
,

334 
assoc
->
¡©e
, 
hash
,

335 
assoc
->
assoc_id
,

336 
assoc
->
¢dbuf_u£d
,

337 
	`©omic_»ad
(&
assoc
->
rmem_®loc
),

338 
	`sock_i_uid
(
sk
), 
	`sock_i_šo
(sk),

339 
•b
->
bšd_addr
.
pÜt
,

340 
assoc
->
³”
.
pÜt
);

341 
	`£q_´štf
(
£q
, " ");

342 
	`sùp_£q_dump_loÿl_addrs
(
£q
, 
•b
);

343 
	`£q_´štf
(
£q
, "<-> ");

344 
	`sùp_£q_dump_»mÙe_addrs
(
£q
, 
assoc
);

345 
	`£q_´štf
(
£q
, "\t%8lu %5d %5d %4d %4d %4d %8d ",

346 
assoc
->
hbš‹rv®
,‡ssoc->
c
.
sš™_max_š¡»ams
,

347 
assoc
->
c
.
sš™_num_o¡»ams
,‡ssoc->
max_»Œªs
,

348 
assoc
->
š™_»Œ›s
,‡ssoc->
shutdown_»Œ›s
,

349 
assoc
->
¹x_d©a_chunks
);

350 
	`£q_´štf
(
£q
, "\n");

352 
	`»ad_uÆock
(&
h—d
->
lock
);

353 
	`sùp_loÿl_bh_’abË
();

356 
	}
}

358 cÚ¡ 
£q_İ”©iÚs
 
	gsùp_assoc_İs
 = {

359 .
¡¬t
 = 
sùp_assocs_£q_¡¬t
,

360 .
	gÃxt
 = 
sùp_assocs_£q_Ãxt
,

361 .
	g¡İ
 = 
sùp_assocs_£q_¡İ
,

362 .
	gshow
 = 
sùp_assocs_£q_show
,

366 
	$sùp_assocs_£q_İ’
(
šode
 *šode, 
fe
 *file)

368  
	`£q_İ’
(
fe
, &
sùp_assoc_İs
);

369 
	}
}

371 cÚ¡ 
fe_İ”©iÚs
 
	gsùp_assocs_£q_fİs
 = {

372 .
İ’
 = 
sùp_assocs_£q_İ’
,

373 .
	g»ad
 = 
£q_»ad
,

374 .
	gÎ£ek
 = 
£q_l£ek
,

375 .
	g»Ëa£
 = 
£q_»Ëa£
,

379 
__š™
 
	$sùp_assocs_´oc_š™
()

381 
´oc_dœ_’Œy
 *
p
;

383 
p
 = 
	`´oc_ü—‹
("assocs", 
S_IRUGO
, 
´oc_Ãt_sùp
,

384 &
sùp_assocs_£q_fİs
);

385 ià(!
p
)

386  -
ENOMEM
;

389 
	}
}

392 
	$sùp_assocs_´oc_ex™
()

394 
	`»move_´oc_’Œy
("assocs", 
´oc_Ãt_sùp
);

395 
	}
}

397 *
	$sùp_»maddr_£q_¡¬t
(
£q_fe
 *
£q
, 
loff_t
 *
pos
)

399 ià(*
pos
 >ğ
sùp_assoc_hashsize
)

400  
NULL
;

402 ià(*
pos
 < 0)

403 *
pos
 = 0;

405 ià(*
pos
 == 0)

406 
	`£q_´štf
(
£q
, "ADDR ASSOC_ID HB_ACT RTO MAX_PATH_RTX "

409  (*)
pos
;

410 
	}
}

412 *
	$sùp_»maddr_£q_Ãxt
(
£q_fe
 *
£q
, *
v
, 
loff_t
 *
pos
)

414 ià(++*
pos
 >ğ
sùp_assoc_hashsize
)

415  
NULL
;

417  
pos
;

418 
	}
}

420 
	$sùp_»maddr_£q_¡İ
(
£q_fe
 *
£q
, *
v
)

423 
	}
}

425 
	$sùp_»maddr_£q_show
(
£q_fe
 *
£q
, *
v
)

427 
sùp_hashbuck‘
 *
h—d
;

428 
sùp_•_commÚ
 *
•b
;

429 
sùp_assocŸtiÚ
 *
assoc
;

430 
hli¡_node
 *
node
;

431 
sùp_Œª¥Üt
 *
t¥
;

432 
hash
 = *(
loff_t
 *)
v
;

434 ià(
hash
 >ğ
sùp_assoc_hashsize
)

435  -
ENOMEM
;

437 
h—d
 = &
sùp_assoc_hashbË
[
hash
];

438 
	`sùp_loÿl_bh_di§bË
();

439 
	`»ad_lock
(&
h—d
->
lock
);

440 
	`rcu_»ad_lock
();

441 
	`sùp_fÜ_—ch_h’Œy
(
•b
, 
node
, &
h—d
->
chaš
) {

442 
assoc
 = 
	`sùp_assoc
(
•b
);

443 
	`li¡_fÜ_—ch_’Œy_rcu
(
t¥
, &
assoc
->
³”
.
Œª¥Üt_addr_li¡
,

444 
Œª¥Üts
) {

445 ià(
t¥
->
d—d
)

451 
t¥
->
af_¥ecific
->
	`£q_dump_addr
(
£q
, &t¥->
addr
);

452 
	`£q_´štf
(
£q
, " ");

457 
	`£q_´štf
(
£q
, "%d ", 
t¥
->
asoc
->
assoc_id
);

463 
	`£q_´štf
(
£q
, "%d ", 
	`tim”_³ndšg
(&
t¥
->
hb_tim”
));

468 
	`£q_´štf
(
£q
, "%lu ", 
t¥
->
¹o
);

473 
	`£q_´štf
(
£q
, "%d ", 
t¥
->
·thmaxrxt
);

480 
	`£q_´štf
(
£q
, "0 ");

487 
	`£q_´štf
(
£q
, "0");

489 
	`£q_´štf
(
£q
, "\n");

493 
	`rcu_»ad_uÆock
();

494 
	`»ad_uÆock
(&
h—d
->
lock
);

495 
	`sùp_loÿl_bh_’abË
();

499 
	}
}

501 cÚ¡ 
£q_İ”©iÚs
 
	gsùp_»maddr_İs
 = {

502 .
¡¬t
 = 
sùp_»maddr_£q_¡¬t
,

503 .
	gÃxt
 = 
sùp_»maddr_£q_Ãxt
,

504 .
	g¡İ
 = 
sùp_»maddr_£q_¡İ
,

505 .
	gshow
 = 
sùp_»maddr_£q_show
,

509 
	$sùp_»maddr_´oc_ex™
()

511 
	`»move_´oc_’Œy
("»maddr", 
´oc_Ãt_sùp
);

512 
	}
}

514 
	$sùp_»maddr_£q_İ’
(
šode
 *šode, 
fe
 *file)

516  
	`£q_İ’
(
fe
, &
sùp_»maddr_İs
);

517 
	}
}

519 cÚ¡ 
fe_İ”©iÚs
 
	gsùp_»maddr_£q_fİs
 = {

520 .
İ’
 = 
sùp_»maddr_£q_İ’
,

521 .
	g»ad
 = 
£q_»ad
,

522 .
	gÎ£ek
 = 
£q_l£ek
,

523 .
	g»Ëa£
 = 
£q_»Ëa£
,

526 
__š™
 
	$sùp_»maddr_´oc_š™
()

528 
´oc_dœ_’Œy
 *
p
;

530 
p
 = 
	`´oc_ü—‹
("»maddr", 
S_IRUGO
, 
´oc_Ãt_sùp
, &
sùp_»maddr_£q_fİs
);

531 ià(!
p
)

532  -
ENOMEM
;

534 
	}
}

	@protocol.c

49 
	~<lšux/moduË.h
>

50 
	~<lšux/š™.h
>

51 
	~<lšux/Ãtdeviû.h
>

52 
	~<lšux/š‘deviû.h
>

53 
	~<lšux/£q_fe.h
>

54 
	~<lšux/boÙmem.h
>

55 
	~<lšux/highmem.h
>

56 
	~<lšux/sw­.h
>

57 
	~<Ãt/Ãt_Çme¥aû.h
>

58 
	~<Ãt/´ÙocŞ.h
>

59 
	~<Ãt/.h
>

60 
	~<Ãt/v6.h
>

61 
	~<Ãt/rou‹.h
>

62 
	~<Ãt/sùp/sùp.h
>

63 
	~<Ãt/addrcÚf.h
>

64 
	~<Ãt/š‘_commÚ.h
>

65 
	~<Ãt/š‘_eú.h
>

68 
sùp_glob®s
 sùp_glob® 
	g__»ad_mo¡ly
;

69 
	$DEFINE_SNMP_STAT
(
sùp_mib
, 
sùp_¡©i¡ics
è
__»ad_mo¡ly
;

71 #ifdeà
CONFIG_PROC_FS


72 
´oc_dœ_’Œy
 *
´oc_Ãt_sùp
;

75 
idr
 
sùp_assocs_id
;

76 
	`DEFINE_SPINLOCK
(
sùp_assocs_id_lock
);

82 
sock
 *
sùp_ùl_sock
;

84 
sùp_pf
 *
sùp_pf_š‘6_¥ecific
;

85 
sùp_pf
 *
sùp_pf_š‘_¥ecific
;

86 
sùp_af
 *
sùp_af_v4_¥ecific
;

87 
sùp_af
 *
sùp_af_v6_¥ecific
;

89 
kmem_ÿche
 *
sùp_chunk_ÿch•
 
__»ad_mo¡ly
;

90 
kmem_ÿche
 *
sùp_buck‘_ÿch•
 
__»ad_mo¡ly
;

92 
sysùl_sùp_mem
[3];

93 
sysùl_sùp_rmem
[3];

94 
sysùl_sùp_wmem
[3];

97 
sock
 *
	$sùp_g‘_ùl_sock
()

99  
sùp_ùl_sock
;

100 
	}
}

103 
__š™
 
	$sùp_´oc_š™
()

105 ià(
	`³rıu_couÁ”_š™
(&
sùp_sock‘s_®loÿ‹d
, 0))

106 
out_nomem
;

107 #ifdeà
CONFIG_PROC_FS


108 ià(!
´oc_Ãt_sùp
) {

109 
´oc_Ãt_sùp
 = 
	`´oc_mkdœ
("sùp", 
š™_Ãt
.
´oc_Ãt
);

110 ià(!
´oc_Ãt_sùp
)

111 
out_ä“_³rıu
;

114 ià(
	`sùp_¢mp_´oc_š™
())

115 
out_¢mp_´oc_š™
;

116 ià(
	`sùp_•s_´oc_š™
())

117 
out_•s_´oc_š™
;

118 ià(
	`sùp_assocs_´oc_š™
())

119 
out_assocs_´oc_š™
;

120 ià(
	`sùp_»maddr_´oc_š™
())

121 
out_»maddr_´oc_š™
;

125 
out_»maddr_´oc_š™
:

126 
	`sùp_assocs_´oc_ex™
();

127 
out_assocs_´oc_š™
:

128 
	`sùp_•s_´oc_ex™
();

129 
out_•s_´oc_š™
:

130 
	`sùp_¢mp_´oc_ex™
();

131 
out_¢mp_´oc_š™
:

132 ià(
´oc_Ãt_sùp
) {

133 
´oc_Ãt_sùp
 = 
NULL
;

134 
	`»move_´oc_’Œy
("sùp", 
š™_Ãt
.
´oc_Ãt
);

136 
out_ä“_³rıu
:

137 
	`³rıu_couÁ”_de¡roy
(&
sùp_sock‘s_®loÿ‹d
);

142 
out_nomem
:

143  -
ENOMEM
;

144 
	}
}

150 
	$sùp_´oc_ex™
()

152 #ifdeà
CONFIG_PROC_FS


153 
	`sùp_¢mp_´oc_ex™
();

154 
	`sùp_•s_´oc_ex™
();

155 
	`sùp_assocs_´oc_ex™
();

156 
	`sùp_»maddr_´oc_ex™
();

158 ià(
´oc_Ãt_sùp
) {

159 
´oc_Ãt_sùp
 = 
NULL
;

160 
	`»move_´oc_’Œy
("sùp", 
š™_Ãt
.
´oc_Ãt
);

163 
	`³rıu_couÁ”_de¡roy
(&
sùp_sock‘s_®loÿ‹d
);

164 
	}
}

169 
	$sùp_v4_cİy_add¾i¡
(
li¡_h—d
 *
add¾i¡
,

170 
Ãt_deviû
 *
dev
)

172 
š_deviû
 *
š_dev
;

173 
š_içddr
 *
iç
;

174 
sùp_sockaddr_’Œy
 *
addr
;

176 
	`rcu_»ad_lock
();

177 ià((
š_dev
 = 
	`__š_dev_g‘_rcu
(
dev
)è=ğ
NULL
) {

178 
	`rcu_»ad_uÆock
();

182 
iç
 = 
š_dev
->
iç_li¡
; iç; iç = iç->
iç_Ãxt
) {

184 
addr
 = 
	`t_Ãw
(
sùp_sockaddr_’Œy
, 
GFP_ATOMIC
);

185 ià(
addr
) {

186 
addr
->
a
.
v4
.
sš_çmy
 = 
AF_INET
;

187 
addr
->
a
.
v4
.
sš_pÜt
 = 0;

188 
addr
->
a
.
v4
.
sš_addr
.
s_addr
 = 
iç
->
iç_loÿl
;

189 
addr
->
v®id
 = 1;

190 
	`INIT_LIST_HEAD
(&
addr
->
li¡
);

191 
	`INIT_RCU_HEAD
(&
addr
->
rcu
);

192 
	`li¡_add_
(&
addr
->
li¡
, 
add¾i¡
);

196 
	`rcu_»ad_uÆock
();

197 
	}
}

202 
	$sùp_g‘_loÿl_addr_li¡
()

204 
Ãt_deviû
 *
dev
;

205 
li¡_h—d
 *
pos
;

206 
sùp_af
 *
af
;

208 
	`»ad_lock
(&
dev_ba£_lock
);

209 
	`fÜ_—ch_Ãtdev
(&
š™_Ãt
, 
dev
) {

210 
	`__li¡_fÜ_—ch
(
pos
, &
sùp_add»ss_çm›s
) {

211 
af
 = 
	`li¡_’Œy
(
pos
, 
sùp_af
, 
li¡
);

212 
af
->
	`cİy_add¾i¡
(&
sùp_loÿl_addr_li¡
, 
dev
);

215 
	`»ad_uÆock
(&
dev_ba£_lock
);

216 
	}
}

219 
	$sùp_ä“_loÿl_addr_li¡
()

221 
sùp_sockaddr_’Œy
 *
addr
;

222 
li¡_h—d
 *
pos
, *
‹mp
;

224 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
sùp_loÿl_addr_li¡
) {

225 
addr
 = 
	`li¡_’Œy
(
pos
, 
sùp_sockaddr_’Œy
, 
li¡
);

226 
	`li¡_d–
(
pos
);

227 
	`kä“
(
addr
);

229 
	}
}

231 
	$sùp_loÿl_addr_ä“
(
rcu_h—d
 *
h—d
)

233 
sùp_sockaddr_’Œy
 *
e
 = 
	`cÚš”_of
(
h—d
,

234 
sùp_sockaddr_’Œy
, 
rcu
);

235 
	`kä“
(
e
);

236 
	}
}

239 
	$sùp_cİy_loÿl_addr_li¡
(
sùp_bšd_addr
 *
bp
, 
sùp_scİe_t
 
scİe
,

240 
gå_t
 
gå
, 
cİy_æags
)

242 
sùp_sockaddr_’Œy
 *
addr
;

243 
”rÜ
 = 0;

245 
	`rcu_»ad_lock
();

246 
	`li¡_fÜ_—ch_’Œy_rcu
(
addr
, &
sùp_loÿl_addr_li¡
, 
li¡
) {

247 ià(!
addr
->
v®id
)

249 ià(
	`sùp_š_scİe
(&
addr
->
a
, 
scİe
)) {

254 ià((((
AF_INET
 =ğ
addr
->
a
.
§
.
§_çmy
) &&

255 (
cİy_æags
 & 
SCTP_ADDR4_PEERSUPP
))) ||

256 (((
AF_INET6
 =ğ
addr
->
a
.
§
.
§_çmy
) &&

257 (
cİy_æags
 & 
SCTP_ADDR6_ALLOWED
) &&

258 (
cİy_æags
 & 
SCTP_ADDR6_PEERSUPP
)))) {

259 
”rÜ
 = 
	`sùp_add_bšd_addr
(
bp
, &
addr
->
a
,

260 
SCTP_ADDR_SRC
, 
GFP_ATOMIC
);

261 ià(
”rÜ
)

262 
’d_cİy
;

267 
’d_cİy
:

268 
	`rcu_»ad_uÆock
();

269  
”rÜ
;

270 
	}
}

273 
	$sùp_v4_äom_skb
(
sùp_addr
 *
addr
, 
sk_buff
 *
skb
,

274 
is_§ddr
)

276 *
äom
;

277 
__be16
 *
pÜt
;

278 
sùphdr
 *
sh
;

280 
pÜt
 = &
addr
->
v4
.
sš_pÜt
;

281 
addr
->
v4
.
sš_çmy
 = 
AF_INET
;

283 
sh
 = 
	`sùp_hdr
(
skb
);

284 ià(
is_§ddr
) {

285 *
pÜt
 = 
sh
->
sourû
;

286 
äom
 = &
	`_hdr
(
skb
)->
§ddr
;

288 *
pÜt
 = 
sh
->
de¡
;

289 
äom
 = &
	`_hdr
(
skb
)->
daddr
;

291 
	`memıy
(&
addr
->
v4
.
sš_addr
.
s_addr
, 
äom
, (
š_addr
));

292 
	}
}

295 
	$sùp_v4_äom_sk
(
sùp_addr
 *
addr
, 
sock
 *
sk
)

297 
addr
->
v4
.
sš_çmy
 = 
AF_INET
;

298 
addr
->
v4
.
sš_pÜt
 = 0;

299 
addr
->
v4
.
sš_addr
.
s_addr
 = 
	`š‘_sk
(
sk
)->
rcv_§ddr
;

300 
	}
}

303 
	$sùp_v4_to_sk_§ddr
(
sùp_addr
 *
addr
, 
sock
 *
sk
)

305 
	`š‘_sk
(
sk
)->
rcv_§ddr
 = 
addr
->
v4
.
sš_addr
.
s_addr
;

306 
	}
}

309 
	$sùp_v4_to_sk_daddr
(
sùp_addr
 *
addr
, 
sock
 *
sk
)

311 
	`š‘_sk
(
sk
)->
daddr
 = 
addr
->
v4
.
sš_addr
.
s_addr
;

312 
	}
}

315 
	$sùp_v4_äom_addr_·¿m
(
sùp_addr
 *
addr
,

316 
sùp_addr_·¿m
 *
·¿m
,

317 
__be16
 
pÜt
, 
iif
)

319 
addr
->
v4
.
sš_çmy
 = 
AF_INET
;

320 
addr
->
v4
.
sš_pÜt
 = 
pÜt
;

321 
addr
->
v4
.
sš_addr
.
s_addr
 = 
·¿m
->v4.addr.s_addr;

322 
	}
}

327 
	$sùp_v4_to_addr_·¿m
(cÚ¡ 
sùp_addr
 *
addr
,

328 
sùp_addr_·¿m
 *
·¿m
)

330 
Ëngth
 = (
sùp_v4addr_·¿m_t
);

332 
·¿m
->
v4
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_IPV4_ADDRESS
;

333 
·¿m
->
v4
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
(length);

334 
·¿m
->
v4
.
addr
.
s_addr
 =‡ddr->v4.
sš_addr
.s_addr;

336  
Ëngth
;

337 
	}
}

340 
	$sùp_v4_d¡_§ddr
(
sùp_addr
 *
§ddr
, 
d¡_’Œy
 *
d¡
,

341 
__be16
 
pÜt
)

343 
¹abË
 *
¹
 = (¹abË *)
d¡
;

344 
§ddr
->
v4
.
sš_çmy
 = 
AF_INET
;

345 
§ddr
->
v4
.
sš_pÜt
 = 
pÜt
;

346 
§ddr
->
v4
.
sš_addr
.
s_addr
 = 
¹
->
¹_¤c
;

347 
	}
}

350 
	$sùp_v4_cmp_addr
(cÚ¡ 
sùp_addr
 *
addr1
,

351 cÚ¡ 
sùp_addr
 *
addr2
)

353 ià(
addr1
->
§
.
§_çmy
 !ğ
addr2
->sa.sa_family)

355 ià(
addr1
->
v4
.
sš_pÜt
 !ğ
addr2
->v4.sin_port)

357 ià(
addr1
->
v4
.
sš_addr
.
s_addr
 !ğ
addr2
->v4.sin_addr.s_addr)

361 
	}
}

364 
	$sùp_v4_šaddr_ªy
(
sùp_addr
 *
addr
, 
__be16
 
pÜt
)

366 
addr
->
v4
.
sš_çmy
 = 
AF_INET
;

367 
addr
->
v4
.
sš_addr
.
s_addr
 = 
	`htÚl
(
INADDR_ANY
);

368 
addr
->
v4
.
sš_pÜt
 = 
pÜt
;

369 
	}
}

372 
	$sùp_v4_is_ªy
(cÚ¡ 
sùp_addr
 *
addr
)

374  
	`htÚl
(
INADDR_ANY
è=ğ
addr
->
v4
.
sš_addr
.
s_addr
;

375 
	}
}

384 
	$sùp_v4_addr_v®id
(
sùp_addr
 *
addr
,

385 
sùp_sock
 *
¥
,

386 cÚ¡ 
sk_buff
 *
skb
)

389 ià(
¥
 && 
	`v6_Úly_sock
(
	`sùp_İt2sk
(sp)))

393 ià(
	`IS_IPV4_UNUSABLE_ADDRESS
(
addr
->
v4
.
sš_addr
.
s_addr
))

397 ià(
skb
 && 
	`skb_¹abË
(skb)->
¹_æags
 & 
RTCF_BROADCAST
)

401 
	}
}

404 
	$sùp_v4_avaabË
(
sùp_addr
 *
addr
, 
sùp_sock
 *
¥
)

406 
»t
 = 
	`š‘_addr_ty³
(&
š™_Ãt
, 
addr
->
v4
.
sš_addr
.
s_addr
);

409 ià(
addr
->
v4
.
sš_addr
.
s_addr
 !ğ
	`htÚl
(
INADDR_ANY
) &&

410 
»t
 !ğ
RTN_LOCAL
 &&

411 !
¥
->
š‘
.
ä“bšd
 &&

412 !
sysùl__nÚloÿl_bšd
)

415 ià(
	`v6_Úly_sock
(
	`sùp_İt2sk
(
¥
)))

419 
	}
}

438 
sùp_scİe_t
 
	$sùp_v4_scİe
(
sùp_addr
 *
addr
)

440 
sùp_scİe_t
 
»tv®
;

443 ià(
	`IS_IPV4_UNUSABLE_ADDRESS
(
addr
->
v4
.
sš_addr
.
s_addr
)) {

444 
»tv®
 = 
SCTP_SCOPE_UNUSABLE
;

445 } ià(
	`v4_is_loİback
(
addr
->
v4
.
sš_addr
.
s_addr
)) {

446 
»tv®
 = 
SCTP_SCOPE_LOOPBACK
;

447 } ià(
	`v4_is_lškloÿl_169
(
addr
->
v4
.
sš_addr
.
s_addr
)) {

448 
»tv®
 = 
SCTP_SCOPE_LINK
;

449 } ià(
	`v4_is_´iv©e_10
(
addr
->
v4
.
sš_addr
.
s_addr
) ||

450 
	`v4_is_´iv©e_172
(
addr
->
v4
.
sš_addr
.
s_addr
) ||

451 
	`v4_is_´iv©e_192
(
addr
->
v4
.
sš_addr
.
s_addr
)) {

452 
»tv®
 = 
SCTP_SCOPE_PRIVATE
;

454 
»tv®
 = 
SCTP_SCOPE_GLOBAL
;

457  
»tv®
;

458 
	}
}

464 
d¡_’Œy
 *
	$sùp_v4_g‘_d¡
(
sùp_assocŸtiÚ
 *
asoc
,

465 
sùp_addr
 *
daddr
,

466 
sùp_addr
 *
§ddr
,

467 
æowi
 *
æ
,

468 
sock
 *
sk
)

470 
¹abË
 *
¹
;

471 
sùp_bšd_addr
 *
bp
;

472 
sùp_sockaddr_’Œy
 *
Ïddr
;

473 
d¡_’Œy
 *
d¡
 = 
NULL
;

474 
sùp_addr
 
d¡_§ddr
;

476 
	`mem£t
(
æ
, 0x0, (
æowi
));

477 
æ
->
æ4_d¡
 = 
daddr
->
v4
.
sš_addr
.
s_addr
;

478 
æ
->
æ__dpÜt
 = 
daddr
->
v4
.
sš_pÜt
;

479 
æ
->
´Ùo
 = 
IPPROTO_SCTP
;

480 ià(
asoc
) {

481 
æ
->
æ4_tos
 = 
	`RT_CONN_FLAGS
(
asoc
->
ba£
.
sk
);

482 
æ
->
oif
 = 
asoc
->
ba£
.
sk
->
sk_bound_dev_if
;

483 
æ
->
æ__¥Üt
 = 
	`htÚs
(
asoc
->
ba£
.
bšd_addr
.
pÜt
);

485 ià(
§ddr
) {

486 
æ
->
æ4_¤c
 = 
§ddr
->
v4
.
sš_addr
.
s_addr
;

487 
æ
->
æ__¥Üt
 = 
§ddr
->
v4
.
sš_pÜt
;

490 
	`SCTP_DEBUG_PRINTK
("%s: DST:%pI4, SRC:%pI4 - ",

491 
__func__
, &
æ
->
æ4_d¡
, &æ->
æ4_¤c
);

493 ià(!
	`_rou‹_ouut_key
(&
š™_Ãt
, &
¹
, 
æ
)) {

494 
d¡
 = &
¹
->
u
.dst;

500 ià(!
asoc
 || 
§ddr
)

501 
out
;

503 
bp
 = &
asoc
->
ba£
.
bšd_addr
;

505 ià(
d¡
) {

509 
	`sùp_v4_d¡_§ddr
(&
d¡_§ddr
, 
d¡
, 
	`htÚs
(
bp
->
pÜt
));

510 
	`rcu_»ad_lock
();

511 
	`li¡_fÜ_—ch_’Œy_rcu
(
Ïddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

512 ià(!
Ïddr
->
v®id
 || (Ïddr->
¡©e
 !ğ
SCTP_ADDR_SRC
))

514 ià(
	`sùp_v4_cmp_addr
(&
d¡_§ddr
, &
Ïddr
->
a
))

515 
out_uÆock
;

517 
	`rcu_»ad_uÆock
();

522 
	`d¡_»Ëa£
(
d¡
);

523 
d¡
 = 
NULL
;

529 
	`rcu_»ad_lock
();

530 
	`li¡_fÜ_—ch_’Œy_rcu
(
Ïddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

531 ià(!
Ïddr
->
v®id
)

533 ià((
Ïddr
->
¡©e
 =ğ
SCTP_ADDR_SRC
) &&

534 (
AF_INET
 =ğ
Ïddr
->
a
.
§
.
§_çmy
)) {

535 
æ
->
æ4_¤c
 = 
Ïddr
->
a
.
v4
.
sš_addr
.
s_addr
;

536 
æ
->
æ__¥Üt
 = 
Ïddr
->
a
.
v4
.
sš_pÜt
;

537 ià(!
	`_rou‹_ouut_key
(&
š™_Ãt
, &
¹
, 
æ
)) {

538 
d¡
 = &
¹
->
u
.dst;

539 
out_uÆock
;

544 
out_uÆock
:

545 
	`rcu_»ad_uÆock
();

546 
out
:

547 ià(
d¡
)

548 
	`SCTP_DEBUG_PRINTK
("rt_dst:%pI4,„t_src:%pI4\n",

549 &
¹
->
¹_d¡
, &¹->
¹_¤c
);

551 
	`SCTP_DEBUG_PRINTK
("NO ROUTE\n");

553  
d¡
;

554 
	}
}

559 
	$sùp_v4_g‘_§ddr
(
sùp_sock
 *
sk
,

560 
sùp_Œª¥Üt
 *
t
,

561 
sùp_addr
 *
daddr
,

562 
æowi
 *
æ
)

564 
sùp_addr
 *
§ddr
 = &
t
->saddr;

565 
¹abË
 *
¹
 = (¹abË *)
t
->
d¡
;

567 ià(
¹
) {

568 
§ddr
->
v4
.
sš_çmy
 = 
AF_INET
;

569 
§ddr
->
v4
.
sš_addr
.
s_addr
 = 
¹
->
¹_¤c
;

571 
	}
}

574 
	$sùp_v4_skb_iif
(cÚ¡ 
sk_buff
 *
skb
)

576  
	`skb_¹abË
(
skb
)->
¹_iif
;

577 
	}
}

580 
	$sùp_v4_is_û
(cÚ¡ 
sk_buff
 *
skb
)

582  
	`INET_ECN_is_û
(
	`_hdr
(
skb
)->
tos
);

583 
	}
}

586 
sock
 *
	$sùp_v4_ü—‹_acû±_sk
(
sock
 *
sk
,

587 
sùp_assocŸtiÚ
 *
asoc
)

589 
sock
 *
Ãwsk
 = 
	`sk_®loc
(
	`sock_Ãt
(
sk
), 
PF_INET
, 
GFP_KERNEL
,

590 
sk
->
sk_´Ù
);

591 
š‘_sock
 *
Ãwš‘
;

593 ià(!
Ãwsk
)

594 
out
;

596 
	`sock_š™_d©a
(
NULL
, 
Ãwsk
);

598 
	`sùp_cİy_sock
(
Ãwsk
, 
sk
, 
asoc
);

599 
	`sock_»£t_æag
(
Ãwsk
, 
SOCK_ZAPPED
);

601 
Ãwš‘
 = 
	`š‘_sk
(
Ãwsk
);

603 
Ãwš‘
->
daddr
 = 
asoc
->
³”
.
´im¬y_addr
.
v4
.
sš_addr
.
s_addr
;

605 
	`sk_»fút_debug_šc
(
Ãwsk
);

607 ià(
Ãwsk
->
sk_´Ù
->
	`š™
(newsk)) {

608 
	`sk_commÚ_»Ëa£
(
Ãwsk
);

609 
Ãwsk
 = 
NULL
;

612 
out
:

613  
Ãwsk
;

614 
	}
}

617 
	$sùp_v4_addr_v4m­
(
sùp_sock
 *
¥
, 
sùp_addr
 *
addr
)

620 
	}
}

623 
	$sùp_v4_£q_dump_addr
(
£q_fe
 *
£q
, 
sùp_addr
 *
addr
)

625 
	`£q_´štf
(
£q
, "%pI4 ", &
addr
->
v4
.
sš_addr
);

626 
	}
}

628 
	$sùp_v4_eú_ÿ·bË
(
sock
 *
sk
)

630 
	`INET_ECN_xm™
(
sk
);

631 
	}
}

639 
	$sùp_š‘addr_ev’t
(
nÙif›r_block
 *
this
, 
ev
,

640 *
±r
)

642 
š_içddr
 *
iç
 = (š_içdd¸*)
±r
;

643 
sùp_sockaddr_’Œy
 *
addr
 = 
NULL
;

644 
sùp_sockaddr_’Œy
 *
‹mp
;

645 
found
 = 0;

647 ià(!
	`Ãt_eq
(
	`dev_Ãt
(
iç
->
iç_dev
->
dev
), &
š™_Ãt
))

648  
NOTIFY_DONE
;

650 
ev
) {

651 
NETDEV_UP
:

652 
addr
 = 
	`km®loc
((
sùp_sockaddr_’Œy
), 
GFP_ATOMIC
);

653 ià(
addr
) {

654 
addr
->
a
.
v4
.
sš_çmy
 = 
AF_INET
;

655 
addr
->
a
.
v4
.
sš_pÜt
 = 0;

656 
addr
->
a
.
v4
.
sš_addr
.
s_addr
 = 
iç
->
iç_loÿl
;

657 
addr
->
v®id
 = 1;

658 
	`¥š_lock_bh
(&
sùp_loÿl_addr_lock
);

659 
	`li¡_add__rcu
(&
addr
->
li¡
, &
sùp_loÿl_addr_li¡
);

660 
	`¥š_uÆock_bh
(&
sùp_loÿl_addr_lock
);

663 
NETDEV_DOWN
:

664 
	`¥š_lock_bh
(&
sùp_loÿl_addr_lock
);

665 
	`li¡_fÜ_—ch_’Œy_§ã
(
addr
, 
‹mp
,

666 &
sùp_loÿl_addr_li¡
, 
li¡
) {

667 ià(
addr
->
a
.
§
.
§_çmy
 =ğ
AF_INET
 &&

668 
addr
->
a
.
v4
.
sš_addr
.
s_addr
 ==

669 
iç
->
iç_loÿl
) {

670 
found
 = 1;

671 
addr
->
v®id
 = 0;

672 
	`li¡_d–_rcu
(&
addr
->
li¡
);

676 
	`¥š_uÆock_bh
(&
sùp_loÿl_addr_lock
);

677 ià(
found
)

678 
	`ÿÎ_rcu
(&
addr
->
rcu
, 
sùp_loÿl_addr_ä“
);

682  
NOTIFY_DONE
;

683 
	}
}

689 
	$sùp_ùl_sock_š™
()

691 
”r
;

692 
§_çmy_t
 
çmy
 = 
PF_INET
;

694 ià(
	`sùp_g‘_pf_¥ecific
(
PF_INET6
))

695 
çmy
 = 
PF_INET6
;

697 
”r
 = 
	`š‘_ùl_sock_ü—‹
(&
sùp_ùl_sock
, 
çmy
,

698 
SOCK_SEQPACKET
, 
IPPROTO_SCTP
, &
š™_Ãt
);

701 ià(
”r
 < 0 && 
çmy
 =ğ
PF_INET6
)

702 
”r
 = 
	`š‘_ùl_sock_ü—‹
(&
sùp_ùl_sock
, 
AF_INET
,

703 
SOCK_SEQPACKET
, 
IPPROTO_SCTP
,

704 &
š™_Ãt
);

706 ià(
”r
 < 0) {

707 
	`´štk
(
KERN_ERR


709  
”r
;

712 
	}
}

715 
	$sùp_»gi¡”_af
(
sùp_af
 *
af
)

717 
af
->
§_çmy
) {

718 
AF_INET
:

719 ià(
sùp_af_v4_¥ecific
)

721 
sùp_af_v4_¥ecific
 = 
af
;

723 
AF_INET6
:

724 ià(
sùp_af_v6_¥ecific
)

726 
sùp_af_v6_¥ecific
 = 
af
;

732 
	`INIT_LIST_HEAD
(&
af
->
li¡
);

733 
	`li¡_add_
(&
af
->
li¡
, &
sùp_add»ss_çm›s
);

735 
	}
}

740 
sùp_af
 *
	$sùp_g‘_af_¥ecific
(
§_çmy_t
 
çmy
)

742 
çmy
) {

743 
AF_INET
:

744  
sùp_af_v4_¥ecific
;

745 
AF_INET6
:

746  
sùp_af_v6_¥ecific
;

748  
NULL
;

750 
	}
}

753 
	$sùp_š‘_msgÇme
(*
msgÇme
, *
addr_Ën
)

755 
sockaddr_š
 *
sš
;

757 
sš
 = (
sockaddr_š
 *)
msgÇme
;

758 *
addr_Ën
 = (
sockaddr_š
);

759 
sš
->
sš_çmy
 = 
AF_INET
;

760 
	`mem£t
(
sš
->
sš_z”o
, 0, (sin->sin_zero));

761 
	}
}

764 
	$sùp_š‘_ev’t_msgÇme
(
sùp_uÍev’t
 *
ev’t
, *
msgÇme
,

765 *
addr_Ën
)

767 
sockaddr_š
 *
sš
, *
sšäom
;

769 ià(
msgÇme
) {

770 
sùp_assocŸtiÚ
 *
asoc
;

772 
asoc
 = 
ev’t
->asoc;

773 
	`sùp_š‘_msgÇme
(
msgÇme
, 
addr_Ën
);

774 
sš
 = (
sockaddr_š
 *)
msgÇme
;

775 
sšäom
 = &
asoc
->
³”
.
´im¬y_addr
.
v4
;

776 
sš
->
sš_pÜt
 = 
	`htÚs
(
asoc
->
³”
.
pÜt
);

777 
sš
->
sš_addr
.
s_addr
 = 
sšäom
->sin_addr.s_addr;

779 
	}
}

782 
	$sùp_š‘_skb_msgÇme
(
sk_buff
 *
skb
, *
msgÇme
, *
Ën
)

784 ià(
msgÇme
) {

785 
sùphdr
 *
sh
 = 
	`sùp_hdr
(
skb
);

786 
sockaddr_š
 *
sš
 = (sockaddr_š *)
msgÇme
;

788 
	`sùp_š‘_msgÇme
(
msgÇme
, 
Ën
);

789 
sš
->
sš_pÜt
 = 
sh
->
sourû
;

790 
sš
->
sš_addr
.
s_addr
 = 
	`_hdr
(
skb
)->
§ddr
;

792 
	}
}

795 
	$sùp_š‘_af_suµÜ‹d
(
§_çmy_t
 
çmy
, 
sùp_sock
 *
¥
)

798  (
AF_INET
 =ğ
çmy
);

799 
	}
}

802 
	$sùp_š‘_cmp_addr
(cÚ¡ 
sùp_addr
 *
addr1
,

803 cÚ¡ 
sùp_addr
 *
addr2
,

804 
sùp_sock
 *
İt
)

807 ià(
addr1
->
§
.
§_çmy
 !ğ
addr2
->sa.sa_family)

809 ià(
	`htÚl
(
INADDR_ANY
è=ğ
addr1
->
v4
.
sš_addr
.
s_addr
 ||

810 
	`htÚl
(
INADDR_ANY
è=ğ
addr2
->
v4
.
sš_addr
.
s_addr
)

812 ià(
addr1
->
v4
.
sš_addr
.
s_addr
 =ğ
addr2
->v4.sin_addr.s_addr)

816 
	}
}

821 
	$sùp_š‘_bšd_v”ify
(
sùp_sock
 *
İt
, 
sùp_addr
 *
addr
)

823  
	`sùp_v4_avaabË
(
addr
, 
İt
);

824 
	}
}

829 
	$sùp_š‘_£nd_v”ify
(
sùp_sock
 *
İt
, 
sùp_addr
 *
addr
)

832 
	}
}

837 
	$sùp_š‘_suµÜ‹d_addrs
(cÚ¡ 
sùp_sock
 *
İt
,

838 
__be16
 *
ty³s
)

840 
ty³s
[0] = 
SCTP_PARAM_IPV4_ADDRESS
;

842 
	}
}

845 
šlše
 
	$sùp_v4_xm™
(
sk_buff
 *
skb
,

846 
sùp_Œª¥Üt
 *
Œª¥Üt
)

848 
š‘_sock
 *
š‘
 = 
	`š‘_sk
(
skb
->
sk
);

850 
	`SCTP_DEBUG_PRINTK
("%s: skb:%p,†en:%d, src:%pI4, dst:%pI4\n",

851 
__func__
, 
skb
, skb->
Ën
,

852 &
	`skb_¹abË
(
skb
)->
¹_¤c
,

853 &
	`skb_¹abË
(
skb
)->
¹_d¡
);

855 
š‘
->
pmtudisc
 = 
Œª¥Üt
->
·¿m_æags
 & 
SPP_PMTUD_ENABLE
 ?

856 
IP_PMTUDISC_DO
 : 
IP_PMTUDISC_DONT
;

858 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTSCTPPACKS
);

859  
	`_queue_xm™
(
skb
, 0);

860 
	}
}

862 
sùp_af
 
	gsùp_af_š‘
;

864 
sùp_pf
 
	gsùp_pf_š‘
 = {

865 .
ev’t_msgÇme
 = 
sùp_š‘_ev’t_msgÇme
,

866 .
	gskb_msgÇme
 = 
sùp_š‘_skb_msgÇme
,

867 .
	gaf_suµÜ‹d
 = 
sùp_š‘_af_suµÜ‹d
,

868 .
	gcmp_addr
 = 
sùp_š‘_cmp_addr
,

869 .
	gbšd_v”ify
 = 
sùp_š‘_bšd_v”ify
,

870 .
	g£nd_v”ify
 = 
sùp_š‘_£nd_v”ify
,

871 .
	gsuµÜ‹d_addrs
 = 
sùp_š‘_suµÜ‹d_addrs
,

872 .
	gü—‹_acû±_sk
 = 
sùp_v4_ü—‹_acû±_sk
,

873 .
	gaddr_v4m­
 = 
sùp_v4_addr_v4m­
,

874 .
	gaf
 = &
sùp_af_š‘


878 
nÙif›r_block
 
	gsùp_š‘addr_nÙif›r
 = {

879 .
nÙif›r_ÿÎ
 = 
sùp_š‘addr_ev’t
,

883 cÚ¡ 
´Ùo_İs
 
	gš‘_£q·ck‘_İs
 = {

884 .
çmy
 = 
PF_INET
,

885 .
	gowÃr
 = 
THIS_MODULE
,

886 .
	g»Ëa£
 = 
š‘_»Ëa£
,

887 .
	gbšd
 = 
š‘_bšd
,

888 .
	gcÚÃù
 = 
š‘_dg¿m_cÚÃù
,

889 .
	gsock‘·œ
 = 
sock_no_sock‘·œ
,

890 .
	gacû±
 = 
š‘_acû±
,

891 .
	gg‘Çme
 = 
š‘_g‘Çme
,

892 .
	gpŞl
 = 
sùp_pŞl
,

893 .
	gioùl
 = 
š‘_ioùl
,

894 .
	gli¡’
 = 
sùp_š‘_li¡’
,

895 .
	gshutdown
 = 
š‘_shutdown
,

896 .
	g£tsockİt
 = 
sock_commÚ_£tsockİt
,

897 .
	gg‘sockİt
 = 
sock_commÚ_g‘sockİt
,

898 .
	g£ndmsg
 = 
š‘_£ndmsg
,

899 .
	g»cvmsg
 = 
sock_commÚ_»cvmsg
,

900 .
	gmm­
 = 
sock_no_mm­
,

901 .
	g£nd·ge
 = 
sock_no_£nd·ge
,

902 #ifdeà
CONFIG_COMPAT


903 .
	gcom·t_£tsockİt
 = 
com·t_sock_commÚ_£tsockİt
,

904 .
	gcom·t_g‘sockİt
 = 
com·t_sock_commÚ_g‘sockİt
,

909 
š‘_´Ùosw
 
	gsùp_£q·ck‘_´Ùosw
 = {

910 .
ty³
 = 
SOCK_SEQPACKET
,

911 .
	g´ÙocŞ
 = 
IPPROTO_SCTP
,

912 .
	g´Ù
 = &
sùp_´Ù
,

913 .
	gİs
 = &
š‘_£q·ck‘_İs
,

914 .
	gno_check
 = 0,

915 .
	gæags
 = 
SCTP_PROTOSW_FLAG


917 
š‘_´Ùosw
 
	gsùp_¡»am_´Ùosw
 = {

918 .
ty³
 = 
SOCK_STREAM
,

919 .
	g´ÙocŞ
 = 
IPPROTO_SCTP
,

920 .
	g´Ù
 = &
sùp_´Ù
,

921 .
	gİs
 = &
š‘_£q·ck‘_İs
,

922 .
	gno_check
 = 0,

923 .
	gæags
 = 
SCTP_PROTOSW_FLAG


927 cÚ¡ 
Ãt_´ÙocŞ
 
	gsùp_´ÙocŞ
 = {

928 .
hªdËr
 = 
sùp_rcv
,

929 .
	g”r_hªdËr
 = 
sùp_v4_”r
,

930 .
	gno_pŞicy
 = 1,

934 
sùp_af
 
	gsùp_af_š‘
 = {

935 .
§_çmy
 = 
AF_INET
,

936 .
	gsùp_xm™
 = 
sùp_v4_xm™
,

937 .
	g£tsockİt
 = 
_£tsockİt
,

938 .
	gg‘sockİt
 = 
_g‘sockİt
,

939 .
	gg‘_d¡
 = 
sùp_v4_g‘_d¡
,

940 .
	gg‘_§ddr
 = 
sùp_v4_g‘_§ddr
,

941 .
	gcİy_add¾i¡
 = 
sùp_v4_cİy_add¾i¡
,

942 .
	gäom_skb
 = 
sùp_v4_äom_skb
,

943 .
	gäom_sk
 = 
sùp_v4_äom_sk
,

944 .
	gto_sk_§ddr
 = 
sùp_v4_to_sk_§ddr
,

945 .
	gto_sk_daddr
 = 
sùp_v4_to_sk_daddr
,

946 .
	gäom_addr_·¿m
 = 
sùp_v4_äom_addr_·¿m
,

947 .
	gto_addr_·¿m
 = 
sùp_v4_to_addr_·¿m
,

948 .
	gcmp_addr
 = 
sùp_v4_cmp_addr
,

949 .
	gaddr_v®id
 = 
sùp_v4_addr_v®id
,

950 .
	gšaddr_ªy
 = 
sùp_v4_šaddr_ªy
,

951 .
	gis_ªy
 = 
sùp_v4_is_ªy
,

952 .
	gavaabË
 = 
sùp_v4_avaabË
,

953 .
	gscİe
 = 
sùp_v4_scİe
,

954 .
	gskb_iif
 = 
sùp_v4_skb_iif
,

955 .
	gis_û
 = 
sùp_v4_is_û
,

956 .
	g£q_dump_addr
 = 
sùp_v4_£q_dump_addr
,

957 .
	geú_ÿ·bË
 = 
sùp_v4_eú_ÿ·bË
,

958 .
	gÃt_h—d”_Ën
 = (
hdr
),

959 .
	gsockaddr_Ën
 = (
sockaddr_š
),

960 #ifdeà
CONFIG_COMPAT


961 .
	gcom·t_£tsockİt
 = 
com·t__£tsockİt
,

962 .
	gcom·t_g‘sockİt
 = 
com·t__g‘sockİt
,

966 
sùp_pf
 *
	$sùp_g‘_pf_¥ecific
(
§_çmy_t
 
çmy
) {

968 
çmy
) {

969 
PF_INET
:

970  
sùp_pf_š‘_¥ecific
;

971 
PF_INET6
:

972  
sùp_pf_š‘6_¥ecific
;

974  
NULL
;

976 
	}
}

979 
	$sùp_»gi¡”_pf
(
sùp_pf
 *
pf
, 
§_çmy_t
 
çmy
)

981 
çmy
) {

982 
PF_INET
:

983 ià(
sùp_pf_š‘_¥ecific
)

985 
sùp_pf_š‘_¥ecific
 = 
pf
;

987 
PF_INET6
:

988 ià(
sùp_pf_š‘6_¥ecific
)

990 
sùp_pf_š‘6_¥ecific
 = 
pf
;

996 
	}
}

998 
šlše
 
	$š™_sùp_mibs
()

1000  
	`¢mp_mib_š™
((**)
sùp_¡©i¡ics
, (
sùp_mib
));

1001 
	}
}

1003 
šlše
 
	$ş—nup_sùp_mibs
()

1005 
	`¢mp_mib_ä“
((**)
sùp_¡©i¡ics
);

1006 
	}
}

1008 
	$sùp_v4_pf_š™
()

1011 
	`sùp_»gi¡”_pf
(&
sùp_pf_š‘
, 
PF_INET
);

1012 
	`sùp_»gi¡”_af
(&
sùp_af_š‘
);

1013 
	}
}

1015 
	$sùp_v4_pf_ex™
()

1017 
	`li¡_d–
(&
sùp_af_š‘
.
li¡
);

1018 
	}
}

1020 
	$sùp_v4_´Ùosw_š™
()

1022 
rc
;

1024 
rc
 = 
	`´Ùo_»gi¡”
(&
sùp_´Ù
, 1);

1025 ià(
rc
)

1026  
rc
;

1029 
	`š‘_»gi¡”_´Ùosw
(&
sùp_£q·ck‘_´Ùosw
);

1030 
	`š‘_»gi¡”_´Ùosw
(&
sùp_¡»am_´Ùosw
);

1033 
	}
}

1035 
	$sùp_v4_´Ùosw_ex™
()

1037 
	`š‘_uÄegi¡”_´Ùosw
(&
sùp_¡»am_´Ùosw
);

1038 
	`š‘_uÄegi¡”_´Ùosw
(&
sùp_£q·ck‘_´Ùosw
);

1039 
	`´Ùo_uÄegi¡”
(&
sùp_´Ù
);

1040 
	}
}

1042 
	$sùp_v4_add_´ÙocŞ
()

1045 
	`»gi¡”_š‘addr_nÙif›r
(&
sùp_š‘addr_nÙif›r
);

1048 ià(
	`š‘_add_´ÙocŞ
(&
sùp_´ÙocŞ
, 
IPPROTO_SCTP
) < 0)

1049  -
EAGAIN
;

1052 
	}
}

1054 
	$sùp_v4_d–_´ÙocŞ
()

1056 
	`š‘_d–_´ÙocŞ
(&
sùp_´ÙocŞ
, 
IPPROTO_SCTP
);

1057 
	`uÄegi¡”_š‘addr_nÙif›r
(&
sùp_š‘addr_nÙif›r
);

1058 
	}
}

1061 
SCTP_STATIC
 
__š™
 
	$sùp_š™
()

1063 
i
;

1064 
¡©us
 = -
EINVAL
;

1065 
gßl
;

1066 
lim™
;

1067 
Ä_·ges
;

1068 
max_sh¬e
;

1069 
Üd”
;

1072 ià(!
	`sùp_§n™y_check
())

1073 
out
;

1076 
¡©us
 = -
ENOBUFS
;

1077 
sùp_buck‘_ÿch•
 = 
	`kmem_ÿche_ü—‹
("sctp_bind_bucket",

1078 (
sùp_bšd_buck‘
),

1079 0, 
SLAB_HWCACHE_ALIGN
,

1080 
NULL
);

1081 ià(!
sùp_buck‘_ÿch•
)

1082 
out
;

1084 
sùp_chunk_ÿch•
 = 
	`kmem_ÿche_ü—‹
("sctp_chunk",

1085 (
sùp_chunk
),

1086 0, 
SLAB_HWCACHE_ALIGN
,

1087 
NULL
);

1088 ià(!
sùp_chunk_ÿch•
)

1089 
”r_chunk_ÿch•
;

1092 
¡©us
 = 
	`š™_sùp_mibs
();

1093 ià(
¡©us
)

1094 
”r_š™_mibs
;

1097 
¡©us
 = 
	`sùp_´oc_š™
();

1098 ià(
¡©us
)

1099 
”r_š™_´oc
;

1102 
	`sùp_dbg_objút_š™
();

1109 
sùp_¹o_š™Ÿl
 = 
SCTP_RTO_INITIAL
;

1111 
sùp_¹o_mš
 = 
SCTP_RTO_MIN
;

1113 
sùp_¹o_max
 = 
SCTP_RTO_MAX
;

1115 
sùp_¹o_®pha
 = 
SCTP_RTO_ALPHA
;

1117 
sùp_¹o_b‘a
 = 
SCTP_RTO_BETA
;

1120 
sùp_v®id_cook›_liã
 = 
SCTP_DEFAULT_COOKIE_LIFE
;

1123 
sùp_cook›_´e£rve_’abË
 = 1;

1126 
sùp_max_bur¡
 = 
SCTP_DEFAULT_MAX_BURST
;

1132 
sùp_max_»Œªs_assocŸtiÚ
 = 10;

1133 
sùp_max_»Œªs_·th
 = 5;

1134 
sùp_max_»Œªs_š™
 = 8;

1137 
sùp_¢dbuf_pŞicy
 = 0;

1140 
sùp_rcvbuf_pŞicy
 = 0;

1143 
sùp_hb_š‹rv®
 = 
SCTP_DEFAULT_TIMEOUT_HEARTBEAT
;

1146 
sùp_§ck_timeout
 = 
SCTP_DEFAULT_TIMEOUT_SACK
;

1151 
sùp_max_š¡»ams
 = 
SCTP_DEFAULT_INSTREAMS
;

1152 
sùp_max_out¡»ams
 = 
SCTP_DEFAULT_OUTSTREAMS
;

1158 
sùp_pf_»Œªs
 = 
INT_MAX
;

1161 
	`idr_š™
(&
sùp_assocs_id
);

1170 
Ä_·ges
 = 
tÙ®¿m_·ges
 - 
tÙ®high_·ges
;

1171 
lim™
 = 
	`mš
(
Ä_·ges
, 1UL<<(28-
PAGE_SHIFT
)) >> (20-PAGE_SHIFT);

1172 
lim™
 = (lim™ * (
Ä_·ges
 >> (20-
PAGE_SHIFT
))) >> (PAGE_SHIFT-11);

1173 
lim™
 = 
	`max
(limit, 128UL);

1174 
lim™
 = 
	`mš
Öim™, 
INT_MAX
 * 4UL / 3 / 2);

1175 
sysùl_sùp_mem
[0] = 
lim™
 / 4 * 3;

1176 
sysùl_sùp_mem
[1] = 
lim™
;

1177 
sysùl_sùp_mem
[2] = sysctl_sctp_mem[0] * 2;

1180 
lim™
 = (
sysùl_sùp_mem
[1]è<< (
PAGE_SHIFT
 - 7);

1181 
max_sh¬e
 = 
	`mš
(4UL*1024*1024, 
lim™
);

1183 
sysùl_sùp_rmem
[0] = 
SK_MEM_QUANTUM
;

1184 
sysùl_sùp_rmem
[1] = 1500 * 
	`SKB_TRUESIZE
(1);

1185 
sysùl_sùp_rmem
[2] = 
	`max
(sysùl_sùp_rmem[1], 
max_sh¬e
);

1187 
sysùl_sùp_wmem
[0] = 
SK_MEM_QUANTUM
;

1188 
sysùl_sùp_wmem
[1] = 16*1024;

1189 
sysùl_sùp_wmem
[2] = 
	`max
(64*1024, 
max_sh¬e
);

1194 ià(
tÙ®¿m_·ges
 >= (128 * 1024))

1195 
gßl
 = 
tÙ®¿m_·ges
 >> (22 - 
PAGE_SHIFT
);

1197 
gßl
 = 
tÙ®¿m_·ges
 >> (24 - 
PAGE_SHIFT
);

1199 
Üd”
 = 0; (1UL << ord”è< 
gßl
; order++)

1203 
sùp_assoc_hashsize
 = (1UL << 
Üd”
è* 
PAGE_SIZE
 /

1204 (
sùp_hashbuck‘
);

1205 ià((
sùp_assoc_hashsize
 > (64 * 1024)è&& 
Üd”
 > 0)

1207 
sùp_assoc_hashbË
 = (
sùp_hashbuck‘
 *)

1208 
	`__g‘_ä“_·ges
(
GFP_ATOMIC
|
__GFP_NOWARN
, 
Üd”
);

1209 } !
sùp_assoc_hashbË
 && --
Üd”
 > 0);

1210 ià(!
sùp_assoc_hashbË
) {

1211 
	`´štk
(
KERN_ERR
 "SCTP: Failed‡ssociation hash‡lloc.\n");

1212 
¡©us
 = -
ENOMEM
;

1213 
”r_ahash_®loc
;

1215 
i
 = 0; i < 
sùp_assoc_hashsize
; i++) {

1216 
	`rwlock_š™
(&
sùp_assoc_hashbË
[
i
].
lock
);

1217 
	`INIT_HLIST_HEAD
(&
sùp_assoc_hashbË
[
i
].
chaš
);

1221 
sùp_•_hashsize
 = 64;

1222 
sùp_•_hashbË
 = (
sùp_hashbuck‘
 *)

1223 
	`km®loc
(64 * (
sùp_hashbuck‘
), 
GFP_KERNEL
);

1224 ià(!
sùp_•_hashbË
) {

1225 
	`´štk
(
KERN_ERR
 "SCTP: Failedƒndpoint_hash‡lloc.\n");

1226 
¡©us
 = -
ENOMEM
;

1227 
”r_ehash_®loc
;

1229 
i
 = 0; i < 
sùp_•_hashsize
; i++) {

1230 
	`rwlock_š™
(&
sùp_•_hashbË
[
i
].
lock
);

1231 
	`INIT_HLIST_HEAD
(&
sùp_•_hashbË
[
i
].
chaš
);

1236 
sùp_pÜt_hashsize
 = (1UL << 
Üd”
è* 
PAGE_SIZE
 /

1237 (
sùp_bšd_hashbuck‘
);

1238 ià((
sùp_pÜt_hashsize
 > (64 * 1024)è&& 
Üd”
 > 0)

1240 
sùp_pÜt_hashbË
 = (
sùp_bšd_hashbuck‘
 *)

1241 
	`__g‘_ä“_·ges
(
GFP_ATOMIC
|
__GFP_NOWARN
, 
Üd”
);

1242 } !
sùp_pÜt_hashbË
 && --
Üd”
 > 0);

1243 ià(!
sùp_pÜt_hashbË
) {

1244 
	`´štk
(
KERN_ERR
 "SCTP: Failed bind hash‡lloc.");

1245 
¡©us
 = -
ENOMEM
;

1246 
”r_bhash_®loc
;

1248 
i
 = 0; i < 
sùp_pÜt_hashsize
; i++) {

1249 
	`¥š_lock_š™
(&
sùp_pÜt_hashbË
[
i
].
lock
);

1250 
	`INIT_HLIST_HEAD
(&
sùp_pÜt_hashbË
[
i
].
chaš
);

1253 
	`´štk
(
KERN_INFO
 "SCTP: Hashables configured "

1255 
sùp_assoc_hashsize
, 
sùp_pÜt_hashsize
);

1258 
sùp_add_’abË
 = 0;

1259 
sùp_add_nßuth
 = 0;

1262 
sùp_´sùp_’abË
 = 1;

1265 
sùp_auth_’abË
 = 0;

1268 
sùp_scİe_pŞicy
 = 
SCTP_SCOPE_POLICY_ENABLE
;

1271 
sùp_rwnd_upd_shiá
 = 
SCTP_DEFAULT_RWND_SHIFT
;

1273 
	`sùp_sysùl_»gi¡”
();

1275 
	`INIT_LIST_HEAD
(&
sùp_add»ss_çm›s
);

1276 
	`sùp_v4_pf_š™
();

1277 
	`sùp_v6_pf_š™
();

1280 
	`INIT_LIST_HEAD
(&
sùp_loÿl_addr_li¡
);

1281 
	`¥š_lock_š™
(&
sùp_loÿl_addr_lock
);

1282 
	`sùp_g‘_loÿl_addr_li¡
();

1284 
¡©us
 = 
	`sùp_v4_´Ùosw_š™
();

1286 ià(
¡©us
)

1287 
”r_´Ùosw_š™
;

1289 
¡©us
 = 
	`sùp_v6_´Ùosw_š™
();

1290 ià(
¡©us
)

1291 
”r_v6_´Ùosw_š™
;

1294 ià((
¡©us
 = 
	`sùp_ùl_sock_š™
())) {

1295 
	`´štk
 (
KERN_ERR


1297 
”r_ùl_sock_š™
;

1300 
¡©us
 = 
	`sùp_v4_add_´ÙocŞ
();

1301 ià(
¡©us
)

1302 
”r_add_´ÙocŞ
;

1305 
¡©us
 = 
	`sùp_v6_add_´ÙocŞ
();

1306 ià(
¡©us
)

1307 
”r_v6_add_´ÙocŞ
;

1309 
¡©us
 = 0;

1310 
out
:

1311  
¡©us
;

1312 
”r_v6_add_´ÙocŞ
:

1313 
	`sùp_v4_d–_´ÙocŞ
();

1314 
”r_add_´ÙocŞ
:

1315 
	`š‘_ùl_sock_de¡roy
(
sùp_ùl_sock
);

1316 
”r_ùl_sock_š™
:

1317 
	`sùp_v6_´Ùosw_ex™
();

1318 
”r_v6_´Ùosw_š™
:

1319 
	`sùp_v4_´Ùosw_ex™
();

1320 
”r_´Ùosw_š™
:

1321 
	`sùp_ä“_loÿl_addr_li¡
();

1322 
	`sùp_v4_pf_ex™
();

1323 
	`sùp_v6_pf_ex™
();

1324 
	`sùp_sysùl_uÄegi¡”
();

1325 
	`ä“_·ges
(()
sùp_pÜt_hashbË
,

1326 
	`g‘_Üd”
(
sùp_pÜt_hashsize
 *

1327 (
sùp_bšd_hashbuck‘
)));

1328 
”r_bhash_®loc
:

1329 
	`kä“
(
sùp_•_hashbË
);

1330 
”r_ehash_®loc
:

1331 
	`ä“_·ges
(()
sùp_assoc_hashbË
,

1332 
	`g‘_Üd”
(
sùp_assoc_hashsize
 *

1333 (
sùp_hashbuck‘
)));

1334 
”r_ahash_®loc
:

1335 
	`sùp_dbg_objút_ex™
();

1336 
	`sùp_´oc_ex™
();

1337 
”r_š™_´oc
:

1338 
	`ş—nup_sùp_mibs
();

1339 
”r_š™_mibs
:

1340 
	`kmem_ÿche_de¡roy
(
sùp_chunk_ÿch•
);

1341 
”r_chunk_ÿch•
:

1342 
	`kmem_ÿche_de¡roy
(
sùp_buck‘_ÿch•
);

1343 
out
;

1344 
	}
}

1347 
SCTP_STATIC
 
__ex™
 
	$sùp_ex™
()

1354 
	`sùp_v6_d–_´ÙocŞ
();

1355 
	`sùp_v4_d–_´ÙocŞ
();

1358 
	`š‘_ùl_sock_de¡roy
(
sùp_ùl_sock
);

1361 
	`sùp_v6_´Ùosw_ex™
();

1362 
	`sùp_v4_´Ùosw_ex™
();

1365 
	`sùp_ä“_loÿl_addr_li¡
();

1368 
	`sùp_v6_pf_ex™
();

1369 
	`sùp_v4_pf_ex™
();

1371 
	`sùp_sysùl_uÄegi¡”
();

1373 
	`ä“_·ges
(()
sùp_assoc_hashbË
,

1374 
	`g‘_Üd”
(
sùp_assoc_hashsize
 *

1375 (
sùp_hashbuck‘
)));

1376 
	`kä“
(
sùp_•_hashbË
);

1377 
	`ä“_·ges
(()
sùp_pÜt_hashbË
,

1378 
	`g‘_Üd”
(
sùp_pÜt_hashsize
 *

1379 (
sùp_bšd_hashbuck‘
)));

1381 
	`sùp_dbg_objút_ex™
();

1382 
	`sùp_´oc_ex™
();

1383 
	`ş—nup_sùp_mibs
();

1385 
	`rcu_b¬r›r
();

1387 
	`kmem_ÿche_de¡roy
(
sùp_chunk_ÿch•
);

1388 
	`kmem_ÿche_de¡roy
(
sùp_buck‘_ÿch•
);

1389 
	}
}

1391 
moduË_š™
(
sùp_š™
);

1392 
moduË_ex™
(
sùp_ex™
);

1397 
MODULE_ALIAS
("Ãt-pf-" 
__¡ršgify
(
PF_INET
) "-proto-132");

1398 
MODULE_ALIAS
("Ãt-pf-" 
__¡ršgify
(
PF_INET6
) "-proto-132");

1399 
MODULE_AUTHOR
("Linux Kernel SCTP developers <lksctp-developers@lists.sourceforge.net>");

1400 
MODULE_DESCRIPTION
("Support forhe SCTP…rotocol (RFC2960)");

1401 
moduË_·¿m_Çmed
(
no_checksums
, 
sùp_checksum_di§bË
, 
boŞ
, 0644);

1402 
MODULE_PARM_DESC
(
no_checksums
, "Disable checksums computing‡nd verification");

1403 
MODULE_LICENSE
("GPL");

	@sctp.h

49 #iâdeà
__Ãt_sùp_h__


50 
	#__Ãt_sùp_h__


	)

65 
	~<lšux/ty³s.h
>

66 
	~<lšux/¦ab.h
>

67 
	~<lšux/š.h
>

68 
	~<lšux/‰y.h
>

69 
	~<lšux/´oc_fs.h
>

70 
	~<lšux/¥šlock.h
>

71 
	~<lšux/jiff›s.h
>

72 
	~<lšux/idr.h
>

74 
	#CONFIG_IP_SCTP_MODULE
 1

	)

75 
	#SCTP_DEFAULT_COOKIE_HMAC_MD5
 
md5


	)

77 #ià
IS_ENABLED
(
CONFIG_IPV6
)

78 
	~<Ãt/v6.h
>

79 
	~<Ãt/6_rou‹.h
>

82 
	~<asm/uacûss.h
>

83 
	~<asm/·ge.h
>

84 
	~<Ãt/sock.h
>

85 
	~<Ãt/¢mp.h
>

86 
	~<Ãt/sùp/¡ruùs.h
>

87 
	~<Ãt/sùp/cÚ¡ªts.h
>

91 #iâdeà
SCTP_DEBUG


92 #ifdeà
CONFIG_SCTP_DBG_MSG


93 
	#SCTP_DEBUG
 1

	)

95 
	#SCTP_DEBUG
 0

	)

99 #ifdeà
CONFIG_IP_SCTP_MODULE


100 
	#SCTP_PROTOSW_FLAG
 0

	)

102 
	#SCTP_PROTOSW_FLAG
 
INET_PROTOSW_PERMANENT


	)

109 #iâdeà
SCTP_STATIC


110 
	#SCTP_STATIC
 

	)

120 
sùp_cİy_loÿl_addr_li¡
(
Ãt
 *, 
sùp_bšd_addr
 *,

121 
sùp_scİe_t
, 
gå_t
 
gå
,

122 
æags
);

123 
sùp_pf
 *
sùp_g‘_pf_¥ecific
(
§_çmy_t
 
çmy
);

124 
sùp_»gi¡”_pf
(
sùp_pf
 *, 
§_çmy_t
);

125 
sùp_addr_wq_mgmt
(
Ãt
 *, 
sùp_sockaddr_’Œy
 *, );

130 
sùp_backlog_rcv
(
sock
 *
sk
, 
sk_buff
 *
skb
);

131 
sùp_š‘_li¡’
(
sock‘
 *
sock
, 
backlog
);

132 
sùp_wr™e_¥aû
(
sock
 *
sk
);

133 
sùp_d©a_»ady
(
sock
 *
sk
, 
Ën
);

134 
sùp_pŞl
(
fe
 *fe, 
sock‘
 *
sock
,

135 
pŞl_bË
 *
wa™
);

136 
sùp_sock_rä“
(
sk_buff
 *
skb
);

137 
sùp_cİy_sock
(
sock
 *
Ãwsk
, sock *
sk
,

138 
sùp_assocŸtiÚ
 *
asoc
);

139 
³rıu_couÁ”
 
sùp_sock‘s_®loÿ‹d
;

140 
sùp_ascÚf_mgmt
(
sùp_sock
 *, 
sùp_sockaddr_’Œy
 *);

145 
sùp_´im™ive_ASSOCIATE
(
Ãt
 *, 
sùp_assocŸtiÚ
 *, *
¬g
);

146 
sùp_´im™ive_SHUTDOWN
(
Ãt
 *, 
sùp_assocŸtiÚ
 *, *
¬g
);

147 
sùp_´im™ive_ABORT
(
Ãt
 *, 
sùp_assocŸtiÚ
 *, *
¬g
);

148 
sùp_´im™ive_SEND
(
Ãt
 *, 
sùp_assocŸtiÚ
 *, *
¬g
);

149 
sùp_´im™ive_REQUESTHEARTBEAT
(
Ãt
 *, 
sùp_assocŸtiÚ
 *, *
¬g
);

150 
sùp_´im™ive_ASCONF
(
Ãt
 *, 
sùp_assocŸtiÚ
 *, *
¬g
);

155 
sùp_rcv
(
sk_buff
 *
skb
);

156 
sùp_v4_”r
(
sk_buff
 *
skb
, 
u32
 
šfo
);

157 
sùp_hash_e¡ablished
(
sùp_assocŸtiÚ
 *);

158 
sùp_unhash_e¡ablished
(
sùp_assocŸtiÚ
 *);

159 
sùp_hash_’dpošt
(
sùp_’dpošt
 *);

160 
sùp_unhash_’dpošt
(
sùp_’dpošt
 *);

161 
sock
 *
sùp_”r_lookup
(
Ãt
 *Ãt, 
çmy
, 
sk_buff
 *,

162 
sùphdr
 *, 
sùp_assocŸtiÚ
 **,

163 
sùp_Œª¥Üt
 **);

164 
sùp_”r_fšish
(
sock
 *, 
sùp_assocŸtiÚ
 *);

165 
sùp_icmp_äag_Ãeded
(
sock
 *, 
sùp_assocŸtiÚ
 *,

166 
sùp_Œª¥Üt
 *
t
, 
__u32
 
pmtu
);

167 
sùp_icmp_»dœeù
(
sock
 *, 
sùp_Œª¥Üt
 *,

168 
sk_buff
 *);

169 
sùp_icmp_´Ùo_uÄ—chabË
(
sock
 *
sk
,

170 
sùp_assocŸtiÚ
 *
asoc
,

171 
sùp_Œª¥Üt
 *
t
);

172 
sùp_backlog_mig¿‹
(
sùp_assocŸtiÚ
 *
assoc
,

173 
sock
 *
Şdsk
, sock *
Ãwsk
);

178 
sùp_¢mp_´oc_š™
(
Ãt
 *net);

179 
sùp_¢mp_´oc_ex™
(
Ãt
 *net);

180 
sùp_•s_´oc_š™
(
Ãt
 *net);

181 
sùp_•s_´oc_ex™
(
Ãt
 *net);

182 
sùp_assocs_´oc_š™
(
Ãt
 *net);

183 
sùp_assocs_´oc_ex™
(
Ãt
 *net);

184 
sùp_»maddr_´oc_š™
(
Ãt
 *net);

185 
sùp_»maddr_´oc_ex™
(
Ãt
 *net);

195 
kmem_ÿche
 *
sùp_chunk_ÿch•
 
__»ad_mo¡ly
;

196 
kmem_ÿche
 *
sùp_buck‘_ÿch•
 
__»ad_mo¡ly
;

203 #ifdeà
TEST_FRAME


204 
	~<‹¡_äame.h
>

208 
	#sùp_¥š_lock_œq§ve
(
lock
, 
æags
è
	`¥š_lock_œq§ve
Öock, fÏgs)

	)

209 
	#sùp_¥š_uÆock_œq»¡Üe
(
lock
, 
æags
) \

210 
	`¥š_uÆock_œq»¡Üe
(
lock
, 
æags
)

	)

211 
	#sùp_loÿl_bh_di§bË
(è
	`loÿl_bh_di§bË
()

	)

212 
	#sùp_loÿl_bh_’abË
(è
	`loÿl_bh_’abË
()

	)

213 
	#sùp_¥š_lock
(
lock
è
	`¥š_lock
Öock)

	)

214 
	#sùp_¥š_uÆock
(
lock
è
	`¥š_uÆock
Öock)

	)

215 
	#sùp_wr™e_lock
(
lock
è
	`wr™e_lock
Öock)

	)

216 
	#sùp_wr™e_uÆock
(
lock
è
	`wr™e_uÆock
Öock)

	)

217 
	#sùp_»ad_lock
(
lock
è
	`»ad_lock
Öock)

	)

218 
	#sùp_»ad_uÆock
(
lock
è
	`»ad_uÆock
Öock)

	)

221 
	#sùp_lock_sock
(
sk
è
	`lock_sock
(sk)

	)

222 
	#sùp_»Ëa£_sock
(
sk
è
	`»Ëa£_sock
(sk)

	)

223 
	#sùp_bh_lock_sock
(
sk
è
	`bh_lock_sock
(sk)

	)

224 
	#sùp_bh_uÆock_sock
(
sk
è
	`bh_uÆock_sock
(sk)

	)

227 
	#SCTP_INC_STATS
(
Ãt
, 
f›ld
è
	`SNMP_INC_STATS
(Ò‘)->
sùp
.
sùp_¡©i¡ics
, f›ld)

	)

228 
	#SCTP_INC_STATS_BH
(
Ãt
, 
f›ld
è
	`SNMP_INC_STATS_BH
(Ò‘)->
sùp
.
sùp_¡©i¡ics
, f›ld)

	)

229 
	#SCTP_INC_STATS_USER
(
Ãt
, 
f›ld
è
	`SNMP_INC_STATS_USER
(Ò‘)->
sùp
.
sùp_¡©i¡ics
, f›ld)

	)

230 
	#SCTP_DEC_STATS
(
Ãt
, 
f›ld
è
	`SNMP_DEC_STATS
(Ò‘)->
sùp
.
sùp_¡©i¡ics
, f›ld)

	)

236 
	mSCTP_MIB_NUM
 = 0,

237 
	mSCTP_MIB_CURRESTAB
,

238 
	mSCTP_MIB_ACTIVEESTABS
,

239 
	mSCTP_MIB_PASSIVEESTABS
,

240 
	mSCTP_MIB_ABORTEDS
,

241 
	mSCTP_MIB_SHUTDOWNS
,

242 
	mSCTP_MIB_OUTOFBLUES
,

243 
	mSCTP_MIB_CHECKSUMERRORS
,

244 
	mSCTP_MIB_OUTCTRLCHUNKS
,

245 
	mSCTP_MIB_OUTORDERCHUNKS
,

246 
	mSCTP_MIB_OUTUNORDERCHUNKS
,

247 
	mSCTP_MIB_INCTRLCHUNKS
,

248 
	mSCTP_MIB_INORDERCHUNKS
,

249 
	mSCTP_MIB_INUNORDERCHUNKS
,

250 
	mSCTP_MIB_FRAGUSRMSGS
,

251 
	mSCTP_MIB_REASMUSRMSGS
,

252 
	mSCTP_MIB_OUTSCTPPACKS
,

253 
	mSCTP_MIB_INSCTPPACKS
,

254 
	mSCTP_MIB_T1_INIT_EXPIREDS
,

255 
	mSCTP_MIB_T1_COOKIE_EXPIREDS
,

256 
	mSCTP_MIB_T2_SHUTDOWN_EXPIREDS
,

257 
	mSCTP_MIB_T3_RTX_EXPIREDS
,

258 
	mSCTP_MIB_T4_RTO_EXPIREDS
,

259 
	mSCTP_MIB_T5_SHUTDOWN_GUARD_EXPIREDS
,

260 
	mSCTP_MIB_DELAY_SACK_EXPIREDS
,

261 
	mSCTP_MIB_AUTOCLOSE_EXPIREDS
,

262 
	mSCTP_MIB_T1_RETRANSMITS
,

263 
	mSCTP_MIB_T3_RETRANSMITS
,

264 
	mSCTP_MIB_PMTUD_RETRANSMITS
,

265 
	mSCTP_MIB_FAST_RETRANSMITS
,

266 
	mSCTP_MIB_IN_PKT_SOFTIRQ
,

267 
	mSCTP_MIB_IN_PKT_BACKLOG
,

268 
	mSCTP_MIB_IN_PKT_DISCARDS
,

269 
	mSCTP_MIB_IN_DATA_CHUNK_DISCARDS
,

270 
	m__SCTP_MIB_MAX


273 
	#SCTP_MIB_MAX
 
__SCTP_MIB_MAX


	)

274 
	ssùp_mib
 {

275 
	mmibs
[
SCTP_MIB_MAX
];

279 
šlše
 
	$sùp_max_¹o
(
sùp_assocŸtiÚ
 *
asoc
,

280 
sùp_Œª¥Üt
 *
Œªs
)

282 ià(
asoc
->
¡©s
.
max_obs_¹o
 < (
__u64
)
Œªs
->
¹o
) {

283 
asoc
->
¡©s
.
max_obs_¹o
 = 
Œªs
->
¹o
;

284 
	`mem£t
(&
asoc
->
¡©s
.
obs_¹o_addr
, 0,

285 (
sockaddr_¡Üage
));

286 
	`memıy
(&
asoc
->
¡©s
.
obs_¹o_addr
, &
Œªs
->
addr
,

287 
Œªs
->
af_¥ecific
->
sockaddr_Ën
);

289 
	}
}

292 #ià
SCTP_DEBUG


293 
sùp_debug_æag
;

294 
	#SCTP_DEBUG_PRINTK
(
fmt
, 
¬gs
...) \

296 ià(
sùp_debug_æag
) \

297 
	`´štk
(
KERN_DEBUG
 
	`´_fmt
(
fmt
), ##
¬gs
); \

298 } 0)

	)

299 
	#SCTP_DEBUG_PRINTK_CONT
(
fmt
, 
¬gs
...) \

301 ià(
sùp_debug_æag
) \

302 
	`´_cÚt
(
fmt
, ##
¬gs
); \

303 } 0)

	)

304 
	#SCTP_DEBUG_PRINTK_IPADDR
(
fmt_Ëad
, 
fmt_Œa
, \

305 
¬gs_Ëad
, 
addr
, 
¬gs_Œa
...) \

307 cÚ¡ 
sùp_addr
 *
_addr
 = (
addr
); \

308 ià(
sùp_debug_æag
) { \

309 ià(
_addr
->
§
.
§_çmy
 =ğ
AF_INET6
) { \

310 
	`´štk
(
KERN_DEBUG
 \

311 
	`´_fmt
(
fmt_Ëad
 "%pI6" 
fmt_Œa
), \

312 
¬gs_Ëad
, \

313 &
_addr
->
v6
.
sš6_addr
, \

314 
¬gs_Œa
); \

316 
	`´štk
(
KERN_DEBUG
 \

317 
	`´_fmt
(
fmt_Ëad
 "%pI4" 
fmt_Œa
), \

318 
¬gs_Ëad
, \

319 &
_addr
->
v4
.
sš_addr
.
s_addr
, \

320 
¬gs_Œa
); \

323 } 0)

	)

324 
	#SCTP_ENABLE_DEBUG
 { 
sùp_debug_æag
 = 1; }

	)

325 
	#SCTP_DISABLE_DEBUG
 { 
sùp_debug_æag
 = 0; }

	)

327 
	#SCTP_ASSERT
(
ex´
, 
¡r
, 
func
) \

328 ià(!(
ex´
)) { \

329 
	`SCTP_DEBUG_PRINTK
("Assertion Failed: %s(%s)‡t %s:%s:%d\n", \

330 
¡r
, (#ex´), 
__FILE__
, 
__func__
, 
__LINE__
); \

331 
func
; \

332 }

	)

336 
	#SCTP_DEBUG_PRINTK
(
wh©ev”
...)

	)

337 
	#SCTP_DEBUG_PRINTK_CONT
(
fmt
, 
¬gs
...)

	)

338 
	#SCTP_DEBUG_PRINTK_IPADDR
(
wh©ev”
...)

	)

339 
	#SCTP_ENABLE_DEBUG


	)

340 
	#SCTP_DISABLE_DEBUG


	)

341 
	#SCTP_ASSERT
(
ex´
, 
¡r
, 
func
)

	)

349 #ifdeà
CONFIG_SCTP_DBG_OBJCNT


351 
©omic_t
 
sùp_dbg_objút_sock
;

352 
©omic_t
 
sùp_dbg_objút_•
;

353 
©omic_t
 
sùp_dbg_objút_assoc
;

354 
©omic_t
 
sùp_dbg_objút_Œª¥Üt
;

355 
©omic_t
 
sùp_dbg_objút_chunk
;

356 
©omic_t
 
sùp_dbg_objút_bšd_addr
;

357 
©omic_t
 
sùp_dbg_objút_bšd_buck‘
;

358 
©omic_t
 
sùp_dbg_objút_addr
;

359 
©omic_t
 
sùp_dbg_objút_s¢m­
;

360 
©omic_t
 
sùp_dbg_objút_d©amsg
;

361 
©omic_t
 
sùp_dbg_objút_keys
;

364 
	#SCTP_DBG_OBJCNT_INC
(
Çme
) \

365 
	`©omic_šc
(&
sùp_dbg_objút_
## 
Çme
)

	)

366 
	#SCTP_DBG_OBJCNT_DEC
(
Çme
) \

367 
	`©omic_dec
(&
sùp_dbg_objút_
## 
Çme
)

	)

368 
	#SCTP_DBG_OBJCNT
(
Çme
) \

369 
©omic_t
 
sùp_dbg_objút_
## 
Çme
 = 
	`ATOMIC_INIT
(0)

	)

374 
	#SCTP_DBG_OBJCNT_ENTRY
(
Çme
) \

375 {.
Ïb–
ğ#Çme, .
couÁ”
ğ&
sùp_dbg_objút_
## 
Çme
}

	)

377 
sùp_dbg_objút_š™
(
Ãt
 *);

378 
sùp_dbg_objút_ex™
(
Ãt
 *);

382 
	#SCTP_DBG_OBJCNT_INC
(
Çme
)

	)

383 
	#SCTP_DBG_OBJCNT_DEC
(
Çme
)

	)

385 
šlše
 
	$sùp_dbg_objút_š™
(
Ãt
 *Ãtè{ ; 
	}
}

386 
šlše
 
	$sùp_dbg_objút_ex™
(
Ãt
 *Ãtè{ ; 
	}
}

390 #ià
defšed
 
CONFIG_SYSCTL


391 
sùp_sysùl_»gi¡”
();

392 
sùp_sysùl_uÄegi¡”
();

393 
sùp_sysùl_Ãt_»gi¡”
(
Ãt
 *net);

394 
sùp_sysùl_Ãt_uÄegi¡”
(
Ãt
 *net);

396 
šlše
 
	$sùp_sysùl_»gi¡”
(è{ ; 
	}
}

397 
šlše
 
	$sùp_sysùl_uÄegi¡”
(è{ ; 
	}
}

398 
šlše
 
	$sùp_sysùl_Ãt_»gi¡”
(
Ãt
 *Ãtè{  0; 
	}
}

399 
šlše
 
	$sùp_sysùl_Ãt_uÄegi¡”
(
Ãt
 *Ãtè{ ; 
	}
}

403 
	#SCTP_SAT_LEN
(
x
è((
sùp_·¿mhdr
è+ (xè* (
__u16
))

	)

405 #ià
IS_ENABLED
(
CONFIG_IPV6
)

407 
sùp_v6_pf_š™
();

408 
sùp_v6_pf_ex™
();

409 
sùp_v6_´Ùosw_š™
();

410 
sùp_v6_´Ùosw_ex™
();

411 
sùp_v6_add_´ÙocŞ
();

412 
sùp_v6_d–_´ÙocŞ
();

416 
šlše
 
	$sùp_v6_pf_š™
(è{ ; 
	}
}

417 
šlše
 
	$sùp_v6_pf_ex™
(è{ ; 
	}
}

418 
šlše
 
	$sùp_v6_´Ùosw_š™
(è{  0; 
	}
}

419 
šlše
 
	$sùp_v6_´Ùosw_ex™
(è{ ; 
	}
}

420 
šlše
 
	$sùp_v6_add_´ÙocŞ
(è{  0; 
	}
}

421 
šlše
 
	$sùp_v6_d–_´ÙocŞ
(è{ ; 
	}
}

427 
šlše
 
sùp_assoc_t
 
	$sùp_assoc2id
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

429  
asoc
 ?‡soc->
assoc_id
 : 0;

430 
	}
}

433 
sùp_assocŸtiÚ
 *
sùp_id2assoc
(
sock
 *
sk
, 
sùp_assoc_t
 
id
);

435 
sùp_do_³–off
(
sock
 *
sk
, 
sùp_assoc_t
 
id
, 
sock‘
 **
sockp
);

438 
	#sùp_skb_fÜ_—ch
(
pos
, 
h—d
, 
tmp
) \

439 
	`skb_queue_w®k_§ã
(
h—d
, 
pos
, 
tmp
)

	)

442 
šlše
 
	$sùp_skb_li¡_
(
sk_buff_h—d
 *
li¡
,

443 
sk_buff_h—d
 *
h—d
)

445 
æags
;

447 
	`sùp_¥š_lock_œq§ve
(&
h—d
->
lock
, 
æags
);

448 
	`sùp_¥š_lock
(&
li¡
->
lock
);

450 
	`skb_queue_¥liû__š™
(
li¡
, 
h—d
);

452 
	`sùp_¥š_uÆock
(&
li¡
->
lock
);

453 
	`sùp_¥š_uÆock_œq»¡Üe
(&
h—d
->
lock
, 
æags
);

454 
	}
}

464 
šlše
 
li¡_h—d
 *
	$sùp_li¡_dequeue
(
li¡_h—d
 *
li¡
)

466 
li¡_h—d
 *
»suÉ
 = 
NULL
;

468 ià(
li¡
->
Ãxt
 !=†ist) {

469 
»suÉ
 = 
li¡
->
Ãxt
;

470 
li¡
->
Ãxt
 = 
»suÉ
->next;

471 
li¡
->
Ãxt
->
´ev
 =†ist;

472 
	`INIT_LIST_HEAD
(
»suÉ
);

474  
»suÉ
;

475 
	}
}

481 
šlše
 
	$sùp_skb_£t_owÃr_r
(
sk_buff
 *
skb
, 
sock
 *
sk
)

483 
sùp_uÍev’t
 *
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

485 
	`skb_Üphª
(
skb
);

486 
skb
->
sk
 = sk;

487 
skb
->
de¡ruùÜ
 = 
sùp_sock_rä“
;

488 
	`©omic_add
(
ev’t
->
rmem_Ën
, &
sk
->
sk_rmem_®loc
);

492 
sk
->
sk_fÜw¬d_®loc
 -ğ
ev’t
->
rmem_Ën
;

493 
	}
}

496 
šlše
 
	$sùp_li¡_sšgË_’Œy
(
li¡_h—d
 *
h—d
)

498  (
h—d
->
Ãxt
 !ğh—dè&& (h—d->Ãxˆ=ğh—d->
´ev
);

499 
	}
}

502 
šlše
 
__s32
 
	$sùp_j™‹r
(
__u32
 
¹o
)

504 
__u32
 
sùp_¿nd
;

505 
__s32
 
»t
;

508 ià(!
¹o
)

509 
¹o
 = 1;

511 
sùp_¿nd
 +ğ
jiff›s
;

512 
sùp_¿nd
 ^= (sctp_rand << 12);

513 
sùp_¿nd
 ^= (sctp_rand >> 20);

518 
»t
 = 
sùp_¿nd
 % 
¹o
 - (rto >> 1);

519  
»t
;

520 
	}
}

523 
šlše
 
	$sùp_äag_pošt
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
pmtu
)

525 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
asoc
->
ba£
.
sk
);

526 
äag
 = 
pmtu
;

528 
äag
 -ğ
¥
->
pf
->
af
->
Ãt_h—d”_Ën
;

529 
äag
 -ğ(
sùphdr
è+ (
sùp_d©a_chunk
);

531 ià(
asoc
->
u£r_äag
)

532 
äag
 = 
	`mš_t
(, f¿g, 
asoc
->
u£r_äag
);

534 
äag
 = 
	`mš_t
(, f¿g, 
SCTP_MAX_CHUNK_LEN
);

536  
äag
;

537 
	}
}

539 
šlše
 
	$sùp_assoc_³ndšg_pmtu
(
sock
 *
sk
, 
sùp_assocŸtiÚ
 *
asoc
)

542 
	`sùp_assoc_sync_pmtu
(
sk
, 
asoc
);

543 
asoc
->
pmtu_³ndšg
 = 0;

544 
	}
}

551 
	#sùp_w®k_·¿ms
(
pos
, 
chunk
, 
memb”
)\

552 
	`_sùp_w®k_·¿ms
((
pos
), (
chunk
), 
	`Áohs
((chunk)->
chunk_hdr
.
Ëngth
), 
memb”
)

	)

554 
	#_sùp_w®k_·¿ms
(
pos
, 
chunk
, 
’d
, 
memb”
)\

555 
pos
.
v
 = 
chunk
->
memb”
;\

556 
pos
.
v
 <ğ(*)
chunk
 + 
’d
 - 
	`Áohs
Õos.
p
->
Ëngth
) &&\

557 
	`Áohs
(
pos
.
p
->
Ëngth
è>ğ(
sùp_·¿mhdr_t
);\

558 
pos
.
v
 +ğ
	`WORD_ROUND
(
	`Áohs
Õos.
p
->
Ëngth
)))

	)

560 
	#sùp_w®k_”rÜs
(
”r
, 
chunk_hdr
)\

561 
	`_sùp_w®k_”rÜs
((
”r
), (
chunk_hdr
), 
	`Áohs
((chunk_hdr)->
Ëngth
))

	)

563 
	#_sùp_w®k_”rÜs
(
”r
, 
chunk_hdr
, 
’d
)\

564 
”r
 = (
sùp_”rhdr_t
 *)((*)
chunk_hdr
 + \

565 (
sùp_chunkhdr_t
));\

566 (*)
”r
 <ğ(*)
chunk_hdr
 + 
’d
 - 
	`Áohs
Ó¼->
Ëngth
) &&\

567 
	`Áohs
(
”r
->
Ëngth
è>ğ(
sùp_”rhdr_t
); \

568 
”r
 = (
sùp_”rhdr_t
 *)((*ë¼ + 
	`WORD_ROUND
(
	`Áohs
Ó¼->
Ëngth
))))

	)

570 
	#sùp_w®k_fwdt¢
(
pos
, 
chunk
)\

571 
	`_sùp_w®k_fwdt¢
((
pos
), (
chunk
), 
	`Áohs
((chunk)->
chunk_hdr
->
Ëngth
è- (
sùp_fwdt¢_chunk
))

	)

573 
	#_sùp_w®k_fwdt¢
(
pos
, 
chunk
, 
’d
)\

574 
pos
 = 
chunk
->
subh
.
fwdt¢_hdr
->
sk
;\

575 (*)
pos
 <ğ(*)
chunk
->
subh
.
fwdt¢_hdr
->
sk
 + 
’d
 - (
sùp_fwdt¢_sk
);\

576 
pos
++)

	)

579 
	#WORD_ROUND
(
s
è(((s)+3)&~3)

	)

582 
	#t_Ãw
(
ty³
, 
æags
èÑy³ *)
	`kz®loc
(Ñy³), fÏgs)

	)

585 
	#tv_É
(
s
, 
t
) \

586 (
s
.
tv_£c
 < 
t
.tv_£ø|| (s.tv_£ø=ğt.tv_£ø&& s.
tv_u£c
 <.tv_u£c))

	)

589 
	#TIMEVAL_ADD
(
tv1
, 
tv2
) \

591 
su£cÚds_t
 
u£cs
 = (
tv2
).
tv_u£c
 + (
tv1
).tv_usec; \

592 
time_t
 
£cs
 = (
tv2
).
tv_£c
 + (
tv1
).tv_sec; \

594 ià(
u£cs
 >= 1000000) { \

595 
u£cs
 -= 1000000; \

596 
£cs
++; \

598 (
tv2
).
tv_£c
 = 
£cs
; \

599 (
tv2
).
tv_u£c
 = 
u£cs
; \

600 })

	)

604 
´Ùo
 
sùp_´Ù
;

605 
´Ùo
 
sùpv6_´Ù
;

606 
sùp_put_pÜt
(
sock
 *
sk
);

608 
idr
 
sùp_assocs_id
;

609 
¥šlock_t
 
sùp_assocs_id_lock
;

614 
šlše
 
	$v”2af
(
__u8
 
v”
)

616 
v”
) {

618  
AF_INET
;

620  
AF_INET6
;

624 
	}
}

627 
šlše
 
	$·¿m_ty³2af
(
__be16
 
ty³
)

629 
ty³
) {

630 
SCTP_PARAM_IPV4_ADDRESS
:

631  
AF_INET
;

632 
SCTP_PARAM_IPV6_ADDRESS
:

633  
AF_INET6
;

637 
	}
}

640 
šlše
 
	$sùp_§n™y_check
()

642 
	`SCTP_ASSERT
((
sùp_uÍev’t
) <=

643 (((
sk_buff
 *)0)->
cb
),

647 
	}
}

651 
šlše
 
	$sùp_phashâ
(
Ãt
 *Ãt, 
__u16
 
ÍÜt
)

653  (
	`Ãt_hash_mix
(
Ãt
è+ 
ÍÜt
è& (
sùp_pÜt_hashsize
 - 1);

654 
	}
}

657 
šlše
 
	$sùp_•_hashâ
(
Ãt
 *Ãt, 
__u16
 
ÍÜt
)

659  (
	`Ãt_hash_mix
(
Ãt
è+ 
ÍÜt
è& (
sùp_•_hashsize
 - 1);

660 
	}
}

663 
šlše
 
	$sùp_assoc_hashâ
(
Ãt
 *Ãt, 
__u16
 
ÍÜt
, __u16 
½Üt
)

665 
h
 = (
ÍÜt
 << 16è+ 
½Üt
 + 
	`Ãt_hash_mix
(
Ãt
);

666 
h
 ^= h>>8;

667  
h
 & (
sùp_assoc_hashsize
 - 1);

668 
	}
}

674 
šlše
 
	$sùp_vg_hashâ
(
__u16
 
ÍÜt
, __u16 
½Üt
, 
__u32
 
vg
)

676 
h
 = (
ÍÜt
 << 16è+ 
½Üt
;

677 
h
 ^ğ
vg
;

678  
h
 & (
sùp_assoc_hashsize
 - 1);

679 
	}
}

681 
	#sùp_fÜ_—ch_h’Œy
(
•b
, 
node
, 
h—d
) \

682 
	`hli¡_fÜ_—ch_’Œy
(
•b
, 
node
, 
h—d
,‚ode)

	)

685 
	#sùp_¡yË
(
sk
, 
¡yË
è
	`__sùp_¡yË
((sk), (
SCTP_SOCKET_
##¡yË))

	)

686 
šlše
 
	$__sùp_¡yË
(cÚ¡ 
sock
 *
sk
, 
sùp_sock‘_ty³_t
 
¡yË
)

688  
	`sùp_sk
(
sk
)->
ty³
 =ğ
¡yË
;

689 
	}
}

692 
	#sùp_¡©e
(
asoc
, 
¡©e
è
	`__sùp_¡©e
(×soc), (
SCTP_STATE_
##¡©e))

	)

693 
šlše
 
	$__sùp_¡©e
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

694 
sùp_¡©e_t
 
¡©e
)

696  
asoc
->
¡©e
 == state;

697 
	}
}

700 
	#sùp_s¡©e
(
sk
, 
¡©e
è
	`__sùp_s¡©e
((sk), (
SCTP_SS_
##¡©e))

	)

701 
šlše
 
	$__sùp_s¡©e
(cÚ¡ 
sock
 *
sk
, 
sùp_sock_¡©e_t
 
¡©e
)

703  
sk
->
sk_¡©e
 =ğ
¡©e
;

704 
	}
}

707 
šlše
 
	$sùp_v6_m­_v4
(
sùp_addr
 *
addr
)

709 
addr
->
v4
.
sš_çmy
 = 
AF_INET
;

710 
addr
->
v4
.
sš_pÜt
 =‡ddr->
v6
.
sš6_pÜt
;

711 
addr
->
v4
.
sš_addr
.
s_addr
 =‡ddr->
v6
.
sš6_addr
.
s6_addr32
[3];

712 
	}
}

715 
šlše
 
	$sùp_v4_m­_v6
(
sùp_addr
 *
addr
)

717 
addr
->
v6
.
sš6_çmy
 = 
AF_INET6
;

718 
addr
->
v6
.
sš6_pÜt
 =‡ddr->
v4
.
sš_pÜt
;

719 
addr
->
v6
.
sš6_addr
.
s6_addr32
[3] =‡ddr->
v4
.
sš_addr
.
s_addr
;

720 
addr
->
v6
.
sš6_addr
.
s6_addr32
[0] = 0;

721 
addr
->
v6
.
sš6_addr
.
s6_addr32
[1] = 0;

722 
addr
->
v6
.
sš6_addr
.
s6_addr32
[2] = 
	`htÚl
(0x0000ffff);

723 
	}
}

728 
šlše
 
d¡_’Œy
 *
	$sùp_Œª¥Üt_d¡_check
(
sùp_Œª¥Üt
 *
t
)

730 ià(
t
->
d¡
 && !
	`d¡_check
(t->dst, 0)) {

731 
	`d¡_»Ëa£
(
t
->
d¡
);

732 
t
->
d¡
 = 
NULL
;

735  
t
->
d¡
;

736 
	}
}

	@sm.h

50 
	~<lšux/ty³s.h
>

51 
	~<lšux/comp”.h
>

52 
	~<lšux/¦ab.h
>

53 
	~<lšux/š.h
>

54 
	~<Ãt/sùp/commªd.h
>

55 
	~<Ãt/sùp/sùp.h
>

57 #iâdeà
__sùp_sm_h__


58 
	#__sùp_sm_h__


	)

64 
	mSCTP_DISPOSITION_DISCARD
,

65 
	mSCTP_DISPOSITION_CONSUME
,

66 
	mSCTP_DISPOSITION_NOMEM
,

67 
	mSCTP_DISPOSITION_DELETE_TCB
,

68 
	mSCTP_DISPOSITION_ABORT
,

69 
	mSCTP_DISPOSITION_VIOLATION
,

70 
	mSCTP_DISPOSITION_NOT_IMPL
,

71 
	mSCTP_DISPOSITION_ERROR
,

72 
	mSCTP_DISPOSITION_BUG
,

73 } 
	tsùp_di¥os™iÚ_t
;

76 
	mÇme
;

77 
	maùiÚ
;

78 } 
	tsùp_sm_commªd_t
;

80 
	$sùp_di¥os™iÚ_t
 (
	tsùp_¡©e_â_t
è(
	tÃt
 *,

81 cÚ¡ 
	tsùp_’dpošt
 *,

82 cÚ¡ 
	tsùp_assocŸtiÚ
 *,

83 cÚ¡ 
	tsùp_subty³_t
 
	tty³
,

84 *
	t¬g
,

85 
	tsùp_cmd_£q_t
 *);

86 (
	tsùp_tim”_ev’t_t
) ();

88 
sùp_¡©e_â_t
 *
â
;

89 cÚ¡ *
Çme
;

90 } 
	tsùp_sm_bË_’Œy_t
;

97 
sùp_¡©e_â_t
 
sùp_sf_nÙ_im¶
;

98 
sùp_¡©e_â_t
 
sùp_sf_bug
;

101 
sùp_¡©e_â_t
 
sùp_sf_tim”_ignÜe
;

104 
sùp_¡©e_â_t
 
sùp_sf_do_9_1_abÜt
;

105 
sùp_¡©e_â_t
 
sùp_sf_cook›_wa™_abÜt
;

106 
sùp_¡©e_â_t
 
sùp_sf_cook›_echÛd_abÜt
;

107 
sùp_¡©e_â_t
 
sùp_sf_shutdown_³ndšg_abÜt
;

108 
sùp_¡©e_â_t
 
sùp_sf_shutdown_£Á_abÜt
;

109 
sùp_¡©e_â_t
 
sùp_sf_shutdown_ack_£Á_abÜt
;

110 
sùp_¡©e_â_t
 
sùp_sf_do_5_1B_š™
;

111 
sùp_¡©e_â_t
 
sùp_sf_do_5_1C_ack
;

112 
sùp_¡©e_â_t
 
sùp_sf_do_5_1D_û
;

113 
sùp_¡©e_â_t
 
sùp_sf_do_5_1E_ÿ
;

114 
sùp_¡©e_â_t
 
sùp_sf_do_4_C
;

115 
sùp_¡©e_â_t
 
sùp_sf_—t_d©a_6_2
;

116 
sùp_¡©e_â_t
 
sùp_sf_—t_d©a_ç¡_4_4
;

117 
sùp_¡©e_â_t
 
sùp_sf_—t_§ck_6_2
;

118 
sùp_¡©e_â_t
 
sùp_sf_İ”r_nÙify
;

119 
sùp_¡©e_â_t
 
sùp_sf_t1_š™_tim”_expœe
;

120 
sùp_¡©e_â_t
 
sùp_sf_t1_cook›_tim”_expœe
;

121 
sùp_¡©e_â_t
 
sùp_sf_t2_tim”_expœe
;

122 
sùp_¡©e_â_t
 
sùp_sf_t4_tim”_expœe
;

123 
sùp_¡©e_â_t
 
sùp_sf_t5_tim”_expœe
;

124 
sùp_¡©e_â_t
 
sùp_sf_£ndb—t_8_3
;

125 
sùp_¡©e_â_t
 
sùp_sf_b—t_8_3
;

126 
sùp_¡©e_â_t
 
sùp_sf_backb—t_8_3
;

127 
sùp_¡©e_â_t
 
sùp_sf_do_9_2_fš®
;

128 
sùp_¡©e_â_t
 
sùp_sf_do_9_2_shutdown
;

129 
sùp_¡©e_â_t
 
sùp_sf_do_9_2_shut_ù¢
;

130 
sùp_¡©e_â_t
 
sùp_sf_do_eú_cwr
;

131 
sùp_¡©e_â_t
 
sùp_sf_do_eúe
;

132 
sùp_¡©e_â_t
 
sùp_sf_oÙb
;

133 
sùp_¡©e_â_t
 
sùp_sf_pdisÿrd
;

134 
sùp_¡©e_â_t
 
sùp_sf_viŞ©iÚ
;

135 
sùp_¡©e_â_t
 
sùp_sf_disÿrd_chunk
;

136 
sùp_¡©e_â_t
 
sùp_sf_do_5_2_1_simš™
;

137 
sùp_¡©e_â_t
 
sùp_sf_do_5_2_2_dupš™
;

138 
sùp_¡©e_â_t
 
sùp_sf_do_5_2_3_š™ack
;

139 
sùp_¡©e_â_t
 
sùp_sf_do_5_2_4_dupcook
;

140 
sùp_¡©e_â_t
 
sùp_sf_unk_chunk
;

141 
sùp_¡©e_â_t
 
sùp_sf_do_8_5_1_E_§
;

142 
sùp_¡©e_â_t
 
sùp_sf_cook›_echÛd_”r
;

143 
sùp_¡©e_â_t
 
sùp_sf_do_ascÚf
;

144 
sùp_¡©e_â_t
 
sùp_sf_do_ascÚf_ack
;

145 
sùp_¡©e_â_t
 
sùp_sf_do_9_2_»shuck
;

146 
sùp_¡©e_â_t
 
sùp_sf_—t_fwd_t¢
;

147 
sùp_¡©e_â_t
 
sùp_sf_—t_fwd_t¢_ç¡
;

148 
sùp_¡©e_â_t
 
sùp_sf_—t_auth
;

151 
sùp_¡©e_â_t
 
sùp_sf_do_´m_asoc
;

152 
sùp_¡©e_â_t
 
sùp_sf_do_´m_£nd
;

153 
sùp_¡©e_â_t
 
sùp_sf_do_9_2_´m_shutdown
;

154 
sùp_¡©e_â_t
 
sùp_sf_cook›_wa™_´m_shutdown
;

155 
sùp_¡©e_â_t
 
sùp_sf_cook›_echÛd_´m_shutdown
;

156 
sùp_¡©e_â_t
 
sùp_sf_do_9_1_´m_abÜt
;

157 
sùp_¡©e_â_t
 
sùp_sf_cook›_wa™_´m_abÜt
;

158 
sùp_¡©e_â_t
 
sùp_sf_cook›_echÛd_´m_abÜt
;

159 
sùp_¡©e_â_t
 
sùp_sf_shutdown_³ndšg_´m_abÜt
;

160 
sùp_¡©e_â_t
 
sùp_sf_shutdown_£Á_´m_abÜt
;

161 
sùp_¡©e_â_t
 
sùp_sf_shutdown_ack_£Á_´m_abÜt
;

162 
sùp_¡©e_â_t
 
sùp_sf_”rÜ_şo£d
;

163 
sùp_¡©e_â_t
 
sùp_sf_”rÜ_shutdown
;

164 
sùp_¡©e_â_t
 
sùp_sf_ignÜe_´im™ive
;

165 
sùp_¡©e_â_t
 
sùp_sf_do_´m_»que¡h—¹b—t
;

166 
sùp_¡©e_â_t
 
sùp_sf_do_´m_ascÚf
;

169 
sùp_¡©e_â_t
 
sùp_sf_do_no_³ndšg_t¢
;

170 
sùp_¡©e_â_t
 
sùp_sf_do_9_2_¡¬t_shutdown
;

171 
sùp_¡©e_â_t
 
sùp_sf_do_9_2_shutdown_ack
;

172 
sùp_¡©e_â_t
 
sùp_sf_ignÜe_Ùh”
;

173 
sùp_¡©e_â_t
 
sùp_sf_cook›_wa™_icmp_abÜt
;

176 
sùp_¡©e_â_t
 
sùp_sf_do_6_3_3_¹x
;

177 
sùp_¡©e_â_t
 
sùp_sf_do_6_2_§ck
;

178 
sùp_¡©e_â_t
 
sùp_sf_autoşo£_tim”_expœe
;

181 
__u8
 
	`sùp_g‘_chunk_ty³
(
sùp_chunk
 *
chunk
);

182 cÚ¡ 
sùp_sm_bË_’Œy_t
 *
	`sùp_sm_lookup_ev’t
(
Ãt
 *,

183 
sùp_ev’t_t
,

184 
sùp_¡©e_t
,

185 
sùp_subty³_t
);

186 
	`sùp_chunk_iif
(cÚ¡ 
sùp_chunk
 *);

187 
sùp_assocŸtiÚ
 *
	`sùp_make_‹mp_asoc
(cÚ¡ 
sùp_’dpošt
 *,

188 
sùp_chunk
 *,

189 
gå_t
 
gå
);

190 
__u32
 
	`sùp_g’”©e_v”ifiÿtiÚ_g
();

191 
	`sùp_pİuÏ‹_t›_gs
(
__u8
 *
cook›
, 
__u32
 
curTag
, __u32 
hisTag
);

194 
sùp_chunk
 *
	`sùp_make_š™
(cÚ¡ 
sùp_assocŸtiÚ
 *,

195 cÚ¡ 
sùp_bšd_addr
 *,

196 
gå_t
 
gå
, 
v·¿m_Ën
);

197 
sùp_chunk
 *
	`sùp_make_š™_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *,

198 cÚ¡ 
sùp_chunk
 *,

199 cÚ¡ 
gå_t
 
gå
,

200 cÚ¡ 
unk·¿m_Ën
);

201 
sùp_chunk
 *
	`sùp_make_cook›_echo
(cÚ¡ 
sùp_assocŸtiÚ
 *,

202 cÚ¡ 
sùp_chunk
 *);

203 
sùp_chunk
 *
	`sùp_make_cook›_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *,

204 cÚ¡ 
sùp_chunk
 *);

205 
sùp_chunk
 *
	`sùp_make_cwr
(cÚ¡ 
sùp_assocŸtiÚ
 *,

206 cÚ¡ 
__u32
 
lowe¡_t¢
,

207 cÚ¡ 
sùp_chunk
 *);

208 
sùp_chunk
 * 
	`sùp_make_d©aäag_em±y
(
sùp_assocŸtiÚ
 *,

209 cÚ¡ 
sùp_¢drcvšfo
 *
sšfo
,

210 
Ën
, cÚ¡ 
__u8
 
æags
,

211 
__u16
 
s¢
);

212 
sùp_chunk
 *
	`sùp_make_eúe
(cÚ¡ 
sùp_assocŸtiÚ
 *,

213 cÚ¡ 
__u32
);

214 
sùp_chunk
 *
	`sùp_make_§ck
(cÚ¡ 
sùp_assocŸtiÚ
 *);

215 
sùp_chunk
 *
	`sùp_make_shutdown
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

216 cÚ¡ 
sùp_chunk
 *
chunk
);

217 
sùp_chunk
 *
	`sùp_make_shutdown_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

218 cÚ¡ 
sùp_chunk
 *);

219 
sùp_chunk
 *
	`sùp_make_shutdown_com¶‘e
(cÚ¡ 
sùp_assocŸtiÚ
 *,

220 cÚ¡ 
sùp_chunk
 *);

221 
	`sùp_š™_ÿu£
(
sùp_chunk
 *, 
__be16
 
ÿu£
, 
size_t
);

222 
sùp_chunk
 *
	`sùp_make_abÜt
(cÚ¡ 
sùp_assocŸtiÚ
 *,

223 cÚ¡ 
sùp_chunk
 *,

224 cÚ¡ 
size_t
 
hšt
);

225 
sùp_chunk
 *
	`sùp_make_abÜt_no_d©a
(cÚ¡ 
sùp_assocŸtiÚ
 *,

226 cÚ¡ 
sùp_chunk
 *,

227 
__u32
 
t¢
);

228 
sùp_chunk
 *
	`sùp_make_abÜt_u£r
(cÚ¡ 
sùp_assocŸtiÚ
 *,

229 cÚ¡ 
msghdr
 *, 
size_t
 
msg_Ën
);

230 
sùp_chunk
 *
	`sùp_make_abÜt_viŞ©iÚ
(cÚ¡ 
sùp_assocŸtiÚ
 *,

231 cÚ¡ 
sùp_chunk
 *,

232 cÚ¡ 
__u8
 *,

233 cÚ¡ 
size_t
 );

234 
sùp_chunk
 *
	`sùp_make_viŞ©iÚ_·¿mËn
(cÚ¡ 
sùp_assocŸtiÚ
 *,

235 cÚ¡ 
sùp_chunk
 *,

236 
sùp_·¿mhdr
 *);

237 
sùp_chunk
 *
	`sùp_make_viŞ©iÚ_max_»Œªs
(cÚ¡ 
sùp_assocŸtiÚ
 *,

238 cÚ¡ 
sùp_chunk
 *);

239 
sùp_chunk
 *
	`sùp_make_h—¹b—t
(cÚ¡ 
sùp_assocŸtiÚ
 *,

240 cÚ¡ 
sùp_Œª¥Üt
 *);

241 
sùp_chunk
 *
	`sùp_make_h—¹b—t_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *,

242 cÚ¡ 
sùp_chunk
 *,

243 cÚ¡ *
·ylßd
,

244 cÚ¡ 
size_t
 
·yËn
);

245 
sùp_chunk
 *
	`sùp_make_İ_”rÜ
(cÚ¡ 
sùp_assocŸtiÚ
 *,

246 cÚ¡ 
sùp_chunk
 *
chunk
,

247 
__be16
 
ÿu£_code
,

248 cÚ¡ *
·ylßd
,

249 
size_t
 
·yËn
,

250 
size_t
 
»£rve_
);

252 
sùp_chunk
 *
	`sùp_make_ascÚf_upd©e_
(
sùp_assocŸtiÚ
 *,

253 
sùp_addr
 *,

254 
sockaddr
 *,

255 , 
__be16
);

256 
sùp_chunk
 *
	`sùp_make_ascÚf_£t_´im
(
sùp_assocŸtiÚ
 *
asoc
,

257 
sùp_addr
 *
addr
);

258 
	`sùp_v”ify_ascÚf
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

259 
sùp_·¿mhdr
 *
·¿m_hdr
, *
chunk_’d
,

260 
sùp_·¿mhdr
 **
”½
);

261 
sùp_chunk
 *
	`sùp_´oûss_ascÚf
(
sùp_assocŸtiÚ
 *
asoc
,

262 
sùp_chunk
 *
ascÚf
);

263 
	`sùp_´oûss_ascÚf_ack
(
sùp_assocŸtiÚ
 *
asoc
,

264 
sùp_chunk
 *
ascÚf_ack
);

265 
sùp_chunk
 *
	`sùp_make_fwdt¢
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

266 
__u32
 
Ãw_cum_t¢
, 
size_t
 
n¡»ams
,

267 
sùp_fwdt¢_sk
 *
skli¡
);

268 
sùp_chunk
 *
	`sùp_make_auth
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
);

270 
	`sùp_chunk_assign_t¢
(
sùp_chunk
 *);

271 
	`sùp_chunk_assign_s¢
(
sùp_chunk
 *);

275 
	`sùp_do_sm
(
Ãt
 *Ãt, 
sùp_ev’t_t
 
ev’t_ty³
, 
sùp_subty³_t
 
subty³
,

276 
sùp_¡©e_t
 
¡©e
,

277 
sùp_’dpošt
 *,

278 
sùp_assocŸtiÚ
 *
asoc
,

279 *
ev’t_¬g
,

280 
gå_t
 
gå
);

283 
	`sùp_g’”©e_t3_¹x_ev’t
(
³”
);

284 
	`sùp_g’”©e_h—¹b—t_ev’t
(
³”
);

285 
	`sùp_g’”©e_´Ùo_uÄ—ch_ev’t
(
³”
);

287 
	`sùp_oÙb_pkt_ä“
(
sùp_·ck‘
 *);

289 
sùp_assocŸtiÚ
 *
	`sùp_uÅack_cook›
(cÚ¡ 
sùp_’dpošt
 *,

290 cÚ¡ 
sùp_assocŸtiÚ
 *,

291 
sùp_chunk
 *,

292 
gå_t
 
gå
, *
”r
,

293 
sùp_chunk
 **
”r_chk_p
);

294 
	`sùp_add_addr_cÚfig
(
sùp_assocŸtiÚ
 *, 
sùp_·¿m_t
,

295 
sockaddr_¡Üage
*, );

298 
__u32
 
	`sùp_g’”©e_g
(cÚ¡ 
sùp_’dpošt
 *);

299 
__u32
 
	`sùp_g’”©e_t¢
(cÚ¡ 
sùp_’dpošt
 *);

302 
sùp_tim”_ev’t_t
 *
sùp_tim”_ev’ts
[
SCTP_NUM_TIMEOUT_TYPES
];

306 
šlše
 
__u16
 
	$sùp_d©a_size
(
sùp_chunk
 *
chunk
)

308 
__u16
 
size
;

310 
size
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

311 
size
 -ğ(
sùp_d©a_chunk_t
);

313  
size
;

314 
	}
}

346 
	mTSN_SIGN_BIT
 = (1<<31)

349 
šlše
 
	$TSN_É
(
__u32
 
s
, __u32 
t
)

351  ((
s
è- (
t
)è& 
TSN_SIGN_BIT
;

352 
	}
}

354 
šlše
 
	$TSN_Ée
(
__u32
 
s
, __u32 
t
)

356  ((
s
è=ğ(
t
)è|| (((sè- (t)è& 
TSN_SIGN_BIT
);

357 
	}
}

370 
	mSSN_SIGN_BIT
 = (1<<15)

373 
šlše
 
	$SSN_É
(
__u16
 
s
, __u16 
t
)

375  ((
s
è- (
t
)è& 
SSN_SIGN_BIT
;

376 
	}
}

378 
šlše
 
	$SSN_Ée
(
__u16
 
s
, __u16 
t
)

380  ((
s
è=ğ(
t
)è|| (((sè- (t)è& 
SSN_SIGN_BIT
);

381 
	}
}

389 
	mADDIP_SERIAL_SIGN_BIT
 = (1<<31)

392 
šlše
 
	$ADDIP_SERIAL_g‹
(
__u16
 
s
, __u16 
t
)

394  ((
s
è=ğ(
t
)è|| ((Ñè- (s)è& 
ADDIP_SERIAL_SIGN_BIT
);

395 
	}
}

398 
šlše
 

399 
	$sùp_vg_v”ify
(cÚ¡ 
sùp_chunk
 *
chunk
,

400 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

408 ià(
	`Áohl
(
chunk
->
sùp_hdr
->
vg
è=ğ
asoc
->
c
.
my_vg
)

412 
	}
}

417 
šlše
 

418 
	$sùp_vg_v”ify_e™h”
(cÚ¡ 
sùp_chunk
 *
chunk
,

419 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

442 ià((!
	`sùp_‹¡_T_b™
(
chunk
) &&

443 (
	`Áohl
(
chunk
->
sùp_hdr
->
vg
è=ğ
asoc
->
c
.
my_vg
)) ||

444 (
	`sùp_‹¡_T_b™
(
chunk
è&& 
asoc
->
c
.
³”_vg
 &&

445 (
	`Áohl
(
chunk
->
sùp_hdr
->
vg
è=ğ
asoc
->
c
.
³”_vg
))) {

450 
	}
}

	@sm_make_chunk.c

53 
	~<lšux/ktime.h
>

54 
	~<lšux/ty³s.h
>

55 
	~<lšux/k”Ãl.h
>

56 
	~<lšux/.h
>

57 
	~<lšux/v6.h
>

58 
	~<lšux/Ãt.h
>

59 
	~<lšux/š‘.h
>

60 
	~<lšux/sÿ‰”li¡.h
>

61 
	~<lšux/üy±o.h
>

62 
	~<Ãt/sock.h
>

64 
	~<lšux/skbuff.h
>

65 
	~<lšux/¿ndom.h
>

66 
	~<Ãt/sùp/sùp.h
>

67 
	~<Ãt/sùp/sm.h
>

69 
SCTP_STATIC


70 
sùp_chunk
 *
sùp_make_chunk
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

71 
__u8
 
ty³
, __u8 
æags
, 
·yËn
);

72 
sùp_cook›_·¿m_t
 *
sùp_·ck_cook›
(cÚ¡ 
sùp_’dpošt
 *
•
,

73 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

74 cÚ¡ 
sùp_chunk
 *
š™_chunk
,

75 *
cook›_Ën
,

76 cÚ¡ 
__u8
 *
¿w_addrs
, 
addrs_Ën
);

77 
sùp_´oûss_·¿m
(
sùp_assocŸtiÚ
 *
asoc
,

78 
sùp_·¿ms
 
·¿m
,

79 cÚ¡ 
sùp_addr
 *
³”_addr
,

80 
gå_t
 
gå
);

81 *
sùp_addto_·¿m
(
sùp_chunk
 *
chunk
, 
Ën
,

82 cÚ¡ *
d©a
);

85 
	$sùp_chunk_iif
(cÚ¡ 
sùp_chunk
 *
chunk
)

87 
sùp_af
 *
af
;

88 
iif
 = 0;

90 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`v”2af
(
	`_hdr
(
chunk
->
skb
)->
v”siÚ
));

91 ià(
af
)

92 
iif
 = 
af
->
	`skb_iif
(
chunk
->
skb
);

94  
iif
;

95 
	}
}

102 cÚ¡ 
sùp_·¿mhdr
 
	geÿp_·¿m
 = {

103 
SCTP_PARAM_ECN_CAPABLE
,

104 
ıu_to_be16
((
sùp_·¿mhdr
)),

106 cÚ¡ 
sùp_·¿mhdr
 
	g´sùp_·¿m
 = {

107 
SCTP_PARAM_FWD_TSN_SUPPORT
,

108 
ıu_to_be16
((
sùp_·¿mhdr
)),

115 
	$sùp_š™_ÿu£
(
sùp_chunk
 *
chunk
, 
__be16
 
ÿu£_code
,

116 
size_t
 
·yËn
)

118 
sùp_”rhdr_t
 
”r
;

119 
__u16
 
Ën
;

122 
”r
.
ÿu£
 = 
ÿu£_code
;

123 
Ën
 = (
sùp_”rhdr_t
è+ 
·yËn
;

124 
”r
.
Ëngth
 = 
	`htÚs
(
Ën
);

125 
chunk
->
subh
.
”r_hdr
 = 
	`sùp_addto_chunk
(chunk, (
sùp_”rhdr_t
), &
”r
);

126 
	}
}

133 
	$sùp_š™_ÿu£_fixed
(
sùp_chunk
 *
chunk
, 
__be16
 
ÿu£_code
,

134 
size_t
 
·yËn
)

136 
sùp_”rhdr_t
 
”r
;

137 
__u16
 
Ën
;

140 
”r
.
ÿu£
 = 
ÿu£_code
;

141 
Ën
 = (
sùp_”rhdr_t
è+ 
·yËn
;

142 
”r
.
Ëngth
 = 
	`htÚs
(
Ën
);

144 ià(
	`skb_room
(
chunk
->
skb
è< 
Ën
)

145  -
ENOSPC
;

146 
chunk
->
subh
.
”r_hdr
 = 
	`sùp_addto_chunk_fixed
(chunk,

147 (
sùp_”rhdr_t
),

148 &
”r
);

150 
	}
}

195 
sùp_chunk
 *
	$sùp_make_š™
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

196 cÚ¡ 
sùp_bšd_addr
 *
bp
,

197 
gå_t
 
gå
, 
v·¿m_Ën
)

199 
sùp_š™hdr_t
 
š™
;

200 
sùp_·¿ms
 
addrs
;

201 
size_t
 
chunksize
;

202 
sùp_chunk
 *
»tv®
 = 
NULL
;

203 
num_ty³s
, 
addrs_Ën
 = 0;

204 
sùp_sock
 *
¥
;

205 
sùp_suµÜ‹d_addrs_·¿m_t
 
§t
;

206 
__be16
 
ty³s
[2];

207 
sùp_ad­tiÚ_šd_·¿m_t
 
a¬am
;

208 
sùp_suµÜ‹d_ext_·¿m_t
 
ext_·¿m
;

209 
num_ext
 = 0;

210 
__u8
 
ex‹nsiÚs
[3];

211 
sùp_·¿mhdr_t
 *
auth_chunks
 = 
NULL
,

212 *
auth_hmacs
 = 
NULL
;

219 
»tv®
 = 
NULL
;

222 
addrs
 = 
	`sùp_bšd_addrs_to_¿w
(
bp
, &
addrs_Ën
, 
gå
);

224 
š™
.
š™_g
 = 
	`htÚl
(
asoc
->
c
.
my_vg
);

225 
š™
.
a_rwnd
 = 
	`htÚl
(
asoc
->
rwnd
);

226 
š™
.
num_outbound_¡»ams
 = 
	`htÚs
(
asoc
->
c
.
sš™_num_o¡»ams
);

227 
š™
.
num_šbound_¡»ams
 = 
	`htÚs
(
asoc
->
c
.
sš™_max_š¡»ams
);

228 
š™
.
š™Ÿl_t¢
 = 
	`htÚl
(
asoc
->
c
.initial_tsn);

231 
¥
 = 
	`sùp_sk
(
asoc
->
ba£
.
sk
);

232 
num_ty³s
 = 
¥
->
pf
->
	`suµÜ‹d_addrs
(¥, 
ty³s
);

234 
chunksize
 = (
š™
è+ 
addrs_Ën
;

235 
chunksize
 +ğ
	`WORD_ROUND
(
	`SCTP_SAT_LEN
(
num_ty³s
));

236 
chunksize
 +ğ(
eÿp_·¿m
);

238 ià(
sùp_´sùp_’abË
)

239 
chunksize
 +ğ(
´sùp_·¿m
);

246 ià(
sùp_add_’abË
) {

247 
ex‹nsiÚs
[
num_ext
] = 
SCTP_CID_ASCONF
;

248 
ex‹nsiÚs
[
num_ext
+1] = 
SCTP_CID_ASCONF_ACK
;

249 
num_ext
 += 2;

252 ià(
¥
->
ad­tiÚ_šd
)

253 
chunksize
 +ğ(
a¬am
);

255 
chunksize
 +ğ
v·¿m_Ën
;

258 ià(
sùp_auth_’abË
) {

260 
chunksize
 +ğ(
asoc
->
c
.
auth_¿ndom
);

263 
auth_hmacs
 = (
sùp_·¿mhdr_t
 *)
asoc
->
c
.auth_hmacs;

264 ià(
auth_hmacs
->
Ëngth
)

265 
chunksize
 +ğ
	`WORD_ROUND
(
	`Áohs
(
auth_hmacs
->
Ëngth
));

267 
auth_hmacs
 = 
NULL
;

270 
auth_chunks
 = (
sùp_·¿mhdr_t
 *)
asoc
->
c
.auth_chunks;

271 ià(
auth_chunks
->
Ëngth
)

272 
chunksize
 +ğ
	`WORD_ROUND
(
	`Áohs
(
auth_chunks
->
Ëngth
));

274 
auth_chunks
 = 
NULL
;

276 
ex‹nsiÚs
[
num_ext
] = 
SCTP_CID_AUTH
;

277 
num_ext
 += 1;

281 ià(
num_ext
)

282 
chunksize
 +ğ
	`WORD_ROUND
((
sùp_suµÜ‹d_ext_·¿m_t
) +

283 
num_ext
);

297 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_INIT
, 0, 
chunksize
);

298 ià(!
»tv®
)

299 
nod©a
;

301 
»tv®
->
subh
.
š™_hdr
 =

302 
	`sùp_addto_chunk
(
»tv®
, (
š™
), &init);

303 
»tv®
->
·¿m_hdr
.
v
 =

304 
	`sùp_addto_chunk
(
»tv®
, 
addrs_Ën
, 
addrs
.
v
);

313 
§t
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_SUPPORTED_ADDRESS_TYPES
;

314 
§t
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
(
	`SCTP_SAT_LEN
(
num_ty³s
));

315 
	`sùp_addto_chunk
(
»tv®
, (
§t
), &sat);

316 
	`sùp_addto_chunk
(
»tv®
, 
num_ty³s
 * (
__u16
), &
ty³s
);

318 
	`sùp_addto_chunk
(
»tv®
, (
eÿp_·¿m
), &ecap_param);

323 ià(
num_ext
) {

324 
ext_·¿m
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_SUPPORTED_EXT
;

325 
ext_·¿m
.
·¿m_hdr
.
Ëngth
 =

326 
	`htÚs
((
sùp_suµÜ‹d_ext_·¿m_t
è+ 
num_ext
);

327 
	`sùp_addto_chunk
(
»tv®
, (
sùp_suµÜ‹d_ext_·¿m_t
),

328 &
ext_·¿m
);

329 
	`sùp_addto_·¿m
(
»tv®
, 
num_ext
, 
ex‹nsiÚs
);

332 ià(
sùp_´sùp_’abË
)

333 
	`sùp_addto_chunk
(
»tv®
, (
´sùp_·¿m
), &prsctp_param);

335 ià(
¥
->
ad­tiÚ_šd
) {

336 
a¬am
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_ADAPTATION_LAYER_IND
;

337 
a¬am
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
((aiparam));

338 
a¬am
.
ad­tiÚ_šd
 = 
	`htÚl
(
¥
->adaptation_ind);

339 
	`sùp_addto_chunk
(
»tv®
, (
a¬am
), &aiparam);

343 ià(
sùp_auth_’abË
) {

344 
	`sùp_addto_chunk
(
»tv®
, (
asoc
->
c
.
auth_¿ndom
),

345 
asoc
->
c
.
auth_¿ndom
);

346 ià(
auth_hmacs
)

347 
	`sùp_addto_chunk
(
»tv®
, 
	`Áohs
(
auth_hmacs
->
Ëngth
),

348 
auth_hmacs
);

349 ià(
auth_chunks
)

350 
	`sùp_addto_chunk
(
»tv®
, 
	`Áohs
(
auth_chunks
->
Ëngth
),

351 
auth_chunks
);

353 
nod©a
:

354 
	`kä“
(
addrs
.
v
);

355  
»tv®
;

356 
	}
}

358 
sùp_chunk
 *
	$sùp_make_š™_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

359 cÚ¡ 
sùp_chunk
 *
chunk
,

360 
gå_t
 
gå
, 
unk·¿m_Ën
)

362 
sùp_š™hdr_t
 
š™ack
;

363 
sùp_chunk
 *
»tv®
;

364 
sùp_·¿ms
 
addrs
;

365 
sùp_sock
 *
¥
;

366 
addrs_Ën
;

367 
sùp_cook›_·¿m_t
 *
cook›
;

368 
cook›_Ën
;

369 
size_t
 
chunksize
;

370 
sùp_ad­tiÚ_šd_·¿m_t
 
a¬am
;

371 
sùp_suµÜ‹d_ext_·¿m_t
 
ext_·¿m
;

372 
num_ext
 = 0;

373 
__u8
 
ex‹nsiÚs
[3];

374 
sùp_·¿mhdr_t
 *
auth_chunks
 = 
NULL
,

375 *
auth_hmacs
 = 
NULL
,

376 *
auth_¿ndom
 = 
NULL
;

378 
»tv®
 = 
NULL
;

381 
addrs
 = 
	`sùp_bšd_addrs_to_¿w
(&
asoc
->
ba£
.
bšd_addr
, &
addrs_Ën
, 
gå
);

383 
š™ack
.
š™_g
 = 
	`htÚl
(
asoc
->
c
.
my_vg
);

384 
š™ack
.
a_rwnd
 = 
	`htÚl
(
asoc
->
rwnd
);

385 
š™ack
.
num_outbound_¡»ams
 = 
	`htÚs
(
asoc
->
c
.
sš™_num_o¡»ams
);

386 
š™ack
.
num_šbound_¡»ams
 = 
	`htÚs
(
asoc
->
c
.
sš™_max_š¡»ams
);

387 
š™ack
.
š™Ÿl_t¢
 = 
	`htÚl
(
asoc
->
c
.initial_tsn);

392 
cook›
 = 
	`sùp_·ck_cook›
(
asoc
->
•
,‡soc, 
chunk
, &
cook›_Ën
,

393 
addrs
.
v
, 
addrs_Ën
);

394 ià(!
cook›
)

395 
nomem_cook›
;

400 
¥
 = 
	`sùp_sk
(
asoc
->
ba£
.
sk
);

401 
chunksize
 = (
š™ack
è+ 
addrs_Ën
 + 
cook›_Ën
 + 
unk·¿m_Ën
;

404 ià(
asoc
->
³”
.
eú_ÿ·bË
)

405 
chunksize
 +ğ(
eÿp_·¿m
);

407 ià(
asoc
->
³”
.
´sùp_ÿ·bË
)

408 
chunksize
 +ğ(
´sùp_·¿m
);

410 ià(
asoc
->
³”
.
ascÚf_ÿ·bË
) {

411 
ex‹nsiÚs
[
num_ext
] = 
SCTP_CID_ASCONF
;

412 
ex‹nsiÚs
[
num_ext
+1] = 
SCTP_CID_ASCONF_ACK
;

413 
num_ext
 += 2;

416 ià(
¥
->
ad­tiÚ_šd
)

417 
chunksize
 +ğ(
a¬am
);

419 ià(
asoc
->
³”
.
auth_ÿ·bË
) {

420 
auth_¿ndom
 = (
sùp_·¿mhdr_t
 *)
asoc
->
c
.auth_random;

421 
chunksize
 +ğ
	`Áohs
(
auth_¿ndom
->
Ëngth
);

423 
auth_hmacs
 = (
sùp_·¿mhdr_t
 *)
asoc
->
c
.auth_hmacs;

424 ià(
auth_hmacs
->
Ëngth
)

425 
chunksize
 +ğ
	`WORD_ROUND
(
	`Áohs
(
auth_hmacs
->
Ëngth
));

427 
auth_hmacs
 = 
NULL
;

429 
auth_chunks
 = (
sùp_·¿mhdr_t
 *)
asoc
->
c
.auth_chunks;

430 ià(
auth_chunks
->
Ëngth
)

431 
chunksize
 +ğ
	`WORD_ROUND
(
	`Áohs
(
auth_chunks
->
Ëngth
));

433 
auth_chunks
 = 
NULL
;

435 
ex‹nsiÚs
[
num_ext
] = 
SCTP_CID_AUTH
;

436 
num_ext
 += 1;

439 ià(
num_ext
)

440 
chunksize
 +ğ
	`WORD_ROUND
((
sùp_suµÜ‹d_ext_·¿m_t
) +

441 
num_ext
);

444 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_INIT_ACK
, 0, 
chunksize
);

445 ià(!
»tv®
)

446 
nomem_chunk
;

451 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

452 
»tv®
->
subh
.
š™_hdr
 =

453 
	`sùp_addto_chunk
(
»tv®
, (
š™ack
), &initack);

454 
»tv®
->
·¿m_hdr
.
v
 = 
	`sùp_addto_chunk
Ô‘v®, 
addrs_Ën
, 
addrs
.v);

455 
	`sùp_addto_chunk
(
»tv®
, 
cook›_Ën
, 
cook›
);

456 ià(
asoc
->
³”
.
eú_ÿ·bË
)

457 
	`sùp_addto_chunk
(
»tv®
, (
eÿp_·¿m
), &ecap_param);

458 ià(
num_ext
) {

459 
ext_·¿m
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_SUPPORTED_EXT
;

460 
ext_·¿m
.
·¿m_hdr
.
Ëngth
 =

461 
	`htÚs
((
sùp_suµÜ‹d_ext_·¿m_t
è+ 
num_ext
);

462 
	`sùp_addto_chunk
(
»tv®
, (
sùp_suµÜ‹d_ext_·¿m_t
),

463 &
ext_·¿m
);

464 
	`sùp_addto_·¿m
(
»tv®
, 
num_ext
, 
ex‹nsiÚs
);

466 ià(
asoc
->
³”
.
´sùp_ÿ·bË
)

467 
	`sùp_addto_chunk
(
»tv®
, (
´sùp_·¿m
), &prsctp_param);

469 ià(
¥
->
ad­tiÚ_šd
) {

470 
a¬am
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_ADAPTATION_LAYER_IND
;

471 
a¬am
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
((aiparam));

472 
a¬am
.
ad­tiÚ_šd
 = 
	`htÚl
(
¥
->adaptation_ind);

473 
	`sùp_addto_chunk
(
»tv®
, (
a¬am
), &aiparam);

476 ià(
asoc
->
³”
.
auth_ÿ·bË
) {

477 
	`sùp_addto_chunk
(
»tv®
, 
	`Áohs
(
auth_¿ndom
->
Ëngth
),

478 
auth_¿ndom
);

479 ià(
auth_hmacs
)

480 
	`sùp_addto_chunk
(
»tv®
, 
	`Áohs
(
auth_hmacs
->
Ëngth
),

481 
auth_hmacs
);

482 ià(
auth_chunks
)

483 
	`sùp_addto_chunk
(
»tv®
, 
	`Áohs
(
auth_chunks
->
Ëngth
),

484 
auth_chunks
);

488 
»tv®
->
asoc
 = (
sùp_assocŸtiÚ
 *)‡soc;

499 ià(
chunk
)

500 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

502 
nomem_chunk
:

503 
	`kä“
(
cook›
);

504 
nomem_cook›
:

505 
	`kä“
(
addrs
.
v
);

506  
»tv®
;

507 
	}
}

543 
sùp_chunk
 *
	$sùp_make_cook›_echo
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

544 cÚ¡ 
sùp_chunk
 *
chunk
)

546 
sùp_chunk
 *
»tv®
;

547 *
cook›
;

548 
cook›_Ën
;

550 
cook›
 = 
asoc
->
³”
.cookie;

551 
cook›_Ën
 = 
asoc
->
³”
.cookie_len;

554 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_COOKIE_ECHO
, 0, 
cook›_Ën
);

555 ià(!
»tv®
)

556 
nod©a
;

557 
»tv®
->
subh
.
cook›_hdr
 =

558 
	`sùp_addto_chunk
(
»tv®
, 
cook›_Ën
, 
cook›
);

569 ià(
chunk
)

570 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

572 
nod©a
:

573  
»tv®
;

574 
	}
}

594 
sùp_chunk
 *
	$sùp_make_cook›_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

595 cÚ¡ 
sùp_chunk
 *
chunk
)

597 
sùp_chunk
 *
»tv®
;

599 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_COOKIE_ACK
, 0, 0);

610 ià(
»tv®
 && 
chunk
)

611 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

613  
»tv®
;

614 
	}
}

639 
sùp_chunk
 *
	$sùp_make_cwr
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

640 cÚ¡ 
__u32
 
lowe¡_t¢
,

641 cÚ¡ 
sùp_chunk
 *
chunk
)

643 
sùp_chunk
 *
»tv®
;

644 
sùp_cwrhdr_t
 
cwr
;

646 
cwr
.
lowe¡_t¢
 = 
	`htÚl
(lowest_tsn);

647 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_ECN_CWR
, 0,

648 (
sùp_cwrhdr_t
));

650 ià(!
»tv®
)

651 
nod©a
;

653 
»tv®
->
subh
.
eú_cwr_hdr
 =

654 
	`sùp_addto_chunk
(
»tv®
, (
cwr
), &cwr);

666 ià(
chunk
)

667 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

669 
nod©a
:

670  
»tv®
;

671 
	}
}

674 
sùp_chunk
 *
	$sùp_make_eúe
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

675 cÚ¡ 
__u32
 
lowe¡_t¢
)

677 
sùp_chunk
 *
»tv®
;

678 
sùp_eúehdr_t
 
eúe
;

680 
eúe
.
lowe¡_t¢
 = 
	`htÚl
(lowest_tsn);

681 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_ECN_ECNE
, 0,

682 (
sùp_eúehdr_t
));

683 ià(!
»tv®
)

684 
nod©a
;

685 
»tv®
->
subh
.
eúe_hdr
 =

686 
	`sùp_addto_chunk
(
»tv®
, (
eúe
), &ecne);

688 
nod©a
:

689  
»tv®
;

690 
	}
}

695 
sùp_chunk
 *
	$sùp_make_d©aäag_em±y
(
sùp_assocŸtiÚ
 *
asoc
,

696 cÚ¡ 
sùp_¢drcvšfo
 *
sšfo
,

697 
d©a_Ën
, 
__u8
 
æags
, 
__u16
 
s¢
)

699 
sùp_chunk
 *
»tv®
;

700 
sùp_d©ahdr
 
dp
;

701 
chunk_Ën
;

706 
dp
.
t¢
 = 0;

707 
dp
.
¡»am
 = 
	`htÚs
(
sšfo
->
sšfo_¡»am
);

708 
dp
.
µid
 = 
sšfo
->
sšfo_µid
;

711 ià(
sšfo
->
sšfo_æags
 & 
SCTP_UNORDERED
) {

712 
æags
 |ğ
SCTP_DATA_UNORDERED
;

713 
dp
.
s¢
 = 0;

715 
dp
.
s¢
 = 
	`htÚs
(ssn);

717 
chunk_Ën
 = (
dp
è+ 
d©a_Ën
;

718 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_DATA
, 
æags
, 
chunk_Ën
);

719 ià(!
»tv®
)

720 
nod©a
;

722 
»tv®
->
subh
.
d©a_hdr
 = 
	`sùp_addto_chunk
Ô‘v®, (
dp
), &dp);

723 
	`memıy
(&
»tv®
->
sšfo
, sšfo, (
sùp_¢drcvšfo
));

725 
nod©a
:

726  
»tv®
;

727 
	}
}

733 
sùp_chunk
 *
	$sùp_make_§ck
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

735 
sùp_chunk
 *
»tv®
;

736 
sùp_§ckhdr
 
§ck
;

737 
Ën
;

738 
__u32
 
ù¢
;

739 
__u16
 
num_gabs
, 
num_dup_t¢s
;

740 
sùp_assocŸtiÚ
 *
­Œ
 = (sùp_assocŸtiÚ *)
asoc
;

741 
sùp_t¢m­
 *
m­
 = (sùp_t¢m­ *)&
asoc
->
³”
.
t¢_m­
;

742 
sùp_g­_ack_block
 
gabs
[
SCTP_MAX_GABS
];

743 
sùp_Œª¥Üt
 *
Œªs
;

745 
	`mem£t
(
gabs
, 0, (gabs));

746 
ù¢
 = 
	`sùp_t¢m­_g‘_ù¢
(
m­
);

747 
	`SCTP_DEBUG_PRINTK
("§ckCTSNAck s’t: 0x%x.\n", 
ù¢
);

750 
num_gabs
 = 
	`sùp_t¢m­_num_gabs
(
m­
, 
gabs
);

751 
num_dup_t¢s
 = 
	`sùp_t¢m­_num_dups
(
m­
);

754 
§ck
.
cum_t¢_ack
 = 
	`htÚl
(
ù¢
);

755 
§ck
.
a_rwnd
 = 
	`htÚl
(
asoc
->a_rwnd);

756 
§ck
.
num_g­_ack_blocks
 = 
	`htÚs
(
num_gabs
);

757 
§ck
.
num_dup_t¢s
 = 
	`htÚs
(num_dup_tsns);

759 
Ën
 = (
§ck
)

760 + (
sùp_g­_ack_block
è* 
num_gabs


761 + (
__u32
è* 
num_dup_t¢s
;

764 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_SACK
, 0, 
Ën
);

765 ià(!
»tv®
)

766 
nod©a
;

798 
»tv®
->
Œª¥Üt
 = 
asoc
->
³”
.
Ï¡_d©a_äom
;

800 
»tv®
->
subh
.
§ck_hdr
 =

801 
	`sùp_addto_chunk
(
»tv®
, (
§ck
), &sack);

804 ià(
num_gabs
)

805 
	`sùp_addto_chunk
(
»tv®
, (
__u32
è* 
num_gabs
,

806 
gabs
);

809 ià(
num_dup_t¢s
)

810 
	`sùp_addto_chunk
(
»tv®
, (
__u32
è* 
num_dup_t¢s
,

811 
	`sùp_t¢m­_g‘_dups
(
m­
));

821 ià(++
­Œ
->
³”
.
§ck_g’”©iÚ
 == 0) {

822 
	`li¡_fÜ_—ch_’Œy
(
Œªs
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

823 
Œª¥Üts
)

824 
Œªs
->
§ck_g’”©iÚ
 = 0;

825 
­Œ
->
³”
.
§ck_g’”©iÚ
 = 1;

827 
nod©a
:

828  
»tv®
;

829 
	}
}

832 
sùp_chunk
 *
	$sùp_make_shutdown
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

833 cÚ¡ 
sùp_chunk
 *
chunk
)

835 
sùp_chunk
 *
»tv®
;

836 
sùp_shutdownhdr_t
 
shut
;

837 
__u32
 
ù¢
;

839 
ù¢
 = 
	`sùp_t¢m­_g‘_ù¢
(&
asoc
->
³”
.
t¢_m­
);

840 
shut
.
cum_t¢_ack
 = 
	`htÚl
(
ù¢
);

842 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_SHUTDOWN
, 0,

843 (
sùp_shutdownhdr_t
));

844 ià(!
»tv®
)

845 
nod©a
;

847 
»tv®
->
subh
.
shutdown_hdr
 =

848 
	`sùp_addto_chunk
(
»tv®
, (
shut
), &shut);

850 ià(
chunk
)

851 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

852 
nod©a
:

853  
»tv®
;

854 
	}
}

856 
sùp_chunk
 *
	$sùp_make_shutdown_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

857 cÚ¡ 
sùp_chunk
 *
chunk
)

859 
sùp_chunk
 *
»tv®
;

861 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_SHUTDOWN_ACK
, 0, 0);

872 ià(
»tv®
 && 
chunk
)

873 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

875  
»tv®
;

876 
	}
}

878 
sùp_chunk
 *
	$sùp_make_shutdown_com¶‘e
(

879 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

880 cÚ¡ 
sùp_chunk
 *
chunk
)

882 
sùp_chunk
 *
»tv®
;

883 
__u8
 
æags
 = 0;

888 
æags
 |ğ
asoc
 ? 0 : 
SCTP_CHUNK_FLAG_T
;

890 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_SHUTDOWN_COMPLETE
, 
æags
, 0);

902 ià(
»tv®
 && 
chunk
)

903 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

905  
»tv®
;

906 
	}
}

911 
sùp_chunk
 *
	$sùp_make_abÜt
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

912 cÚ¡ 
sùp_chunk
 *
chunk
,

913 cÚ¡ 
size_t
 
hšt
)

915 
sùp_chunk
 *
»tv®
;

916 
__u8
 
æags
 = 0;

921 ià(!
asoc
) {

922 ià(
chunk
 && chunk->
chunk_hdr
 &&

923 
chunk
->
chunk_hdr
->
ty³
 =ğ
SCTP_CID_INIT
)

924 
æags
 = 0;

926 
æags
 = 
SCTP_CHUNK_FLAG_T
;

929 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_ABORT
, 
æags
, 
hšt
);

940 ià(
»tv®
 && 
chunk
)

941 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

943  
»tv®
;

944 
	}
}

947 
sùp_chunk
 *
	$sùp_make_abÜt_no_d©a
(

948 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

949 cÚ¡ 
sùp_chunk
 *
chunk
, 
__u32
 
t¢
)

951 
sùp_chunk
 *
»tv®
;

952 
__be32
 
·ylßd
;

954 
»tv®
 = 
	`sùp_make_abÜt
(
asoc
, 
chunk
, (
sùp_”rhdr_t
)

955 + (
t¢
));

957 ià(!
»tv®
)

958 
no_mem
;

961 
·ylßd
 = 
	`htÚl
(
t¢
);

962 
	`sùp_š™_ÿu£
(
»tv®
, 
SCTP_ERROR_NO_DATA
, (
·ylßd
));

963 
	`sùp_addto_chunk
(
»tv®
, (
·ylßd
), (const *)&payload);

974 ià(
chunk
)

975 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

977 
no_mem
:

978  
»tv®
;

979 
	}
}

982 
sùp_chunk
 *
	$sùp_make_abÜt_u£r
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

983 cÚ¡ 
msghdr
 *
msg
,

984 
size_t
 
·yËn
)

986 
sùp_chunk
 *
»tv®
;

987 *
·ylßd
 = 
NULL
;

988 
”r
;

990 
»tv®
 = 
	`sùp_make_abÜt
(
asoc
, 
NULL
, (
sùp_”rhdr_t
è+ 
·yËn
);

991 ià(!
»tv®
)

992 
”r_chunk
;

994 ià(
·yËn
) {

996 
·ylßd
 = 
	`km®loc
(
·yËn
, 
GFP_KERNEL
);

997 ià(!
·ylßd
)

998 
”r_·ylßd
;

1000 
”r
 = 
	`memıy_äomiovec
(
·ylßd
, 
msg
->
msg_iov
, 
·yËn
);

1001 ià(
”r
 < 0)

1002 
”r_cİy
;

1005 
	`sùp_š™_ÿu£
(
»tv®
, 
SCTP_ERROR_USER_ABORT
, 
·yËn
);

1006 
	`sùp_addto_chunk
(
»tv®
, 
·yËn
, 
·ylßd
);

1008 ià(
·yËn
)

1009 
	`kä“
(
·ylßd
);

1011  
»tv®
;

1013 
”r_cİy
:

1014 
	`kä“
(
·ylßd
);

1015 
”r_·ylßd
:

1016 
	`sùp_chunk_ä“
(
»tv®
);

1017 
»tv®
 = 
NULL
;

1018 
”r_chunk
:

1019  
»tv®
;

1020 
	}
}

1025 *
	$sùp_addto_·¿m
(
sùp_chunk
 *
chunk
, 
Ën
,

1026 cÚ¡ *
d©a
)

1028 *
rg‘
;

1029 
chunkËn
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

1031 
rg‘
 = 
	`skb_put
(
chunk
->
skb
, 
Ën
);

1033 ià(
d©a
)

1034 
	`memıy
(
rg‘
, 
d©a
, 
Ën
);

1036 
	`mem£t
(
rg‘
, 0, 
Ën
);

1039 
chunk
->
chunk_hdr
->
Ëngth
 = 
	`htÚs
(
chunkËn
 + 
Ën
);

1040 
chunk
->
chunk_’d
 = 
	`skb__poš‹r
(chunk->
skb
);

1042  
rg‘
;

1043 
	}
}

1046 
sùp_chunk
 *
	$sùp_make_abÜt_viŞ©iÚ
(

1047 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1048 cÚ¡ 
sùp_chunk
 *
chunk
,

1049 cÚ¡ 
__u8
 *
·ylßd
,

1050 cÚ¡ 
size_t
 
·yËn
)

1052 
sùp_chunk
 *
»tv®
;

1053 
sùp_·¿mhdr
 
phdr
;

1055 
»tv®
 = 
	`sùp_make_abÜt
(
asoc
, 
chunk
, (
sùp_”rhdr_t
è+ 
·yËn


1056 + (
sùp_·¿mhdr_t
));

1057 ià(!
»tv®
)

1058 
’d
;

1060 
	`sùp_š™_ÿu£
(
»tv®
, 
SCTP_ERROR_PROTO_VIOLATION
, 
·yËn


1061 + (
sùp_·¿mhdr_t
));

1063 
phdr
.
ty³
 = 
	`htÚs
(
chunk
->
chunk_hdr
->type);

1064 
phdr
.
Ëngth
 = 
chunk
->
chunk_hdr
->length;

1065 
	`sùp_addto_chunk
(
»tv®
, 
·yËn
, 
·ylßd
);

1066 
	`sùp_addto_·¿m
(
»tv®
, (
sùp_·¿mhdr_t
), &
phdr
);

1068 
’d
:

1069  
»tv®
;

1070 
	}
}

1072 
sùp_chunk
 *
	$sùp_make_viŞ©iÚ_·¿mËn
(

1073 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1074 cÚ¡ 
sùp_chunk
 *
chunk
,

1075 
sùp_·¿mhdr
 *
·¿m
)

1077 
sùp_chunk
 *
»tv®
;

1078 cÚ¡ 
”rÜ
[] = "The following…arameter had invalid†ength:";

1079 
size_t
 
·ylßd_Ën
 = (
”rÜ
è+ (
sùp_”rhdr_t
) +

1080 (
sùp_·¿mhdr_t
);

1082 
»tv®
 = 
	`sùp_make_abÜt
(
asoc
, 
chunk
, 
·ylßd_Ën
);

1083 ià(!
»tv®
)

1084 
nod©a
;

1086 
	`sùp_š™_ÿu£
(
»tv®
, 
SCTP_ERROR_PROTO_VIOLATION
,

1087 (
”rÜ
è+ (
sùp_·¿mhdr_t
));

1088 
	`sùp_addto_chunk
(
»tv®
, (
”rÜ
),ƒrror);

1089 
	`sùp_addto_·¿m
(
»tv®
, (
sùp_·¿mhdr_t
), 
·¿m
);

1091 
nod©a
:

1092  
»tv®
;

1093 
	}
}

1095 
sùp_chunk
 *
	$sùp_make_viŞ©iÚ_max_»Œªs
(

1096 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1097 cÚ¡ 
sùp_chunk
 *
chunk
)

1099 
sùp_chunk
 *
»tv®
;

1100 cÚ¡ 
”rÜ
[] = "Associationƒxceeded its max_retans count";

1101 
size_t
 
·ylßd_Ën
 = (
”rÜ
è+ (
sùp_”rhdr_t
);

1103 
»tv®
 = 
	`sùp_make_abÜt
(
asoc
, 
chunk
, 
·ylßd_Ën
);

1104 ià(!
»tv®
)

1105 
nod©a
;

1107 
	`sùp_š™_ÿu£
(
»tv®
, 
SCTP_ERROR_PROTO_VIOLATION
, (
”rÜ
));

1108 
	`sùp_addto_chunk
(
»tv®
, (
”rÜ
),ƒrror);

1110 
nod©a
:

1111  
»tv®
;

1112 
	}
}

1115 
sùp_chunk
 *
	$sùp_make_h—¹b—t
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1116 cÚ¡ 
sùp_Œª¥Üt
 *
Œª¥Üt
,

1117 cÚ¡ *
·ylßd
, cÚ¡ 
size_t
 
·yËn
)

1119 
sùp_chunk
 *
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_HEARTBEAT
,

1120 0, 
·yËn
);

1122 ià(!
»tv®
)

1123 
nod©a
;

1128 
»tv®
->
Œª¥Üt
 = (
sùp_Œª¥Üt
 *)ransport;

1129 
»tv®
->
subh
.
hbs_hdr
 = 
	`sùp_addto_chunk
Ô‘v®, 
·yËn
, 
·ylßd
);

1131 
nod©a
:

1132  
»tv®
;

1133 
	}
}

1135 
sùp_chunk
 *
	$sùp_make_h—¹b—t_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1136 cÚ¡ 
sùp_chunk
 *
chunk
,

1137 cÚ¡ *
·ylßd
, cÚ¡ 
size_t
 
·yËn
)

1139 
sùp_chunk
 *
»tv®
;

1141 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_HEARTBEAT_ACK
, 0, 
·yËn
);

1142 ià(!
»tv®
)

1143 
nod©a
;

1145 
»tv®
->
subh
.
hbs_hdr
 = 
	`sùp_addto_chunk
Ô‘v®, 
·yËn
, 
·ylßd
);

1156 ià(
chunk
)

1157 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

1159 
nod©a
:

1160  
»tv®
;

1161 
	}
}

1166 
sùp_chunk
 *
	$sùp_make_İ_”rÜ_¥aû
(

1167 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1168 cÚ¡ 
sùp_chunk
 *
chunk
,

1169 
size_t
 
size
)

1171 
sùp_chunk
 *
»tv®
;

1173 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_ERROR
, 0,

1174 (
sùp_”rhdr_t
è+ 
size
);

1175 ià(!
»tv®
)

1176 
nod©a
;

1186 ià(
chunk
)

1187 
»tv®
->
Œª¥Üt
 = 
chunk
->transport;

1189 
nod©a
:

1190  
»tv®
;

1191 
	}
}

1199 
šlše
 
sùp_chunk
 *
	$sùp_make_İ_”rÜ_fixed
(

1200 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1201 cÚ¡ 
sùp_chunk
 *
chunk
)

1203 
size_t
 
size
 = 
asoc
 ?‡soc->
·thmtu
 : 0;

1205 ià(!
size
)

1206 
size
 = 
SCTP_DEFAULT_MAXSEGMENT
;

1208  
	`sùp_make_İ_”rÜ_¥aû
(
asoc
, 
chunk
, 
size
);

1209 
	}
}

1212 
sùp_chunk
 *
	$sùp_make_İ_”rÜ
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1213 cÚ¡ 
sùp_chunk
 *
chunk
,

1214 
__be16
 
ÿu£_code
, cÚ¡ *
·ylßd
,

1215 
size_t
 
·yËn
, size_ˆ
»£rve_
)

1217 
sùp_chunk
 *
»tv®
;

1219 
»tv®
 = 
	`sùp_make_İ_”rÜ_¥aû
(
asoc
, 
chunk
, 
·yËn
 + 
»£rve_
);

1220 ià(!
»tv®
)

1221 
nod©a
;

1223 
	`sùp_š™_ÿu£
(
»tv®
, 
ÿu£_code
, 
·yËn
 + 
»£rve_
);

1224 
	`sùp_addto_chunk
(
»tv®
, 
·yËn
, 
·ylßd
);

1225 ià(
»£rve_
)

1226 
	`sùp_addto_·¿m
(
»tv®
, 
»£rve_
, 
NULL
);

1228 
nod©a
:

1229  
»tv®
;

1230 
	}
}

1232 
sùp_chunk
 *
	$sùp_make_auth
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

1234 
sùp_chunk
 *
»tv®
;

1235 
sùp_hmac
 *
hmac_desc
;

1236 
sùp_authhdr
 
auth_hdr
;

1237 
__u8
 *
hmac
;

1240 
hmac_desc
 = 
	`sùp_auth_asoc_g‘_hmac
(
asoc
);

1241 ià(
	`uÆik–y
(!
hmac_desc
))

1242  
NULL
;

1244 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_AUTH
, 0,

1245 
hmac_desc
->
hmac_Ën
 + (
sùp_authhdr_t
));

1246 ià(!
»tv®
)

1247  
NULL
;

1249 
auth_hdr
.
hmac_id
 = 
	`htÚs
(
hmac_desc
->hmac_id);

1250 
auth_hdr
.
shkey_id
 = 
	`htÚs
(
asoc
->
aùive_key_id
);

1252 
»tv®
->
subh
.
auth_hdr
 = 
	`sùp_addto_chunk
Ô‘v®, (
sùp_authhdr_t
),

1253 &
auth_hdr
);

1255 
hmac
 = 
	`skb_put
(
»tv®
->
skb
, 
hmac_desc
->
hmac_Ën
);

1256 
	`mem£t
(
hmac
, 0, 
hmac_desc
->
hmac_Ën
);

1259 
»tv®
->
chunk_hdr
->
Ëngth
 =

1260 
	`htÚs
(
	`Áohs
(
»tv®
->
chunk_hdr
->
Ëngth
è+ 
hmac_desc
->
hmac_Ën
);

1261 
»tv®
->
chunk_’d
 = 
	`skb__poš‹r
Ô‘v®->
skb
);

1263  
»tv®
;

1264 
	}
}

1274 
sùp_chunk
 *
	$sùp_chunkify
(
sk_buff
 *
skb
,

1275 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1276 
sock
 *
sk
)

1278 
sùp_chunk
 *
»tv®
;

1280 
»tv®
 = 
	`kmem_ÿche_z®loc
(
sùp_chunk_ÿch•
, 
GFP_ATOMIC
);

1282 ià(!
»tv®
)

1283 
nod©a
;

1285 ià(!
sk
) {

1286 
	`SCTP_DEBUG_PRINTK
("chunkifyšg skb %°w/Øª sk\n", 
skb
);

1289 
	`INIT_LIST_HEAD
(&
»tv®
->
li¡
);

1290 
»tv®
->
skb
 = skb;

1291 
»tv®
->
asoc
 = (
sùp_assocŸtiÚ
 *)asoc;

1292 
»tv®
->
has_t¢
 = 0;

1293 
»tv®
->
has_s¢
 = 0;

1294 
»tv®
->
¹t_š_´og»ss
 = 0;

1295 
»tv®
->
£Á_©
 = 0;

1296 
»tv®
->
sšgËtÚ
 = 1;

1297 
»tv®
->
’d_of_·ck‘
 = 0;

1298 
»tv®
->
eú_û_dÚe
 = 0;

1299 
»tv®
->
pdisÿrd
 = 0;

1307 
»tv®
->
t¢_missšg_»pÜt
 = 0;

1308 
»tv®
->
t¢_g­_acked
 = 0;

1309 
»tv®
->
ç¡_»Œªsm™
 = 
SCTP_CAN_FRTX
;

1314 
»tv®
->
msg
 = 
NULL
;

1317 
	`INIT_LIST_HEAD
(&
»tv®
->
Œªsm™‹d_li¡
);

1318 
	`INIT_LIST_HEAD
(&
»tv®
->
äag_li¡
);

1319 
	`SCTP_DBG_OBJCNT_INC
(
chunk
);

1320 
	`©omic_£t
(&
»tv®
->
»fút
, 1);

1322 
nod©a
:

1323  
»tv®
;

1324 
	}
}

1327 
	$sùp_š™_addrs
(
sùp_chunk
 *
chunk
, 
sùp_addr
 *
¤c
,

1328 
sùp_addr
 *
de¡
)

1330 
	`memıy
(&
chunk
->
sourû
, 
¤c
, (
sùp_addr
));

1331 
	`memıy
(&
chunk
->
de¡
, de¡, (
sùp_addr
));

1332 
	}
}

1335 cÚ¡ 
sùp_addr
 *
	$sùp_sourû
(cÚ¡ 
sùp_chunk
 *
chunk
)

1338 ià(
chunk
->
Œª¥Üt
) {

1339  &
chunk
->
Œª¥Üt
->
addr
;

1342  &
chunk
->
sourû
;

1344 
	}
}

1349 
SCTP_STATIC


1350 
sùp_chunk
 *
	$sùp_make_chunk
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1351 
__u8
 
ty³
, __u8 
æags
, 
·yËn
)

1353 
sùp_chunk
 *
»tv®
;

1354 
sùp_chunkhdr_t
 *
chunk_hdr
;

1355 
sk_buff
 *
skb
;

1356 
sock
 *
sk
;

1359 
skb
 = 
	`®loc_skb
(
	`WORD_ROUND
((
sùp_chunkhdr_t
è+ 
·yËn
),

1360 
GFP_ATOMIC
);

1361 ià(!
skb
)

1362 
nod©a
;

1365 
chunk_hdr
 = (
sùp_chunkhdr_t
 *)
	`skb_put
(
skb
, (sctp_chunkhdr_t));

1366 
chunk_hdr
->
ty³
 =ype;

1367 
chunk_hdr
->
æags
 = flags;

1368 
chunk_hdr
->
Ëngth
 = 
	`htÚs
((
sùp_chunkhdr_t
));

1370 
sk
 = 
asoc
 ?‡soc->
ba£
.sk : 
NULL
;

1371 
»tv®
 = 
	`sùp_chunkify
(
skb
, 
asoc
, 
sk
);

1372 ià(!
»tv®
) {

1373 
	`kä“_skb
(
skb
);

1374 
nod©a
;

1377 
»tv®
->
chunk_hdr
 = chunk_hdr;

1378 
»tv®
->
chunk_’d
 = ((
__u8
 *)
chunk_hdr
è+ (
sùp_chunkhdr
);

1381 ià(
	`sùp_auth_£nd_cid
(
ty³
, 
asoc
))

1382 
»tv®
->
auth
 = 1;

1385 
skb
->
sk
 = sk;

1387  
»tv®
;

1388 
nod©a
:

1389  
NULL
;

1390 
	}
}

1394 
	$sùp_chunk_de¡roy
(
sùp_chunk
 *
chunk
)

1396 
	`BUG_ON
(!
	`li¡_em±y
(&
chunk
->
li¡
));

1397 
	`li¡_d–_š™
(&
chunk
->
Œªsm™‹d_li¡
);

1400 
	`dev_kä“_skb
(
chunk
->
skb
);

1402 
	`SCTP_DBG_OBJCNT_DEC
(
chunk
);

1403 
	`kmem_ÿche_ä“
(
sùp_chunk_ÿch•
, 
chunk
);

1404 
	}
}

1407 
	$sùp_chunk_ä“
(
sùp_chunk
 *
chunk
)

1410 ià(
chunk
->
msg
)

1411 
	`sùp_d©amsg_put
(
chunk
->
msg
);

1413 
	`sùp_chunk_put
(
chunk
);

1414 
	}
}

1417 
	$sùp_chunk_hŞd
(
sùp_chunk
 *
ch
)

1419 
	`©omic_šc
(&
ch
->
»fút
);

1420 
	}
}

1423 
	$sùp_chunk_put
(
sùp_chunk
 *
ch
)

1425 ià(
	`©omic_dec_ªd_‹¡
(&
ch
->
»fút
))

1426 
	`sùp_chunk_de¡roy
(
ch
);

1427 
	}
}

1432 *
	$sùp_addto_chunk
(
sùp_chunk
 *
chunk
, 
Ën
, cÚ¡ *
d©a
)

1434 *
rg‘
;

1435 *
·ddšg
;

1436 
chunkËn
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

1437 
·dËn
 = 
	`WORD_ROUND
(
chunkËn
) - chunklen;

1439 
·ddšg
 = 
	`skb_put
(
chunk
->
skb
, 
·dËn
);

1440 
rg‘
 = 
	`skb_put
(
chunk
->
skb
, 
Ën
);

1442 
	`mem£t
(
·ddšg
, 0, 
·dËn
);

1443 
	`memıy
(
rg‘
, 
d©a
, 
Ën
);

1446 
chunk
->
chunk_hdr
->
Ëngth
 = 
	`htÚs
(
chunkËn
 + 
·dËn
 + 
Ën
);

1447 
chunk
->
chunk_’d
 = 
	`skb__poš‹r
(chunk->
skb
);

1449  
rg‘
;

1450 
	}
}

1455 *
	$sùp_addto_chunk_fixed
(
sùp_chunk
 *
chunk
,

1456 
Ën
, cÚ¡ *
d©a
)

1458 ià(
	`skb_room
(
chunk
->
skb
è>ğ
Ën
)

1459  
	`sùp_addto_chunk
(
chunk
, 
Ën
, 
d©a
);

1461  
NULL
;

1462 
	}
}

1468 
	$sùp_u£r_addto_chunk
(
sùp_chunk
 *
chunk
, 
off
, 
Ën
,

1469 
iovec
 *
d©a
)

1471 
__u8
 *
rg‘
;

1472 
”r
 = 0;

1475 
rg‘
 = 
	`skb_put
(
chunk
->
skb
, 
Ën
);

1478 ià((
”r
 = 
	`memıy_äomioveûnd
(
rg‘
, 
d©a
, 
off
, 
Ën
)))

1479 
out
;

1482 
chunk
->
chunk_hdr
->
Ëngth
 =

1483 
	`htÚs
(
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
è+ 
Ën
);

1484 
chunk
->
chunk_’d
 = 
	`skb__poš‹r
(chunk->
skb
);

1486 
out
:

1487  
”r
;

1488 
	}
}

1493 
	$sùp_chunk_assign_s¢
(
sùp_chunk
 *
chunk
)

1495 
sùp_d©amsg
 *
msg
;

1496 
sùp_chunk
 *
lchunk
;

1497 
sùp_¡»am
 *
¡»am
;

1498 
__u16
 
s¢
;

1499 
__u16
 
sid
;

1501 ià(
chunk
->
has_s¢
)

1505 
sid
 = 
	`Áohs
(
chunk
->
subh
.
d©a_hdr
->
¡»am
);

1506 
¡»am
 = &
chunk
->
asoc
->
s¢m­
->
out
;

1511 
msg
 = 
chunk
->msg;

1512 
	`li¡_fÜ_—ch_’Œy
(
lchunk
, &
msg
->
chunks
, 
äag_li¡
) {

1513 ià(
lchunk
->
chunk_hdr
->
æags
 & 
SCTP_DATA_UNORDERED
) {

1514 
s¢
 = 0;

1516 ià(
lchunk
->
chunk_hdr
->
æags
 & 
SCTP_DATA_LAST_FRAG
)

1517 
s¢
 = 
	`sùp_s¢_Ãxt
(
¡»am
, 
sid
);

1519 
s¢
 = 
	`sùp_s¢_³ek
(
¡»am
, 
sid
);

1522 
lchunk
->
subh
.
d©a_hdr
->
s¢
 = 
	`htÚs
(ssn);

1523 
lchunk
->
has_s¢
 = 1;

1525 
	}
}

1530 
	$sùp_chunk_assign_t¢
(
sùp_chunk
 *
chunk
)

1532 ià(!
chunk
->
has_t¢
) {

1536 
chunk
->
subh
.
d©a_hdr
->
t¢
 =

1537 
	`htÚl
(
	`sùp_assocŸtiÚ_g‘_Ãxt_t¢
(
chunk
->
asoc
));

1538 
chunk
->
has_t¢
 = 1;

1540 
	}
}

1543 
sùp_assocŸtiÚ
 *
	$sùp_make_‹mp_asoc
(cÚ¡ 
sùp_’dpošt
 *
•
,

1544 
sùp_chunk
 *
chunk
,

1545 
gå_t
 
gå
)

1547 
sùp_assocŸtiÚ
 *
asoc
;

1548 
sk_buff
 *
skb
;

1549 
sùp_scİe_t
 
scİe
;

1550 
sùp_af
 *
af
;

1553 
scİe
 = 
	`sùp_scİe
(
	`sùp_sourû
(
chunk
));

1554 
asoc
 = 
	`sùp_assocŸtiÚ_Ãw
(
•
,ƒp->
ba£
.
sk
, 
scİe
, 
gå
);

1555 ià(!
asoc
)

1556 
nod©a
;

1557 
asoc
->
‹mp
 = 1;

1558 
skb
 = 
chunk
->skb;

1560 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`v”2af
(
	`_hdr
(
skb
)->
v”siÚ
));

1561 ià(
	`uÆik–y
(!
af
))

1562 
ç
;

1563 
af
->
	`äom_skb
(&
asoc
->
c
.
³”_addr
, 
skb
, 1);

1564 
nod©a
:

1565  
asoc
;

1567 
ç
:

1568 
	`sùp_assocŸtiÚ_ä“
(
asoc
);

1569  
NULL
;

1570 
	}
}

1575 
sùp_cook›_·¿m_t
 *
	$sùp_·ck_cook›
(cÚ¡ 
sùp_’dpošt
 *
•
,

1576 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1577 cÚ¡ 
sùp_chunk
 *
š™_chunk
,

1578 *
cook›_Ën
,

1579 cÚ¡ 
__u8
 *
¿w_addrs
, 
addrs_Ën
)

1581 
sùp_cook›_·¿m_t
 *
»tv®
;

1582 
sùp_sigÃd_cook›
 *
cook›
;

1583 
sÿ‰”li¡
 
sg
;

1584 
h—d”size
, 
bodysize
;

1585 
keyËn
;

1586 *
key
;

1591 
h—d”size
 = (
sùp_·¿mhdr_t
) +

1592 ((
sùp_sigÃd_cook›
) -

1593 (
sùp_cook›
));

1594 
bodysize
 = (
sùp_cook›
)

1595 + 
	`Áohs
(
š™_chunk
->
chunk_hdr
->
Ëngth
è+ 
addrs_Ën
;

1600 ià(
bodysize
 % 
SCTP_COOKIE_MULTIPLE
)

1601 
bodysize
 +ğ
SCTP_COOKIE_MULTIPLE


1602 - (
bodysize
 % 
SCTP_COOKIE_MULTIPLE
);

1603 *
cook›_Ën
 = 
h—d”size
 + 
bodysize
;

1608 
»tv®
 = 
	`kz®loc
(*
cook›_Ën
, 
GFP_ATOMIC
);

1609 ià(!
»tv®
)

1610 
nod©a
;

1612 
cook›
 = (
sùp_sigÃd_cook›
 *è
»tv®
->
body
;

1615 
»tv®
->
p
.
ty³
 = 
SCTP_PARAM_STATE_COOKIE
;

1616 
»tv®
->
p
.
Ëngth
 = 
	`htÚs
(*
cook›_Ën
);

1619 
cook›
->
c
 = 
asoc
->c;

1621 
cook›
->
c
.
¿w_addr_li¡_Ën
 = 
addrs_Ën
;

1624 
cook›
->
c
.
´sùp_ÿ·bË
 = 
asoc
->
³”
.prsctp_capable;

1627 
cook›
->
c
.
ad­tiÚ_šd
 = 
asoc
->
³”
.adaptation_ind;

1630 
	`do_g‘timeofday
(&
cook›
->
c
.
expœ©iÚ
);

1632 
cook›
->
c
.
expœ©iÚ
 = 
	`ktime_add
(
asoc
->
cook›_liã
, cookie->c.expiration);

1635 
	`memıy
(&
cook›
->
c
.
³”_š™
[0], 
š™_chunk
->
chunk_hdr
,

1636 
	`Áohs
(
š™_chunk
->
chunk_hdr
->
Ëngth
));

1639 
	`memıy
((
__u8
 *)&
cook›
->
c
.
³”_š™
[0] +

1640 
	`Áohs
(
š™_chunk
->
chunk_hdr
->
Ëngth
), 
¿w_addrs
, 
addrs_Ën
);

1642 ià(
	`sùp_sk
(
•
->
ba£
.
sk
)->
hmac
) {

1643 
hash_desc
 
desc
;

1646 
	`sg_š™_Úe
(&
sg
, &
cook›
->
c
, 
bodysize
);

1647 
keyËn
 = 
SCTP_SECRET_SIZE
;

1648 
key
 = (*)
•
->
£ü‘_key
[•->
cu¼’t_key
];

1649 
desc
.
tfm
 = 
	`sùp_sk
(
•
->
ba£
.
sk
)->
hmac
;

1650 
desc
.
æags
 = 0;

1652 ià(
	`üy±o_hash_£tkey
(
desc
.
tfm
, 
key
, 
keyËn
) ||

1653 
	`üy±o_hash_dige¡
(&
desc
, &
sg
, 
bodysize
, 
cook›
->
sigÇtu»
))

1654 
ä“_cook›
;

1657  
»tv®
;

1659 
ä“_cook›
:

1660 
	`kä“
(
»tv®
);

1661 
nod©a
:

1662 *
cook›_Ën
 = 0;

1663  
NULL
;

1664 
	}
}

1667 
sùp_assocŸtiÚ
 *
	$sùp_uÅack_cook›
(

1668 cÚ¡ 
sùp_’dpošt
 *
•
,

1669 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1670 
sùp_chunk
 *
chunk
, 
gå_t
 
gå
,

1671 *
”rÜ
, 
sùp_chunk
 **
”½
)

1673 
sùp_assocŸtiÚ
 *
»tv®
 = 
NULL
;

1674 
sùp_sigÃd_cook›
 *
cook›
;

1675 
sùp_cook›
 *
b—r_cook›
;

1676 
h—d”size
, 
bodysize
, 
fixed_size
;

1677 
__u8
 *
dige¡
 = 
•
->digest;

1678 
sÿ‰”li¡
 
sg
;

1679 
keyËn
, 
Ën
;

1680 *
key
;

1681 
sùp_scİe_t
 
scİe
;

1682 
sk_buff
 *
skb
 = 
chunk
->skb;

1683 
timev®
 
tv
;

1684 
timev®
 
tv_»f
;

1685 
hash_desc
 
desc
;

1686 
ktime_t
 
tv_kt
;

1687 
su£cÚds_t
 
u£cs
;

1688 
__be32
 
n
;

1694 
h—d”size
 = (
sùp_chunkhdr_t
) +

1695 ((
sùp_sigÃd_cook›
) -

1696 (
sùp_cook›
));

1697 
bodysize
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
è- 
h—d”size
;

1698 
fixed_size
 = 
h—d”size
 + (
sùp_cook›
);

1704 
Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

1705 ià(
Ën
 < 
fixed_size
 + (
sùp_chunkhdr
))

1706 
m®fÜmed
;

1709 ià(
bodysize
 % 
SCTP_COOKIE_MULTIPLE
)

1710 
m®fÜmed
;

1713 
cook›
 = 
chunk
->
subh
.
cook›_hdr
;

1714 
b—r_cook›
 = &
cook›
->
c
;

1716 ià(!
	`sùp_sk
(
•
->
ba£
.
sk
)->
hmac
)

1717 
no_hmac
;

1720 
keyËn
 = 
SCTP_SECRET_SIZE
;

1721 
	`sg_š™_Úe
(&
sg
, 
b—r_cook›
, 
bodysize
);

1722 
key
 = (*)
•
->
£ü‘_key
[•->
cu¼’t_key
];

1723 
desc
.
tfm
 = 
	`sùp_sk
(
•
->
ba£
.
sk
)->
hmac
;

1724 
desc
.
æags
 = 0;

1726 
	`mem£t
(
dige¡
, 0x00, 
SCTP_SIGNATURE_SIZE
);

1727 ià(
	`üy±o_hash_£tkey
(
desc
.
tfm
, 
key
, 
keyËn
) ||

1728 
	`üy±o_hash_dige¡
(&
desc
, &
sg
, 
bodysize
, 
dige¡
)) {

1729 *
”rÜ
 = -
SCTP_IERROR_NOMEM
;

1730 
ç
;

1733 ià(
	`memcmp
(
dige¡
, 
cook›
->
sigÇtu»
, 
SCTP_SIGNATURE_SIZE
)) {

1735 
key
 = (*)
•
->
£ü‘_key
[•->
Ï¡_key
];

1736 
	`mem£t
(
dige¡
, 0x00, 
SCTP_SIGNATURE_SIZE
);

1737 ià(
	`üy±o_hash_£tkey
(
desc
.
tfm
, 
key
, 
keyËn
) ||

1738 
	`üy±o_hash_dige¡
(&
desc
, &
sg
, 
bodysize
, 
dige¡
)) {

1739 *
”rÜ
 = -
SCTP_IERROR_NOMEM
;

1740 
ç
;

1743 ià(
	`memcmp
(
dige¡
, 
cook›
->
sigÇtu»
, 
SCTP_SIGNATURE_SIZE
)) {

1745 *
”rÜ
 = -
SCTP_IERROR_BAD_SIG
;

1746 
ç
;

1750 
no_hmac
:

1758 ià(
	`Áohl
(
chunk
->
sùp_hdr
->
vg
è!ğ
b—r_cook›
->
my_vg
) {

1759 *
”rÜ
 = -
SCTP_IERROR_BAD_TAG
;

1760 
ç
;

1763 ià(
chunk
->
sùp_hdr
->
sourû
 !ğ
b—r_cook›
->
³”_addr
.
v4
.
sš_pÜt
 ||

1764 
	`Áohs
(
chunk
->
sùp_hdr
->
de¡
è!ğ
b—r_cook›
->
my_pÜt
) {

1765 *
”rÜ
 = -
SCTP_IERROR_BAD_PORTS
;

1766 
ç
;

1777 ià(
	`sock_æag
(
•
->
ba£
.
sk
, 
SOCK_TIMESTAMP
))

1778 
	`skb_g‘_time¡amp
(
skb
, &
tv
);

1780 
	`do_g‘timeofday
(&
tv
);

1782 
tv_kt
 = 
	`timev®_to_ktime
(
tv
);

1784 ià(!
asoc
 && (
	`ktime_com·»
(
b—r_cook›
->
expœ©iÚ
, 
tv_kt
)) < 0) {

1793 
Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

1794 *
”½
 = 
	`sùp_make_İ_”rÜ_¥aû
(
asoc
, 
chunk
, 
Ën
);

1795 ià(*
”½
) {

1796 
tv_»f
 = 
	`ktime_to_timev®
(
b—r_cook›
->
expœ©iÚ
);

1798 
u£cs
 = (
tv
.
tv_£c
 -

1799 
tv_»f
.
tv_£c
) * 1000000L +

1800 
tv
.
tv_u£c
 - 
tv_»f
.tv_usec;

1802 
n
 = 
	`htÚl
(
u£cs
);

1804 
	`sùp_š™_ÿu£
(*
”½
, 
SCTP_ERROR_STALE_COOKIE
,

1805 (
n
));

1806 
	`sùp_addto_chunk
(*
”½
, (
n
), &n);

1807 *
”rÜ
 = -
SCTP_IERROR_STALE_COOKIE
;

1809 *
”rÜ
 = -
SCTP_IERROR_NOMEM
;

1811 
ç
;

1815 
scİe
 = 
	`sùp_scİe
(
	`sùp_sourû
(
chunk
));

1816 
»tv®
 = 
	`sùp_assocŸtiÚ_Ãw
(
•
,ƒp->
ba£
.
sk
, 
scİe
, 
gå
);

1817 ià(!
»tv®
) {

1818 *
”rÜ
 = -
SCTP_IERROR_NOMEM
;

1819 
ç
;

1823 
»tv®
->
³”
.
pÜt
 = 
	`Áohs
(
chunk
->
sùp_hdr
->
sourû
);

1826 
	`memıy
(&
»tv®
->
c
, 
b—r_cook›
, (*bear_cookie));

1828 ià(
	`sùp_assoc_£t_bšd_addr_äom_cook›
(
»tv®
, 
b—r_cook›
,

1829 
GFP_ATOMIC
) < 0) {

1830 *
”rÜ
 = -
SCTP_IERROR_NOMEM
;

1831 
ç
;

1835 ià(
	`li¡_em±y
(&
»tv®
->
ba£
.
bšd_addr
.
add»ss_li¡
)) {

1836 
	`sùp_add_bšd_addr
(&
»tv®
->
ba£
.
bšd_addr
, &
chunk
->
de¡
,

1837 
SCTP_ADDR_SRC
, 
GFP_ATOMIC
);

1840 
»tv®
->
Ãxt_t¢
 =„‘v®->
c
.
š™Ÿl_t¢
;

1841 
»tv®
->
ù¢_ack_pošt
 =„‘v®->
Ãxt_t¢
 - 1;

1842 
»tv®
->
add_£rŸl
 =„‘v®->
c
.
š™Ÿl_t¢
;

1843 
»tv®
->
adv_³”_ack_pošt
 =„‘v®->
ù¢_ack_pošt
;

1844 
»tv®
->
³”
.
´sùp_ÿ·bË
 =„‘v®->
c
.prsctp_capable;

1845 
»tv®
->
³”
.
ad­tiÚ_šd
 =„‘v®->
c
.adaptation_ind;

1848  
»tv®
;

1850 
ç
:

1851 ià(
»tv®
)

1852 
	`sùp_assocŸtiÚ_ä“
(
»tv®
);

1854  
NULL
;

1856 
m®fÜmed
:

1860 *
”rÜ
 = -
SCTP_IERROR_MALFORMED
;

1861 
ç
;

1862 
	}
}

1868 
	s__sùp_missšg
 {

1869 
__be32
 
	mnum_missšg
;

1870 
__be16
 
	mty³
;

1871 } 
__©Œibu‹__
((
·cked
));

1876 
	$sùp_´oûss_missšg_·¿m
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1877 
sùp_·¿m_t
 
·¿mty³
,

1878 
sùp_chunk
 *
chunk
,

1879 
sùp_chunk
 **
”½
)

1881 
__sùp_missšg
 
»pÜt
;

1882 
__u16
 
Ën
;

1884 
Ën
 = 
	`WORD_ROUND
((
»pÜt
));

1889 ià(!*
”½
)

1890 *
”½
 = 
	`sùp_make_İ_”rÜ_¥aû
(
asoc
, 
chunk
, 
Ën
);

1892 ià(*
”½
) {

1893 
»pÜt
.
num_missšg
 = 
	`htÚl
(1);

1894 
»pÜt
.
ty³
 = 
·¿mty³
;

1895 
	`sùp_š™_ÿu£
(*
”½
, 
SCTP_ERROR_MISS_PARAM
,

1896 (
»pÜt
));

1897 
	`sùp_addto_chunk
(*
”½
, (
»pÜt
), &report);

1902 
	}
}

1905 
	$sùp_´oûss_šv_mªd©Üy
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1906 
sùp_chunk
 *
chunk
,

1907 
sùp_chunk
 **
”½
)

1911 ià(!*
”½
)

1912 *
”½
 = 
	`sùp_make_İ_”rÜ_¥aû
(
asoc
, 
chunk
, 0);

1914 ià(*
”½
)

1915 
	`sùp_š™_ÿu£
(*
”½
, 
SCTP_ERROR_INV_PARAM
, 0);

1919 
	}
}

1921 
	$sùp_´oûss_šv_·¿mËngth
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1922 
sùp_·¿mhdr
 *
·¿m
,

1923 cÚ¡ 
sùp_chunk
 *
chunk
,

1924 
sùp_chunk
 **
”½
)

1929 ià(*
”½
)

1930 
	`sùp_chunk_ä“
(*
”½
);

1933 *
”½
 = 
	`sùp_make_viŞ©iÚ_·¿mËn
(
asoc
, 
chunk
, 
·¿m
);

1936 
	}
}

1942 
	$sùp_´oûss_hn_·¿m
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1943 
sùp_·¿ms
 
·¿m
,

1944 
sùp_chunk
 *
chunk
,

1945 
sùp_chunk
 **
”½
)

1947 
__u16
 
Ën
 = 
	`Áohs
(
·¿m
.
p
->
Ëngth
);

1954 ià(*
”½
)

1955 
	`sùp_chunk_ä“
(*
”½
);

1957 *
”½
 = 
	`sùp_make_İ_”rÜ_¥aû
(
asoc
, 
chunk
, 
Ën
);

1959 ià(*
”½
) {

1960 
	`sùp_š™_ÿu£
(*
”½
, 
SCTP_ERROR_DNS_FAILED
, 
Ën
);

1961 
	`sùp_addto_chunk
(*
”½
, 
Ën
, 
·¿m
.
v
);

1966 
	}
}

1968 
	$sùp_v”ify_ext_·¿m
(
sùp_·¿ms
 
·¿m
)

1970 
__u16
 
num_ext
 = 
	`Áohs
(
·¿m
.
p
->
Ëngth
è- (
sùp_·¿mhdr_t
);

1971 
have_auth
 = 0;

1972 
have_ascÚf
 = 0;

1973 
i
;

1975 
i
 = 0; i < 
num_ext
; i++) {

1976 
·¿m
.
ext
->
chunks
[
i
]) {

1977 
SCTP_CID_AUTH
:

1978 
have_auth
 = 1;

1980 
SCTP_CID_ASCONF
:

1981 
SCTP_CID_ASCONF_ACK
:

1982 
have_ascÚf
 = 1;

1992 ià(
sùp_add_nßuth
)

1995 ià(
sùp_add_’abË
 && !
have_auth
 && 
have_ascÚf
)

1999 
	}
}

2001 
	$sùp_´oûss_ext_·¿m
(
sùp_assocŸtiÚ
 *
asoc
,

2002 
sùp_·¿ms
 
·¿m
)

2004 
__u16
 
num_ext
 = 
	`Áohs
(
·¿m
.
p
->
Ëngth
è- (
sùp_·¿mhdr_t
);

2005 
i
;

2007 
i
 = 0; i < 
num_ext
; i++) {

2008 
·¿m
.
ext
->
chunks
[
i
]) {

2009 
SCTP_CID_FWD_TSN
:

2010 ià(
sùp_´sùp_’abË
 &&

2011 !
asoc
->
³”
.
´sùp_ÿ·bË
)

2012 
asoc
->
³”
.
´sùp_ÿ·bË
 = 1;

2014 
SCTP_CID_AUTH
:

2018 ià(
sùp_auth_’abË
)

2019 
asoc
->
³”
.
auth_ÿ·bË
 = 1;

2021 
SCTP_CID_ASCONF
:

2022 
SCTP_CID_ASCONF_ACK
:

2023 ià(
sùp_add_’abË
)

2024 
asoc
->
³”
.
ascÚf_ÿ·bË
 = 1;

2030 
	}
}

2057 
sùp_›¼Ü_t
 
	$sùp_´oûss_unk_·¿m
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2058 
sùp_·¿ms
 
·¿m
,

2059 
sùp_chunk
 *
chunk
,

2060 
sùp_chunk
 **
”½
)

2062 
»tv®
 = 
SCTP_IERROR_NO_ERROR
;

2064 
·¿m
.
p
->
ty³
 & 
SCTP_PARAM_ACTION_MASK
) {

2065 
SCTP_PARAM_ACTION_DISCARD
:

2066 
»tv®
 = 
SCTP_IERROR_ERROR
;

2068 
SCTP_PARAM_ACTION_SKIP
:

2070 
SCTP_PARAM_ACTION_DISCARD_ERR
:

2071 
»tv®
 = 
SCTP_IERROR_ERROR
;

2073 
SCTP_PARAM_ACTION_SKIP_ERR
:

2077 ià(
NULL
 =ğ*
”½
)

2078 *
”½
 = 
	`sùp_make_İ_”rÜ_fixed
(
asoc
, 
chunk
);

2080 ià(*
”½
) {

2081 ià(!
	`sùp_š™_ÿu£_fixed
(*
”½
, 
SCTP_ERROR_UNKNOWN_PARAM
,

2082 
	`WORD_ROUND
(
	`Áohs
(
·¿m
.
p
->
Ëngth
))))

2083 
	`sùp_addto_chunk_fixed
(*
”½
,

2084 
	`WORD_ROUND
(
	`Áohs
(
·¿m
.
p
->
Ëngth
)),

2085 
·¿m
.
v
);

2092 
»tv®
 = 
SCTP_IERROR_NOMEM
;

2099  
»tv®
;

2100 
	}
}

2109 
sùp_›¼Ü_t
 
	$sùp_v”ify_·¿m
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2110 
sùp_·¿ms
 
·¿m
,

2111 
sùp_cid_t
 
cid
,

2112 
sùp_chunk
 *
chunk
,

2113 
sùp_chunk
 **
”r_chunk
)

2115 
sùp_hmac_®go_·¿m
 *
hmacs
;

2116 
»tv®
 = 
SCTP_IERROR_NO_ERROR
;

2117 
__u16
 
n_–t
, 
id
 = 0;

2118 
i
;

2125 
·¿m
.
p
->
ty³
) {

2126 
SCTP_PARAM_IPV4_ADDRESS
:

2127 
SCTP_PARAM_IPV6_ADDRESS
:

2128 
SCTP_PARAM_COOKIE_PRESERVATIVE
:

2129 
SCTP_PARAM_SUPPORTED_ADDRESS_TYPES
:

2130 
SCTP_PARAM_STATE_COOKIE
:

2131 
SCTP_PARAM_HEARTBEAT_INFO
:

2132 
SCTP_PARAM_UNRECOGNIZED_PARAMETERS
:

2133 
SCTP_PARAM_ECN_CAPABLE
:

2134 
SCTP_PARAM_ADAPTATION_LAYER_IND
:

2137 
SCTP_PARAM_SUPPORTED_EXT
:

2138 ià(!
	`sùp_v”ify_ext_·¿m
(
·¿m
))

2139  
SCTP_IERROR_ABORT
;

2142 
SCTP_PARAM_SET_PRIMARY
:

2143 ià(
sùp_add_’abË
)

2145 
çÎthrough
;

2147 
SCTP_PARAM_HOST_NAME_ADDRESS
:

2149 
	`sùp_´oûss_hn_·¿m
(
asoc
, 
·¿m
, 
chunk
, 
”r_chunk
);

2150 
»tv®
 = 
SCTP_IERROR_ABORT
;

2153 
SCTP_PARAM_FWD_TSN_SUPPORT
:

2154 ià(
sùp_´sùp_’abË
)

2156 
çÎthrough
;

2158 
SCTP_PARAM_RANDOM
:

2159 ià(!
sùp_auth_’abË
)

2160 
çÎthrough
;

2167 ià(
SCTP_AUTH_RANDOM_LENGTH
 !=

2168 
	`Áohs
(
·¿m
.
p
->
Ëngth
è- (
sùp_·¿mhdr_t
)) {

2169 
	`sùp_´oûss_šv_·¿mËngth
(
asoc
, 
·¿m
.
p
,

2170 
chunk
, 
”r_chunk
);

2171 
»tv®
 = 
SCTP_IERROR_ABORT
;

2175 
SCTP_PARAM_CHUNKS
:

2176 ià(!
sùp_auth_’abË
)

2177 
çÎthrough
;

2184 ià(260 < 
	`Áohs
(
·¿m
.
p
->
Ëngth
)) {

2185 
	`sùp_´oûss_šv_·¿mËngth
(
asoc
, 
·¿m
.
p
,

2186 
chunk
, 
”r_chunk
);

2187 
»tv®
 = 
SCTP_IERROR_ABORT
;

2191 
SCTP_PARAM_HMAC_ALGO
:

2192 ià(!
sùp_auth_’abË
)

2193 
çÎthrough
;

2195 
hmacs
 = (
sùp_hmac_®go_·¿m
 *)
·¿m
.
p
;

2196 
n_–t
 = (
	`Áohs
(
·¿m
.
p
->
Ëngth
è- (
sùp_·¿mhdr_t
)) >> 1;

2202 
i
 = 0; i < 
n_–t
; i++) {

2203 
id
 = 
	`Áohs
(
hmacs
->
hmac_ids
[
i
]);

2205 ià(
id
 =ğ
SCTP_AUTH_HMAC_ID_SHA1
)

2209 ià(
id
 !ğ
SCTP_AUTH_HMAC_ID_SHA1
) {

2210 
	`sùp_´oûss_šv_·¿mËngth
(
asoc
, 
·¿m
.
p
, 
chunk
,

2211 
”r_chunk
);

2212 
»tv®
 = 
SCTP_IERROR_ABORT
;

2215 
çÎthrough
:

2217 
	`SCTP_DEBUG_PRINTK
("Unrecognized…aram: %d for chunk %d.\n",

2218 
	`Áohs
(
·¿m
.
p
->
ty³
), 
cid
);

2219 
»tv®
 = 
	`sùp_´oûss_unk_·¿m
(
asoc
, 
·¿m
, 
chunk
, 
”r_chunk
);

2222  
»tv®
;

2223 
	}
}

2226 
	$sùp_v”ify_š™
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2227 
sùp_cid_t
 
cid
,

2228 
sùp_š™_chunk_t
 *
³”_š™
,

2229 
sùp_chunk
 *
chunk
,

2230 
sùp_chunk
 **
”½
)

2232 
sùp_·¿ms
 
·¿m
;

2233 
has_cook›
 = 0;

2234 
»suÉ
;

2237 ià((0 =ğ
³”_š™
->
š™_hdr
.
num_outbound_¡»ams
) ||

2238 (0 =ğ
³”_š™
->
š™_hdr
.
num_šbound_¡»ams
) ||

2239 (0 =ğ
³”_š™
->
š™_hdr
.
š™_g
) ||

2240 (
SCTP_DEFAULT_MINWINDOW
 > 
	`Áohl
(
³”_š™
->
š™_hdr
.
a_rwnd
))) {

2242  
	`sùp_´oûss_šv_mªd©Üy
(
asoc
, 
chunk
, 
”½
);

2246 
	`sùp_w®k_·¿ms
(
·¿m
, 
³”_š™
, 
š™_hdr
.
·¿ms
) {

2248 ià(
SCTP_PARAM_STATE_COOKIE
 =ğ
·¿m
.
p
->
ty³
)

2249 
has_cook›
 = 1;

2260 ià(
·¿m
.
v
 !ğ(*)
chunk
->
chunk_’d
)

2261  
	`sùp_´oûss_šv_·¿mËngth
(
asoc
, 
·¿m
.
p
, 
chunk
, 
”½
);

2266 ià((
SCTP_CID_INIT_ACK
 =ğ
cid
è&& !
has_cook›
)

2267  
	`sùp_´oûss_missšg_·¿m
(
asoc
, 
SCTP_PARAM_STATE_COOKIE
,

2268 
chunk
, 
”½
);

2271 
	`sùp_w®k_·¿ms
(
·¿m
, 
³”_š™
, 
š™_hdr
.
·¿ms
) {

2273 
»suÉ
 = 
	`sùp_v”ify_·¿m
(
asoc
, 
·¿m
, 
cid
, 
chunk
, 
”½
);

2274 
»suÉ
) {

2275 
SCTP_IERROR_ABORT
:

2276 
SCTP_IERROR_NOMEM
:

2278 
SCTP_IERROR_ERROR
:

2280 
SCTP_IERROR_NO_ERROR
:

2288 
	}
}

2294 
	$sùp_´oûss_š™
(
sùp_assocŸtiÚ
 *
asoc
, 
sùp_chunk
 *
chunk
,

2295 cÚ¡ 
sùp_addr
 *
³”_addr
,

2296 
sùp_š™_chunk_t
 *
³”_š™
, 
gå_t
 
gå
)

2298 
sùp_·¿ms
 
·¿m
;

2299 
sùp_Œª¥Üt
 *
Œª¥Üt
;

2300 
li¡_h—d
 *
pos
, *
‹mp
;

2301 
sùp_af
 *
af
;

2302 
sùp_addr
 
addr
;

2303 *
cook›
;

2304 
¤c_m©ch
 = 0;

2316 if(!
	`sùp_assoc_add_³”
(
asoc
, 
³”_addr
, 
gå
, 
SCTP_ACTIVE
))

2317 
nomem
;

2319 ià(
	`sùp_cmp_addr_exaù
(
	`sùp_sourû
(
chunk
), 
³”_addr
))

2320 
¤c_m©ch
 = 1;

2323 
	`sùp_w®k_·¿ms
(
·¿m
, 
³”_š™
, 
š™_hdr
.
·¿ms
) {

2324 ià(!
¤c_m©ch
 && (
·¿m
.
p
->
ty³
 =ğ
SCTP_PARAM_IPV4_ADDRESS
 ||

2325 
·¿m
.
p
->
ty³
 =ğ
SCTP_PARAM_IPV6_ADDRESS
)) {

2326 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`·¿m_ty³2af
(
·¿m
.
p
->
ty³
));

2327 
af
->
	`äom_addr_·¿m
(&
addr
, 
·¿m
.addr,

2328 
chunk
->
sùp_hdr
->
sourû
, 0);

2329 ià(
	`sùp_cmp_addr_exaù
(
	`sùp_sourû
(
chunk
), &
addr
))

2330 
¤c_m©ch
 = 1;

2333 ià(!
	`sùp_´oûss_·¿m
(
asoc
, 
·¿m
, 
³”_addr
, 
gå
))

2334 
ş—n_up
;

2338 ià(!
¤c_m©ch
)

2339 
ş—n_up
;

2344 ià(
asoc
->
³”
.
auth_ÿ·bË
 && (!asoc->³”.
³”_¿ndom
 ||

2345 !
asoc
->
³”
.
³”_hmacs
))

2346 
asoc
->
³”
.
auth_ÿ·bË
 = 0;

2354 ià(!
sùp_add_nßuth
 &&

2355 (
asoc
->
³”
.
ascÚf_ÿ·bË
 && !asoc->³”.
auth_ÿ·bË
)) {

2356 
asoc
->
³”
.
add_di§bËd_mask
 |ğ(
SCTP_PARAM_ADD_IP
 |

2357 
SCTP_PARAM_DEL_IP
 |

2358 
SCTP_PARAM_SET_PRIMARY
);

2359 
asoc
->
³”
.
ascÚf_ÿ·bË
 = 0;

2360 
ş—n_up
;

2364 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
) {

2365 
Œª¥Üt
 = 
	`li¡_’Œy
(
pos
, 
sùp_Œª¥Üt
, 
Œª¥Üts
);

2366 ià(
Œª¥Üt
->
¡©e
 =ğ
SCTP_UNKNOWN
) {

2367 
	`sùp_assoc_rm_³”
(
asoc
, 
Œª¥Üt
);

2374 
asoc
->
³”
.
i
.
š™_g
 =

2375 
	`Áohl
(
³”_š™
->
š™_hdr
.
š™_g
);

2376 
asoc
->
³”
.
i
.
a_rwnd
 =

2377 
	`Áohl
(
³”_š™
->
š™_hdr
.
a_rwnd
);

2378 
asoc
->
³”
.
i
.
num_outbound_¡»ams
 =

2379 
	`Áohs
(
³”_š™
->
š™_hdr
.
num_outbound_¡»ams
);

2380 
asoc
->
³”
.
i
.
num_šbound_¡»ams
 =

2381 
	`Áohs
(
³”_š™
->
š™_hdr
.
num_šbound_¡»ams
);

2382 
asoc
->
³”
.
i
.
š™Ÿl_t¢
 =

2383 
	`Áohl
(
³”_š™
->
š™_hdr
.
š™Ÿl_t¢
);

2388 ià(
asoc
->
c
.
sš™_num_o¡»ams
 >

2389 
	`Áohs
(
³”_š™
->
š™_hdr
.
num_šbound_¡»ams
)) {

2390 
asoc
->
c
.
sš™_num_o¡»ams
 =

2391 
	`Áohs
(
³”_š™
->
š™_hdr
.
num_šbound_¡»ams
);

2394 ià(
asoc
->
c
.
sš™_max_š¡»ams
 >

2395 
	`Áohs
(
³”_š™
->
š™_hdr
.
num_outbound_¡»ams
)) {

2396 
asoc
->
c
.
sš™_max_š¡»ams
 =

2397 
	`Áohs
(
³”_š™
->
š™_hdr
.
num_outbound_¡»ams
);

2401 
asoc
->
c
.
³”_vg
 =‡soc->
³”
.
i
.
š™_g
;

2404 
asoc
->
³”
.
rwnd
 =‡soc->³”.
i
.
a_rwnd
;

2407 
cook›
 = 
asoc
->
³”
.cookie;

2408 ià(
cook›
) {

2409 
asoc
->
³”
.
cook›
 = 
	`kmemdup
(cook›,‡soc->³”.
cook›_Ën
, 
gå
);

2410 ià(!
asoc
->
³”
.
cook›
)

2411 
ş—n_up
;

2418 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

2419 
Œª¥Üts
) {

2420 
Œª¥Üt
->
s¡h»sh
 = 
asoc
->
³”
.
i
.
a_rwnd
;

2424 ià(!
	`sùp_t¢m­_š™
(&
asoc
->
³”
.
t¢_m­
, 
SCTP_TSN_MAP_INITIAL
,

2425 
asoc
->
³”
.
i
.
š™Ÿl_t¢
, 
gå
))

2426 
ş—n_up
;

2439 ià(!
asoc
->
‹mp
) {

2440 
”rÜ
;

2442 
asoc
->
s¢m­
 = 
	`sùp_s¢m­_Ãw
×soc->
c
.
sš™_max_š¡»ams
,

2443 
asoc
->
c
.
sš™_num_o¡»ams
, 
gå
);

2444 ià(!
asoc
->
s¢m­
)

2445 
ş—n_up
;

2447 
”rÜ
 = 
	`sùp_assoc_£t_id
(
asoc
, 
gå
);

2448 ià(
”rÜ
)

2449 
ş—n_up
;

2462 
asoc
->
³”
.
add_£rŸl
 =‡soc->³”.
i
.
š™Ÿl_t¢
 - 1;

2465 
ş—n_up
:

2467 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
) {

2468 
Œª¥Üt
 = 
	`li¡_’Œy
(
pos
, 
sùp_Œª¥Üt
, 
Œª¥Üts
);

2469 ià(
Œª¥Üt
->
¡©e
 !ğ
SCTP_ACTIVE
)

2470 
	`sùp_assoc_rm_³”
(
asoc
, 
Œª¥Üt
);

2473 
nomem
:

2475 
	}
}

2489 
	$sùp_´oûss_·¿m
(
sùp_assocŸtiÚ
 *
asoc
,

2490 
sùp_·¿ms
 
·¿m
,

2491 cÚ¡ 
sùp_addr
 *
³”_addr
,

2492 
gå_t
 
gå
)

2494 
sùp_addr
 
addr
;

2495 
i
;

2496 
__u16
 
§t
;

2497 
»tv®
 = 1;

2498 
sùp_scİe_t
 
scİe
;

2499 
time_t
 
¡®e
;

2500 
sùp_af
 *
af
;

2501 
sùp_addr_·¿m
 *
addr_·¿m
;

2502 
sùp_Œª¥Üt
 *
t
;

2508 
·¿m
.
p
->
ty³
) {

2509 
SCTP_PARAM_IPV6_ADDRESS
:

2510 ià(
PF_INET6
 !ğ
asoc
->
ba£
.
sk
->
sk_çmy
)

2512 
do_addr_·¿m
;

2514 
SCTP_PARAM_IPV4_ADDRESS
:

2516 ià(
	`v6_Úly_sock
(
asoc
->
ba£
.
sk
))

2518 
do_addr_·¿m
:

2519 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`·¿m_ty³2af
(
·¿m
.
p
->
ty³
));

2520 
af
->
	`äom_addr_·¿m
(&
addr
, 
·¿m
.addr, 
	`htÚs
(
asoc
->
³”
.
pÜt
), 0);

2521 
scİe
 = 
	`sùp_scİe
(
³”_addr
);

2522 ià(
	`sùp_š_scİe
(&
addr
, 
scİe
))

2523 ià(!
	`sùp_assoc_add_³”
(
asoc
, &
addr
, 
gå
, 
SCTP_UNCONFIRMED
))

2527 
SCTP_PARAM_COOKIE_PRESERVATIVE
:

2528 ià(!
sùp_cook›_´e£rve_’abË
)

2531 
¡®e
 = 
	`Áohl
(
·¿m
.
liã
->
liã¥ª_šüem’t
);

2536 
asoc
->
cook›_liã
.
tv_£c
 +ğ
¡®e
 / 1000;

2537 
asoc
->
cook›_liã
.
tv_u£c
 +ğ(
¡®e
 % 1000) * 1000;

2540 
SCTP_PARAM_HOST_NAME_ADDRESS
:

2541 
	`SCTP_DEBUG_PRINTK
("unimplemented SCTP_HOST_NAME_ADDRESS\n");

2544 
SCTP_PARAM_SUPPORTED_ADDRESS_TYPES
:

2548 
asoc
->
³”
.
v4_add»ss
 = 0;

2549 
asoc
->
³”
.
v6_add»ss
 = 0;

2554 ià(
³”_addr
->
§
.
§_çmy
 =ğ
AF_INET6
)

2555 
asoc
->
³”
.
v6_add»ss
 = 1;

2556 ià(
³”_addr
->
§
.
§_çmy
 =ğ
AF_INET
)

2557 
asoc
->
³”
.
v4_add»ss
 = 1;

2560 
§t
 = 
	`Áohs
(
·¿m
.
p
->
Ëngth
è- (
sùp_·¿mhdr_t
);

2561 ià(
§t
)

2562 
§t
 /ğ(
__u16
);

2564 
i
 = 0; i < 
§t
; ++i) {

2565 
·¿m
.
§t
->
ty³s
[
i
]) {

2566 
SCTP_PARAM_IPV4_ADDRESS
:

2567 
asoc
->
³”
.
v4_add»ss
 = 1;

2570 
SCTP_PARAM_IPV6_ADDRESS
:

2571 ià(
PF_INET6
 =ğ
asoc
->
ba£
.
sk
->
sk_çmy
)

2572 
asoc
->
³”
.
v6_add»ss
 = 1;

2575 
SCTP_PARAM_HOST_NAME_ADDRESS
:

2576 
asoc
->
³”
.
ho¡Çme_add»ss
 = 1;

2585 
SCTP_PARAM_STATE_COOKIE
:

2586 
asoc
->
³”
.
cook›_Ën
 =

2587 
	`Áohs
(
·¿m
.
p
->
Ëngth
è- (
sùp_·¿mhdr_t
);

2588 
asoc
->
³”
.
cook›
 = 
·¿m
.cook›->
body
;

2591 
SCTP_PARAM_HEARTBEAT_INFO
:

2595 
SCTP_PARAM_UNRECOGNIZED_PARAMETERS
:

2599 
SCTP_PARAM_ECN_CAPABLE
:

2600 
asoc
->
³”
.
eú_ÿ·bË
 = 1;

2603 
SCTP_PARAM_ADAPTATION_LAYER_IND
:

2604 
asoc
->
³”
.
ad­tiÚ_šd
 = 
	`Áohl
(
·¿m
.
ašd
->adaptation_ind);

2607 
SCTP_PARAM_SET_PRIMARY
:

2608 ià(!
sùp_add_’abË
)

2609 
çÎ_through
;

2611 
addr_·¿m
 = 
·¿m
.
v
 + (
sùp_add_·¿m_t
);

2613 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`·¿m_ty³2af
(
·¿m
.
p
->
ty³
));

2614 
af
->
	`äom_addr_·¿m
(&
addr
, 
addr_·¿m
,

2615 
	`htÚs
(
asoc
->
³”
.
pÜt
), 0);

2620 ià(!
af
->
	`addr_v®id
(&
addr
, 
NULL
, NULL))

2623 
t
 = 
	`sùp_assoc_lookup_·ddr
(
asoc
, &
addr
);

2624 ià(!
t
)

2627 
	`sùp_assoc_£t_´im¬y
(
asoc
, 
t
);

2630 
SCTP_PARAM_SUPPORTED_EXT
:

2631 
	`sùp_´oûss_ext_·¿m
(
asoc
, 
·¿m
);

2634 
SCTP_PARAM_FWD_TSN_SUPPORT
:

2635 ià(
sùp_´sùp_’abË
) {

2636 
asoc
->
³”
.
´sùp_ÿ·bË
 = 1;

2640 
çÎ_through
;

2642 
SCTP_PARAM_RANDOM
:

2643 ià(!
sùp_auth_’abË
)

2644 
çÎ_through
;

2647 
asoc
->
³”
.
³”_¿ndom
 = 
	`kmemdup
(
·¿m
.
p
,

2648 
	`Áohs
(
·¿m
.
p
->
Ëngth
), 
gå
);

2649 ià(!
asoc
->
³”
.
³”_¿ndom
) {

2650 
»tv®
 = 0;

2655 
SCTP_PARAM_HMAC_ALGO
:

2656 ià(!
sùp_auth_’abË
)

2657 
çÎ_through
;

2660 
asoc
->
³”
.
³”_hmacs
 = 
	`kmemdup
(
·¿m
.
p
,

2661 
	`Áohs
(
·¿m
.
p
->
Ëngth
), 
gå
);

2662 ià(!
asoc
->
³”
.
³”_hmacs
) {

2663 
»tv®
 = 0;

2668 
	`sùp_auth_asoc_£t_deçuÉ_hmac
(
asoc
, 
·¿m
.
hmac_®go
);

2671 
SCTP_PARAM_CHUNKS
:

2672 ià(!
sùp_auth_’abË
)

2673 
çÎ_through
;

2675 
asoc
->
³”
.
³”_chunks
 = 
	`kmemdup
(
·¿m
.
p
,

2676 
	`Áohs
(
·¿m
.
p
->
Ëngth
), 
gå
);

2677 ià(!
asoc
->
³”
.
³”_chunks
)

2678 
»tv®
 = 0;

2680 
çÎ_through
:

2687 
	`SCTP_DEBUG_PRINTK
("Ignoring…aram: %d for‡ssociation %p.\n",

2688 
	`Áohs
(
·¿m
.
p
->
ty³
), 
asoc
);

2692  
»tv®
;

2693 
	}
}

2696 
__u32
 
	$sùp_g’”©e_g
(cÚ¡ 
sùp_’dpošt
 *
•
)

2701 
__u32
 
x
;

2704 
	`g‘_¿ndom_by‹s
(&
x
, (
__u32
));

2705 } 
x
 == 0);

2707  
x
;

2708 
	}
}

2711 
__u32
 
	$sùp_g’”©e_t¢
(cÚ¡ 
sùp_’dpošt
 *
•
)

2713 
__u32
 
»tv®
;

2715 
	`g‘_¿ndom_by‹s
(&
»tv®
, (
__u32
));

2716  
»tv®
;

2717 
	}
}

2741 
sùp_chunk
 *
	$sùp_make_ascÚf
(
sùp_assocŸtiÚ
 *
asoc
,

2742 
sùp_addr
 *
addr
,

2743 
v·¿m_Ën
)

2745 
sùp_addhdr_t
 
ascÚf
;

2746 
sùp_chunk
 *
»tv®
;

2747 
Ëngth
 = (
ascÚf
è+ 
v·¿m_Ën
;

2748 
sùp_addr_·¿m
 
add½¬am
;

2749 
add¾’
;

2750 
sùp_af
 *
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
v4
.
sš_çmy
);

2752 
add¾’
 = 
af
->
	`to_addr_·¿m
(
addr
, &
add½¬am
);

2753 ià(!
add¾’
)

2754  
NULL
;

2755 
Ëngth
 +ğ
add¾’
;

2758 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_ASCONF
, 0, 
Ëngth
);

2759 ià(!
»tv®
)

2760  
NULL
;

2762 
ascÚf
.
£rŸl
 = 
	`htÚl
(
asoc
->
add_£rŸl
++);

2764 
»tv®
->
subh
.
add_hdr
 =

2765 
	`sùp_addto_chunk
(
»tv®
, (
ascÚf
), &asconf);

2766 
»tv®
->
·¿m_hdr
.
v
 =

2767 
	`sùp_addto_chunk
(
»tv®
, 
add¾’
, &
add½¬am
);

2769  
»tv®
;

2770 
	}
}

2796 
sùp_chunk
 *
	$sùp_make_ascÚf_upd©e_
(
sùp_assocŸtiÚ
 *
asoc
,

2797 
sùp_addr
 *
Ïddr
,

2798 
sockaddr
 *
addrs
,

2799 
addrút
,

2800 
__be16
 
æags
)

2802 
sùp_add_·¿m_t
 
·¿m
;

2803 
sùp_chunk
 *
»tv®
;

2804 
sùp_addr_·¿m
 
addr_·¿m
;

2805 
sùp_addr
 *
addr
;

2806 *
addr_buf
;

2807 
sùp_af
 *
af
;

2808 
·¿mËn
 = (
·¿m
);

2809 
addr_·¿m_Ën
 = 0;

2810 
tÙ®Ën
 = 0;

2811 
i
;

2814 
addr_buf
 = 
addrs
;

2815 
i
 = 0; i < 
addrút
; i++) {

2816 
addr
 = (
sùp_addr
 *)
addr_buf
;

2817 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
v4
.
sš_çmy
);

2818 
addr_·¿m_Ën
 = 
af
->
	`to_addr_·¿m
(
addr
, &
addr_·¿m
);

2820 
tÙ®Ën
 +ğ
·¿mËn
;

2821 
tÙ®Ën
 +ğ
addr_·¿m_Ën
;

2823 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

2827 
»tv®
 = 
	`sùp_make_ascÚf
(
asoc
, 
Ïddr
, 
tÙ®Ën
);

2828 ià(!
»tv®
)

2829  
NULL
;

2832 
addr_buf
 = 
addrs
;

2833 
i
 = 0; i < 
addrút
; i++) {

2834 
addr
 = (
sùp_addr
 *)
addr_buf
;

2835 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
v4
.
sš_çmy
);

2836 
addr_·¿m_Ën
 = 
af
->
	`to_addr_·¿m
(
addr
, &
addr_·¿m
);

2837 
·¿m
.
·¿m_hdr
.
ty³
 = 
æags
;

2838 
·¿m
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
(
·¿mËn
 + 
addr_·¿m_Ën
);

2839 
·¿m
.
ür_id
 = 
i
;

2841 
	`sùp_addto_chunk
(
»tv®
, 
·¿mËn
, &
·¿m
);

2842 
	`sùp_addto_chunk
(
»tv®
, 
addr_·¿m_Ën
, &
addr_·¿m
);

2844 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

2846  
»tv®
;

2847 
	}
}

2863 
sùp_chunk
 *
	$sùp_make_ascÚf_£t_´im
(
sùp_assocŸtiÚ
 *
asoc
,

2864 
sùp_addr
 *
addr
)

2866 
sùp_add_·¿m_t
 
·¿m
;

2867 
sùp_chunk
 *
»tv®
;

2868 
Ën
 = (
·¿m
);

2869 
sùp_addr_·¿m
 
add½¬am
;

2870 
add¾’
;

2871 
sùp_af
 *
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
v4
.
sš_çmy
);

2873 
add¾’
 = 
af
->
	`to_addr_·¿m
(
addr
, &
add½¬am
);

2874 ià(!
add¾’
)

2875  
NULL
;

2876 
Ën
 +ğ
add¾’
;

2879 
»tv®
 = 
	`sùp_make_ascÚf
(
asoc
, 
addr
, 
Ën
);

2880 ià(!
»tv®
)

2881  
NULL
;

2883 
·¿m
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_SET_PRIMARY
;

2884 
·¿m
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
(
Ën
);

2885 
·¿m
.
ür_id
 = 0;

2887 
	`sùp_addto_chunk
(
»tv®
, (
·¿m
), &param);

2888 
	`sùp_addto_chunk
(
»tv®
, 
add¾’
, &
add½¬am
);

2890  
»tv®
;

2891 
	}
}

2912 
sùp_chunk
 *
	$sùp_make_ascÚf_ack
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2913 
__u32
 
£rŸl
, 
v·¿m_Ën
)

2915 
sùp_addhdr_t
 
ascÚf
;

2916 
sùp_chunk
 *
»tv®
;

2917 
Ëngth
 = (
ascÚf
è+ 
v·¿m_Ën
;

2920 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_ASCONF_ACK
, 0, 
Ëngth
);

2921 ià(!
»tv®
)

2922  
NULL
;

2924 
ascÚf
.
£rŸl
 = 
	`htÚl
(serial);

2926 
»tv®
->
subh
.
add_hdr
 =

2927 
	`sùp_addto_chunk
(
»tv®
, (
ascÚf
), &asconf);

2929  
»tv®
;

2930 
	}
}

2933 
	$sùp_add_ascÚf_»¥Ú£
(
sùp_chunk
 *
chunk
, 
__be32
 
ür_id
,

2934 
__be16
 
”r_code
, 
sùp_add_·¿m_t
 *
ascÚf_·¿m
)

2936 
sùp_add_·¿m_t
 
ack_·¿m
;

2937 
sùp_”rhdr_t
 
”r_·¿m
;

2938 
ascÚf_·¿m_Ën
 = 0;

2939 
”r_·¿m_Ën
 = 0;

2940 
__be16
 
»¥Ú£_ty³
;

2942 ià(
SCTP_ERROR_NO_ERROR
 =ğ
”r_code
) {

2943 
»¥Ú£_ty³
 = 
SCTP_PARAM_SUCCESS_REPORT
;

2945 
»¥Ú£_ty³
 = 
SCTP_PARAM_ERR_CAUSE
;

2946 
”r_·¿m_Ën
 = (
”r_·¿m
);

2947 ià(
ascÚf_·¿m
)

2948 
ascÚf_·¿m_Ën
 =

2949 
	`Áohs
(
ascÚf_·¿m
->
·¿m_hdr
.
Ëngth
);

2953 
ack_·¿m
.
·¿m_hdr
.
ty³
 = 
»¥Ú£_ty³
;

2954 
ack_·¿m
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
((ack_param) +

2955 
”r_·¿m_Ën
 +

2956 
ascÚf_·¿m_Ën
);

2957 
ack_·¿m
.
ür_id
 = crr_id;

2958 
	`sùp_addto_chunk
(
chunk
, (
ack_·¿m
), &ack_param);

2960 ià(
SCTP_ERROR_NO_ERROR
 =ğ
”r_code
)

2964 
”r_·¿m
.
ÿu£
 = 
”r_code
;

2965 
”r_·¿m
.
Ëngth
 = 
	`htÚs
(
”r_·¿m_Ën
 + 
ascÚf_·¿m_Ën
);

2966 
	`sùp_addto_chunk
(
chunk
, 
”r_·¿m_Ën
, &
”r_·¿m
);

2969 ià(
ascÚf_·¿m
)

2970 
	`sùp_addto_chunk
(
chunk
, 
ascÚf_·¿m_Ën
, 
ascÚf_·¿m
);

2971 
	}
}

2974 
__be16
 
	$sùp_´oûss_ascÚf_·¿m
(
sùp_assocŸtiÚ
 *
asoc
,

2975 
sùp_chunk
 *
ascÚf
,

2976 
sùp_add_·¿m_t
 *
ascÚf_·¿m
)

2978 
sùp_Œª¥Üt
 *
³”
;

2979 
sùp_af
 *
af
;

2980 
sùp_addr
 
addr
;

2981 
sùp_addr_·¿m
 *
addr_·¿m
;

2983 
addr_·¿m
 = (
sùp_addr_·¿m
 *)

2984 ((*)
ascÚf_·¿m
 + (
sùp_add_·¿m_t
));

2986 ià(
ascÚf_·¿m
->
·¿m_hdr
.
ty³
 !ğ
SCTP_PARAM_ADD_IP
 &&

2987 
ascÚf_·¿m
->
·¿m_hdr
.
ty³
 !ğ
SCTP_PARAM_DEL_IP
 &&

2988 
ascÚf_·¿m
->
·¿m_hdr
.
ty³
 !ğ
SCTP_PARAM_SET_PRIMARY
)

2989  
SCTP_ERROR_UNKNOWN_PARAM
;

2991 
addr_·¿m
->
v4
.
·¿m_hdr
.
ty³
) {

2992 
SCTP_PARAM_IPV6_ADDRESS
:

2993 ià(!
asoc
->
³”
.
v6_add»ss
)

2994  
SCTP_ERROR_DNS_FAILED
;

2996 
SCTP_PARAM_IPV4_ADDRESS
:

2997 ià(!
asoc
->
³”
.
v4_add»ss
)

2998  
SCTP_ERROR_DNS_FAILED
;

3001  
SCTP_ERROR_DNS_FAILED
;

3004 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`·¿m_ty³2af
(
addr_·¿m
->
v4
.
·¿m_hdr
.
ty³
));

3005 ià(
	`uÆik–y
(!
af
))

3006  
SCTP_ERROR_DNS_FAILED
;

3008 
af
->
	`äom_addr_·¿m
(&
addr
, 
addr_·¿m
, 
	`htÚs
(
asoc
->
³”
.
pÜt
), 0);

3015 ià(!
af
->
	`is_ªy
(&
addr
è&& !af->
	`addr_v®id
(&addr, 
NULL
, 
ascÚf
->
skb
))

3016  
SCTP_ERROR_DNS_FAILED
;

3018 
ascÚf_·¿m
->
·¿m_hdr
.
ty³
) {

3019 
SCTP_PARAM_ADD_IP
:

3024 ià(
af
->
	`is_ªy
(&
addr
))

3025 
	`memıy
(&
addr
, &
ascÚf
->
sourû
, (addr));

3034 
³”
 = 
	`sùp_assoc_add_³”
(
asoc
, &
addr
, 
GFP_ATOMIC
, 
SCTP_UNCONFIRMED
);

3035 ià(!
³”
)

3036  
SCTP_ERROR_RSRC_LOW
;

3039 ià(!
	`mod_tim”
(&
³”
->
hb_tim”
, 
	`sùp_Œª¥Üt_timeout
(peer)))

3040 
	`sùp_Œª¥Üt_hŞd
(
³”
);

3042 
SCTP_PARAM_DEL_IP
:

3048 ià(
asoc
->
³”
.
Œª¥Üt_couÁ
 == 1)

3049  
SCTP_ERROR_DEL_LAST_IP
;

3058 ià(
	`sùp_cmp_addr_exaù
(
	`sùp_sourû
(
ascÚf
), &
addr
))

3059  
SCTP_ERROR_DEL_SRC_IP
;

3066 ià(
af
->
	`is_ªy
(&
addr
)) {

3067 
	`sùp_assoc_£t_´im¬y
(
asoc
, 
ascÚf
->
Œª¥Üt
);

3068 
	`sùp_assoc_d–_nÚ´im¬y_³”s
(
asoc
,

3069 
ascÚf
->
Œª¥Üt
);

3071 
	`sùp_assoc_d–_³”
(
asoc
, &
addr
);

3073 
SCTP_PARAM_SET_PRIMARY
:

3079 ià(
af
->
	`is_ªy
(&
addr
))

3080 
	`memıy
(&
addr
.
v4
, 
	`sùp_sourû
(
ascÚf
), (addr));

3082 
³”
 = 
	`sùp_assoc_lookup_·ddr
(
asoc
, &
addr
);

3083 ià(!
³”
)

3084  
SCTP_ERROR_DNS_FAILED
;

3086 
	`sùp_assoc_£t_´im¬y
(
asoc
, 
³”
);

3090  
SCTP_ERROR_NO_ERROR
;

3091 
	}
}

3094 
	$sùp_v”ify_ascÚf
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3095 
sùp_·¿mhdr
 *
·¿m_hdr
, *
chunk_’d
,

3096 
sùp_·¿mhdr
 **
”½
) {

3097 
sùp_add_·¿m_t
 *
ascÚf_·¿m
;

3098 
sùp_·¿ms
 
·¿m
;

3099 
Ëngth
, 
¶’
;

3101 
·¿m
.
v
 = (
sùp_·¿mhdr_t
 *è
·¿m_hdr
;

3102 
·¿m
.
v
 <ğ
chunk_’d
 - (
sùp_·¿mhdr_t
)) {

3103 
Ëngth
 = 
	`Áohs
(
·¿m
.
p
->length);

3104 *
”½
 = 
·¿m
.
p
;

3106 ià(
·¿m
.
v
 > 
chunk_’d
 - 
Ëngth
 ||

3107 
Ëngth
 < (
sùp_·¿mhdr_t
))

3110 
·¿m
.
p
->
ty³
) {

3111 
SCTP_PARAM_ADD_IP
:

3112 
SCTP_PARAM_DEL_IP
:

3113 
SCTP_PARAM_SET_PRIMARY
:

3114 
ascÚf_·¿m
 = (
sùp_add_·¿m_t
 *)
·¿m
.
v
;

3115 
¶’
 = 
	`Áohs
(
ascÚf_·¿m
->
·¿m_hdr
.
Ëngth
);

3116 ià(
¶’
 < (
sùp_add_·¿m_t
) +

3117 (
sùp_·¿mhdr_t
))

3120 
SCTP_PARAM_SUCCESS_REPORT
:

3121 
SCTP_PARAM_ADAPTATION_LAYER_IND
:

3122 ià(
Ëngth
 !ğ(
sùp_add_·¿m_t
))

3130 
·¿m
.
v
 +ğ
	`WORD_ROUND
(
Ëngth
);

3133 ià(
·¿m
.
v
 !ğ
chunk_’d
)

3137 
	}
}

3142 
sùp_chunk
 *
	$sùp_´oûss_ascÚf
(
sùp_assocŸtiÚ
 *
asoc
,

3143 
sùp_chunk
 *
ascÚf
)

3145 
sùp_addhdr_t
 *
hdr
;

3146 
sùp_addr_·¿m
 *
addr_·¿m
;

3147 
sùp_add_·¿m_t
 *
ascÚf_·¿m
;

3148 
sùp_chunk
 *
ascÚf_ack
;

3150 
__be16
 
”r_code
;

3151 
Ëngth
 = 0;

3152 
chunk_Ën
;

3153 
__u32
 
£rŸl
;

3154 
®l_·¿m_·ss
 = 1;

3156 
chunk_Ën
 = 
	`Áohs
(
ascÚf
->
chunk_hdr
->
Ëngth
è- (
sùp_chunkhdr_t
);

3157 
hdr
 = (
sùp_addhdr_t
 *)
ascÚf
->
skb
->
d©a
;

3158 
£rŸl
 = 
	`Áohl
(
hdr
->serial);

3161 
Ëngth
 = (
sùp_addhdr_t
);

3162 
addr_·¿m
 = (
sùp_addr_·¿m
 *)(
ascÚf
->
skb
->
d©a
 + 
Ëngth
);

3163 
chunk_Ën
 -ğ
Ëngth
;

3168 
Ëngth
 = 
	`Áohs
(
addr_·¿m
->
v4
.
·¿m_hdr
.length);

3169 
ascÚf_·¿m
 = (
sùp_add_·¿m_t
 *)((*)
addr_·¿m
 + 
Ëngth
);

3170 
chunk_Ën
 -ğ
Ëngth
;

3177 
ascÚf_ack
 = 
	`sùp_make_ascÚf_ack
(
asoc
, 
£rŸl
, 
chunk_Ën
 * 4);

3178 ià(!
ascÚf_ack
)

3179 
dÚe
;

3182 
chunk_Ën
 > 0) {

3183 
”r_code
 = 
	`sùp_´oûss_ascÚf_·¿m
(
asoc
, 
ascÚf
,

3184 
ascÚf_·¿m
);

3192 ià(
SCTP_ERROR_NO_ERROR
 !ğ
”r_code
)

3193 
®l_·¿m_·ss
 = 0;

3195 ià(!
®l_·¿m_·ss
)

3196 
	`sùp_add_ascÚf_»¥Ú£
(
ascÚf_ack
,

3197 
ascÚf_·¿m
->
ür_id
, 
”r_code
,

3198 
ascÚf_·¿m
);

3205 ià(
SCTP_ERROR_RSRC_LOW
 =ğ
”r_code
)

3206 
dÚe
;

3209 
Ëngth
 = 
	`Áohs
(
ascÚf_·¿m
->
·¿m_hdr
.length);

3210 
ascÚf_·¿m
 = (
sùp_add_·¿m_t
 *)((*)asconf_param +

3211 
Ëngth
);

3212 
chunk_Ën
 -ğ
Ëngth
;

3215 
dÚe
:

3216 
asoc
->
³”
.
add_£rŸl
++;

3221 ià(
ascÚf_ack
) {

3222 
	`sùp_chunk_hŞd
(
ascÚf_ack
);

3223 
	`li¡_add_
(&
ascÚf_ack
->
Œªsm™‹d_li¡
,

3224 &
asoc
->
ascÚf_ack_li¡
);

3227  
ascÚf_ack
;

3228 
	}
}

3231 
	$sùp_ascÚf_·¿m_sucûss
(
sùp_assocŸtiÚ
 *
asoc
,

3232 
sùp_add_·¿m_t
 *
ascÚf_·¿m
)

3234 
sùp_af
 *
af
;

3235 
sùp_addr
 
addr
;

3236 
sùp_bšd_addr
 *
bp
 = &
asoc
->
ba£
.
bšd_addr
;

3237 
sùp_addr_·¿m
 *
addr_·¿m
;

3238 
sùp_Œª¥Üt
 *
Œª¥Üt
;

3239 
sùp_sockaddr_’Œy
 *
§ddr
;

3241 
addr_·¿m
 = (
sùp_addr_·¿m
 *)

3242 ((*)
ascÚf_·¿m
 + (
sùp_add_·¿m_t
));

3245 
af
 = 
	`sùp_g‘_af_¥ecific
(
	`·¿m_ty³2af
(
addr_·¿m
->
v4
.
·¿m_hdr
.
ty³
));

3246 
af
->
	`äom_addr_·¿m
(&
addr
, 
addr_·¿m
, 
	`htÚs
(
bp
->
pÜt
), 0);

3248 
ascÚf_·¿m
->
·¿m_hdr
.
ty³
) {

3249 
SCTP_PARAM_ADD_IP
:

3253 
	`loÿl_bh_di§bË
();

3254 
	`li¡_fÜ_—ch_’Œy
(
§ddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

3255 ià(
	`sùp_cmp_addr_exaù
(&
§ddr
->
a
, &
addr
))

3256 
§ddr
->
¡©e
 = 
SCTP_ADDR_SRC
;

3258 
	`loÿl_bh_’abË
();

3259 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

3260 
Œª¥Üts
) {

3261 
	`d¡_»Ëa£
(
Œª¥Üt
->
d¡
);

3262 
Œª¥Üt
->
d¡
 = 
NULL
;

3265 
SCTP_PARAM_DEL_IP
:

3266 
	`loÿl_bh_di§bË
();

3267 
	`sùp_d–_bšd_addr
(
bp
, &
addr
);

3268 
	`loÿl_bh_’abË
();

3269 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

3270 
Œª¥Üts
) {

3271 
	`d¡_»Ëa£
(
Œª¥Üt
->
d¡
);

3272 
Œª¥Üt
->
d¡
 = 
NULL
;

3278 
	}
}

3289 
__be16
 
	$sùp_g‘_ascÚf_»¥Ú£
(
sùp_chunk
 *
ascÚf_ack
,

3290 
sùp_add_·¿m_t
 *
ascÚf_·¿m
,

3291 
no_”r
)

3293 
sùp_add_·¿m_t
 *
ascÚf_ack_·¿m
;

3294 
sùp_”rhdr_t
 *
”r_·¿m
;

3295 
Ëngth
;

3296 
ascÚf_ack_Ën
;

3297 
__be16
 
”r_code
;

3299 ià(
no_”r
)

3300 
”r_code
 = 
SCTP_ERROR_NO_ERROR
;

3302 
”r_code
 = 
SCTP_ERROR_REQ_REFUSED
;

3304 
ascÚf_ack_Ën
 = 
	`Áohs
(
ascÚf_ack
->
chunk_hdr
->
Ëngth
) -

3305 (
sùp_chunkhdr_t
);

3310 
Ëngth
 = (
sùp_addhdr_t
);

3311 
ascÚf_ack_·¿m
 = (
sùp_add_·¿m_t
 *)(
ascÚf_ack
->
skb
->
d©a
 +

3312 
Ëngth
);

3313 
ascÚf_ack_Ën
 -ğ
Ëngth
;

3315 
ascÚf_ack_Ën
 > 0) {

3316 ià(
ascÚf_ack_·¿m
->
ür_id
 =ğ
ascÚf_·¿m
->crr_id) {

3317 
ascÚf_ack_·¿m
->
·¿m_hdr
.
ty³
) {

3318 
SCTP_PARAM_SUCCESS_REPORT
:

3319  
SCTP_ERROR_NO_ERROR
;

3320 
SCTP_PARAM_ERR_CAUSE
:

3321 
Ëngth
 = (
sùp_add_·¿m_t
);

3322 
”r_·¿m
 = (
sùp_”rhdr_t
 *)

3323 ((*)
ascÚf_ack_·¿m
 + 
Ëngth
);

3324 
ascÚf_ack_Ën
 -ğ
Ëngth
;

3325 ià(
ascÚf_ack_Ën
 > 0)

3326  
”r_·¿m
->
ÿu£
;

3328  
SCTP_ERROR_INV_PARAM
;

3331  
SCTP_ERROR_INV_PARAM
;

3335 
Ëngth
 = 
	`Áohs
(
ascÚf_ack_·¿m
->
·¿m_hdr
.length);

3336 
ascÚf_ack_·¿m
 = (
sùp_add_·¿m_t
 *)

3337 ((*)
ascÚf_ack_·¿m
 + 
Ëngth
);

3338 
ascÚf_ack_Ën
 -ğ
Ëngth
;

3341  
”r_code
;

3342 
	}
}

3345 
	$sùp_´oûss_ascÚf_ack
(
sùp_assocŸtiÚ
 *
asoc
,

3346 
sùp_chunk
 *
ascÚf_ack
)

3348 
sùp_chunk
 *
ascÚf
 = 
asoc
->
add_Ï¡_ascÚf
;

3349 
sùp_addr_·¿m
 *
addr_·¿m
;

3350 
sùp_add_·¿m_t
 *
ascÚf_·¿m
;

3351 
Ëngth
 = 0;

3352 
ascÚf_Ën
 = 
ascÚf
->
skb
->
Ën
;

3353 
®l_·¿m_·ss
 = 0;

3354 
no_”r
 = 1;

3355 
»tv®
 = 0;

3356 
__be16
 
”r_code
 = 
SCTP_ERROR_NO_ERROR
;

3361 
Ëngth
 = (
sùp_add_chunk_t
);

3362 
addr_·¿m
 = (
sùp_addr_·¿m
 *)(
ascÚf
->
skb
->
d©a
 + 
Ëngth
);

3363 
ascÚf_Ën
 -ğ
Ëngth
;

3368 
Ëngth
 = 
	`Áohs
(
addr_·¿m
->
v4
.
·¿m_hdr
.length);

3369 
ascÚf_·¿m
 = (
sùp_add_·¿m_t
 *)((*)
addr_·¿m
 + 
Ëngth
);

3370 
ascÚf_Ën
 -ğ
Ëngth
;

3377 ià(
ascÚf_ack
->
skb
->
Ën
 =ğ(
sùp_addhdr_t
))

3378 
®l_·¿m_·ss
 = 1;

3381 
ascÚf_Ën
 > 0) {

3382 ià(
®l_·¿m_·ss
)

3383 
”r_code
 = 
SCTP_ERROR_NO_ERROR
;

3385 
”r_code
 = 
	`sùp_g‘_ascÚf_»¥Ú£
(
ascÚf_ack
,

3386 
ascÚf_·¿m
,

3387 
no_”r
);

3388 ià(
no_”r
 && (
SCTP_ERROR_NO_ERROR
 !ğ
”r_code
))

3389 
no_”r
 = 0;

3392 
”r_code
) {

3393 
SCTP_ERROR_NO_ERROR
:

3394 
	`sùp_ascÚf_·¿m_sucûss
(
asoc
, 
ascÚf_·¿m
);

3397 
SCTP_ERROR_RSRC_LOW
:

3398 
»tv®
 = 1;

3401 
SCTP_ERROR_UNKNOWN_PARAM
:

3405 
asoc
->
³”
.
add_di§bËd_mask
 |=

3406 
ascÚf_·¿m
->
·¿m_hdr
.
ty³
;

3409 
SCTP_ERROR_REQ_REFUSED
:

3410 
SCTP_ERROR_DEL_LAST_IP
:

3411 
SCTP_ERROR_DEL_SRC_IP
:

3419 
Ëngth
 = 
	`Áohs
(
ascÚf_·¿m
->
·¿m_hdr
.length);

3420 
ascÚf_·¿m
 = (
sùp_add_·¿m_t
 *)((*)asconf_param +

3421 
Ëngth
);

3422 
ascÚf_Ën
 -ğ
Ëngth
;

3426 
	`li¡_d–_š™
(&
ascÚf
->
Œªsm™‹d_li¡
);

3427 
	`sùp_chunk_ä“
(
ascÚf
);

3428 
asoc
->
add_Ï¡_ascÚf
 = 
NULL
;

3430  
»tv®
;

3431 
	}
}

3434 
sùp_chunk
 *
	$sùp_make_fwdt¢
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3435 
__u32
 
Ãw_cum_t¢
, 
size_t
 
n¡»ams
,

3436 
sùp_fwdt¢_sk
 *
skli¡
)

3438 
sùp_chunk
 *
»tv®
 = 
NULL
;

3439 
sùp_fwdt¢_chunk
 *
á¢_chunk
;

3440 
sùp_fwdt¢_hdr
 
á¢_hdr
;

3441 
sùp_fwdt¢_sk
 
sk
;

3442 
size_t
 
hšt
;

3443 
i
;

3445 
hšt
 = (
n¡»ams
 + 1è* (
__u32
);

3447 
»tv®
 = 
	`sùp_make_chunk
(
asoc
, 
SCTP_CID_FWD_TSN
, 0, 
hšt
);

3449 ià(!
»tv®
)

3450  
NULL
;

3452 
á¢_chunk
 = (
sùp_fwdt¢_chunk
 *)
»tv®
->
subh
.
fwdt¢_hdr
;

3454 
á¢_hdr
.
Ãw_cum_t¢
 = 
	`htÚl
(new_cum_tsn);

3455 
»tv®
->
subh
.
fwdt¢_hdr
 =

3456 
	`sùp_addto_chunk
(
»tv®
, (
á¢_hdr
), &ftsn_hdr);

3458 
i
 = 0; i < 
n¡»ams
; i++) {

3459 
sk
.
¡»am
 = 
skli¡
[
i
].stream;

3460 
sk
.
s¢
 = 
skli¡
[
i
].ssn;

3461 
	`sùp_addto_chunk
(
»tv®
, (
sk
), &skip);

3464  
»tv®
;

3465 
	}
}

	@sm_sideeffect.c

50 
	~<lšux/skbuff.h
>

51 
	~<lšux/ty³s.h
>

52 
	~<lšux/sock‘.h
>

53 
	~<lšux/.h
>

54 
	~<Ãt/sock.h
>

55 
	~<Ãt/sùp/sùp.h
>

56 
	~<Ãt/sùp/sm.h
>

58 
sùp_cmd_š‹½»‹r
(
sùp_ev’t_t
 
ev’t_ty³
,

59 
sùp_subty³_t
 
subty³
,

60 
sùp_¡©e_t
 
¡©e
,

61 
sùp_’dpošt
 *
•
,

62 
sùp_assocŸtiÚ
 *
asoc
,

63 *
ev’t_¬g
,

64 
sùp_di¥os™iÚ_t
 
¡©us
,

65 
sùp_cmd_£q_t
 *
commªds
,

66 
gå_t
 
gå
);

67 
sùp_side_efãùs
(
sùp_ev’t_t
 
ev’t_ty³
, 
sùp_subty³_t
 
subty³
,

68 
sùp_¡©e_t
 
¡©e
,

69 
sùp_’dpošt
 *
•
,

70 
sùp_assocŸtiÚ
 *
asoc
,

71 *
ev’t_¬g
,

72 
sùp_di¥os™iÚ_t
 
¡©us
,

73 
sùp_cmd_£q_t
 *
commªds
,

74 
gå_t
 
gå
);

76 
sùp_cmd_hb_tim”_upd©e
(
sùp_cmd_£q_t
 *
cmds
,

77 
sùp_Œª¥Üt
 *
t
);

83 
	$sùp_do_eú_û_wÜk
(
sùp_assocŸtiÚ
 *
asoc
,

84 
__u32
 
lowe¡_t¢
)

88 
asoc
->
Ï¡_eúe_t¢
 = 
lowe¡_t¢
;

89 
asoc
->
Ãed_eúe
 = 1;

90 
	}
}

104 
sùp_chunk
 *
	$sùp_do_eú_eúe_wÜk
(
sùp_assocŸtiÚ
 *
asoc
,

105 
__u32
 
lowe¡_t¢
,

106 
sùp_chunk
 *
chunk
)

108 
sùp_chunk
 *
»¶
;

120 ià(
	`TSN_É
(
asoc
->
Ï¡_cwr_t¢
, 
lowe¡_t¢
)) {

121 
sùp_Œª¥Üt
 *
Œª¥Üt
;

126 
Œª¥Üt
 = 
	`sùp_assoc_lookup_t¢
(
asoc
, 
lowe¡_t¢
);

129 ià(
Œª¥Üt
)

130 
	`sùp_Œª¥Üt_low”_cwnd
(
Œª¥Üt
,

131 
SCTP_LOWER_CWND_ECNE
);

132 
asoc
->
Ï¡_cwr_t¢
 = 
lowe¡_t¢
;

138 
»¶
 = 
	`sùp_make_cwr
(
asoc
,‡soc->
Ï¡_cwr_t¢
, 
chunk
);

143  
»¶
;

144 
	}
}

147 
	$sùp_do_eú_cwr_wÜk
(
sùp_assocŸtiÚ
 *
asoc
,

148 
__u32
 
lowe¡_t¢
)

153 
asoc
->
Ãed_eúe
 = 0;

154 
	}
}

157 
	$sùp_g’_§ck
(
sùp_assocŸtiÚ
 *
asoc
, 
fÜû
,

158 
sùp_cmd_£q_t
 *
commªds
)

160 
__u32
 
ù¢
, 
max_t¢_£’
;

161 
sùp_chunk
 *
§ck
;

162 
sùp_Œª¥Üt
 *
Œªs
 = 
asoc
->
³”
.
Ï¡_d©a_äom
;

163 
”rÜ
 = 0;

165 ià(
fÜû
 ||

166 (!
Œªs
 && (
asoc
->
·¿m_æags
 & 
SPP_SACKDELAY_DISABLE
)) ||

167 (
Œªs
 && (Œªs->
·¿m_æags
 & 
SPP_SACKDELAY_DISABLE
)))

168 
asoc
->
³”
.
§ck_Ãeded
 = 1;

170 
ù¢
 = 
	`sùp_t¢m­_g‘_ù¢
(&
asoc
->
³”
.
t¢_m­
);

171 
max_t¢_£’
 = 
	`sùp_t¢m­_g‘_max_t¢_£’
(&
asoc
->
³”
.
t¢_m­
);

183 ià(
max_t¢_£’
 !ğ
ù¢
)

184 
asoc
->
³”
.
§ck_Ãeded
 = 1;

194 ià(!
asoc
->
³”
.
§ck_Ãeded
) {

195 
asoc
->
³”
.
§ck_út
++;

202 ià(
Œªs
) {

204 ià(
asoc
->
³”
.
§ck_út
 >ğ
Œªs
->
§ckäeq
 - 1)

205 
asoc
->
³”
.
§ck_Ãeded
 = 1;

207 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_SACK
] =

208 
Œªs
->
§ckd–ay
;

211 ià(
asoc
->
³”
.
§ck_út
 >ğasoc->
§ckäeq
 - 1)

212 
asoc
->
³”
.
§ck_Ãeded
 = 1;

214 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_SACK
] =

215 
asoc
->
§ckd–ay
;

219 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

220 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_SACK
));

222 
asoc
->
a_rwnd
 =‡soc->
rwnd
;

223 
§ck
 = 
	`sùp_make_§ck
(
asoc
);

224 ià(!
§ck
)

225 
nomem
;

227 
asoc
->
³”
.
§ck_Ãeded
 = 0;

228 
asoc
->
³”
.
§ck_út
 = 0;

230 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
§ck
));

233 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

234 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_SACK
));

237  
”rÜ
;

238 
nomem
:

239 
”rÜ
 = -
ENOMEM
;

240  
”rÜ
;

241 
	}
}

246 
	$sùp_g’”©e_t3_¹x_ev’t
(
³”
)

248 
”rÜ
;

249 
sùp_Œª¥Üt
 *
Œª¥Üt
 = (sùp_Œª¥Üˆ*è
³”
;

250 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

254 
	`sùp_bh_lock_sock
(
asoc
->
ba£
.
sk
);

255 ià(
	`sock_owÃd_by_u£r
(
asoc
->
ba£
.
sk
)) {

256 
	`SCTP_DEBUG_PRINTK
("%s:Sock i busy.\n", 
__func__
);

259 ià(!
	`mod_tim”
(&
Œª¥Üt
->
T3_¹x_tim”
, 
jiff›s
 + (
HZ
/20)))

260 
	`sùp_Œª¥Üt_hŞd
(
Œª¥Üt
);

261 
out_uÆock
;

267 ià(
Œª¥Üt
->
d—d
)

268 
out_uÆock
;

271 
”rÜ
 = 
	`sùp_do_sm
(
SCTP_EVENT_T_TIMEOUT
,

272 
	`SCTP_ST_TIMEOUT
(
SCTP_EVENT_TIMEOUT_T3_RTX
),

273 
asoc
->
¡©e
,

274 
asoc
->
•
,‡soc,

275 
Œª¥Üt
, 
GFP_ATOMIC
);

277 ià(
”rÜ
)

278 
asoc
->
ba£
.
sk
->
sk_”r
 = -
”rÜ
;

280 
out_uÆock
:

281 
	`sùp_bh_uÆock_sock
(
asoc
->
ba£
.
sk
);

282 
	`sùp_Œª¥Üt_put
(
Œª¥Üt
);

283 
	}
}

288 
	$sùp_g’”©e_timeout_ev’t
(
sùp_assocŸtiÚ
 *
asoc
,

289 
sùp_ev’t_timeout_t
 
timeout_ty³
)

291 
”rÜ
 = 0;

293 
	`sùp_bh_lock_sock
(
asoc
->
ba£
.
sk
);

294 ià(
	`sock_owÃd_by_u£r
(
asoc
->
ba£
.
sk
)) {

295 
	`SCTP_DEBUG_PRINTK
("%s:Sock is busy:imer %d\n",

296 
__func__
,

297 
timeout_ty³
);

300 ià(!
	`mod_tim”
(&
asoc
->
tim”s
[
timeout_ty³
], 
jiff›s
 + (
HZ
/20)))

301 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

302 
out_uÆock
;

308 ià(
asoc
->
ba£
.
d—d
)

309 
out_uÆock
;

312 
”rÜ
 = 
	`sùp_do_sm
(
SCTP_EVENT_T_TIMEOUT
,

313 
	`SCTP_ST_TIMEOUT
(
timeout_ty³
),

314 
asoc
->
¡©e
,‡soc->
•
,‡soc,

315 (*)
timeout_ty³
, 
GFP_ATOMIC
);

317 ià(
”rÜ
)

318 
asoc
->
ba£
.
sk
->
sk_”r
 = -
”rÜ
;

320 
out_uÆock
:

321 
	`sùp_bh_uÆock_sock
(
asoc
->
ba£
.
sk
);

322 
	`sùp_assocŸtiÚ_put
(
asoc
);

323 
	}
}

325 
	$sùp_g’”©e_t1_cook›_ev’t
(
d©a
)

327 
sùp_assocŸtiÚ
 *
asoc
 = (sùp_assocŸtiÚ *è
d©a
;

328 
	`sùp_g’”©e_timeout_ev’t
(
asoc
, 
SCTP_EVENT_TIMEOUT_T1_COOKIE
);

329 
	}
}

331 
	$sùp_g’”©e_t1_š™_ev’t
(
d©a
)

333 
sùp_assocŸtiÚ
 *
asoc
 = (sùp_assocŸtiÚ *è
d©a
;

334 
	`sùp_g’”©e_timeout_ev’t
(
asoc
, 
SCTP_EVENT_TIMEOUT_T1_INIT
);

335 
	}
}

337 
	$sùp_g’”©e_t2_shutdown_ev’t
(
d©a
)

339 
sùp_assocŸtiÚ
 *
asoc
 = (sùp_assocŸtiÚ *è
d©a
;

340 
	`sùp_g’”©e_timeout_ev’t
(
asoc
, 
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
);

341 
	}
}

343 
	$sùp_g’”©e_t4_¹o_ev’t
(
d©a
)

345 
sùp_assocŸtiÚ
 *
asoc
 = (sùp_assocŸtiÚ *è
d©a
;

346 
	`sùp_g’”©e_timeout_ev’t
(
asoc
, 
SCTP_EVENT_TIMEOUT_T4_RTO
);

347 
	}
}

349 
	$sùp_g’”©e_t5_shutdown_gu¬d_ev’t
(
d©a
)

351 
sùp_assocŸtiÚ
 *
asoc
 = (sùp_assocŸtiÚ *)
d©a
;

352 
	`sùp_g’”©e_timeout_ev’t
(
asoc
,

353 
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
);

355 
	}
}

357 
	$sùp_g’”©e_autoşo£_ev’t
(
d©a
)

359 
sùp_assocŸtiÚ
 *
asoc
 = (sùp_assocŸtiÚ *è
d©a
;

360 
	`sùp_g’”©e_timeout_ev’t
(
asoc
, 
SCTP_EVENT_TIMEOUT_AUTOCLOSE
);

361 
	}
}

366 
	$sùp_g’”©e_h—¹b—t_ev’t
(
d©a
)

368 
”rÜ
 = 0;

369 
sùp_Œª¥Üt
 *
Œª¥Üt
 = (sùp_Œª¥Üˆ*è
d©a
;

370 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

372 
	`sùp_bh_lock_sock
(
asoc
->
ba£
.
sk
);

373 ià(
	`sock_owÃd_by_u£r
(
asoc
->
ba£
.
sk
)) {

374 
	`SCTP_DEBUG_PRINTK
("%s:Sock i busy.\n", 
__func__
);

377 ià(!
	`mod_tim”
(&
Œª¥Üt
->
hb_tim”
, 
jiff›s
 + (
HZ
/20)))

378 
	`sùp_Œª¥Üt_hŞd
(
Œª¥Üt
);

379 
out_uÆock
;

385 ià(
Œª¥Üt
->
d—d
)

386 
out_uÆock
;

388 
”rÜ
 = 
	`sùp_do_sm
(
SCTP_EVENT_T_TIMEOUT
,

389 
	`SCTP_ST_TIMEOUT
(
SCTP_EVENT_TIMEOUT_HEARTBEAT
),

390 
asoc
->
¡©e
,‡soc->
•
,‡soc,

391 
Œª¥Üt
, 
GFP_ATOMIC
);

393 ià(
”rÜ
)

394 
asoc
->
ba£
.
sk
->
sk_”r
 = -
”rÜ
;

396 
out_uÆock
:

397 
	`sùp_bh_uÆock_sock
(
asoc
->
ba£
.
sk
);

398 
	`sùp_Œª¥Üt_put
(
Œª¥Üt
);

399 
	}
}

404 
	$sùp_g’”©e_´Ùo_uÄ—ch_ev’t
(
d©a
)

406 
sùp_Œª¥Üt
 *
Œª¥Üt
 = (sùp_Œª¥Üˆ*è
d©a
;

407 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

409 
	`sùp_bh_lock_sock
(
asoc
->
ba£
.
sk
);

410 ià(
	`sock_owÃd_by_u£r
(
asoc
->
ba£
.
sk
)) {

411 
	`SCTP_DEBUG_PRINTK
("%s:Sock i busy.\n", 
__func__
);

414 ià(!
	`mod_tim”
(&
Œª¥Üt
->
´Ùo_uÄ—ch_tim”
,

415 
jiff›s
 + (
HZ
/20)))

416 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

417 
out_uÆock
;

423 ià(
asoc
->
ba£
.
d—d
)

424 
out_uÆock
;

426 
	`sùp_do_sm
(
SCTP_EVENT_T_OTHER
,

427 
	`SCTP_ST_OTHER
(
SCTP_EVENT_ICMP_PROTO_UNREACH
),

428 
asoc
->
¡©e
,‡soc->
•
,‡soc, 
Œª¥Üt
, 
GFP_ATOMIC
);

430 
out_uÆock
:

431 
	`sùp_bh_uÆock_sock
(
asoc
->
ba£
.
sk
);

432 
	`sùp_assocŸtiÚ_put
(
asoc
);

433 
	}
}

437 
	$sùp_g’”©e_§ck_ev’t
(
d©a
)

439 
sùp_assocŸtiÚ
 *
asoc
 = (sùp_assocŸtiÚ *è
d©a
;

440 
	`sùp_g’”©e_timeout_ev’t
(
asoc
, 
SCTP_EVENT_TIMEOUT_SACK
);

441 
	}
}

443 
sùp_tim”_ev’t_t
 *
	gsùp_tim”_ev’ts
[
SCTP_NUM_TIMEOUT_TYPES
] = {

444 
NULL
,

445 
sùp_g’”©e_t1_cook›_ev’t
,

446 
sùp_g’”©e_t1_š™_ev’t
,

447 
sùp_g’”©e_t2_shutdown_ev’t
,

448 
NULL
,

449 
sùp_g’”©e_t4_¹o_ev’t
,

450 
sùp_g’”©e_t5_shutdown_gu¬d_ev’t
,

451 
NULL
,

452 
sùp_g’”©e_§ck_ev’t
,

453 
sùp_g’”©e_autoşo£_ev’t
,

472 
	$sùp_do_8_2_Œª¥Üt_¡rike
(
sùp_cmd_£q_t
 *
commªds
,

473 
sùp_assocŸtiÚ
 *
asoc
,

474 
sùp_Œª¥Üt
 *
Œª¥Üt
,

475 
is_hb
)

487 ià(!
is_hb
) {

488 
asoc
->
ov”®l_”rÜ_couÁ
++;

489 ià(
Œª¥Üt
->
¡©e
 !ğ
SCTP_INACTIVE
)

490 
Œª¥Üt
->
”rÜ_couÁ
++;

491 } ià(
Œª¥Üt
->
hb_£Á
) {

492 ià(
Œª¥Üt
->
¡©e
 !ğ
SCTP_UNCONFIRMED
)

493 
asoc
->
ov”®l_”rÜ_couÁ
++;

494 ià(
Œª¥Üt
->
¡©e
 !ğ
SCTP_INACTIVE
)

495 
Œª¥Üt
->
”rÜ_couÁ
++;

503 ià((
Œª¥Üt
->
¡©e
 !ğ
SCTP_PF
) &&

504 (
asoc
->
pf_»Œªs
 < 
Œª¥Üt
->
·thmaxrxt
) &&

505 (
Œª¥Üt
->
”rÜ_couÁ
 > 
asoc
->
pf_»Œªs
)) {

507 
	`sùp_assoc_cÚŒŞ_Œª¥Üt
(
asoc
, 
Œª¥Üt
,

508 
SCTP_TRANSPORT_PF
,

512 
	`sùp_cmd_hb_tim”_upd©e
(
commªds
, 
Œª¥Üt
);

515 ià(
Œª¥Üt
->
¡©e
 !ğ
SCTP_INACTIVE
 &&

516 (
Œª¥Üt
->
”rÜ_couÁ
 >¿n¥Üt->
·thmaxrxt
)) {

517 
	`SCTP_DEBUG_PRINTK_IPADDR
("transport_strike:association %p",

519 
asoc
,

520 (&
Œª¥Üt
->
addr
),

521 
	`Áohs
(
Œª¥Üt
->
addr
.
v4
.
sš_pÜt
));

522 
	`sùp_assoc_cÚŒŞ_Œª¥Üt
(
asoc
, 
Œª¥Üt
,

523 
SCTP_TRANSPORT_DOWN
,

524 
SCTP_FAILED_THRESHOLD
);

536 ià(!
is_hb
 || 
Œª¥Üt
->
hb_£Á
) {

537 
Œª¥Üt
->
¹o
 = 
	`mš
(Ñ¿n¥Üt->¹Ø* 2),¿n¥Üt->
asoc
->
¹o_max
);

539 
	}
}

542 
	$sùp_cmd_š™_çed
(
sùp_cmd_£q_t
 *
commªds
,

543 
sùp_assocŸtiÚ
 *
asoc
,

544 
”rÜ
)

546 
sùp_uÍev’t
 *
ev’t
;

548 
ev’t
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
,0, 
SCTP_CANT_STR_ASSOC
,

549 (
__u16
)
”rÜ
, 0, 0, 
NULL
,

550 
GFP_ATOMIC
);

552 ià(
ev’t
)

553 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
,

554 
	`SCTP_ULPEVENT
(
ev’t
));

556 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

557 
	`SCTP_STATE
(
SCTP_STATE_CLOSED
));

560 
asoc
->
outqueue
.
”rÜ
 =ƒrror;

561 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DELETE_TCB
, 
	`SCTP_NULL
());

562 
	}
}

565 
	$sùp_cmd_assoc_çed
(
sùp_cmd_£q_t
 *
commªds
,

566 
sùp_assocŸtiÚ
 *
asoc
,

567 
sùp_ev’t_t
 
ev’t_ty³
,

568 
sùp_subty³_t
 
subty³
,

569 
sùp_chunk
 *
chunk
,

570 
”rÜ
)

572 
sùp_uÍev’t
 *
ev’t
;

573 
sùp_chunk
 *
abÜt
;

575 
	`sùp_uÍq_abÜt_pd
(&
asoc
->
uÍq
, 
GFP_ATOMIC
);

577 ià(
ev’t_ty³
 =ğ
SCTP_EVENT_T_CHUNK
 && 
subty³
.
chunk
 =ğ
SCTP_CID_ABORT
)

578 
ev’t
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
, 0, 
SCTP_COMM_LOST
,

579 (
__u16
)
”rÜ
, 0, 0, 
chunk
,

580 
GFP_ATOMIC
);

582 
ev’t
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
, 0, 
SCTP_COMM_LOST
,

583 (
__u16
)
”rÜ
, 0, 0, 
NULL
,

584 
GFP_ATOMIC
);

585 ià(
ev’t
)

586 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
,

587 
	`SCTP_ULPEVENT
(
ev’t
));

589 ià(
asoc
->
ov”®l_”rÜ_couÁ
 >ğasoc->
max_»Œªs
) {

590 
abÜt
 = 
	`sùp_make_viŞ©iÚ_max_»Œªs
(
asoc
, 
chunk
);

591 ià(
abÜt
)

592 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

593 
	`SCTP_CHUNK
(
abÜt
));

596 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

597 
	`SCTP_STATE
(
SCTP_STATE_CLOSED
));

600 
asoc
->
outqueue
.
”rÜ
 =ƒrror;

601 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DELETE_TCB
, 
	`SCTP_NULL
());

602 
	}
}

609 
	$sùp_cmd_´oûss_š™
(
sùp_cmd_£q_t
 *
commªds
,

610 
sùp_assocŸtiÚ
 *
asoc
,

611 
sùp_chunk
 *
chunk
,

612 
sùp_š™_chunk_t
 *
³”_š™
,

613 
gå_t
 
gå
)

615 
”rÜ
;

622 ià(!
	`sùp_´oûss_š™
(
asoc
, 
chunk
, 
	`sùp_sourû
(chunk), 
³”_š™
, 
gå
))

623 
”rÜ
 = -
ENOMEM
;

625 
”rÜ
 = 0;

627  
”rÜ
;

628 
	}
}

631 
	$sùp_cmd_hb_tim”s_¡¬t
(
sùp_cmd_£q_t
 *
cmds
,

632 
sùp_assocŸtiÚ
 *
asoc
)

634 
sùp_Œª¥Üt
 *
t
;

640 
	`li¡_fÜ_—ch_’Œy
(
t
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
, 
Œª¥Üts
) {

642 ià(!
	`mod_tim”
(&
t
->
hb_tim”
, 
	`sùp_Œª¥Üt_timeout
(t)))

643 
	`sùp_Œª¥Üt_hŞd
(
t
);

645 
	}
}

647 
	$sùp_cmd_hb_tim”s_¡İ
(
sùp_cmd_£q_t
 *
cmds
,

648 
sùp_assocŸtiÚ
 *
asoc
)

650 
sùp_Œª¥Üt
 *
t
;

654 
	`li¡_fÜ_—ch_’Œy
(
t
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

655 
Œª¥Üts
) {

656 ià(
	`d–_tim”
(&
t
->
hb_tim”
))

657 
	`sùp_Œª¥Üt_put
(
t
);

659 
	}
}

662 
	$sùp_cmd_t3_¹x_tim”s_¡İ
(
sùp_cmd_£q_t
 *
cmds
,

663 
sùp_assocŸtiÚ
 *
asoc
)

665 
sùp_Œª¥Üt
 *
t
;

667 
	`li¡_fÜ_—ch_’Œy
(
t
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

668 
Œª¥Üts
) {

669 ià(
	`tim”_³ndšg
(&
t
->
T3_¹x_tim”
) &&

670 
	`d–_tim”
(&
t
->
T3_¹x_tim”
)) {

671 
	`sùp_Œª¥Üt_put
(
t
);

674 
	}
}

678 
	$sùp_cmd_hb_tim”_upd©e
(
sùp_cmd_£q_t
 *
cmds
,

679 
sùp_Œª¥Üt
 *
t
)

682 ià(!
	`mod_tim”
(&
t
->
hb_tim”
, 
	`sùp_Œª¥Üt_timeout
(t)))

683 
	`sùp_Œª¥Üt_hŞd
(
t
);

684 
	}
}

687 
	$sùp_cmd_Œª¥Üt_Ú
(
sùp_cmd_£q_t
 *
cmds
,

688 
sùp_assocŸtiÚ
 *
asoc
,

689 
sùp_Œª¥Üt
 *
t
,

690 
sùp_chunk
 *
chunk
)

692 
sùp_£nd”_hb_šfo_t
 *
hbšfo
;

698 
t
->
”rÜ_couÁ
 = 0;

708 ià(
t
->
asoc
->
¡©e
 !ğ
SCTP_STATE_SHUTDOWN_PENDING
)

709 
t
->
asoc
->
ov”®l_”rÜ_couÁ
 = 0;

714 
t
->
hb_£Á
 = 0;

719 ià((
t
->
¡©e
 =ğ
SCTP_INACTIVE
è|| (t->¡©=ğ
SCTP_UNCONFIRMED
))

720 
	`sùp_assoc_cÚŒŞ_Œª¥Üt
(
asoc
, 
t
, 
SCTP_TRANSPORT_UP
,

721 
SCTP_HEARTBEAT_SUCCESS
);

723 ià(
t
->
¡©e
 =ğ
SCTP_PF
)

724 
	`sùp_assoc_cÚŒŞ_Œª¥Üt
(
asoc
, 
t
, 
SCTP_TRANSPORT_UP
,

725 
SCTP_HEARTBEAT_SUCCESS
);

734 ià(
t
->
¹o_³ndšg
 == 0)

735 
t
->
¹o_³ndšg
 = 1;

737 
hbšfo
 = (
sùp_£nd”_hb_šfo_t
 *è
chunk
->
skb
->
d©a
;

738 
	`sùp_Œª¥Üt_upd©e_¹o
(
t
, (
jiff›s
 - 
hbšfo
->
£Á_©
));

741 ià(!
	`mod_tim”
(&
t
->
hb_tim”
, 
	`sùp_Œª¥Üt_timeout
(t)))

742 
	`sùp_Œª¥Üt_hŞd
(
t
);

743 
	}
}

747 
	$sùp_cmd_´oûss_§ck
(
sùp_cmd_£q_t
 *
cmds
,

748 
sùp_assocŸtiÚ
 *
asoc
,

749 
sùp_§ckhdr
 *
§ckh
)

751 
”r
 = 0;

753 ià(
	`sùp_outq_§ck
(&
asoc
->
outqueue
, 
§ckh
)) {

755 
”r
 = 
	`sùp_do_sm
(
SCTP_EVENT_T_OTHER
,

756 
	`SCTP_ST_OTHER
(
SCTP_EVENT_NO_PENDING_TSN
),

757 
asoc
->
¡©e
,‡soc->
•
,‡soc, 
NULL
,

758 
GFP_ATOMIC
);

761  
”r
;

762 
	}
}

767 
	$sùp_cmd_£tup_t2
(
sùp_cmd_£q_t
 *
cmds
,

768 
sùp_assocŸtiÚ
 *
asoc
,

769 
sùp_chunk
 *
chunk
)

771 
sùp_Œª¥Üt
 *
t
;

773 ià(
chunk
->
Œª¥Üt
)

774 
t
 = 
chunk
->
Œª¥Üt
;

776 
t
 = 
	`sùp_assoc_choo£_®‹r_Œª¥Üt
(
asoc
,

777 
asoc
->
shutdown_Ï¡_£Á_to
);

778 
chunk
->
Œª¥Üt
 = 
t
;

780 
asoc
->
shutdown_Ï¡_£Á_to
 = 
t
;

781 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
] = 
t
->
¹o
;

782 
	}
}

785 
	$sùp_cmd_Ãw_¡©e
(
sùp_cmd_£q_t
 *
cmds
,

786 
sùp_assocŸtiÚ
 *
asoc
,

787 
sùp_¡©e_t
 
¡©e
)

789 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

791 
asoc
->
¡©e
 = state;

793 
	`SCTP_DEBUG_PRINTK
("sctp_cmd_new_state:‡soc %p[%s]\n",

794 
asoc
, 
sùp_¡©e_tbl
[
¡©e
]);

796 ià(
	`sùp_¡yË
(
sk
, 
TCP
)) {

800 ià(
	`sùp_¡©e
(
asoc
, 
ESTABLISHED
è&& 
	`sùp_s¡©e
(
sk
, 
CLOSED
))

801 
sk
->
sk_¡©e
 = 
SCTP_SS_ESTABLISHED
;

804 ià(
	`sùp_¡©e
(
asoc
, 
SHUTDOWN_RECEIVED
) &&

805 
	`sùp_s¡©e
(
sk
, 
ESTABLISHED
))

806 
sk
->
sk_shutdown
 |ğ
RCV_SHUTDOWN
;

809 ià(
	`sùp_¡©e
(
asoc
, 
COOKIE_WAIT
)) {

813 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T1_INIT
] =

814 
asoc
->
¹o_š™Ÿl
;

815 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T1_COOKIE
] =

816 
asoc
->
¹o_š™Ÿl
;

819 ià(
	`sùp_¡©e
(
asoc
, 
ESTABLISHED
) ||

820 
	`sùp_¡©e
(
asoc
, 
CLOSED
) ||

821 
	`sùp_¡©e
(
asoc
, 
SHUTDOWN_RECEIVED
)) {

825 ià(
	`wa™queue_aùive
(&
asoc
->
wa™
))

826 
	`wake_up_š‹¼u±ibË
(&
asoc
->
wa™
);

834 ià(!
	`sùp_¡yË
(
sk
, 
UDP
))

835 
sk
->
	`sk_¡©e_chªge
(sk);

837 
	}
}

840 
	$sùp_cmd_d–‘e_tcb
(
sùp_cmd_£q_t
 *
cmds
,

841 
sùp_assocŸtiÚ
 *
asoc
)

843 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

849 ià(
	`sùp_¡yË
(
sk
, 
TCP
è&& 
	`sùp_s¡©e
(sk, 
LISTENING
) &&

850 (!
asoc
->
‹mp
è&& (
sk
->
sk_shutdown
 !ğ
SHUTDOWN_MASK
))

853 
	`sùp_unhash_e¡ablished
(
asoc
);

854 
	`sùp_assocŸtiÚ_ä“
(
asoc
);

855 
	}
}

863 
	$sùp_cmd_£tup_t4
(
sùp_cmd_£q_t
 *
cmds
,

864 
sùp_assocŸtiÚ
 *
asoc
,

865 
sùp_chunk
 *
chunk
)

867 
sùp_Œª¥Üt
 *
t
;

869 
t
 = 
	`sùp_assoc_choo£_®‹r_Œª¥Üt
(
asoc
, 
chunk
->
Œª¥Üt
);

870 
asoc
->
timeouts
[
SCTP_EVENT_TIMEOUT_T4_RTO
] = 
t
->
¹o
;

871 
chunk
->
Œª¥Üt
 = 
t
;

872 
	}
}

875 
	$sùp_cmd_´oûss_İ”r
(
sùp_cmd_£q_t
 *
cmds
,

876 
sùp_assocŸtiÚ
 *
asoc
,

877 
sùp_chunk
 *
chunk
)

879 
sùp_”rhdr
 *
”r_hdr
;

880 
sùp_uÍev’t
 *
ev
;

882 
chunk
->
chunk_’d
 > chunk->
skb
->
d©a
) {

883 
”r_hdr
 = (
sùp_”rhdr
 *)(
chunk
->
skb
->
d©a
);

885 
ev
 = 
	`sùp_uÍev’t_make_»mÙe_”rÜ
(
asoc
, 
chunk
, 0,

886 
GFP_ATOMIC
);

887 ià(!
ev
)

890 
	`sùp_uÍq__ev’t
(&
asoc
->
uÍq
, 
ev
);

892 
”r_hdr
->
ÿu£
) {

893 
SCTP_ERROR_UNKNOWN_CHUNK
:

895 
sùp_chunkhdr_t
 *
unk_chunk_hdr
;

897 
unk_chunk_hdr
 = (
sùp_chunkhdr_t
 *)
”r_hdr
->
v¬ŸbË
;

898 
unk_chunk_hdr
->
ty³
) {

905 
SCTP_CID_ASCONF
:

906 ià(
asoc
->
³”
.
ascÚf_ÿ·bË
 == 0)

909 
asoc
->
³”
.
ascÚf_ÿ·bË
 = 0;

910 
	`sùp_add_cmd_sf
(
cmds
, 
SCTP_CMD_TIMER_STOP
,

911 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T4_RTO
));

922 
	}
}

925 
	$sùp_cmd_´oûss_fwdt¢
(
sùp_uÍq
 *
uÍq
,

926 
sùp_chunk
 *
chunk
)

928 
sùp_fwdt¢_sk
 *
sk
;

930 
	`sùp_w®k_fwdt¢
(
sk
, 
chunk
) {

931 
	`sùp_uÍq_sk
(
uÍq
, 
	`Áohs
(
sk
->
¡»am
),‚tohs(sk->
s¢
));

935 
	}
}

940 
	$sùp_cmd_d–_nÚ_´im¬y
(
sùp_assocŸtiÚ
 *
asoc
)

942 
sùp_Œª¥Üt
 *
t
;

943 
li¡_h—d
 *
pos
;

944 
li¡_h—d
 *
‹mp
;

946 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
) {

947 
t
 = 
	`li¡_’Œy
(
pos
, 
sùp_Œª¥Üt
, 
Œª¥Üts
);

948 ià(!
	`sùp_cmp_addr_exaù
(&
t
->
addr
,

949 &
asoc
->
³”
.
´im¬y_addr
)) {

950 
	`sùp_assoc_d–_³”
(
asoc
, &
t
->
addr
);

955 
	}
}

958 
	$sùp_cmd_£t_sk_”r
(
sùp_assocŸtiÚ
 *
asoc
, 
”rÜ
)

960 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

962 ià(!
	`sùp_¡yË
(
sk
, 
UDP
))

963 
sk
->
sk_”r
 = 
”rÜ
;

964 
	}
}

967 
	$sùp_cmd_assoc_chªge
(
sùp_cmd_£q_t
 *
commªds
,

968 
sùp_assocŸtiÚ
 *
asoc
,

969 
u8
 
¡©e
)

971 
sùp_uÍev’t
 *
ev
;

973 
ev
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
, 0, 
¡©e
, 0,

974 
asoc
->
c
.
sš™_num_o¡»ams
,

975 
asoc
->
c
.
sš™_max_š¡»ams
,

976 
NULL
, 
GFP_ATOMIC
);

977 ià(
ev
)

978 
	`sùp_uÍq__ev’t
(&
asoc
->
uÍq
, 
ev
);

979 
	}
}

982 
	$sùp_cmd_ad­tiÚ_šd
(
sùp_cmd_£q_t
 *
commªds
,

983 
sùp_assocŸtiÚ
 *
asoc
)

985 
sùp_uÍev’t
 *
ev
;

987 
ev
 = 
	`sùp_uÍev’t_make_ad­tiÚ_šdiÿtiÚ
(
asoc
, 
GFP_ATOMIC
);

989 ià(
ev
)

990 
	`sùp_uÍq__ev’t
(&
asoc
->
uÍq
, 
ev
);

991 
	}
}

994 
	$sùp_cmd_t1_tim”_upd©e
(
sùp_assocŸtiÚ
 *
asoc
,

995 
sùp_ev’t_timeout_t
 
tim”
,

996 *
Çme
)

998 
sùp_Œª¥Üt
 *
t
;

1000 
t
 = 
asoc
->
š™_Ï¡_£Á_to
;

1001 
asoc
->
š™_”r_couÁ”
++;

1003 ià(
t
->
š™_£Á_couÁ
 > (
asoc
->
š™_cyşe
 + 1)) {

1004 
asoc
->
timeouts
[
tim”
] *= 2;

1005 ià(
asoc
->
timeouts
[
tim”
] >‡soc->
max_š™_timeo
) {

1006 
asoc
->
timeouts
[
tim”
] =‡soc->
max_š™_timeo
;

1008 
asoc
->
š™_cyşe
++;

1009 
	`SCTP_DEBUG_PRINTK
(

1014 
Çme
,

1015 
asoc
->
š™_”r_couÁ”
,

1016 
asoc
->
š™_cyşe
,

1017 
asoc
->
timeouts
[
tim”
]);

1020 
	}
}

1026 
	$sùp_cmd_£nd_msg
(
sùp_assocŸtiÚ
 *
asoc
,

1027 
sùp_d©amsg
 *
msg
)

1029 
sùp_chunk
 *
chunk
;

1030 
”rÜ
 = 0;

1032 
	`li¡_fÜ_—ch_’Œy
(
chunk
, &
msg
->
chunks
, 
äag_li¡
) {

1033 
”rÜ
 = 
	`sùp_outq_
(&
asoc
->
outqueue
, 
chunk
);

1034 ià(
”rÜ
)

1038  
”rÜ
;

1039 
	}
}

1045 
	$sùp_cmd_£nd_ascÚf
(
sùp_assocŸtiÚ
 *
asoc
)

1050 ià(!
	`li¡_em±y
(&
asoc
->
add_chunk_li¡
)) {

1051 
li¡_h—d
 *
’Œy
 = 
asoc
->
add_chunk_li¡
.
Ãxt
;

1052 
sùp_chunk
 *
ascÚf
 = 
	`li¡_’Œy
(
’Œy
,

1053 
sùp_chunk
, 
li¡
);

1054 
	`li¡_d–_š™
(
’Œy
);

1057 
	`sùp_chunk_hŞd
(
ascÚf
);

1058 ià(
	`sùp_´im™ive_ASCONF
(
asoc
, 
ascÚf
))

1059 
	`sùp_chunk_ä“
(
ascÚf
);

1061 
asoc
->
add_Ï¡_ascÚf
 = 
ascÚf
;

1063 
	}
}

1070 
	#DEBUG_PRE
 \

1071 
	`SCTP_DEBUG_PRINTK
("sctp_do_sm…refn: " \

1073 
•
, 
sùp_ev‰y³_tbl
[
ev’t_ty³
], \

1074 (*
debug_â
)(
subty³
), 
asoc
, \

1075 
sùp_¡©e_tbl
[
¡©e
], 
¡©e_â
->
Çme
)

	)

1077 
	#DEBUG_POST
 \

1078 
	`SCTP_DEBUG_PRINTK
("sctp_do_sm…ostfn: " \

1080 
asoc
, 
sùp_¡©us_tbl
[
¡©us
])

	)

1082 
	#DEBUG_POST_SFX
 \

1083 
	`SCTP_DEBUG_PRINTK
("sctp_do_sm…ost sfx:ƒrror %d,‡soc %p[%s]\n", \

1084 
”rÜ
, 
asoc
, \

1085 
sùp_¡©e_tbl
[(
asoc
 && 
	`sùp_id2assoc
(
•
->
ba£
.
sk
, \

1086 
	`sùp_assoc2id
(
asoc
)))?asoc->
¡©e
:
SCTP_STATE_CLOSED
])

	)

1094 
	$sùp_do_sm
(
sùp_ev’t_t
 
ev’t_ty³
, 
sùp_subty³_t
 
subty³
,

1095 
sùp_¡©e_t
 
¡©e
,

1096 
sùp_’dpošt
 *
•
,

1097 
sùp_assocŸtiÚ
 *
asoc
,

1098 *
ev’t_¬g
,

1099 
gå_t
 
gå
)

1101 
sùp_cmd_£q_t
 
commªds
;

1102 cÚ¡ 
sùp_sm_bË_’Œy_t
 *
¡©e_â
;

1103 
sùp_di¥os™iÚ_t
 
¡©us
;

1104 
”rÜ
 = 0;

1105 cÚ¡ *(
	t´štâ_t
)(
	tsùp_subty³_t
);

1107 
´štâ_t
 *
bË
[] = {

1108 
NULL
, 
sùp_úame
, 
sùp_Šame
, 
sùp_Úame
, 
sùp_²ame
,

1110 
´štâ_t
 *
debug_â
 
	`__©Œibu‹__
 ((
unu£d
)èğ
bË
[
ev’t_ty³
];

1115 
¡©e_â
 = 
	`sùp_sm_lookup_ev’t
(
ev’t_ty³
, 
¡©e
, 
subty³
);

1117 
	`sùp_š™_cmd_£q
(&
commªds
);

1119 
DEBUG_PRE
;

1120 
¡©us
 = (*
¡©e_â
->
â
)(
•
, 
asoc
, 
subty³
, 
ev’t_¬g
, &
commªds
);

1121 
DEBUG_POST
;

1123 
”rÜ
 = 
	`sùp_side_efãùs
(
ev’t_ty³
, 
subty³
, 
¡©e
,

1124 
•
, 
asoc
, 
ev’t_¬g
, 
¡©us
,

1125 &
commªds
, 
gå
);

1126 
DEBUG_POST_SFX
;

1128  
”rÜ
;

1129 
	}
}

1131 #undeà
DEBUG_PRE


1132 #undeà
DEBUG_POST


1137 
	$sùp_side_efãùs
(
sùp_ev’t_t
 
ev’t_ty³
, 
sùp_subty³_t
 
subty³
,

1138 
sùp_¡©e_t
 
¡©e
,

1139 
sùp_’dpošt
 *
•
,

1140 
sùp_assocŸtiÚ
 *
asoc
,

1141 *
ev’t_¬g
,

1142 
sùp_di¥os™iÚ_t
 
¡©us
,

1143 
sùp_cmd_£q_t
 *
commªds
,

1144 
gå_t
 
gå
)

1146 
”rÜ
;

1154 ià(0 !ğ(
”rÜ
 = 
	`sùp_cmd_š‹½»‹r
(
ev’t_ty³
, 
subty³
, 
¡©e
,

1155 
•
, 
asoc
,

1156 
ev’t_¬g
, 
¡©us
,

1157 
commªds
, 
gå
)))

1158 
ba
;

1160 
¡©us
) {

1161 
SCTP_DISPOSITION_DISCARD
:

1162 
	`SCTP_DEBUG_PRINTK
("Ignored sctp…rotocolƒvent - state %d, "

1164 
¡©e
, 
ev’t_ty³
, 
subty³
.
chunk
);

1167 
SCTP_DISPOSITION_NOMEM
:

1174 
”rÜ
 = -
ENOMEM
;

1177 
SCTP_DISPOSITION_DELETE_TCB
:

1181 
SCTP_DISPOSITION_CONSUME
:

1182 
SCTP_DISPOSITION_ABORT
:

1189 
SCTP_DISPOSITION_VIOLATION
:

1190 ià(
	`Ãt_¿‹lim™
())

1191 
	`´štk
(
KERN_ERR
 "sctp…rotocol violation state %d "

1192 "chunkid %d\n", 
¡©e
, 
subty³
.
chunk
);

1195 
SCTP_DISPOSITION_NOT_IMPL
:

1196 
	`´štk
(
KERN_WARNING
 "sctp unimplemented feature in state %d, "

1198 
¡©e
, 
ev’t_ty³
, 
subty³
.
chunk
);

1201 
SCTP_DISPOSITION_BUG
:

1202 
	`´štk
(
KERN_ERR
 "sctp bug in state %d, "

1204 
¡©e
, 
ev’t_ty³
, 
subty³
.
chunk
);

1205 
	`BUG
();

1209 
	`´štk
(
KERN_ERR
 "sctp impossible disposition %d "

1211 
¡©us
, 
¡©e
, 
ev’t_ty³
, 
subty³
.
chunk
);

1212 
	`BUG
();

1216 
ba
:

1217  
”rÜ
;

1218 
	}
}

1225 
	$sùp_cmd_š‹½»‹r
(
sùp_ev’t_t
 
ev’t_ty³
,

1226 
sùp_subty³_t
 
subty³
,

1227 
sùp_¡©e_t
 
¡©e
,

1228 
sùp_’dpošt
 *
•
,

1229 
sùp_assocŸtiÚ
 *
asoc
,

1230 *
ev’t_¬g
,

1231 
sùp_di¥os™iÚ_t
 
¡©us
,

1232 
sùp_cmd_£q_t
 *
commªds
,

1233 
gå_t
 
gå
)

1235 
”rÜ
 = 0;

1236 
fÜû
;

1237 
sùp_cmd_t
 *
cmd
;

1238 
sùp_chunk
 *
Ãw_obj
;

1239 
sùp_chunk
 *
chunk
 = 
NULL
;

1240 
sùp_·ck‘
 *
·ck‘
;

1241 
tim”_li¡
 *
tim”
;

1242 
timeout
;

1243 
sùp_Œª¥Üt
 *
t
;

1244 
sùp_§ckhdr
 
§ckh
;

1245 
loÿl_cÜk
 = 0;

1247 ià(
SCTP_EVENT_T_TIMEOUT
 !ğ
ev’t_ty³
)

1248 
chunk
 = (
sùp_chunk
 *è
ev’t_¬g
;

1257 
NULL
 !ğ(
cmd
 = 
	`sùp_Ãxt_cmd
(
commªds
))) {

1258 
cmd
->
v”b
) {

1259 
SCTP_CMD_NOP
:

1263 
SCTP_CMD_NEW_ASOC
:

1265 ià(
loÿl_cÜk
) {

1266 
	`sùp_outq_uncÜk
(&
asoc
->
outqueue
);

1267 
loÿl_cÜk
 = 0;

1269 
asoc
 = 
cmd
->
obj
.
±r
;

1271 
	`sùp_’dpošt_add_asoc
(
•
, 
asoc
);

1272 
	`sùp_hash_e¡ablished
(
asoc
);

1275 
SCTP_CMD_UPDATE_ASSOC
:

1276 
	`sùp_assoc_upd©e
(
asoc
, 
cmd
->
obj
.
±r
);

1279 
SCTP_CMD_PURGE_OUTQUEUE
:

1280 
	`sùp_outq_‹¬down
(&
asoc
->
outqueue
);

1283 
SCTP_CMD_DELETE_TCB
:

1284 ià(
loÿl_cÜk
) {

1285 
	`sùp_outq_uncÜk
(&
asoc
->
outqueue
);

1286 
loÿl_cÜk
 = 0;

1289 
	`sùp_cmd_d–‘e_tcb
(
commªds
, 
asoc
);

1290 
asoc
 = 
NULL
;

1293 
SCTP_CMD_NEW_STATE
:

1295 
	`sùp_cmd_Ãw_¡©e
(
commªds
, 
asoc
, 
cmd
->
obj
.
¡©e
);

1298 
SCTP_CMD_REPORT_TSN
:

1300 
”rÜ
 = 
	`sùp_t¢m­_m¬k
(&
asoc
->
³”
.
t¢_m­
,

1301 
cmd
->
obj
.
u32
, 
NULL
);

1304 
SCTP_CMD_REPORT_FWDTSN
:

1306 
	`sùp_t¢m­_sk
(&
asoc
->
³”
.
t¢_m­
, 
cmd
->
obj
.
u32
);

1309 
	`sùp_uÍq_»asm_æusht¢
(&
asoc
->
uÍq
, 
cmd
->
obj
.
u32
);

1312 
	`sùp_uÍq_abÜt_pd
(&
asoc
->
uÍq
, 
GFP_ATOMIC
);

1315 
SCTP_CMD_PROCESS_FWDTSN
:

1316 
	`sùp_cmd_´oûss_fwdt¢
(&
asoc
->
uÍq
, 
cmd
->
obj
.
±r
);

1319 
SCTP_CMD_GEN_SACK
:

1325 
fÜû
 = 
cmd
->
obj
.
i32
;

1326 
”rÜ
 = 
	`sùp_g’_§ck
(
asoc
, 
fÜû
, 
commªds
);

1329 
SCTP_CMD_PROCESS_SACK
:

1331 
”rÜ
 = 
	`sùp_cmd_´oûss_§ck
(
commªds
, 
asoc
,

1332 
cmd
->
obj
.
±r
);

1335 
SCTP_CMD_GEN_INIT_ACK
:

1337 
Ãw_obj
 = 
	`sùp_make_š™_ack
(
asoc
, 
chunk
, 
GFP_ATOMIC
,

1339 ià(!
Ãw_obj
)

1340 
nomem
;

1342 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

1343 
	`SCTP_CHUNK
(
Ãw_obj
));

1346 
SCTP_CMD_PEER_INIT
:

1352 
”rÜ
 = 
	`sùp_cmd_´oûss_š™
(
commªds
, 
asoc
, 
chunk
,

1353 
cmd
->
obj
.
±r
, 
gå
);

1356 
SCTP_CMD_GEN_COOKIE_ECHO
:

1358 
Ãw_obj
 = 
	`sùp_make_cook›_echo
(
asoc
, 
chunk
);

1359 ià(!
Ãw_obj
) {

1360 ià(
cmd
->
obj
.
±r
)

1361 
	`sùp_chunk_ä“
(
cmd
->
obj
.
±r
);

1362 
nomem
;

1364 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

1365 
	`SCTP_CHUNK
(
Ãw_obj
));

1370 ià(
cmd
->
obj
.
±r
)

1371 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

1372 
	`SCTP_CHUNK
(
cmd
->
obj
.
±r
));

1374 ià(
Ãw_obj
->
Œª¥Üt
) {

1375 
Ãw_obj
->
Œª¥Üt
->
š™_£Á_couÁ
++;

1376 
asoc
->
š™_Ï¡_£Á_to
 = 
Ãw_obj
->
Œª¥Üt
;

1391 ià((
asoc
->
³”
.
»Œª_·th
 !=

1392 
asoc
->
³”
.
´im¬y_·th
) &&

1393 (
asoc
->
š™_”r_couÁ”
 > 0)) {

1394 
	`sùp_add_cmd_sf
(
commªds
,

1395 
SCTP_CMD_FORCE_PRIM_RETRAN
,

1396 
	`SCTP_NULL
());

1401 
SCTP_CMD_GEN_SHUTDOWN
:

1405 
asoc
->
ov”®l_”rÜ_couÁ
 = 0;

1408 
Ãw_obj
 = 
	`sùp_make_shutdown
(
asoc
, 
chunk
);

1409 ià(!
Ãw_obj
)

1410 
nomem
;

1411 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

1412 
	`SCTP_CHUNK
(
Ãw_obj
));

1415 
SCTP_CMD_CHUNK_ULP
:

1417 
	`SCTP_DEBUG_PRINTK
("sm_sideff: %s %p, %s %p.\n",

1418 "chunk_up:", 
cmd
->
obj
.
±r
,

1419 "uÍq:", &
asoc
->
uÍq
);

1420 
	`sùp_uÍq__d©a
(&
asoc
->
uÍq
, 
cmd
->
obj
.
±r
,

1421 
GFP_ATOMIC
);

1424 
SCTP_CMD_EVENT_ULP
:

1426 
	`SCTP_DEBUG_PRINTK
("sm_sideff: %s %p, %s %p.\n",

1427 "ev’t_up:",
cmd
->
obj
.
±r
,

1428 "uÍq:",&
asoc
->
uÍq
);

1429 
	`sùp_uÍq__ev’t
(&
asoc
->
uÍq
, 
cmd
->
obj
.
±r
);

1432 
SCTP_CMD_REPLY
:

1434 ià(!
asoc
->
outqueue
.
cÜk
) {

1435 
	`sùp_outq_cÜk
(&
asoc
->
outqueue
);

1436 
loÿl_cÜk
 = 1;

1439 
”rÜ
 = 
	`sùp_outq_
(&
asoc
->
outqueue
, 
cmd
->
obj
.
±r
);

1442 
SCTP_CMD_SEND_PKT
:

1444 
·ck‘
 = 
cmd
->
obj
.
±r
;

1445 
	`sùp_·ck‘_Œªsm™
(
·ck‘
);

1446 
	`sùp_oÙb_pkt_ä“
(
·ck‘
);

1449 
SCTP_CMD_T1_RETRAN
:

1451 
	`sùp_»Œªsm™
(&
asoc
->
outqueue
, 
cmd
->
obj
.
Œª¥Üt
,

1452 
SCTP_RTXR_T1_RTX
);

1455 
SCTP_CMD_RETRAN
:

1457 
	`sùp_»Œªsm™
(&
asoc
->
outqueue
, 
cmd
->
obj
.
Œª¥Üt
,

1458 
SCTP_RTXR_T3_RTX
);

1461 
SCTP_CMD_TRANSMIT
:

1463 
”rÜ
 = 
	`sùp_outq_uncÜk
(&
asoc
->
outqueue
);

1464 
loÿl_cÜk
 = 0;

1467 
SCTP_CMD_ECN_CE
:

1469 
	`sùp_do_eú_û_wÜk
(
asoc
, 
cmd
->
obj
.
u32
);

1472 
SCTP_CMD_ECN_ECNE
:

1474 
Ãw_obj
 = 
	`sùp_do_eú_eúe_wÜk
(
asoc
, 
cmd
->
obj
.
u32
,

1475 
chunk
);

1476 ià(
Ãw_obj
)

1477 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

1478 
	`SCTP_CHUNK
(
Ãw_obj
));

1481 
SCTP_CMD_ECN_CWR
:

1483 
	`sùp_do_eú_cwr_wÜk
(
asoc
, 
cmd
->
obj
.
u32
);

1486 
SCTP_CMD_SETUP_T2
:

1487 
	`sùp_cmd_£tup_t2
(
commªds
, 
asoc
, 
cmd
->
obj
.
±r
);

1490 
SCTP_CMD_TIMER_START_ONCE
:

1491 
tim”
 = &
asoc
->
tim”s
[
cmd
->
obj
.
to
];

1493 ià(
	`tim”_³ndšg
(
tim”
))

1497 
SCTP_CMD_TIMER_START
:

1498 
tim”
 = &
asoc
->
tim”s
[
cmd
->
obj
.
to
];

1499 
timeout
 = 
asoc
->
timeouts
[
cmd
->
obj
.
to
];

1500 
	`BUG_ON
(!
timeout
);

1502 
tim”
->
expœes
 = 
jiff›s
 + 
timeout
;

1503 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

1504 
	`add_tim”
(
tim”
);

1507 
SCTP_CMD_TIMER_RESTART
:

1508 
tim”
 = &
asoc
->
tim”s
[
cmd
->
obj
.
to
];

1509 
timeout
 = 
asoc
->
timeouts
[
cmd
->
obj
.
to
];

1510 ià(!
	`mod_tim”
(
tim”
, 
jiff›s
 + 
timeout
))

1511 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

1514 
SCTP_CMD_TIMER_STOP
:

1515 
tim”
 = &
asoc
->
tim”s
[
cmd
->
obj
.
to
];

1516 ià(
	`tim”_³ndšg
(
tim”
è&& 
	`d–_tim”
(timer))

1517 
	`sùp_assocŸtiÚ_put
(
asoc
);

1520 
SCTP_CMD_INIT_CHOOSE_TRANSPORT
:

1521 
chunk
 = 
cmd
->
obj
.
±r
;

1522 
t
 = 
	`sùp_assoc_choo£_®‹r_Œª¥Üt
(
asoc
,

1523 
asoc
->
š™_Ï¡_£Á_to
);

1524 
asoc
->
š™_Ï¡_£Á_to
 = 
t
;

1525 
chunk
->
Œª¥Üt
 = 
t
;

1526 
t
->
š™_£Á_couÁ
++;

1528 
	`sùp_assoc_£t_´im¬y
(
asoc
, 
t
);

1531 
SCTP_CMD_INIT_RESTART
:

1538 
	`sùp_cmd_t1_tim”_upd©e
(
asoc
,

1539 
SCTP_EVENT_TIMEOUT_T1_INIT
,

1542 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

1543 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

1546 
SCTP_CMD_COOKIEECHO_RESTART
:

1553 
	`sùp_cmd_t1_tim”_upd©e
(
asoc
,

1554 
SCTP_EVENT_TIMEOUT_T1_COOKIE
,

1560 
	`li¡_fÜ_—ch_’Œy
(
t
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

1561 
Œª¥Üts
) {

1562 
	`sùp_»Œªsm™_m¬k
(&
asoc
->
outqueue
, 
t
,

1563 
SCTP_RTXR_T1_RTX
);

1566 
	`sùp_add_cmd_sf
(
commªds
,

1567 
SCTP_CMD_TIMER_RESTART
,

1568 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_COOKIE
));

1571 
SCTP_CMD_INIT_FAILED
:

1572 
	`sùp_cmd_š™_çed
(
commªds
, 
asoc
, 
cmd
->
obj
.
”r
);

1575 
SCTP_CMD_ASSOC_FAILED
:

1576 
	`sùp_cmd_assoc_çed
(
commªds
, 
asoc
, 
ev’t_ty³
,

1577 
subty³
, 
chunk
, 
cmd
->
obj
.
”r
);

1580 
SCTP_CMD_INIT_COUNTER_INC
:

1581 
asoc
->
š™_”r_couÁ”
++;

1584 
SCTP_CMD_INIT_COUNTER_RESET
:

1585 
asoc
->
š™_”r_couÁ”
 = 0;

1586 
asoc
->
š™_cyşe
 = 0;

1587 
	`li¡_fÜ_—ch_’Œy
(
t
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

1588 
Œª¥Üts
) {

1589 
t
->
š™_£Á_couÁ
 = 0;

1593 
SCTP_CMD_REPORT_DUP
:

1594 
	`sùp_t¢m­_m¬k_dup
(&
asoc
->
³”
.
t¢_m­
,

1595 
cmd
->
obj
.
u32
);

1598 
SCTP_CMD_REPORT_BAD_TAG
:

1599 
	`SCTP_DEBUG_PRINTK
("vtag mismatch!\n");

1602 
SCTP_CMD_STRIKE
:

1604 
	`sùp_do_8_2_Œª¥Üt_¡rike
(
commªds
, 
asoc
,

1605 
cmd
->
obj
.
Œª¥Üt
, 0);

1608 
SCTP_CMD_TRANSPORT_IDLE
:

1609 
t
 = 
cmd
->
obj
.
Œª¥Üt
;

1610 
	`sùp_Œª¥Üt_low”_cwnd
(
t
, 
SCTP_LOWER_CWND_INACTIVE
);

1613 
SCTP_CMD_TRANSPORT_HB_SENT
:

1614 
t
 = 
cmd
->
obj
.
Œª¥Üt
;

1615 
	`sùp_do_8_2_Œª¥Üt_¡rike
(
commªds
, 
asoc
,

1616 
t
, 1);

1617 
t
->
hb_£Á
 = 1;

1620 
SCTP_CMD_TRANSPORT_ON
:

1621 
t
 = 
cmd
->
obj
.
Œª¥Üt
;

1622 
	`sùp_cmd_Œª¥Üt_Ú
(
commªds
, 
asoc
, 
t
, 
chunk
);

1625 
SCTP_CMD_HB_TIMERS_START
:

1626 
	`sùp_cmd_hb_tim”s_¡¬t
(
commªds
, 
asoc
);

1629 
SCTP_CMD_HB_TIMER_UPDATE
:

1630 
t
 = 
cmd
->
obj
.
Œª¥Üt
;

1631 
	`sùp_cmd_hb_tim”_upd©e
(
commªds
, 
t
);

1634 
SCTP_CMD_HB_TIMERS_STOP
:

1635 
	`sùp_cmd_hb_tim”s_¡İ
(
commªds
, 
asoc
);

1638 
SCTP_CMD_REPORT_ERROR
:

1639 
”rÜ
 = 
cmd
->
obj
.error;

1642 
SCTP_CMD_PROCESS_CTSN
:

1644 
§ckh
.
cum_t¢_ack
 = 
cmd
->
obj
.
be32
;

1645 
§ckh
.
a_rwnd
 = 
asoc
->
³”
.
rwnd
 +

1646 
asoc
->
outqueue
.
out¡ªdšg_by‹s
;

1647 
§ckh
.
num_g­_ack_blocks
 = 0;

1648 
§ckh
.
num_dup_t¢s
 = 0;

1649 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PROCESS_SACK
,

1650 
	`SCTP_SACKH
(&
§ckh
));

1653 
SCTP_CMD_DISCARD_PACKET
:

1658 
chunk
->
pdisÿrd
 = 1;

1659 ià(
asoc
) {

1660 
	`sùp_outq_uncÜk
(&
asoc
->
outqueue
);

1661 
loÿl_cÜk
 = 0;

1665 
SCTP_CMD_RTO_PENDING
:

1666 
t
 = 
cmd
->
obj
.
Œª¥Üt
;

1667 
t
->
¹o_³ndšg
 = 1;

1670 
SCTP_CMD_PART_DELIVER
:

1671 
	`sùp_uÍq_·¹Ÿl_d–iv”y
(&
asoc
->
uÍq
, 
cmd
->
obj
.
±r
,

1672 
GFP_ATOMIC
);

1675 
SCTP_CMD_RENEGE
:

1676 
	`sùp_uÍq_»Ãge
(&
asoc
->
uÍq
, 
cmd
->
obj
.
±r
,

1677 
GFP_ATOMIC
);

1680 
SCTP_CMD_SETUP_T4
:

1681 
	`sùp_cmd_£tup_t4
(
commªds
, 
asoc
, 
cmd
->
obj
.
±r
);

1684 
SCTP_CMD_PROCESS_OPERR
:

1685 
	`sùp_cmd_´oûss_İ”r
(
commªds
, 
asoc
, 
chunk
);

1687 
SCTP_CMD_CLEAR_INIT_TAG
:

1688 
asoc
->
³”
.
i
.
š™_g
 = 0;

1690 
SCTP_CMD_DEL_NON_PRIMARY
:

1691 
	`sùp_cmd_d–_nÚ_´im¬y
(
asoc
);

1693 
SCTP_CMD_T3_RTX_TIMERS_STOP
:

1694 
	`sùp_cmd_t3_¹x_tim”s_¡İ
(
commªds
, 
asoc
);

1696 
SCTP_CMD_FORCE_PRIM_RETRAN
:

1697 
t
 = 
asoc
->
³”
.
»Œª_·th
;

1698 
asoc
->
³”
.
»Œª_·th
 =‡soc->³”.
´im¬y_·th
;

1699 
”rÜ
 = 
	`sùp_outq_uncÜk
(&
asoc
->
outqueue
);

1700 
loÿl_cÜk
 = 0;

1701 
asoc
->
³”
.
»Œª_·th
 = 
t
;

1703 
SCTP_CMD_SET_SK_ERR
:

1704 
	`sùp_cmd_£t_sk_”r
(
asoc
, 
cmd
->
obj
.
”rÜ
);

1706 
SCTP_CMD_ASSOC_CHANGE
:

1707 
	`sùp_cmd_assoc_chªge
(
commªds
, 
asoc
,

1708 
cmd
->
obj
.
u8
);

1710 
SCTP_CMD_ADAPTATION_IND
:

1711 
	`sùp_cmd_ad­tiÚ_šd
(
commªds
, 
asoc
);

1714 
SCTP_CMD_ASSOC_SHKEY
:

1715 
”rÜ
 = 
	`sùp_auth_asoc_š™_aùive_key
(
asoc
,

1716 
GFP_ATOMIC
);

1718 
SCTP_CMD_UPDATE_INITTAG
:

1719 
asoc
->
³”
.
i
.
š™_g
 = 
cmd
->
obj
.
u32
;

1721 
SCTP_CMD_SEND_MSG
:

1722 ià(!
asoc
->
outqueue
.
cÜk
) {

1723 
	`sùp_outq_cÜk
(&
asoc
->
outqueue
);

1724 
loÿl_cÜk
 = 1;

1726 
”rÜ
 = 
	`sùp_cmd_£nd_msg
(
asoc
, 
cmd
->
obj
.
msg
);

1728 
SCTP_CMD_SEND_NEXT_ASCONF
:

1729 
	`sùp_cmd_£nd_ascÚf
(
asoc
);

1731 
SCTP_CMD_PURGE_ASCONF_QUEUE
:

1732 
	`sùp_ascÚf_queue_‹¬down
(
asoc
);

1734 
SCTP_CMD_SET_ASOC
:

1735 
asoc
 = 
cmd
->
obj
.asoc;

1738 
	`´štk
(
KERN_WARNING
 "Impossible command: %u, %p\n",

1739 
cmd
->
v”b
, cmd->
obj
.
±r
);

1743 ià(
”rÜ
)

1747 
out
:

1752 ià(
asoc
 && 
SCTP_EVENT_T_CHUNK
 =ğ
ev’t_ty³
 && 
chunk
) {

1753 ià(
chunk
->
’d_of_·ck‘
 || chunk->
sšgËtÚ
)

1754 
”rÜ
 = 
	`sùp_outq_uncÜk
(&
asoc
->
outqueue
);

1755 } ià(
loÿl_cÜk
)

1756 
”rÜ
 = 
	`sùp_outq_uncÜk
(&
asoc
->
outqueue
);

1757  
”rÜ
;

1758 
nomem
:

1759 
”rÜ
 = -
ENOMEM
;

1760 
out
;

1761 
	}
}

	@sm_statefuns.c

53 
	~<lšux/ty³s.h
>

54 
	~<lšux/k”Ãl.h
>

55 
	~<lšux/.h
>

56 
	~<lšux/v6.h
>

57 
	~<lšux/Ãt.h
>

58 
	~<lšux/š‘.h
>

59 
	~<Ãt/sock.h
>

60 
	~<Ãt/š‘_eú.h
>

61 
	~<lšux/skbuff.h
>

62 
	~<Ãt/sùp/sùp.h
>

63 
	~<Ãt/sùp/sm.h
>

64 
	~<Ãt/sùp/¡ruùs.h
>

66 
sùp_·ck‘
 *
sùp_abÜt_pkt_Ãw
(cÚ¡ 
sùp_’dpošt
 *
•
,

67 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

68 
sùp_chunk
 *
chunk
,

69 cÚ¡ *
·ylßd
,

70 
size_t
 
·yËn
);

71 
sùp_—t_d©a
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

72 
sùp_chunk
 *
chunk
,

73 
sùp_cmd_£q_t
 *
commªds
);

74 
sùp_·ck‘
 *
sùp_oÙb_pkt_Ãw
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

75 cÚ¡ 
sùp_chunk
 *
chunk
);

76 
sùp_£nd_¡®e_cook›_”r
(cÚ¡ 
sùp_’dpošt
 *
•
,

77 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

78 cÚ¡ 
sùp_chunk
 *
chunk
,

79 
sùp_cmd_£q_t
 *
commªds
,

80 
sùp_chunk
 *
”r_chunk
);

81 
sùp_di¥os™iÚ_t
 
sùp_sf_do_5_2_6_¡®e
(cÚ¡ 
sùp_’dpošt
 *
•
,

82 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

83 cÚ¡ 
sùp_subty³_t
 
ty³
,

84 *
¬g
,

85 
sùp_cmd_£q_t
 *
commªds
);

86 
sùp_di¥os™iÚ_t
 
sùp_sf_shut_8_4_5
(cÚ¡ 
sùp_’dpošt
 *
•
,

87 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

88 cÚ¡ 
sùp_subty³_t
 
ty³
,

89 *
¬g
,

90 
sùp_cmd_£q_t
 *
commªds
);

91 
sùp_di¥os™iÚ_t
 
sùp_sf_bÜt_8_4_8
(cÚ¡ 
sùp_’dpošt
 *
•
,

92 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

93 cÚ¡ 
sùp_subty³_t
 
ty³
,

94 *
¬g
,

95 
sùp_cmd_£q_t
 *
commªds
);

96 
sùp_§ckhdr
 *
sùp_sm_puÎ_§ck
(
sùp_chunk
 *
chunk
);

98 
sùp_di¥os™iÚ_t
 
sùp_¡İ_t1_ªd_abÜt
(
sùp_cmd_£q_t
 *
commªds
,

99 
__be16
 
”rÜ
, 
sk_”r
,

100 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

101 
sùp_Œª¥Üt
 *
Œª¥Üt
);

103 
sùp_di¥os™iÚ_t
 
sùp_sf_abÜt_viŞ©iÚ
(

104 cÚ¡ 
sùp_’dpošt
 *
•
,

105 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

106 *
¬g
,

107 
sùp_cmd_£q_t
 *
commªds
,

108 cÚ¡ 
__u8
 *
·ylßd
,

109 cÚ¡ 
size_t
 
·yËn
);

111 
sùp_di¥os™iÚ_t
 
sùp_sf_viŞ©iÚ_chunkËn
(

112 cÚ¡ 
sùp_’dpošt
 *
•
,

113 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

114 cÚ¡ 
sùp_subty³_t
 
ty³
,

115 *
¬g
,

116 
sùp_cmd_£q_t
 *
commªds
);

118 
sùp_di¥os™iÚ_t
 
sùp_sf_viŞ©iÚ_·¿mËn
(

119 cÚ¡ 
sùp_’dpošt
 *
•
,

120 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

121 cÚ¡ 
sùp_subty³_t
 
ty³
,

122 *
¬g
, *
ext
,

123 
sùp_cmd_£q_t
 *
commªds
);

125 
sùp_di¥os™iÚ_t
 
sùp_sf_viŞ©iÚ_ù¢
(

126 cÚ¡ 
sùp_’dpošt
 *
•
,

127 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

128 cÚ¡ 
sùp_subty³_t
 
ty³
,

129 *
¬g
,

130 
sùp_cmd_£q_t
 *
commªds
);

132 
sùp_di¥os™iÚ_t
 
sùp_sf_viŞ©iÚ_chunk
(

133 cÚ¡ 
sùp_’dpošt
 *
•
,

134 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

135 cÚ¡ 
sùp_subty³_t
 
ty³
,

136 *
¬g
,

137 
sùp_cmd_£q_t
 *
commªds
);

139 
sùp_›¼Ü_t
 
sùp_sf_auth’tiÿ‹
(cÚ¡ 
sùp_’dpošt
 *
•
,

140 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

141 cÚ¡ 
sùp_subty³_t
 
ty³
,

142 
sùp_chunk
 *
chunk
);

144 
sùp_di¥os™iÚ_t
 
__sùp_sf_do_9_1_abÜt
(cÚ¡ 
sùp_’dpošt
 *
•
,

145 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

146 cÚ¡ 
sùp_subty³_t
 
ty³
,

147 *
¬g
,

148 
sùp_cmd_£q_t
 *
commªds
);

157 
šlše
 

158 
	$sùp_chunk_Ëngth_v®id
(
sùp_chunk
 *
chunk
,

159 
__u16
 
»quœed_Ëngth
)

161 
__u16
 
chunk_Ëngth
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

163 ià(
	`uÆik–y
(
chunk_Ëngth
 < 
»quœed_Ëngth
))

167 
	}
}

204 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_4_C
(cÚ¡ 
sùp_’dpošt
 *
•
,

205 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

206 cÚ¡ 
sùp_subty³_t
 
ty³
,

207 *
¬g
,

208 
sùp_cmd_£q_t
 *
commªds
)

210 
sùp_chunk
 *
chunk
 = 
¬g
;

211 
sùp_uÍev’t
 *
ev
;

213 ià(!
	`sùp_vg_v”ify_e™h”
(
chunk
, 
asoc
))

214  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

221 ià(!
chunk
->
sšgËtÚ
)

222  
	`sùp_sf_viŞ©iÚ_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

225 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

226  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

227 
commªds
);

236 
ev
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
, 0, 
SCTP_SHUTDOWN_COMP
,

237 0, 0, 0, 
NULL
, 
GFP_ATOMIC
);

238 ià(
ev
)

239 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
,

240 
	`SCTP_ULPEVENT
(
ev
));

250 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

251 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

253 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

254 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
));

256 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

257 
	`SCTP_STATE
(
SCTP_STATE_CLOSED
));

259 
	`SCTP_INC_STATS
(
SCTP_MIB_SHUTDOWNS
);

260 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

262 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DELETE_TCB
, 
	`SCTP_NULL
());

264  
SCTP_DISPOSITION_DELETE_TCB
;

265 
	}
}

289 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_1B_š™
(cÚ¡ 
sùp_’dpošt
 *
•
,

290 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

291 cÚ¡ 
sùp_subty³_t
 
ty³
,

292 *
¬g
,

293 
sùp_cmd_£q_t
 *
commªds
)

295 
sùp_chunk
 *
chunk
 = 
¬g
;

296 
sùp_chunk
 *
»¶
;

297 
sùp_assocŸtiÚ
 *
Ãw_asoc
;

298 
sùp_chunk
 *
”r_chunk
;

299 
sùp_·ck‘
 *
·ck‘
;

300 
sùp_uÄecognized_·¿m_t
 *
unk_·¿m
;

301 
Ën
;

312 ià(!
chunk
->
sšgËtÚ
)

313  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

318 ià(
•
 =ğ
	`sùp_sk
((
	`sùp_g‘_ùl_sock
()))->ep) {

319 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTOFBLUES
);

320  
	`sùp_sf_bÜt_8_4_8
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

326 ià(
chunk
->
sùp_hdr
->
vg
 != 0)

327  
	`sùp_sf_bÜt_8_4_8
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

334 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_š™_chunk_t
)))

335  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

343 ià(
	`sùp_s¡©e
(
•
->
ba£
.
sk
, 
CLOSING
))

344  
	`sùp_sf_bÜt_8_4_8
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

347 
”r_chunk
 = 
NULL
;

348 ià(!
	`sùp_v”ify_š™
(
NULL
, 
asoc
, 
chunk
->
chunk_hdr
->
ty³
,

349 (
sùp_š™_chunk_t
 *)
chunk
->
chunk_hdr
, chunk,

350 &
”r_chunk
)) {

354 ià(
”r_chunk
) {

355 
·ck‘
 = 
	`sùp_abÜt_pkt_Ãw
(
•
, 
asoc
, 
¬g
,

356 (
__u8
 *)(
”r_chunk
->
chunk_hdr
) +

357 (
sùp_chunkhdr_t
),

358 
	`Áohs
(
”r_chunk
->
chunk_hdr
->
Ëngth
) -

359 (
sùp_chunkhdr_t
));

361 
	`sùp_chunk_ä“
(
”r_chunk
);

363 ià(
·ck‘
) {

364 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_PKT
,

365 
	`SCTP_PACKET
(
·ck‘
));

366 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

367  
SCTP_DISPOSITION_CONSUME
;

369  
SCTP_DISPOSITION_NOMEM
;

372  
	`sùp_sf_bÜt_8_4_8
(
•
, 
asoc
, 
ty³
, 
¬g
,

373 
commªds
);

378 
chunk
->
subh
.
š™_hdr
 = (
sùp_š™hdr_t
 *)chunk->
skb
->
d©a
;

381 
chunk
->
·¿m_hdr
.
v
 = 
	`skb_puÎ
(chunk->
skb
, (
sùp_š™hdr_t
));

383 
Ãw_asoc
 = 
	`sùp_make_‹mp_asoc
(
•
, 
chunk
, 
GFP_ATOMIC
);

384 ià(!
Ãw_asoc
)

385 
nomem
;

387 ià(
	`sùp_assoc_£t_bšd_addr_äom_•
(
Ãw_asoc
,

388 
	`sùp_scİe
(
	`sùp_sourû
(
chunk
)),

389 
GFP_ATOMIC
) < 0)

390 
nomem_š™
;

393 ià(!
	`sùp_´oûss_š™
(
Ãw_asoc
, 
chunk
, 
	`sùp_sourû
(chunk),

394 (
sùp_š™_chunk_t
 *)
chunk
->
chunk_hdr
,

395 
GFP_ATOMIC
))

396 
nomem_š™
;

403 
Ën
 = 0;

404 ià(
”r_chunk
)

405 
Ën
 = 
	`Áohs
(
”r_chunk
->
chunk_hdr
->
Ëngth
) -

406 (
sùp_chunkhdr_t
);

408 
»¶
 = 
	`sùp_make_š™_ack
(
Ãw_asoc
, 
chunk
, 
GFP_ATOMIC
, 
Ën
);

409 ià(!
»¶
)

410 
nomem_š™
;

416 ià(
”r_chunk
) {

424 
unk_·¿m
 = (
sùp_uÄecognized_·¿m_t
 *)

425 ((
__u8
 *)(
”r_chunk
->
chunk_hdr
) +

426 (
sùp_chunkhdr_t
));

430 
	`sùp_addto_chunk
(
»¶
, 
Ën
, 
unk_·¿m
);

431 
	`sùp_chunk_ä“
(
”r_chunk
);

434 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_ASOC
, 
	`SCTP_ASOC
(
Ãw_asoc
));

436 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

444 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DELETE_TCB
, 
	`SCTP_NULL
());

446  
SCTP_DISPOSITION_DELETE_TCB
;

448 
nomem_š™
:

449 
	`sùp_assocŸtiÚ_ä“
(
Ãw_asoc
);

450 
nomem
:

451 ià(
”r_chunk
)

452 
	`sùp_chunk_ä“
(
”r_chunk
);

453  
SCTP_DISPOSITION_NOMEM
;

454 
	}
}

484 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_1C_ack
(cÚ¡ 
sùp_’dpošt
 *
•
,

485 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

486 cÚ¡ 
sùp_subty³_t
 
ty³
,

487 *
¬g
,

488 
sùp_cmd_£q_t
 *
commªds
)

490 
sùp_chunk
 *
chunk
 = 
¬g
;

491 
sùp_š™_chunk_t
 *
š™chunk
;

492 
sùp_chunk
 *
”r_chunk
;

493 
sùp_·ck‘
 *
·ck‘
;

495 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

496  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

502 ià(!
chunk
->
sšgËtÚ
)

503  
	`sùp_sf_viŞ©iÚ_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

506 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_š™ack_chunk_t
)))

507  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

508 
commªds
);

510 
chunk
->
subh
.
š™_hdr
 = (
sùp_š™hdr_t
 *èchunk->
skb
->
d©a
;

513 
”r_chunk
 = 
NULL
;

514 ià(!
	`sùp_v”ify_š™
(
NULL
, 
asoc
, 
chunk
->
chunk_hdr
->
ty³
,

515 (
sùp_š™_chunk_t
 *)
chunk
->
chunk_hdr
, chunk,

516 &
”r_chunk
)) {

518 
sùp_”rÜ_t
 
”rÜ
 = 
SCTP_ERROR_NO_RESOURCE
;

525 ià(
”r_chunk
) {

526 
·ck‘
 = 
	`sùp_abÜt_pkt_Ãw
(
•
, 
asoc
, 
¬g
,

527 (
__u8
 *)(
”r_chunk
->
chunk_hdr
) +

528 (
sùp_chunkhdr_t
),

529 
	`Áohs
(
”r_chunk
->
chunk_hdr
->
Ëngth
) -

530 (
sùp_chunkhdr_t
));

532 
	`sùp_chunk_ä“
(
”r_chunk
);

534 ià(
·ck‘
) {

535 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_PKT
,

536 
	`SCTP_PACKET
(
·ck‘
));

537 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

538 
”rÜ
 = 
SCTP_ERROR_INV_PARAM
;

553 ià(
	`sùp_auth_»cv_cid
(
SCTP_CID_ABORT
, 
asoc
))

554  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

556 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

557  
	`sùp_¡İ_t1_ªd_abÜt
(
commªds
, 
”rÜ
, 
ECONNREFUSED
,

558 
asoc
, 
chunk
->
Œª¥Üt
);

564 
chunk
->
·¿m_hdr
.
v
 = 
	`skb_puÎ
(chunk->
skb
, (
sùp_š™hdr_t
));

566 
š™chunk
 = (
sùp_š™_chunk_t
 *è
chunk
->
chunk_hdr
;

568 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PEER_INIT
,

569 
	`SCTP_PEER_INIT
(
š™chunk
));

572 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_COUNTER_RESET
, 
	`SCTP_NULL
());

578 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

579 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

580 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_START
,

581 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_COOKIE
));

582 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

583 
	`SCTP_STATE
(
SCTP_STATE_COOKIE_ECHOED
));

588 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_SHKEY
, 
	`SCTP_NULL
());

596 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_COOKIE_ECHO
,

597 
	`SCTP_CHUNK
(
”r_chunk
));

599  
SCTP_DISPOSITION_CONSUME
;

600 
	}
}

633 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_1D_û
(cÚ¡ 
sùp_’dpošt
 *
•
,

634 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

635 cÚ¡ 
sùp_subty³_t
 
ty³
, *
¬g
,

636 
sùp_cmd_£q_t
 *
commªds
)

638 
sùp_chunk
 *
chunk
 = 
¬g
;

639 
sùp_assocŸtiÚ
 *
Ãw_asoc
;

640 
sùp_š™_chunk_t
 *
³”_š™
;

641 
sùp_chunk
 *
»¶
;

642 
sùp_uÍev’t
 *
ev
, *
ai_ev
 = 
NULL
;

643 
”rÜ
 = 0;

644 
sùp_chunk
 *
”r_chk_p
;

645 
sock
 *
sk
;

650 ià(
•
 =ğ
	`sùp_sk
((
	`sùp_g‘_ùl_sock
()))->ep) {

651 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTOFBLUES
);

652  
	`sùp_sf_bÜt_8_4_8
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

660 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

661  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

667 
sk
 = 
•
->
ba£
.sk;

668 ià(!
	`sùp_s¡©e
(
sk
, 
LISTENING
) ||

669 (
	`sùp_¡yË
(
sk
, 
TCP
è&& 
	`sk_acû±q_is_fuÎ
(sk)))

670  
	`sùp_sf_bÜt_8_4_8
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

675 
chunk
->
subh
.
cook›_hdr
 =

676 (
sùp_sigÃd_cook›
 *)
chunk
->
skb
->
d©a
;

677 ià(!
	`pskb_puÎ
(
chunk
->
skb
, 
	`Áohs
(chunk->
chunk_hdr
->
Ëngth
) -

678 (
sùp_chunkhdr_t
)))

679 
nomem
;

685 
Ãw_asoc
 = 
	`sùp_uÅack_cook›
(
•
, 
asoc
, 
chunk
, 
GFP_ATOMIC
, &
”rÜ
,

686 &
”r_chk_p
);

694 ià(!
Ãw_asoc
) {

698 
”rÜ
) {

699 -
SCTP_IERROR_NOMEM
:

700 
nomem
;

702 -
SCTP_IERROR_STALE_COOKIE
:

703 
	`sùp_£nd_¡®e_cook›_”r
(
•
, 
asoc
, 
chunk
, 
commªds
,

704 
”r_chk_p
);

705  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

707 -
SCTP_IERROR_BAD_SIG
:

709  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

722 
³”_š™
 = &
chunk
->
subh
.
cook›_hdr
->
c
.peer_init[0];

724 ià(!
	`sùp_´oûss_š™
(
Ãw_asoc
, 
chunk
,

725 &
chunk
->
subh
.
cook›_hdr
->
c
.
³”_addr
,

726 
³”_š™
, 
GFP_ATOMIC
))

727 
nomem_š™
;

733 
”rÜ
 = 
	`sùp_auth_asoc_š™_aùive_key
(
Ãw_asoc
, 
GFP_ATOMIC
);

734 ià(
”rÜ
)

735 
nomem_š™
;

743 ià(
chunk
->
auth_chunk
) {

744 
sùp_chunk
 
auth
;

745 
sùp_›¼Ü_t
 
»t
;

748 
auth
.
skb
 = 
chunk
->
auth_chunk
;

749 
auth
.
asoc
 = 
chunk
->asoc;

750 
auth
.
sùp_hdr
 = 
chunk
->sctp_hdr;

751 
auth
.
chunk_hdr
 = (
sùp_chunkhdr_t
 *)
	`skb_push
(
chunk
->
auth_chunk
,

752 (
sùp_chunkhdr_t
));

753 
	`skb_puÎ
(
chunk
->
auth_chunk
, (
sùp_chunkhdr_t
));

754 
auth
.
Œª¥Üt
 = 
chunk
->transport;

756 
»t
 = 
	`sùp_sf_auth’tiÿ‹
(
•
, 
Ãw_asoc
, 
ty³
, &
auth
);

759 
	`kä“_skb
(
chunk
->
auth_chunk
);

761 ià(
»t
 !ğ
SCTP_IERROR_NO_ERROR
) {

762 
	`sùp_assocŸtiÚ_ä“
(
Ãw_asoc
);

763  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

767 
»¶
 = 
	`sùp_make_cook›_ack
(
Ãw_asoc
, 
chunk
);

768 ià(!
»¶
)

769 
nomem_š™
;

777 
ev
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
Ãw_asoc
, 0, 
SCTP_COMM_UP
, 0,

778 
Ãw_asoc
->
c
.
sš™_num_o¡»ams
,

779 
Ãw_asoc
->
c
.
sš™_max_š¡»ams
,

780 
NULL
, 
GFP_ATOMIC
);

781 ià(!
ev
)

782 
nomem_ev
;

789 ià(
Ãw_asoc
->
³”
.
ad­tiÚ_šd
) {

790 
ai_ev
 = 
	`sùp_uÍev’t_make_ad­tiÚ_šdiÿtiÚ
(
Ãw_asoc
,

791 
GFP_ATOMIC
);

792 ià(!
ai_ev
)

793 
nomem_a›v
;

801 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_ASOC
, 
	`SCTP_ASOC
(
Ãw_asoc
));

802 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

803 
	`SCTP_STATE
(
SCTP_STATE_ESTABLISHED
));

804 
	`SCTP_INC_STATS
(
SCTP_MIB_CURRESTAB
);

805 
	`SCTP_INC_STATS
(
SCTP_MIB_PASSIVEESTABS
);

806 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_HB_TIMERS_START
, 
	`SCTP_NULL
());

808 ià(
Ãw_asoc
->
autoşo£
)

809 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_START
,

810 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_AUTOCLOSE
));

813 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

816 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
, 
	`SCTP_ULPEVENT
(
ev
));

819 ià(
ai_ev
)

820 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
,

821 
	`SCTP_ULPEVENT
(
ai_ev
));

823  
SCTP_DISPOSITION_CONSUME
;

825 
nomem_a›v
:

826 
	`sùp_uÍev’t_ä“
(
ev
);

827 
nomem_ev
:

828 
	`sùp_chunk_ä“
(
»¶
);

829 
nomem_š™
:

830 
	`sùp_assocŸtiÚ_ä“
(
Ãw_asoc
);

831 
nomem
:

832  
SCTP_DISPOSITION_NOMEM
;

833 
	}
}

856 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_1E_ÿ
(cÚ¡ 
sùp_’dpošt
 *
•
,

857 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

858 cÚ¡ 
sùp_subty³_t
 
ty³
, *
¬g
,

859 
sùp_cmd_£q_t
 *
commªds
)

861 
sùp_chunk
 *
chunk
 = 
¬g
;

862 
sùp_uÍev’t
 *
ev
;

864 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

865  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

870 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

871  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

872 
commªds
);

880 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_COUNTER_RESET
, 
	`SCTP_NULL
());

888 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

889 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_COOKIE
));

890 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

891 
	`SCTP_STATE
(
SCTP_STATE_ESTABLISHED
));

892 
	`SCTP_INC_STATS
(
SCTP_MIB_CURRESTAB
);

893 
	`SCTP_INC_STATS
(
SCTP_MIB_ACTIVEESTABS
);

894 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_HB_TIMERS_START
, 
	`SCTP_NULL
());

895 ià(
asoc
->
autoşo£
)

896 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_START
,

897 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_AUTOCLOSE
));

903 
ev
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
, 0, 
SCTP_COMM_UP
,

904 0, 
asoc
->
c
.
sš™_num_o¡»ams
,

905 
asoc
->
c
.
sš™_max_š¡»ams
,

906 
NULL
, 
GFP_ATOMIC
);

908 ià(!
ev
)

909 
nomem
;

911 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
, 
	`SCTP_ULPEVENT
(
ev
));

918 ià(
asoc
->
³”
.
ad­tiÚ_šd
) {

919 
ev
 = 
	`sùp_uÍev’t_make_ad­tiÚ_šdiÿtiÚ
(
asoc
, 
GFP_ATOMIC
);

920 ià(!
ev
)

921 
nomem
;

923 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
,

924 
	`SCTP_ULPEVENT
(
ev
));

927  
SCTP_DISPOSITION_CONSUME
;

928 
nomem
:

929  
SCTP_DISPOSITION_NOMEM
;

930 
	}
}

933 
sùp_di¥os™iÚ_t
 
	$sùp_sf_h—¹b—t
(cÚ¡ 
sùp_’dpošt
 *
•
,

934 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

935 cÚ¡ 
sùp_subty³_t
 
ty³
,

936 *
¬g
,

937 
sùp_cmd_£q_t
 *
commªds
)

939 
sùp_Œª¥Üt
 *
Œª¥Üt
 = (sùp_Œª¥Üˆ*è
¬g
;

940 
sùp_chunk
 *
»¶y
;

941 
sùp_£nd”_hb_šfo_t
 
hbšfo
;

942 
size_t
 
·yËn
 = 0;

944 
hbšfo
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_HEARTBEAT_INFO
;

945 
hbšfo
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
((
sùp_£nd”_hb_šfo_t
));

946 
hbšfo
.
daddr
 = 
Œª¥Üt
->
addr
;

947 
hbšfo
.
£Á_©
 = 
jiff›s
;

948 
hbšfo
.
hb_nÚû
 = 
Œª¥Üt
->hb_nonce;

951 
·yËn
 = (
sùp_£nd”_hb_šfo_t
);

952 
»¶y
 = 
	`sùp_make_h—¹b—t
(
asoc
, 
Œª¥Üt
, &
hbšfo
, 
·yËn
);

953 ià(!
»¶y
)

954  
SCTP_DISPOSITION_NOMEM
;

959 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_RTO_PENDING
,

960 
	`SCTP_TRANSPORT
(
Œª¥Üt
));

962 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

963  
SCTP_DISPOSITION_CONSUME
;

964 
	}
}

967 
sùp_di¥os™iÚ_t
 
	$sùp_sf_£ndb—t_8_3
(cÚ¡ 
sùp_’dpošt
 *
•
,

968 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

969 cÚ¡ 
sùp_subty³_t
 
ty³
,

970 *
¬g
,

971 
sùp_cmd_£q_t
 *
commªds
)

973 
sùp_Œª¥Üt
 *
Œª¥Üt
 = (sùp_Œª¥Üˆ*è
¬g
;

975 ià(
asoc
->
ov”®l_”rÜ_couÁ
 >ğasoc->
max_»Œªs
) {

976 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

977 
	`SCTP_ERROR
(
ETIMEDOUT
));

979 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

980 
	`SCTP_PERR
(
SCTP_ERROR_NO_ERROR
));

981 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

982 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

983  
SCTP_DISPOSITION_DELETE_TCB
;

993 ià(
Œª¥Üt
->
·¿m_æags
 & 
SPP_HB_ENABLE
) {

994 ià(
SCTP_DISPOSITION_NOMEM
 ==

995 
	`sùp_sf_h—¹b—t
(
•
, 
asoc
, 
ty³
, 
¬g
,

996 
commªds
))

997  
SCTP_DISPOSITION_NOMEM
;

1002 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TRANSPORT_HB_SENT
,

1003 
	`SCTP_TRANSPORT
(
Œª¥Üt
));

1005 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TRANSPORT_IDLE
,

1006 
	`SCTP_TRANSPORT
(
Œª¥Üt
));

1007 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_HB_TIMER_UPDATE
,

1008 
	`SCTP_TRANSPORT
(
Œª¥Üt
));

1010  
SCTP_DISPOSITION_CONSUME
;

1011 
	}
}

1037 
sùp_di¥os™iÚ_t
 
	$sùp_sf_b—t_8_3
(cÚ¡ 
sùp_’dpošt
 *
•
,

1038 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1039 cÚ¡ 
sùp_subty³_t
 
ty³
,

1040 *
¬g
,

1041 
sùp_cmd_£q_t
 *
commªds
)

1043 
sùp_chunk
 *
chunk
 = 
¬g
;

1044 
sùp_chunk
 *
»¶y
;

1045 
size_t
 
·yËn
 = 0;

1047 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

1048  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

1051 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_h—¹b—t_chunk_t
)))

1052  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

1053 
commªds
);

1059 
chunk
->
subh
.
hb_hdr
 = (
sùp_h—¹b—thdr_t
 *èchunk->
skb
->
d©a
;

1060 
·yËn
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
è- (
sùp_chunkhdr_t
);

1061 ià(!
	`pskb_puÎ
(
chunk
->
skb
, 
·yËn
))

1062 
nomem
;

1064 
»¶y
 = 
	`sùp_make_h—¹b—t_ack
(
asoc
, 
chunk
,

1065 
chunk
->
subh
.
hb_hdr
, 
·yËn
);

1066 ià(!
»¶y
)

1067 
nomem
;

1069 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

1070  
SCTP_DISPOSITION_CONSUME
;

1072 
nomem
:

1073  
SCTP_DISPOSITION_NOMEM
;

1074 
	}
}

1104 
sùp_di¥os™iÚ_t
 
	$sùp_sf_backb—t_8_3
(cÚ¡ 
sùp_’dpošt
 *
•
,

1105 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1106 cÚ¡ 
sùp_subty³_t
 
ty³
,

1107 *
¬g
,

1108 
sùp_cmd_£q_t
 *
commªds
)

1110 
sùp_chunk
 *
chunk
 = 
¬g
;

1111 
sùp_addr
 
äom_addr
;

1112 
sùp_Œª¥Üt
 *
lšk
;

1113 
sùp_£nd”_hb_šfo_t
 *
hbšfo
;

1114 
max_š‹rv®
;

1116 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

1117  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

1120 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
) +

1121 (
sùp_£nd”_hb_šfo_t
)))

1122  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

1123 
commªds
);

1125 
hbšfo
 = (
sùp_£nd”_hb_šfo_t
 *è
chunk
->
skb
->
d©a
;

1127 ià(
	`Áohs
(
hbšfo
->
·¿m_hdr
.
Ëngth
) !=

1128 (
sùp_£nd”_hb_šfo_t
)) {

1129  
SCTP_DISPOSITION_DISCARD
;

1132 
äom_addr
 = 
hbšfo
->
daddr
;

1133 
lšk
 = 
	`sùp_assoc_lookup_·ddr
(
asoc
, &
äom_addr
);

1136 ià(
	`uÆik–y
(!
lšk
)) {

1137 ià(
äom_addr
.
§
.
§_çmy
 =ğ
AF_INET6
) {

1138 ià(
	`Ãt_¿‹lim™
())

1139 
	`´štk
(
KERN_WARNING


1141 
__func__
,

1142 
asoc
,

1143 &
äom_addr
.
v6
.
sš6_addr
);

1145 ià(
	`Ãt_¿‹lim™
())

1146 
	`´štk
(
KERN_WARNING


1148 
__func__
,

1149 
asoc
,

1150 &
äom_addr
.
v4
.
sš_addr
.
s_addr
);

1152  
SCTP_DISPOSITION_DISCARD
;

1156 ià(
hbšfo
->
hb_nÚû
 !ğ
lšk
->hb_nonce)

1157  
SCTP_DISPOSITION_DISCARD
;

1159 
max_š‹rv®
 = 
lšk
->
hbš‹rv®
 +†šk->
¹o
;

1162 ià(
	`time_aá”
(
hbšfo
->
£Á_©
, 
jiff›s
) ||

1163 
	`time_aá”
(
jiff›s
, 
hbšfo
->
£Á_©
 + 
max_š‹rv®
)) {

1164 
	`SCTP_DEBUG_PRINTK
("%s: HEARTBEAT ACK with invalidimestamp "

1166 
__func__
, 
lšk
);

1167  
SCTP_DISPOSITION_DISCARD
;

1176 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TRANSPORT_ON
, 
	`SCTP_TRANSPORT
(
lšk
));

1178  
SCTP_DISPOSITION_CONSUME
;

1179 
	}
}

1184 
	$sùp_sf_£nd_»¡¬t_abÜt
(
sùp_addr
 *
s§
,

1185 
sùp_chunk
 *
š™
,

1186 
sùp_cmd_£q_t
 *
commªds
)

1188 
Ën
;

1189 
sùp_·ck‘
 *
pkt
;

1190 
sùp_addr_·¿m
 *
add½¬m
;

1191 
sùp_”rhdr
 *
”rhdr
;

1192 
sùp_’dpošt
 *
•
;

1193 
bufãr
[(
sùp_”rhdr
)+(
sùp_addr_·¿m
)];

1194 
sùp_af
 *
af
 = 
	`sùp_g‘_af_¥ecific
(
s§
->
v4
.
sš_çmy
);

1199 
”rhdr
 = (
sùp_”rhdr
 *)
bufãr
;

1200 
add½¬m
 = (
sùp_addr_·¿m
 *)
”rhdr
->
v¬ŸbË
;

1203 
Ën
 = 
af
->
	`to_addr_·¿m
(
s§
, 
add½¬m
);

1204 
Ën
 +ğ(
sùp_”rhdr_t
);

1206 
”rhdr
->
ÿu£
 = 
SCTP_ERROR_RESTART
;

1207 
”rhdr
->
Ëngth
 = 
	`htÚs
(
Ën
);

1210 
•
 = 
	`sùp_sk
((
	`sùp_g‘_ùl_sock
()))->ep;

1215 
pkt
 = 
	`sùp_abÜt_pkt_Ãw
(
•
, 
NULL
, 
š™
, 
”rhdr
, 
Ën
);

1217 ià(!
pkt
)

1218 
out
;

1219 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_PKT
, 
	`SCTP_PACKET
(
pkt
));

1221 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

1224 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DISCARD_PACKET
, 
	`SCTP_NULL
());

1226 
out
:

1231 
	}
}

1233 
boŞ
 
	$li¡_has_sùp_addr
(cÚ¡ 
li¡_h—d
 *
li¡
,

1234 
sùp_addr
 *
addr
)

1236 
sùp_Œª¥Üt
 *
addr
;

1238 
	`li¡_fÜ_—ch_’Œy
(
addr
, 
li¡
, 
Œª¥Üts
) {

1239 ià(
	`sùp_cmp_addr_exaù
(
addr
, &
addr
->ipaddr))

1240  
Œue
;

1243  
çl£
;

1244 
	}
}

1248 
	$sùp_sf_check_»¡¬t_addrs
(cÚ¡ 
sùp_assocŸtiÚ
 *
Ãw_asoc
,

1249 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1250 
sùp_chunk
 *
š™
,

1251 
sùp_cmd_£q_t
 *
commªds
)

1253 
sùp_Œª¥Üt
 *
Ãw_addr
;

1254 
»t
 = 1;

1267 
	`li¡_fÜ_—ch_’Œy
(
Ãw_addr
, &
Ãw_asoc
->
³”
.
Œª¥Üt_addr_li¡
,

1268 
Œª¥Üts
) {

1269 ià(!
	`li¡_has_sùp_addr
(&
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

1270 &
Ãw_addr
->
addr
)) {

1271 
	`sùp_sf_£nd_»¡¬t_abÜt
(&
Ãw_addr
->
addr
, 
š™
,

1272 
commªds
);

1273 
»t
 = 0;

1279  
»t
;

1280 
	}
}

1287 
	$sùp_t›gs_pİuÏ‹
(
sùp_assocŸtiÚ
 *
Ãw_asoc
,

1288 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

1290 
asoc
->
¡©e
) {

1294 
SCTP_STATE_COOKIE_WAIT
:

1295 
Ãw_asoc
->
c
.
my_vg
 = 
asoc
->c.my_vtag;

1296 
Ãw_asoc
->
c
.
my_‰ag
 = 
asoc
->c.
my_vg
;

1297 
Ãw_asoc
->
c
.
³”_‰ag
 = 0;

1300 
SCTP_STATE_COOKIE_ECHOED
:

1301 
Ãw_asoc
->
c
.
my_vg
 = 
asoc
->c.my_vtag;

1302 
Ãw_asoc
->
c
.
my_‰ag
 = 
asoc
->c.
my_vg
;

1303 
Ãw_asoc
->
c
.
³”_‰ag
 = 
asoc
->c.
³”_vg
;

1310 
Ãw_asoc
->
c
.
my_‰ag
 = 
asoc
->c.
my_vg
;

1311 
Ãw_asoc
->
c
.
³”_‰ag
 = 
asoc
->c.
³”_vg
;

1319 
Ãw_asoc
->
rwnd
 = 
asoc
->rwnd;

1320 
Ãw_asoc
->
c
.
sš™_num_o¡»ams
 = 
asoc
->c.sinit_num_ostreams;

1321 
Ãw_asoc
->
c
.
sš™_max_š¡»ams
 = 
asoc
->c.sinit_max_instreams;

1322 
Ãw_asoc
->
c
.
š™Ÿl_t¢
 = 
asoc
->c.initial_tsn;

1323 
	}
}

1334 
	$sùp_t›gs_com·»
(
sùp_assocŸtiÚ
 *
Ãw_asoc
,

1335 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

1338 ià((
asoc
->
c
.
my_vg
 !ğ
Ãw_asoc
->c.my_vtag) &&

1339 (
asoc
->
c
.
³”_vg
 !ğ
Ãw_asoc
->c.peer_vtag) &&

1340 (
asoc
->
c
.
my_vg
 =ğ
Ãw_asoc
->c.
my_‰ag
) &&

1341 (
asoc
->
c
.
³”_vg
 =ğ
Ãw_asoc
->c.
³”_‰ag
))

1345 ià((
asoc
->
c
.
my_vg
 =ğ
Ãw_asoc
->c.my_vtag) &&

1346 ((
asoc
->
c
.
³”_vg
 !ğ
Ãw_asoc
->c.peer_vtag) ||

1347 (0 =ğ
asoc
->
c
.
³”_vg
))) {

1352 ià((
asoc
->
c
.
my_vg
 =ğ
Ãw_asoc
->c.my_vtag) &&

1353 (
asoc
->
c
.
³”_vg
 =ğ
Ãw_asoc
->c.peer_vtag))

1357 ià((
asoc
->
c
.
my_vg
 !ğ
Ãw_asoc
->c.my_vtag) &&

1358 (
asoc
->
c
.
³”_vg
 =ğ
Ãw_asoc
->c.peer_vtag) &&

1359 (0 =ğ
Ãw_asoc
->
c
.
my_‰ag
) &&

1360 (0 =ğ
Ãw_asoc
->
c
.
³”_‰ag
))

1365 
	}
}

1370 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_uÃx³ùed_š™
(

1371 cÚ¡ 
sùp_’dpošt
 *
•
,

1372 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1373 cÚ¡ 
sùp_subty³_t
 
ty³
,

1374 *
¬g
, 
sùp_cmd_£q_t
 *
commªds
)

1376 
sùp_di¥os™iÚ_t
 
»tv®
;

1377 
sùp_chunk
 *
chunk
 = 
¬g
;

1378 
sùp_chunk
 *
»¶
;

1379 
sùp_assocŸtiÚ
 *
Ãw_asoc
;

1380 
sùp_chunk
 *
”r_chunk
;

1381 
sùp_·ck‘
 *
·ck‘
;

1382 
sùp_uÄecognized_·¿m_t
 *
unk_·¿m
;

1383 
Ën
;

1394 ià(!
chunk
->
sšgËtÚ
)

1395  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

1400 ià(
chunk
->
sùp_hdr
->
vg
 != 0)

1401  
	`sùp_sf_bÜt_8_4_8
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

1407 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_š™_chunk_t
)))

1408  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

1409 
commªds
);

1411 
chunk
->
subh
.
š™_hdr
 = (
sùp_š™hdr_t
 *èchunk->
skb
->
d©a
;

1414 
chunk
->
·¿m_hdr
.
v
 = 
	`skb_puÎ
(chunk->
skb
, (
sùp_š™hdr_t
));

1417 
”r_chunk
 = 
NULL
;

1418 ià(!
	`sùp_v”ify_š™
(
NULL
, 
asoc
, 
chunk
->
chunk_hdr
->
ty³
,

1419 (
sùp_š™_chunk_t
 *)
chunk
->
chunk_hdr
, chunk,

1420 &
”r_chunk
)) {

1424 ià(
”r_chunk
) {

1425 
·ck‘
 = 
	`sùp_abÜt_pkt_Ãw
(
•
, 
asoc
, 
¬g
,

1426 (
__u8
 *)(
”r_chunk
->
chunk_hdr
) +

1427 (
sùp_chunkhdr_t
),

1428 
	`Áohs
(
”r_chunk
->
chunk_hdr
->
Ëngth
) -

1429 (
sùp_chunkhdr_t
));

1431 ià(
·ck‘
) {

1432 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_PKT
,

1433 
	`SCTP_PACKET
(
·ck‘
));

1434 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

1435 
»tv®
 = 
SCTP_DISPOSITION_CONSUME
;

1437 
»tv®
 = 
SCTP_DISPOSITION_NOMEM
;

1439 
ş—nup
;

1441  
	`sùp_sf_bÜt_8_4_8
(
•
, 
asoc
, 
ty³
, 
¬g
,

1442 
commªds
);

1453 
Ãw_asoc
 = 
	`sùp_make_‹mp_asoc
(
•
, 
chunk
, 
GFP_ATOMIC
);

1454 ià(!
Ãw_asoc
)

1455 
nomem
;

1457 ià(
	`sùp_assoc_£t_bšd_addr_äom_•
(
Ãw_asoc
,

1458 
	`sùp_scİe
(
	`sùp_sourû
(
chunk
)), 
GFP_ATOMIC
) < 0)

1459 
nomem
;

1465 ià(!
	`sùp_´oûss_š™
(
Ãw_asoc
, 
chunk
, 
	`sùp_sourû
(chunk),

1466 (
sùp_š™_chunk_t
 *)
chunk
->
chunk_hdr
,

1467 
GFP_ATOMIC
))

1468 
nomem
;

1475 ià(!
	`sùp_¡©e
(
asoc
, 
COOKIE_WAIT
)) {

1476 ià(!
	`sùp_sf_check_»¡¬t_addrs
(
Ãw_asoc
, 
asoc
, 
chunk
,

1477 
commªds
)) {

1478 
»tv®
 = 
SCTP_DISPOSITION_CONSUME
;

1479 
nomem_»tv®
;

1483 
	`sùp_t›gs_pİuÏ‹
(
Ãw_asoc
, 
asoc
);

1490 
Ën
 = 0;

1491 ià(
”r_chunk
) {

1492 
Ën
 = 
	`Áohs
(
”r_chunk
->
chunk_hdr
->
Ëngth
) -

1493 (
sùp_chunkhdr_t
);

1496 
»¶
 = 
	`sùp_make_š™_ack
(
Ãw_asoc
, 
chunk
, 
GFP_ATOMIC
, 
Ën
);

1497 ià(!
»¶
)

1498 
nomem
;

1504 ià(
”r_chunk
) {

1512 
unk_·¿m
 = (
sùp_uÄecognized_·¿m_t
 *)

1513 ((
__u8
 *)(
”r_chunk
->
chunk_hdr
) +

1514 (
sùp_chunkhdr_t
));

1518 
	`sùp_addto_chunk
(
»¶
, 
Ën
, 
unk_·¿m
);

1521 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_ASOC
, 
	`SCTP_ASOC
(
Ãw_asoc
));

1522 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

1529 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DELETE_TCB
, 
	`SCTP_NULL
());

1530 
»tv®
 = 
SCTP_DISPOSITION_CONSUME
;

1532  
»tv®
;

1534 
nomem
:

1535 
»tv®
 = 
SCTP_DISPOSITION_NOMEM
;

1536 
nomem_»tv®
:

1537 ià(
Ãw_asoc
)

1538 
	`sùp_assocŸtiÚ_ä“
(
Ãw_asoc
);

1539 
ş—nup
:

1540 ià(
”r_chunk
)

1541 
	`sùp_chunk_ä“
(
”r_chunk
);

1542  
»tv®
;

1543 
	}
}

1583 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_2_1_simš™
(cÚ¡ 
sùp_’dpošt
 *
•
,

1584 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1585 cÚ¡ 
sùp_subty³_t
 
ty³
,

1586 *
¬g
,

1587 
sùp_cmd_£q_t
 *
commªds
)

1592  
	`sùp_sf_do_uÃx³ùed_š™
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

1593 
	}
}

1636 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_2_2_dupš™
(cÚ¡ 
sùp_’dpošt
 *
•
,

1637 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1638 cÚ¡ 
sùp_subty³_t
 
ty³
,

1639 *
¬g
,

1640 
sùp_cmd_£q_t
 *
commªds
)

1645  
	`sùp_sf_do_uÃx³ùed_š™
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

1646 
	}
}

1658 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_2_3_š™ack
(cÚ¡ 
sùp_’dpošt
 *
•
,

1659 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1660 cÚ¡ 
sùp_subty³_t
 
ty³
,

1661 *
¬g
, 
sùp_cmd_£q_t
 *
commªds
)

1666 ià(
•
 =ğ
	`sùp_sk
((
	`sùp_g‘_ùl_sock
()))->ep)

1667  
	`sùp_sf_oÙb
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

1669  
	`sùp_sf_disÿrd_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

1670 
	}
}

1677 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_dupcook_a
(cÚ¡ 
sùp_’dpošt
 *
•
,

1678 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1679 
sùp_chunk
 *
chunk
,

1680 
sùp_cmd_£q_t
 *
commªds
,

1681 
sùp_assocŸtiÚ
 *
Ãw_asoc
)

1683 
sùp_š™_chunk_t
 *
³”_š™
;

1684 
sùp_uÍev’t
 *
ev
;

1685 
sùp_chunk
 *
»¶
;

1686 
sùp_chunk
 *
”r
;

1687 
sùp_di¥os™iÚ_t
 
di¥os™iÚ
;

1692 
³”_š™
 = &
chunk
->
subh
.
cook›_hdr
->
c
.peer_init[0];

1694 ià(!
	`sùp_´oûss_š™
(
Ãw_asoc
, 
chunk
, 
	`sùp_sourû
(chunk), 
³”_š™
,

1695 
GFP_ATOMIC
))

1696 
nomem
;

1702 ià(!
	`sùp_sf_check_»¡¬t_addrs
(
Ãw_asoc
, 
asoc
, 
chunk
, 
commªds
)) {

1703  
SCTP_DISPOSITION_CONSUME
;

1712 ià(
	`sùp_¡©e
(
asoc
, 
SHUTDOWN_ACK_SENT
)) {

1713 
di¥os™iÚ
 = 
	`sùp_sf_do_9_2_»shuck
(
•
, 
asoc
,

1714 
	`SCTP_ST_CHUNK
(
chunk
->
chunk_hdr
->
ty³
),

1715 
chunk
, 
commªds
);

1716 ià(
SCTP_DISPOSITION_NOMEM
 =ğ
di¥os™iÚ
)

1717 
nomem
;

1719 
”r
 = 
	`sùp_make_İ_”rÜ
(
asoc
, 
chunk
,

1720 
SCTP_ERROR_COOKIE_IN_SHUTDOWN
,

1721 
NULL
, 0, 0);

1722 ià(
”r
)

1723 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

1724 
	`SCTP_CHUNK
(
”r
));

1726  
SCTP_DISPOSITION_CONSUME
;

1732 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_T3_RTX_TIMERS_STOP
, 
	`SCTP_NULL
());

1733 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

1734 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_SACK
));

1735 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PURGE_OUTQUEUE
, 
	`SCTP_NULL
());

1740 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

1741 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T4_RTO
));

1742 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PURGE_ASCONF_QUEUE
, 
	`SCTP_NULL
());

1744 
»¶
 = 
	`sùp_make_cook›_ack
(
Ãw_asoc
, 
chunk
);

1745 ià(!
»¶
)

1746 
nomem
;

1749 
ev
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
, 0, 
SCTP_RESTART
, 0,

1750 
Ãw_asoc
->
c
.
sš™_num_o¡»ams
,

1751 
Ãw_asoc
->
c
.
sš™_max_š¡»ams
,

1752 
NULL
, 
GFP_ATOMIC
);

1753 ià(!
ev
)

1754 
nomem_ev
;

1757 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_UPDATE_ASSOC
, 
	`SCTP_ASOC
(
Ãw_asoc
));

1758 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

1759 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
, 
	`SCTP_ULPEVENT
(
ev
));

1760  
SCTP_DISPOSITION_CONSUME
;

1762 
nomem_ev
:

1763 
	`sùp_chunk_ä“
(
»¶
);

1764 
nomem
:

1765  
SCTP_DISPOSITION_NOMEM
;

1766 
	}
}

1776 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_dupcook_b
(cÚ¡ 
sùp_’dpošt
 *
•
,

1777 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1778 
sùp_chunk
 *
chunk
,

1779 
sùp_cmd_£q_t
 *
commªds
,

1780 
sùp_assocŸtiÚ
 *
Ãw_asoc
)

1782 
sùp_š™_chunk_t
 *
³”_š™
;

1783 
sùp_chunk
 *
»¶
;

1788 
³”_š™
 = &
chunk
->
subh
.
cook›_hdr
->
c
.peer_init[0];

1789 ià(!
	`sùp_´oûss_š™
(
Ãw_asoc
, 
chunk
, 
	`sùp_sourû
(chunk), 
³”_š™
,

1790 
GFP_ATOMIC
))

1791 
nomem
;

1794 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_UPDATE_ASSOC
, 
	`SCTP_ASOC
(
Ãw_asoc
));

1795 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

1796 
	`SCTP_STATE
(
SCTP_STATE_ESTABLISHED
));

1797 
	`SCTP_INC_STATS
(
SCTP_MIB_CURRESTAB
);

1798 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_HB_TIMERS_START
, 
	`SCTP_NULL
());

1800 
»¶
 = 
	`sùp_make_cook›_ack
(
Ãw_asoc
, 
chunk
);

1801 ià(!
»¶
)

1802 
nomem
;

1804 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

1818 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_CHANGE
, 
	`SCTP_U8
(
SCTP_COMM_UP
));

1828 ià(
asoc
->
³”
.
ad­tiÚ_šd
)

1829 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ADAPTATION_IND
, 
	`SCTP_NULL
());

1831  
SCTP_DISPOSITION_CONSUME
;

1833 
nomem
:

1834  
SCTP_DISPOSITION_NOMEM
;

1835 
	}
}

1846 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_dupcook_c
(cÚ¡ 
sùp_’dpošt
 *
•
,

1847 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1848 
sùp_chunk
 *
chunk
,

1849 
sùp_cmd_£q_t
 *
commªds
,

1850 
sùp_assocŸtiÚ
 *
Ãw_asoc
)

1856  
SCTP_DISPOSITION_DISCARD
;

1857 
	}
}

1867 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_dupcook_d
(cÚ¡ 
sùp_’dpošt
 *
•
,

1868 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1869 
sùp_chunk
 *
chunk
,

1870 
sùp_cmd_£q_t
 *
commªds
,

1871 
sùp_assocŸtiÚ
 *
Ãw_asoc
)

1873 
sùp_uÍev’t
 *
ev
 = 
NULL
, *
ai_ev
 = NULL;

1874 
sùp_chunk
 *
»¶
;

1884 ià(
asoc
->
¡©e
 < 
SCTP_STATE_ESTABLISHED
) {

1885 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

1886 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_COOKIE
));

1887 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

1888 
	`SCTP_STATE
(
SCTP_STATE_ESTABLISHED
));

1889 
	`SCTP_INC_STATS
(
SCTP_MIB_CURRESTAB
);

1890 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_HB_TIMERS_START
,

1891 
	`SCTP_NULL
());

1900 
ev
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
, 0,

1901 
SCTP_COMM_UP
, 0,

1902 
asoc
->
c
.
sš™_num_o¡»ams
,

1903 
asoc
->
c
.
sš™_max_š¡»ams
,

1904 
NULL
, 
GFP_ATOMIC
);

1905 ià(!
ev
)

1906 
nomem
;

1913 ià(
asoc
->
³”
.
ad­tiÚ_šd
) {

1914 
ai_ev
 = 
	`sùp_uÍev’t_make_ad­tiÚ_šdiÿtiÚ
(
asoc
,

1915 
GFP_ATOMIC
);

1916 ià(!
ai_ev
)

1917 
nomem
;

1922 
»¶
 = 
	`sùp_make_cook›_ack
(
Ãw_asoc
, 
chunk
);

1923 ià(!
»¶
)

1924 
nomem
;

1926 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

1928 ià(
ev
)

1929 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
,

1930 
	`SCTP_ULPEVENT
(
ev
));

1931 ià(
ai_ev
)

1932 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
,

1933 
	`SCTP_ULPEVENT
(
ai_ev
));

1935  
SCTP_DISPOSITION_CONSUME
;

1937 
nomem
:

1938 ià(
ai_ev
)

1939 
	`sùp_uÍev’t_ä“
(
ai_ev
);

1940 ià(
ev
)

1941 
	`sùp_uÍev’t_ä“
(
ev
);

1942  
SCTP_DISPOSITION_NOMEM
;

1943 
	}
}

1961 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_2_4_dupcook
(cÚ¡ 
sùp_’dpošt
 *
•
,

1962 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

1963 cÚ¡ 
sùp_subty³_t
 
ty³
,

1964 *
¬g
,

1965 
sùp_cmd_£q_t
 *
commªds
)

1967 
sùp_di¥os™iÚ_t
 
»tv®
;

1968 
sùp_chunk
 *
chunk
 = 
¬g
;

1969 
sùp_assocŸtiÚ
 *
Ãw_asoc
;

1970 
”rÜ
 = 0;

1971 
aùiÚ
;

1972 
sùp_chunk
 *
”r_chk_p
;

1979 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

1980  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

1981 
commªds
);

1986 
chunk
->
subh
.
cook›_hdr
 = (
sùp_sigÃd_cook›
 *)chunk->
skb
->
d©a
;

1987 ià(!
	`pskb_puÎ
(
chunk
->
skb
, 
	`Áohs
(chunk->
chunk_hdr
->
Ëngth
) -

1988 (
sùp_chunkhdr_t
)))

1989 
nomem
;

1996 
Ãw_asoc
 = 
	`sùp_uÅack_cook›
(
•
, 
asoc
, 
chunk
, 
GFP_ATOMIC
, &
”rÜ
,

1997 &
”r_chk_p
);

2005 ià(!
Ãw_asoc
) {

2009 
”rÜ
) {

2010 -
SCTP_IERROR_NOMEM
:

2011 
nomem
;

2013 -
SCTP_IERROR_STALE_COOKIE
:

2014 
	`sùp_£nd_¡®e_cook›_”r
(
•
, 
asoc
, 
chunk
, 
commªds
,

2015 
”r_chk_p
);

2016  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2017 -
SCTP_IERROR_BAD_SIG
:

2019  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2026 
aùiÚ
 = 
	`sùp_t›gs_com·»
(
Ãw_asoc
, 
asoc
);

2028 
aùiÚ
) {

2030 
»tv®
 = 
	`sùp_sf_do_dupcook_a
(
•
, 
asoc
, 
chunk
, 
commªds
,

2031 
Ãw_asoc
);

2035 
»tv®
 = 
	`sùp_sf_do_dupcook_b
(
•
, 
asoc
, 
chunk
, 
commªds
,

2036 
Ãw_asoc
);

2040 
»tv®
 = 
	`sùp_sf_do_dupcook_c
(
•
, 
asoc
, 
chunk
, 
commªds
,

2041 
Ãw_asoc
);

2045 
»tv®
 = 
	`sùp_sf_do_dupcook_d
(
•
, 
asoc
, 
chunk
, 
commªds
,

2046 
Ãw_asoc
);

2050 
»tv®
 = 
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2055 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_ASOC
, 
	`SCTP_ASOC
(
Ãw_asoc
));

2056 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DELETE_TCB
, 
	`SCTP_NULL
());

2061 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_ASOC
,

2062 
	`SCTP_ASOC
((
sùp_assocŸtiÚ
 *)
asoc
));

2064  
»tv®
;

2066 
nomem
:

2067  
SCTP_DISPOSITION_NOMEM
;

2068 
	}
}

2075 
sùp_di¥os™iÚ_t
 
	$sùp_sf_shutdown_³ndšg_abÜt
(

2076 cÚ¡ 
sùp_’dpošt
 *
•
,

2077 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2078 cÚ¡ 
sùp_subty³_t
 
ty³
,

2079 *
¬g
,

2080 
sùp_cmd_£q_t
 *
commªds
)

2082 
sùp_chunk
 *
chunk
 = 
¬g
;

2084 ià(!
	`sùp_vg_v”ify_e™h”
(
chunk
, 
asoc
))

2085  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2097 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_abÜt_chunk_t
)))

2098  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2105 ià(
SCTP_ADDR_DEL
 ==

2106 
	`sùp_bšd_addr_¡©e
(&
asoc
->
ba£
.
bšd_addr
, &
chunk
->
de¡
))

2107  
	`sùp_sf_disÿrd_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2109  
	`__sùp_sf_do_9_1_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2110 
	}
}

2117 
sùp_di¥os™iÚ_t
 
	$sùp_sf_shutdown_£Á_abÜt
(cÚ¡ 
sùp_’dpošt
 *
•
,

2118 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2119 cÚ¡ 
sùp_subty³_t
 
ty³
,

2120 *
¬g
,

2121 
sùp_cmd_£q_t
 *
commªds
)

2123 
sùp_chunk
 *
chunk
 = 
¬g
;

2125 ià(!
	`sùp_vg_v”ify_e™h”
(
chunk
, 
asoc
))

2126  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2138 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_abÜt_chunk_t
)))

2139  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2146 ià(
SCTP_ADDR_DEL
 ==

2147 
	`sùp_bšd_addr_¡©e
(&
asoc
->
ba£
.
bšd_addr
, &
chunk
->
de¡
))

2148  
	`sùp_sf_disÿrd_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2151 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

2152 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

2155 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

2156 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
));

2158  
	`__sùp_sf_do_9_1_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2159 
	}
}

2166 
sùp_di¥os™iÚ_t
 
	$sùp_sf_shutdown_ack_£Á_abÜt
(

2167 cÚ¡ 
sùp_’dpošt
 *
•
,

2168 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2169 cÚ¡ 
sùp_subty³_t
 
ty³
,

2170 *
¬g
,

2171 
sùp_cmd_£q_t
 *
commªds
)

2176  
	`sùp_sf_shutdown_£Á_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2177 
	}
}

2193 
sùp_di¥os™iÚ_t
 
	$sùp_sf_cook›_echÛd_”r
(cÚ¡ 
sùp_’dpošt
 *
•
,

2194 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2195 cÚ¡ 
sùp_subty³_t
 
ty³
,

2196 *
¬g
,

2197 
sùp_cmd_£q_t
 *
commªds
)

2199 
sùp_chunk
 *
chunk
 = 
¬g
;

2200 
sùp_”rhdr_t
 *
”r
;

2202 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

2203  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2208 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_İ”r_chunk_t
)))

2209  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

2210 
commªds
);

2217 
	`sùp_w®k_”rÜs
(
”r
, 
chunk
->
chunk_hdr
) {

2218 ià(
SCTP_ERROR_STALE_COOKIE
 =ğ
”r
->
ÿu£
)

2219  
	`sùp_sf_do_5_2_6_¡®e
(
•
, 
asoc
, 
ty³
,

2220 
¬g
, 
commªds
);

2228  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2229 
	}
}

2256 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_5_2_6_¡®e
(cÚ¡ 
sùp_’dpošt
 *
•
,

2257 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2258 cÚ¡ 
sùp_subty³_t
 
ty³
,

2259 *
¬g
,

2260 
sùp_cmd_£q_t
 *
commªds
)

2262 
sùp_chunk
 *
chunk
 = 
¬g
;

2263 
time_t
 
¡®e
;

2264 
sùp_cook›_´e£rve_·¿m_t
 
bht
;

2265 
sùp_”rhdr_t
 *
”r
;

2266 
sùp_chunk
 *
»¶y
;

2267 
sùp_bšd_addr
 *
bp
;

2268 
©‹m±s
 = 
asoc
->
š™_”r_couÁ”
 + 1;

2270 ià(
©‹m±s
 > 
asoc
->
max_š™_©‹m±s
) {

2271 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

2272 
	`SCTP_ERROR
(
ETIMEDOUT
));

2273 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_FAILED
,

2274 
	`SCTP_PERR
(
SCTP_ERROR_STALE_COOKIE
));

2275  
SCTP_DISPOSITION_DELETE_TCB
;

2278 
”r
 = (
sùp_”rhdr_t
 *)(
chunk
->
skb
->
d©a
);

2294 
¡®e
 = 
	`Áohl
(*(
__be32
 *)((
u8
 *)
”r
 + (
sùp_”rhdr_t
)));

2295 
¡®e
 = (stale * 2) / 1000;

2297 
bht
.
·¿m_hdr
.
ty³
 = 
SCTP_PARAM_COOKIE_PRESERVATIVE
;

2298 
bht
.
·¿m_hdr
.
Ëngth
 = 
	`htÚs
((bht));

2299 
bht
.
liã¥ª_šüem’t
 = 
	`htÚl
(
¡®e
);

2302 
bp
 = (
sùp_bšd_addr
 *è&
asoc
->
ba£
.
bšd_addr
;

2303 
»¶y
 = 
	`sùp_make_š™
(
asoc
, 
bp
, 
GFP_ATOMIC
, (
bht
));

2304 ià(!
»¶y
)

2305 
nomem
;

2307 
	`sùp_addto_chunk
(
»¶y
, (
bht
), &bht);

2310 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_CLEAR_INIT_TAG
, 
	`SCTP_NULL
());

2313 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_T3_RTX_TIMERS_STOP
, 
	`SCTP_NULL
());

2314 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_HB_TIMERS_STOP
, 
	`SCTP_NULL
());

2319 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DEL_NON_PRIMARY
, 
	`SCTP_NULL
());

2324 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_T1_RETRAN
,

2325 
	`SCTP_TRANSPORT
(
asoc
->
³”
.
´im¬y_·th
));

2330 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_COUNTER_INC
, 
	`SCTP_NULL
());

2332 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

2333 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_COOKIE
));

2334 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

2335 
	`SCTP_STATE
(
SCTP_STATE_COOKIE_WAIT
));

2336 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_START
,

2337 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

2339 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

2341  
SCTP_DISPOSITION_CONSUME
;

2343 
nomem
:

2344  
SCTP_DISPOSITION_NOMEM
;

2345 
	}
}

2378 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_1_abÜt
(cÚ¡ 
sùp_’dpošt
 *
•
,

2379 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2380 cÚ¡ 
sùp_subty³_t
 
ty³
,

2381 *
¬g
,

2382 
sùp_cmd_£q_t
 *
commªds
)

2384 
sùp_chunk
 *
chunk
 = 
¬g
;

2386 ià(!
	`sùp_vg_v”ify_e™h”
(
chunk
, 
asoc
))

2387  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2399 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_abÜt_chunk_t
)))

2400  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2407 ià(
SCTP_ADDR_DEL
 ==

2408 
	`sùp_bšd_addr_¡©e
(&
asoc
->
ba£
.
bšd_addr
, &
chunk
->
de¡
))

2409  
	`sùp_sf_disÿrd_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2411  
	`__sùp_sf_do_9_1_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2412 
	}
}

2414 
sùp_di¥os™iÚ_t
 
	$__sùp_sf_do_9_1_abÜt
(cÚ¡ 
sùp_’dpošt
 *
•
,

2415 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2416 cÚ¡ 
sùp_subty³_t
 
ty³
,

2417 *
¬g
,

2418 
sùp_cmd_£q_t
 *
commªds
)

2420 
sùp_chunk
 *
chunk
 = 
¬g
;

2421 
Ën
;

2422 
__be16
 
”rÜ
 = 
SCTP_ERROR_NO_ERROR
;

2425 
Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

2426 ià(
Ën
 >ğ(
sùp_chunkhdr
è+ (
sùp_”rhdr
)) {

2428 
sùp_”rhdr_t
 *
”r
;

2429 
	`sùp_w®k_”rÜs
(
”r
, 
chunk
->
chunk_hdr
);

2430 ià((*)
”r
 !ğ(*)
chunk
->
chunk_’d
)

2431  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2433 
”rÜ
 = ((
sùp_”rhdr_t
 *)
chunk
->
skb
->
d©a
)->
ÿu£
;

2436 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
, 
	`SCTP_ERROR
(
ECONNRESET
));

2438 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
, 
	`SCTP_PERR
(
”rÜ
));

2439 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

2440 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

2442  
SCTP_DISPOSITION_ABORT
;

2443 
	}
}

2450 
sùp_di¥os™iÚ_t
 
	$sùp_sf_cook›_wa™_abÜt
(cÚ¡ 
sùp_’dpošt
 *
•
,

2451 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2452 cÚ¡ 
sùp_subty³_t
 
ty³
,

2453 *
¬g
,

2454 
sùp_cmd_£q_t
 *
commªds
)

2456 
sùp_chunk
 *
chunk
 = 
¬g
;

2457 
Ën
;

2458 
__be16
 
”rÜ
 = 
SCTP_ERROR_NO_ERROR
;

2460 ià(!
	`sùp_vg_v”ify_e™h”
(
chunk
, 
asoc
))

2461  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2473 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_abÜt_chunk_t
)))

2474  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2477 
Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

2478 ià(
Ën
 >ğ(
sùp_chunkhdr
è+ (
sùp_”rhdr
))

2479 
”rÜ
 = ((
sùp_”rhdr_t
 *)
chunk
->
skb
->
d©a
)->
ÿu£
;

2481  
	`sùp_¡İ_t1_ªd_abÜt
(
commªds
, 
”rÜ
, 
ECONNREFUSED
, 
asoc
,

2482 
chunk
->
Œª¥Üt
);

2483 
	}
}

2488 
sùp_di¥os™iÚ_t
 
	$sùp_sf_cook›_wa™_icmp_abÜt
(cÚ¡ 
sùp_’dpošt
 *
•
,

2489 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2490 cÚ¡ 
sùp_subty³_t
 
ty³
,

2491 *
¬g
,

2492 
sùp_cmd_£q_t
 *
commªds
)

2494  
	`sùp_¡İ_t1_ªd_abÜt
(
commªds
, 
SCTP_ERROR_NO_ERROR
,

2495 
ENOPROTOOPT
, 
asoc
,

2496 (
sùp_Œª¥Üt
 *)
¬g
);

2497 
	}
}

2502 
sùp_di¥os™iÚ_t
 
	$sùp_sf_cook›_echÛd_abÜt
(cÚ¡ 
sùp_’dpošt
 *
•
,

2503 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2504 cÚ¡ 
sùp_subty³_t
 
ty³
,

2505 *
¬g
,

2506 
sùp_cmd_£q_t
 *
commªds
)

2511  
	`sùp_sf_cook›_wa™_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2512 
	}
}

2519 
sùp_di¥os™iÚ_t
 
	$sùp_¡İ_t1_ªd_abÜt
(
sùp_cmd_£q_t
 *
commªds
,

2520 
__be16
 
”rÜ
, 
sk_”r
,

2521 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2522 
sùp_Œª¥Üt
 *
Œª¥Üt
)

2524 
	`SCTP_DEBUG_PRINTK
("ABORT„eceived (INIT).\n");

2525 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

2526 
	`SCTP_STATE
(
SCTP_STATE_CLOSED
));

2527 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

2528 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

2529 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

2530 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
, 
	`SCTP_ERROR
(
sk_”r
));

2532 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_FAILED
,

2533 
	`SCTP_PERR
(
”rÜ
));

2534  
SCTP_DISPOSITION_ABORT
;

2535 
	}
}

2570 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_2_shutdown
(cÚ¡ 
sùp_’dpošt
 *
•
,

2571 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2572 cÚ¡ 
sùp_subty³_t
 
ty³
,

2573 *
¬g
,

2574 
sùp_cmd_£q_t
 *
commªds
)

2576 
sùp_chunk
 *
chunk
 = 
¬g
;

2577 
sùp_shutdownhdr_t
 *
sdh
;

2578 
sùp_di¥os™iÚ_t
 
di¥os™iÚ
;

2579 
sùp_uÍev’t
 *
ev
;

2580 
__u32
 
ù¢
;

2582 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

2583  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2586 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
,

2587 (
sùp_shutdown_chunk_t
)))

2588  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

2589 
commªds
);

2592 
sdh
 = (
sùp_shutdownhdr_t
 *)
chunk
->
skb
->
d©a
;

2593 
	`skb_puÎ
(
chunk
->
skb
, (
sùp_shutdownhdr_t
));

2594 
chunk
->
subh
.
shutdown_hdr
 = 
sdh
;

2595 
ù¢
 = 
	`Áohl
(
sdh
->
cum_t¢_ack
);

2597 ià(
	`TSN_É
(
ù¢
, 
asoc
->
ù¢_ack_pošt
)) {

2598 
	`SCTP_DEBUG_PRINTK
("ù¢ %x\n", 
ù¢
);

2599 
	`SCTP_DEBUG_PRINTK
("ù¢_ack_pošˆ%x\n", 
asoc
->
ù¢_ack_pošt
);

2600  
SCTP_DISPOSITION_DISCARD
;

2607 ià(!
	`TSN_É
(
ù¢
, 
asoc
->
Ãxt_t¢
))

2608  
	`sùp_sf_viŞ©iÚ_ù¢
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2614 
ev
 = 
	`sùp_uÍev’t_make_shutdown_ev’t
(
asoc
, 0, 
GFP_ATOMIC
);

2615 ià(!
ev
) {

2616 
di¥os™iÚ
 = 
SCTP_DISPOSITION_NOMEM
;

2617 
out
;

2619 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
, 
	`SCTP_ULPEVENT
(
ev
));

2627 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

2628 
	`SCTP_STATE
(
SCTP_STATE_SHUTDOWN_RECEIVED
));

2629 
di¥os™iÚ
 = 
SCTP_DISPOSITION_CONSUME
;

2631 ià(
	`sùp_outq_is_em±y
(&
asoc
->
outqueue
)) {

2632 
di¥os™iÚ
 = 
	`sùp_sf_do_9_2_shutdown_ack
(
•
, 
asoc
, 
ty³
,

2633 
¬g
, 
commªds
);

2636 ià(
SCTP_DISPOSITION_NOMEM
 =ğ
di¥os™iÚ
)

2637 
out
;

2643 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PROCESS_CTSN
,

2644 
	`SCTP_BE32
(
chunk
->
subh
.
shutdown_hdr
->
cum_t¢_ack
));

2646 
out
:

2647  
di¥os™iÚ
;

2648 
	}
}

2658 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_2_shut_ù¢
(cÚ¡ 
sùp_’dpošt
 *
•
,

2659 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2660 cÚ¡ 
sùp_subty³_t
 
ty³
,

2661 *
¬g
,

2662 
sùp_cmd_£q_t
 *
commªds
)

2664 
sùp_chunk
 *
chunk
 = 
¬g
;

2665 
sùp_shutdownhdr_t
 *
sdh
;

2666 
__u32
 
ù¢
;

2668 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

2669  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2672 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
,

2673 (
sùp_shutdown_chunk_t
)))

2674  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

2675 
commªds
);

2677 
sdh
 = (
sùp_shutdownhdr_t
 *)
chunk
->
skb
->
d©a
;

2678 
ù¢
 = 
	`Áohl
(
sdh
->
cum_t¢_ack
);

2680 ià(
	`TSN_É
(
ù¢
, 
asoc
->
ù¢_ack_pošt
)) {

2681 
	`SCTP_DEBUG_PRINTK
("ù¢ %x\n", 
ù¢
);

2682 
	`SCTP_DEBUG_PRINTK
("ù¢_ack_pošˆ%x\n", 
asoc
->
ù¢_ack_pošt
);

2683  
SCTP_DISPOSITION_DISCARD
;

2690 ià(!
	`TSN_É
(
ù¢
, 
asoc
->
Ãxt_t¢
))

2691  
	`sùp_sf_viŞ©iÚ_ù¢
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2697 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PROCESS_CTSN
,

2698 
	`SCTP_BE32
(
sdh
->
cum_t¢_ack
));

2700  
SCTP_DISPOSITION_CONSUME
;

2701 
	}
}

2710 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_2_»shuck
(cÚ¡ 
sùp_’dpošt
 *
•
,

2711 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2712 cÚ¡ 
sùp_subty³_t
 
ty³
,

2713 *
¬g
,

2714 
sùp_cmd_£q_t
 *
commªds
)

2716 
sùp_chunk
 *
chunk
 = (sùp_chunk *è
¬g
;

2717 
sùp_chunk
 *
»¶y
;

2720 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

2721  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

2722 
commªds
);

2728 
»¶y
 = 
	`sùp_make_shutdown_ack
(
asoc
, 
chunk
);

2729 ià(
NULL
 =ğ
»¶y
)

2730 
nomem
;

2735 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SETUP_T2
, 
	`SCTP_CHUNK
(
»¶y
));

2738 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

2739 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

2741 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

2743  
SCTP_DISPOSITION_CONSUME
;

2744 
nomem
:

2745  
SCTP_DISPOSITION_NOMEM
;

2746 
	}
}

2773 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_eú_cwr
(cÚ¡ 
sùp_’dpošt
 *
•
,

2774 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2775 cÚ¡ 
sùp_subty³_t
 
ty³
,

2776 *
¬g
,

2777 
sùp_cmd_£q_t
 *
commªds
)

2779 
sùp_cwrhdr_t
 *
cwr
;

2780 
sùp_chunk
 *
chunk
 = 
¬g
;

2781 
u32
 
lowe¡_t¢
;

2783 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

2784  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2786 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_eúe_chunk_t
)))

2787  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

2788 
commªds
);

2790 
cwr
 = (
sùp_cwrhdr_t
 *è
chunk
->
skb
->
d©a
;

2791 
	`skb_puÎ
(
chunk
->
skb
, (
sùp_cwrhdr_t
));

2793 
lowe¡_t¢
 = 
	`Áohl
(
cwr
->lowest_tsn);

2796 ià(
	`TSN_Ée
(
asoc
->
Ï¡_eúe_t¢
, 
lowe¡_t¢
)) {

2798 
	`sùp_add_cmd_sf
(
commªds
,

2799 
SCTP_CMD_ECN_CWR
,

2800 
	`SCTP_U32
(
lowe¡_t¢
));

2802  
SCTP_DISPOSITION_CONSUME
;

2803 
	}
}

2828 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_eúe
(cÚ¡ 
sùp_’dpošt
 *
•
,

2829 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2830 cÚ¡ 
sùp_subty³_t
 
ty³
,

2831 *
¬g
,

2832 
sùp_cmd_£q_t
 *
commªds
)

2834 
sùp_eúehdr_t
 *
eúe
;

2835 
sùp_chunk
 *
chunk
 = 
¬g
;

2837 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

2838  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2840 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_eúe_chunk_t
)))

2841  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

2842 
commªds
);

2844 
eúe
 = (
sùp_eúehdr_t
 *è
chunk
->
skb
->
d©a
;

2845 
	`skb_puÎ
(
chunk
->
skb
, (
sùp_eúehdr_t
));

2848 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ECN_ECNE
,

2849 
	`SCTP_U32
(
	`Áohl
(
eúe
->
lowe¡_t¢
)));

2851  
SCTP_DISPOSITION_CONSUME
;

2852 
	}
}

2884 
sùp_di¥os™iÚ_t
 
	$sùp_sf_—t_d©a_6_2
(cÚ¡ 
sùp_’dpošt
 *
•
,

2885 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2886 cÚ¡ 
sùp_subty³_t
 
ty³
,

2887 *
¬g
,

2888 
sùp_cmd_£q_t
 *
commªds
)

2890 
sùp_chunk
 *
chunk
 = 
¬g
;

2891 
”rÜ
;

2893 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
)) {

2894 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_BAD_TAG
,

2895 
	`SCTP_NULL
());

2896  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

2899 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_d©a_chunk_t
)))

2900  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

2901 
commªds
);

2903 
”rÜ
 = 
	`sùp_—t_d©a
(
asoc
, 
chunk
, 
commªds
 );

2904 
”rÜ
) {

2905 
SCTP_IERROR_NO_ERROR
:

2907 
SCTP_IERROR_HIGH_TSN
:

2908 
SCTP_IERROR_BAD_STREAM
:

2909 
	`SCTP_INC_STATS
(
SCTP_MIB_IN_DATA_CHUNK_DISCARDS
);

2910 
disÿrd_nofÜû
;

2911 
SCTP_IERROR_DUP_TSN
:

2912 
SCTP_IERROR_IGNORE_TSN
:

2913 
	`SCTP_INC_STATS
(
SCTP_MIB_IN_DATA_CHUNK_DISCARDS
);

2914 
disÿrd_fÜû
;

2915 
SCTP_IERROR_NO_DATA
:

2916 
cÚsume
;

2917 
SCTP_IERROR_PROTO_VIOLATION
:

2918  
	`sùp_sf_abÜt_viŞ©iÚ
(
•
, 
asoc
, 
chunk
, 
commªds
,

2919 (
u8
 *)
chunk
->
subh
.
d©a_hdr
, (
sùp_d©ahdr_t
));

2921 
	`BUG
();

2924 ià(
asoc
->
autoşo£
) {

2925 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

2926 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_AUTOCLOSE
));

2951 ià(
chunk
->
’d_of_·ck‘
)

2952 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SACK
, 
	`SCTP_NOFORCE
());

2954  
SCTP_DISPOSITION_CONSUME
;

2956 
disÿrd_fÜû
:

2971 ià(
chunk
->
’d_of_·ck‘
)

2972 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SACK
, 
	`SCTP_FORCE
());

2973  
SCTP_DISPOSITION_DISCARD
;

2975 
disÿrd_nofÜû
:

2976 ià(
chunk
->
’d_of_·ck‘
)

2977 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SACK
, 
	`SCTP_NOFORCE
());

2979  
SCTP_DISPOSITION_DISCARD
;

2980 
cÚsume
:

2981  
SCTP_DISPOSITION_CONSUME
;

2983 
	}
}

3001 
sùp_di¥os™iÚ_t
 
	$sùp_sf_—t_d©a_ç¡_4_4
(cÚ¡ 
sùp_’dpošt
 *
•
,

3002 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3003 cÚ¡ 
sùp_subty³_t
 
ty³
,

3004 *
¬g
,

3005 
sùp_cmd_£q_t
 *
commªds
)

3007 
sùp_chunk
 *
chunk
 = 
¬g
;

3008 
”rÜ
;

3010 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
)) {

3011 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_BAD_TAG
,

3012 
	`SCTP_NULL
());

3013  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3016 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_d©a_chunk_t
)))

3017  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3018 
commªds
);

3020 
”rÜ
 = 
	`sùp_—t_d©a
(
asoc
, 
chunk
, 
commªds
 );

3021 
”rÜ
) {

3022 
SCTP_IERROR_NO_ERROR
:

3023 
SCTP_IERROR_HIGH_TSN
:

3024 
SCTP_IERROR_DUP_TSN
:

3025 
SCTP_IERROR_IGNORE_TSN
:

3026 
SCTP_IERROR_BAD_STREAM
:

3028 
SCTP_IERROR_NO_DATA
:

3029 
cÚsume
;

3030 
SCTP_IERROR_PROTO_VIOLATION
:

3031  
	`sùp_sf_abÜt_viŞ©iÚ
(
•
, 
asoc
, 
chunk
, 
commªds
,

3032 (
u8
 *)
chunk
->
subh
.
d©a_hdr
, (
sùp_d©ahdr_t
));

3034 
	`BUG
();

3045 ià(
chunk
->
’d_of_·ck‘
) {

3049 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SHUTDOWN
, 
	`SCTP_NULL
());

3050 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SACK
, 
	`SCTP_FORCE
());

3051 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

3052 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

3055 
cÚsume
:

3056  
SCTP_DISPOSITION_CONSUME
;

3057 
	}
}

3091 
sùp_di¥os™iÚ_t
 
	$sùp_sf_—t_§ck_6_2
(cÚ¡ 
sùp_’dpošt
 *
•
,

3092 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3093 cÚ¡ 
sùp_subty³_t
 
ty³
,

3094 *
¬g
,

3095 
sùp_cmd_£q_t
 *
commªds
)

3097 
sùp_chunk
 *
chunk
 = 
¬g
;

3098 
sùp_assocŸtiÚ
 *
shadow
 = (sùp_assocŸtiÚ *)
asoc
;

3099 
sùp_§ckhdr_t
 *
§ckh
;

3100 
__u32
 
ù¢
;

3103 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

3104  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3107 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_§ck_chunk_t
)))

3108  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3109 
commªds
);

3112 
§ckh
 = 
	`sùp_sm_puÎ_§ck
(
chunk
);

3114 ià(!
§ckh
)

3115  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3116 
chunk
->
subh
.
§ck_hdr
 = 
§ckh
;

3117 
ù¢
 = 
	`Áohl
(
§ckh
->
cum_t¢_ack
);

3125 ià(
	`TSN_É
(
ù¢
, 
asoc
->
ù¢_ack_pošt
))

3127 
	`SCTP_DEBUG_PRINTK
("ù¢ %x\n", 
ù¢
);

3128 
	`SCTP_DEBUG_PRINTK
("ù¢_ack_pošˆ%x\n", 
asoc
->
ù¢_ack_pošt
);

3129  
SCTP_DISPOSITION_DISCARD
;

3133 if(
shadow
->
bkup_§ck
)

3135 if(
ù¢
 !ğ
shadow
->
ù¢_ack_pošt
)

3138 
s¢
 = (
ù¢
 - 
shadow
->
Ãxt_t¢
)+1;

3141 
	`´štk
("SCTP HO: Adjusting SACKsn„x %d‚xt %d cap %d delta %d\n",

3142 
ù¢
, 
shadow
->
Ãxt_t¢
, shadow->
ù¢_ack_pošt
, 
s¢
);

3143 if(
s¢
 > -1)

3145 if(
shadow
->
s¢m­
->
out
.
s¢
[1])

3147 
shadow
->
s¢m­
->
out
.
s¢
[1] += ssn;

3151 
shadow
->
s¢m­
->
out
.
s¢
[0] += ssn;

3158 
shadow
->
ù¢_ack_pošt
 = 
ù¢
;

3159 
shadow
->
Ãxt_t¢
 = 
ù¢
+1;

3161 
shadow
->
bkup_§ck
 = 0;

3168 ià(!
	`TSN_É
(
ù¢
, 
asoc
->
Ãxt_t¢
))

3169  
	`sùp_sf_viŞ©iÚ_ù¢
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3172 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PROCESS_SACK
, 
	`SCTP_SACKH
(
§ckh
));

3177  
SCTP_DISPOSITION_CONSUME
;

3178 
	}
}

3198 
sùp_di¥os™iÚ_t
 
	$sùp_sf_bÜt_8_4_8
(cÚ¡ 
sùp_’dpošt
 *
•
,

3199 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3200 cÚ¡ 
sùp_subty³_t
 
ty³
,

3201 *
¬g
,

3202 
sùp_cmd_£q_t
 *
commªds
)

3204 
sùp_·ck‘
 *
·ck‘
 = 
NULL
;

3205 
sùp_chunk
 *
chunk
 = 
¬g
;

3206 
sùp_chunk
 *
abÜt
;

3208 
·ck‘
 = 
	`sùp_oÙb_pkt_Ãw
(
asoc
, 
chunk
);

3210 ià(
·ck‘
) {

3214 
abÜt
 = 
	`sùp_make_abÜt
(
asoc
, 
chunk
, 0);

3215 ià(!
abÜt
) {

3216 
	`sùp_oÙb_pkt_ä“
(
·ck‘
);

3217  
SCTP_DISPOSITION_NOMEM
;

3221 ià(
	`sùp_‹¡_T_b™
(
abÜt
))

3222 
·ck‘
->
vg
 = 
	`Áohl
(
chunk
->
sùp_hdr
->vtag);

3225 
abÜt
->
skb
->
sk
 = 
•
->
ba£
.sk;

3227 
	`sùp_·ck‘_­³nd_chunk
(
·ck‘
, 
abÜt
);

3229 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_PKT
,

3230 
	`SCTP_PACKET
(
·ck‘
));

3232 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

3234 
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3235  
SCTP_DISPOSITION_CONSUME
;

3238  
SCTP_DISPOSITION_NOMEM
;

3239 
	}
}

3249 
sùp_di¥os™iÚ_t
 
	$sùp_sf_İ”r_nÙify
(cÚ¡ 
sùp_’dpošt
 *
•
,

3250 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3251 cÚ¡ 
sùp_subty³_t
 
ty³
,

3252 *
¬g
,

3253 
sùp_cmd_£q_t
 *
commªds
)

3255 
sùp_chunk
 *
chunk
 = 
¬g
;

3256 
sùp_”rhdr_t
 *
”r
;

3258 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

3259  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3262 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_İ”r_chunk_t
)))

3263  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3264 
commªds
);

3265 
	`sùp_w®k_”rÜs
(
”r
, 
chunk
->
chunk_hdr
);

3266 ià((*)
”r
 !ğ(*)
chunk
->
chunk_’d
)

3267  
	`sùp_sf_viŞ©iÚ_·¿mËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3268 (*)
”r
, 
commªds
);

3270 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PROCESS_OPERR
,

3271 
	`SCTP_CHUNK
(
chunk
));

3273  
SCTP_DISPOSITION_CONSUME
;

3274 
	}
}

3286 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_2_fš®
(cÚ¡ 
sùp_’dpošt
 *
•
,

3287 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3288 cÚ¡ 
sùp_subty³_t
 
ty³
,

3289 *
¬g
,

3290 
sùp_cmd_£q_t
 *
commªds
)

3292 
sùp_chunk
 *
chunk
 = 
¬g
;

3293 
sùp_chunk
 *
»¶y
;

3294 
sùp_uÍev’t
 *
ev
;

3296 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

3297  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3300 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

3301  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3302 
commªds
);

3308 
ev
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
asoc
, 0, 
SCTP_SHUTDOWN_COMP
,

3309 0, 0, 0, 
NULL
, 
GFP_ATOMIC
);

3310 ià(!
ev
)

3311 
nomem
;

3314 
»¶y
 = 
	`sùp_make_shutdown_com¶‘e
(
asoc
, 
chunk
);

3315 ià(!
»¶y
)

3316 
nomem_chunk
;

3321 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
, 
	`SCTP_ULPEVENT
(
ev
));

3326 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

3327 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

3329 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

3330 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
));

3332 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

3333 
	`SCTP_STATE
(
SCTP_STATE_CLOSED
));

3334 
	`SCTP_INC_STATS
(
SCTP_MIB_SHUTDOWNS
);

3335 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

3336 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

3339 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DELETE_TCB
, 
	`SCTP_NULL
());

3340  
SCTP_DISPOSITION_DELETE_TCB
;

3342 
nomem_chunk
:

3343 
	`sùp_uÍev’t_ä“
(
ev
);

3344 
nomem
:

3345  
SCTP_DISPOSITION_NOMEM
;

3346 
	}
}

3368 
sùp_di¥os™iÚ_t
 
	$sùp_sf_oÙb
(cÚ¡ 
sùp_’dpošt
 *
•
,

3369 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3370 cÚ¡ 
sùp_subty³_t
 
ty³
,

3371 *
¬g
,

3372 
sùp_cmd_£q_t
 *
commªds
)

3374 
sùp_chunk
 *
chunk
 = 
¬g
;

3375 
sk_buff
 *
skb
 = 
chunk
->skb;

3376 
sùp_chunkhdr_t
 *
ch
;

3377 
sùp_”rhdr_t
 *
”r
;

3378 
__u8
 *
ch_’d
;

3379 
oÙb_shut_ack
 = 0;

3380 
oÙb_cook›_ack
 = 0;

3382 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTOFBLUES
);

3384 
ch
 = (
sùp_chunkhdr_t
 *è
chunk
->
chunk_hdr
;

3387 ià(
	`Áohs
(
ch
->
Ëngth
è< (
sùp_chunkhdr_t
))

3388  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3389 
commªds
);

3394 ià(
SCTP_CID_SHUTDOWN_ACK
 =ğ
ch
->
ty³
)

3395 
oÙb_shut_ack
 = 1;

3402 ià(
SCTP_CID_ABORT
 =ğ
ch
->
ty³
)

3403  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3410 ià(
SCTP_CID_COOKIE_ACK
 =ğ
ch
->
ty³
)

3411 
oÙb_cook›_ack
 = 1;

3413 ià(
SCTP_CID_ERROR
 =ğ
ch
->
ty³
) {

3414 
	`sùp_w®k_”rÜs
(
”r
, 
ch
) {

3415 ià(
SCTP_ERROR_STALE_COOKIE
 =ğ
”r
->
ÿu£
) {

3416 
oÙb_cook›_ack
 = 1;

3423 
ch_’d
 = ((
__u8
 *)
ch
è+ 
	`WORD_ROUND
(
	`Áohs
(ch->
Ëngth
));

3424 ià(
ch_’d
 > 
	`skb__poš‹r
(
skb
))

3425  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3426 
commªds
);

3428 
ch
 = (
sùp_chunkhdr_t
 *è
ch_’d
;

3429 } 
ch_’d
 < 
	`skb__poš‹r
(
skb
));

3431 ià(
oÙb_shut_ack
)

3433  
	`sùp_sf_shut_8_4_5
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3435 ià(
oÙb_cook›_ack
)

3437  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3441  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3445 
	}
}

3468 
sùp_di¥os™iÚ_t
 
	$sùp_sf_shut_8_4_5
(cÚ¡ 
sùp_’dpošt
 *
•
,

3469 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3470 cÚ¡ 
sùp_subty³_t
 
ty³
,

3471 *
¬g
,

3472 
sùp_cmd_£q_t
 *
commªds
)

3474 
sùp_·ck‘
 *
·ck‘
 = 
NULL
;

3475 
sùp_chunk
 *
chunk
 = 
¬g
;

3476 
sùp_chunk
 *
shut
;

3478 
·ck‘
 = 
	`sùp_oÙb_pkt_Ãw
(
asoc
, 
chunk
);

3480 ià(
·ck‘
) {

3484 
shut
 = 
	`sùp_make_shutdown_com¶‘e
(
asoc
, 
chunk
);

3485 ià(!
shut
) {

3486 
	`sùp_oÙb_pkt_ä“
(
·ck‘
);

3487  
SCTP_DISPOSITION_NOMEM
;

3491 ià(
	`sùp_‹¡_T_b™
(
shut
))

3492 
·ck‘
->
vg
 = 
	`Áohl
(
chunk
->
sùp_hdr
->vtag);

3495 
shut
->
skb
->
sk
 = 
•
->
ba£
.sk;

3497 
	`sùp_·ck‘_­³nd_chunk
(
·ck‘
, 
shut
);

3499 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_PKT
,

3500 
	`SCTP_PACKET
(
·ck‘
));

3502 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

3507 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

3508  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3514  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3517  
SCTP_DISPOSITION_NOMEM
;

3518 
	}
}

3531 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_8_5_1_E_§
(cÚ¡ 
sùp_’dpošt
 *
•
,

3532 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3533 cÚ¡ 
sùp_subty³_t
 
ty³
,

3534 *
¬g
,

3535 
sùp_cmd_£q_t
 *
commªds
)

3537 
sùp_chunk
 *
chunk
 = 
¬g
;

3540 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

3541  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3542 
commªds
);

3549 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTOFBLUES
);

3551  
	`sùp_sf_shut_8_4_5
(
•
, 
NULL
, 
ty³
, 
¬g
, 
commªds
);

3552 
	}
}

3555 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_ascÚf
(cÚ¡ 
sùp_’dpošt
 *
•
,

3556 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3557 cÚ¡ 
sùp_subty³_t
 
ty³
, *
¬g
,

3558 
sùp_cmd_£q_t
 *
commªds
)

3560 
sùp_chunk
 *
chunk
 = 
¬g
;

3561 
sùp_chunk
 *
ascÚf_ack
 = 
NULL
;

3562 
sùp_·¿mhdr
 *
”r_·¿m
 = 
NULL
;

3563 
sùp_addhdr_t
 *
hdr
;

3564 
sùp_addr_·¿m
 *
addr_·¿m
;

3565 
__u32
 
£rŸl
;

3566 
Ëngth
;

3568 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
)) {

3569 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_BAD_TAG
,

3570 
	`SCTP_NULL
());

3571  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3580 ià(!
sùp_add_nßuth
 && !
chunk
->
auth
)

3581  
	`sùp_sf_disÿrd_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3584 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_add_chunk_t
)))

3585  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3586 
commªds
);

3588 
hdr
 = (
sùp_addhdr_t
 *)
chunk
->
skb
->
d©a
;

3589 
£rŸl
 = 
	`Áohl
(
hdr
->serial);

3591 
addr_·¿m
 = (
sùp_addr_·¿m
 *)
hdr
->
·¿ms
;

3592 
Ëngth
 = 
	`Áohs
(
addr_·¿m
->
p
.length);

3593 ià(
Ëngth
 < (
sùp_·¿mhdr_t
))

3594  
	`sùp_sf_viŞ©iÚ_·¿mËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3595 (*)
addr_·¿m
, 
commªds
);

3598 ià(!
	`sùp_v”ify_ascÚf
(
asoc
,

3599 (
sùp_·¿mhdr_t
 *)((*)
addr_·¿m
 + 
Ëngth
),

3600 (*)
chunk
->
chunk_’d
,

3601 &
”r_·¿m
))

3602  
	`sùp_sf_viŞ©iÚ_·¿mËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3603 (*)
”r_·¿m
, 
commªds
);

3609 ià(
£rŸl
 =ğ
asoc
->
³”
.
add_£rŸl
 + 1) {

3613 ià(!
chunk
->
has_ascÚf
)

3614 
	`sùp_assoc_ş—n_ascÚf_ack_ÿche
(
asoc
);

3624 
ascÚf_ack
 = 
	`sùp_´oûss_ascÚf
((
sùp_assocŸtiÚ
 *)

3625 
asoc
, 
chunk
);

3626 ià(!
ascÚf_ack
)

3627  
SCTP_DISPOSITION_NOMEM
;

3628 } ià(
£rŸl
 < 
asoc
->
³”
.
add_£rŸl
 + 1) {

3641 
ascÚf_ack
 = 
	`sùp_assoc_lookup_ascÚf_ack
(
asoc
, 
hdr
->
£rŸl
);

3642 ià(!
ascÚf_ack
)

3643  
SCTP_DISPOSITION_DISCARD
;

3649 
ascÚf_ack
->
Œª¥Üt
 = 
NULL
;

3654  
SCTP_DISPOSITION_DISCARD
;

3666 
ascÚf_ack
->
de¡
 = 
chunk
->
sourû
;

3667 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
ascÚf_ack
));

3669  
SCTP_DISPOSITION_CONSUME
;

3670 
	}
}

3677 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_ascÚf_ack
(cÚ¡ 
sùp_’dpošt
 *
•
,

3678 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3679 cÚ¡ 
sùp_subty³_t
 
ty³
, *
¬g
,

3680 
sùp_cmd_£q_t
 *
commªds
)

3682 
sùp_chunk
 *
ascÚf_ack
 = 
¬g
;

3683 
sùp_chunk
 *
Ï¡_ascÚf
 = 
asoc
->
add_Ï¡_ascÚf
;

3684 
sùp_chunk
 *
abÜt
;

3685 
sùp_·¿mhdr
 *
”r_·¿m
 = 
NULL
;

3686 
sùp_addhdr_t
 *
add_hdr
;

3687 
__u32
 
£Á_£rŸl
, 
rcvd_£rŸl
;

3689 ià(!
	`sùp_vg_v”ify
(
ascÚf_ack
, 
asoc
)) {

3690 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_BAD_TAG
,

3691 
	`SCTP_NULL
());

3692  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3701 ià(!
sùp_add_nßuth
 && !
ascÚf_ack
->
auth
)

3702  
	`sùp_sf_disÿrd_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3705 ià(!
	`sùp_chunk_Ëngth_v®id
(
ascÚf_ack
, (
sùp_add_chunk_t
)))

3706  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3707 
commªds
);

3709 
add_hdr
 = (
sùp_addhdr_t
 *)
ascÚf_ack
->
skb
->
d©a
;

3710 
rcvd_£rŸl
 = 
	`Áohl
(
add_hdr
->
£rŸl
);

3713 ià(!
	`sùp_v”ify_ascÚf
(
asoc
,

3714 (
sùp_·¿mhdr_t
 *)
add_hdr
->
·¿ms
,

3715 (*)
ascÚf_ack
->
chunk_’d
,

3716 &
”r_·¿m
))

3717  
	`sùp_sf_viŞ©iÚ_·¿mËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3718 (*)
”r_·¿m
, 
commªds
);

3720 ià(
Ï¡_ascÚf
) {

3721 
add_hdr
 = (
sùp_addhdr_t
 *)
Ï¡_ascÚf
->
subh
.addip_hdr;

3722 
£Á_£rŸl
 = 
	`Áohl
(
add_hdr
->
£rŸl
);

3724 
£Á_£rŸl
 = 
asoc
->
add_£rŸl
 - 1;

3733 ià(
	`ADDIP_SERIAL_g‹
(
rcvd_£rŸl
, 
£Á_£rŸl
 + 1) &&

3734 !(
asoc
->
add_Ï¡_ascÚf
)) {

3735 
abÜt
 = 
	`sùp_make_abÜt
(
asoc
, 
ascÚf_ack
,

3736 (
sùp_”rhdr_t
));

3737 ià(
abÜt
) {

3738 
	`sùp_š™_ÿu£
(
abÜt
, 
SCTP_ERROR_ASCONF_ACK
, 0);

3739 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

3740 
	`SCTP_CHUNK
(
abÜt
));

3745 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

3746 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T4_RTO
));

3747 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DISCARD_PACKET
,
	`SCTP_NULL
());

3748 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

3749 
	`SCTP_ERROR
(
ECONNABORTED
));

3750 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

3751 
	`SCTP_PERR
(
SCTP_ERROR_ASCONF_ACK
));

3752 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

3753 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

3754  
SCTP_DISPOSITION_ABORT
;

3757 ià((
rcvd_£rŸl
 =ğ
£Á_£rŸl
è&& 
asoc
->
add_Ï¡_ascÚf
) {

3758 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

3759 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T4_RTO
));

3761 ià(!
	`sùp_´oûss_ascÚf_ack
((
sùp_assocŸtiÚ
 *)
asoc
,

3762 
ascÚf_ack
)) {

3766 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_NEXT_ASCONF
,

3767 
	`SCTP_NULL
());

3768  
SCTP_DISPOSITION_CONSUME
;

3771 
abÜt
 = 
	`sùp_make_abÜt
(
asoc
, 
ascÚf_ack
,

3772 (
sùp_”rhdr_t
));

3773 ià(
abÜt
) {

3774 
	`sùp_š™_ÿu£
(
abÜt
, 
SCTP_ERROR_RSRC_LOW
, 0);

3775 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

3776 
	`SCTP_CHUNK
(
abÜt
));

3781 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DISCARD_PACKET
,
	`SCTP_NULL
());

3782 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

3783 
	`SCTP_ERROR
(
ECONNABORTED
));

3784 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

3785 
	`SCTP_PERR
(
SCTP_ERROR_ASCONF_ACK
));

3786 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

3787 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

3788  
SCTP_DISPOSITION_ABORT
;

3791  
SCTP_DISPOSITION_DISCARD
;

3792 
	}
}

3808 
sùp_di¥os™iÚ_t
 
	$sùp_sf_—t_fwd_t¢
(cÚ¡ 
sùp_’dpošt
 *
•
,

3809 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3810 cÚ¡ 
sùp_subty³_t
 
ty³
,

3811 *
¬g
,

3812 
sùp_cmd_£q_t
 *
commªds
)

3814 
sùp_chunk
 *
chunk
 = 
¬g
;

3815 
sùp_fwdt¢_hdr
 *
fwdt¢_hdr
;

3816 
sùp_fwdt¢_sk
 *
sk
;

3817 
__u16
 
Ën
;

3818 
__u32
 
t¢
;

3820 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
)) {

3821 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_BAD_TAG
,

3822 
	`SCTP_NULL
());

3823  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3827 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_fwdt¢_chunk
)))

3828  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3829 
commªds
);

3831 
fwdt¢_hdr
 = (
sùp_fwdt¢_hdr
 *)
chunk
->
skb
->
d©a
;

3832 
chunk
->
subh
.
fwdt¢_hdr
 = fwdtsn_hdr;

3833 
Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

3834 
Ën
 -ğ(
sùp_chunkhdr
);

3835 
	`skb_puÎ
(
chunk
->
skb
, 
Ën
);

3837 
t¢
 = 
	`Áohl
(
fwdt¢_hdr
->
Ãw_cum_t¢
);

3838 
	`SCTP_DEBUG_PRINTK
("%s: TSN 0x%x.\n", 
__func__
, 
t¢
);

3843 ià(
	`sùp_t¢m­_check
(&
asoc
->
³”
.
t¢_m­
, 
t¢
) < 0)

3844 
disÿrd_nofÜû
;

3847 
	`sùp_w®k_fwdt¢
(
sk
, 
chunk
) {

3848 ià(
	`Áohs
(
sk
->
¡»am
è>ğ
asoc
->
c
.
sš™_max_š¡»ams
)

3849 
disÿrd_nofÜû
;

3852 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_FWDTSN
, 
	`SCTP_U32
(
t¢
));

3853 ià(
Ën
 > (
sùp_fwdt¢_hdr
))

3854 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PROCESS_FWDTSN
,

3855 
	`SCTP_CHUNK
(
chunk
));

3858 ià(
asoc
->
autoşo£
) {

3859 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

3860 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_AUTOCLOSE
));

3866 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SACK
, 
	`SCTP_NOFORCE
());

3868  
SCTP_DISPOSITION_CONSUME
;

3870 
disÿrd_nofÜû
:

3871  
SCTP_DISPOSITION_DISCARD
;

3872 
	}
}

3874 
sùp_di¥os™iÚ_t
 
	$sùp_sf_—t_fwd_t¢_ç¡
(

3875 cÚ¡ 
sùp_’dpošt
 *
•
,

3876 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3877 cÚ¡ 
sùp_subty³_t
 
ty³
,

3878 *
¬g
,

3879 
sùp_cmd_£q_t
 *
commªds
)

3881 
sùp_chunk
 *
chunk
 = 
¬g
;

3882 
sùp_fwdt¢_hdr
 *
fwdt¢_hdr
;

3883 
sùp_fwdt¢_sk
 *
sk
;

3884 
__u16
 
Ën
;

3885 
__u32
 
t¢
;

3887 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
)) {

3888 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_BAD_TAG
,

3889 
	`SCTP_NULL
());

3890  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

3894 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_fwdt¢_chunk
)))

3895  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

3896 
commªds
);

3898 
fwdt¢_hdr
 = (
sùp_fwdt¢_hdr
 *)
chunk
->
skb
->
d©a
;

3899 
chunk
->
subh
.
fwdt¢_hdr
 = fwdtsn_hdr;

3900 
Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

3901 
Ën
 -ğ(
sùp_chunkhdr
);

3902 
	`skb_puÎ
(
chunk
->
skb
, 
Ën
);

3904 
t¢
 = 
	`Áohl
(
fwdt¢_hdr
->
Ãw_cum_t¢
);

3905 
	`SCTP_DEBUG_PRINTK
("%s: TSN 0x%x.\n", 
__func__
, 
t¢
);

3910 ià(
	`sùp_t¢m­_check
(&
asoc
->
³”
.
t¢_m­
, 
t¢
) < 0)

3911 
g’_shutdown
;

3914 
	`sùp_w®k_fwdt¢
(
sk
, 
chunk
) {

3915 ià(
	`Áohs
(
sk
->
¡»am
è>ğ
asoc
->
c
.
sš™_max_š¡»ams
)

3916 
g’_shutdown
;

3919 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_FWDTSN
, 
	`SCTP_U32
(
t¢
));

3920 ià(
Ën
 > (
sùp_fwdt¢_hdr
))

3921 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PROCESS_FWDTSN
,

3922 
	`SCTP_CHUNK
(
chunk
));

3925 
g’_shutdown
:

3932 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SHUTDOWN
, 
	`SCTP_NULL
());

3933 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SACK
, 
	`SCTP_FORCE
());

3934 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

3935 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

3937  
SCTP_DISPOSITION_CONSUME
;

3938 
	}
}

3962 
sùp_›¼Ü_t
 
	$sùp_sf_auth’tiÿ‹
(cÚ¡ 
sùp_’dpošt
 *
•
,

3963 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

3964 cÚ¡ 
sùp_subty³_t
 
ty³
,

3965 
sùp_chunk
 *
chunk
)

3967 
sùp_authhdr
 *
auth_hdr
;

3968 
sùp_hmac
 *
hmac
;

3969 
sig_Ën
;

3970 
__u16
 
key_id
;

3971 
__u8
 *
§ve_dige¡
;

3972 
__u8
 *
dige¡
;

3975 
auth_hdr
 = (
sùp_authhdr
 *)
chunk
->
skb
->
d©a
;

3976 
chunk
->
subh
.
auth_hdr
 =‡uth_hdr;

3977 
	`skb_puÎ
(
chunk
->
skb
, (
sùp_authhdr
));

3982 ià(!
	`sùp_auth_asoc_v”ify_hmac_id
(
asoc
, 
auth_hdr
->
hmac_id
))

3983  
SCTP_IERROR_AUTH_BAD_HMAC
;

3988 
key_id
 = 
	`Áohs
(
auth_hdr
->
shkey_id
);

3989 ià(
key_id
 !ğ
asoc
->
aùive_key_id
 && !
	`sùp_auth_g‘_shkey
(asoc, key_id))

3990  
SCTP_IERROR_AUTH_BAD_KEYID
;

3996 
sig_Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
è- (
sùp_auth_chunk_t
);

3997 
hmac
 = 
	`sùp_auth_g‘_hmac
(
	`Áohs
(
auth_hdr
->
hmac_id
));

3998 ià(
sig_Ën
 !ğ
hmac
->
hmac_Ën
)

3999  
SCTP_IERROR_PROTO_VIOLATION
;

4008 
dige¡
 = 
auth_hdr
->
hmac
;

4009 
	`skb_puÎ
(
chunk
->
skb
, 
sig_Ën
);

4011 
§ve_dige¡
 = 
	`kmemdup
(
dige¡
, 
sig_Ën
, 
GFP_ATOMIC
);

4012 ià(!
§ve_dige¡
)

4013 
nomem
;

4015 
	`mem£t
(
dige¡
, 0, 
sig_Ën
);

4017 
	`sùp_auth_ÿlcuÏ‹_hmac
(
asoc
, 
chunk
->
skb
,

4018 (
sùp_auth_chunk
 *)
chunk
->
chunk_hdr
,

4019 
GFP_ATOMIC
);

4022 ià(
	`memcmp
(
§ve_dige¡
, 
dige¡
, 
sig_Ën
)) {

4023 
	`kä“
(
§ve_dige¡
);

4024  
SCTP_IERROR_BAD_SIG
;

4027 
	`kä“
(
§ve_dige¡
);

4028 
chunk
->
auth
 = 1;

4030  
SCTP_IERROR_NO_ERROR
;

4031 
nomem
:

4032  
SCTP_IERROR_NOMEM
;

4033 
	}
}

4035 
sùp_di¥os™iÚ_t
 
	$sùp_sf_—t_auth
(cÚ¡ 
sùp_’dpošt
 *
•
,

4036 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4037 cÚ¡ 
sùp_subty³_t
 
ty³
,

4038 *
¬g
,

4039 
sùp_cmd_£q_t
 *
commªds
)

4041 
sùp_authhdr
 *
auth_hdr
;

4042 
sùp_chunk
 *
chunk
 = 
¬g
;

4043 
sùp_chunk
 *
”r_chunk
;

4044 
sùp_›¼Ü_t
 
”rÜ
;

4047 ià(!
asoc
->
³”
.
auth_ÿ·bË
)

4048  
	`sùp_sf_unk_chunk
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4050 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
)) {

4051 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_BAD_TAG
,

4052 
	`SCTP_NULL
());

4053  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4057 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_auth_chunk
)))

4058  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

4059 
commªds
);

4061 
auth_hdr
 = (
sùp_authhdr
 *)
chunk
->
skb
->
d©a
;

4062 
”rÜ
 = 
	`sùp_sf_auth’tiÿ‹
(
•
, 
asoc
, 
ty³
, 
chunk
);

4063 
”rÜ
) {

4064 
SCTP_IERROR_AUTH_BAD_HMAC
:

4068 
”r_chunk
 = 
	`sùp_make_İ_”rÜ
(
asoc
, 
chunk
,

4069 
SCTP_ERROR_UNSUP_HMAC
,

4070 &
auth_hdr
->
hmac_id
,

4071 (
__u16
), 0);

4072 ià(
”r_chunk
) {

4073 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

4074 
	`SCTP_CHUNK
(
”r_chunk
));

4077 
SCTP_IERROR_AUTH_BAD_KEYID
:

4078 
SCTP_IERROR_BAD_SIG
:

4079  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4081 
SCTP_IERROR_PROTO_VIOLATION
:

4082  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

4083 
commªds
);

4085 
SCTP_IERROR_NOMEM
:

4086  
SCTP_DISPOSITION_NOMEM
;

4091 ià(
asoc
->
aùive_key_id
 !ğ
	`Áohs
(
auth_hdr
->
shkey_id
)) {

4092 
sùp_uÍev’t
 *
ev
;

4094 
ev
 = 
	`sùp_uÍev’t_make_authkey
(
asoc
, 
	`Áohs
(
auth_hdr
->
shkey_id
),

4095 
SCTP_AUTH_NEWKEY
, 
GFP_ATOMIC
);

4097 ià(!
ev
)

4098  -
ENOMEM
;

4100 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
,

4101 
	`SCTP_ULPEVENT
(
ev
));

4104  
SCTP_DISPOSITION_CONSUME
;

4105 
	}
}

4130 
sùp_di¥os™iÚ_t
 
	$sùp_sf_unk_chunk
(cÚ¡ 
sùp_’dpošt
 *
•
,

4131 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4132 cÚ¡ 
sùp_subty³_t
 
ty³
,

4133 *
¬g
,

4134 
sùp_cmd_£q_t
 *
commªds
)

4136 
sùp_chunk
 *
unk_chunk
 = 
¬g
;

4137 
sùp_chunk
 *
”r_chunk
;

4138 
sùp_chunkhdr_t
 *
hdr
;

4140 
	`SCTP_DEBUG_PRINTK
("ProûssšghunknowÀchunk id %d.\n", 
ty³
.
chunk
);

4142 ià(!
	`sùp_vg_v”ify
(
unk_chunk
, 
asoc
))

4143  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4149 ià(!
	`sùp_chunk_Ëngth_v®id
(
unk_chunk
, (
sùp_chunkhdr_t
)))

4150  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

4151 
commªds
);

4153 
ty³
.
chunk
 & 
SCTP_CID_ACTION_MASK
) {

4154 
SCTP_CID_ACTION_DISCARD
:

4156  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4158 
SCTP_CID_ACTION_DISCARD_ERR
:

4160 
hdr
 = 
unk_chunk
->
chunk_hdr
;

4161 
”r_chunk
 = 
	`sùp_make_İ_”rÜ
(
asoc
, 
unk_chunk
,

4162 
SCTP_ERROR_UNKNOWN_CHUNK
, 
hdr
,

4163 
	`WORD_ROUND
(
	`Áohs
(
hdr
->
Ëngth
)),

4165 ià(
”r_chunk
) {

4166 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

4167 
	`SCTP_CHUNK
(
”r_chunk
));

4171 
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4172  
SCTP_DISPOSITION_CONSUME
;

4174 
SCTP_CID_ACTION_SKIP
:

4176  
SCTP_DISPOSITION_DISCARD
;

4178 
SCTP_CID_ACTION_SKIP_ERR
:

4180 
hdr
 = 
unk_chunk
->
chunk_hdr
;

4181 
”r_chunk
 = 
	`sùp_make_İ_”rÜ
(
asoc
, 
unk_chunk
,

4182 
SCTP_ERROR_UNKNOWN_CHUNK
, 
hdr
,

4183 
	`WORD_ROUND
(
	`Áohs
(
hdr
->
Ëngth
)),

4185 ià(
”r_chunk
) {

4186 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

4187 
	`SCTP_CHUNK
(
”r_chunk
));

4190  
SCTP_DISPOSITION_CONSUME
;

4196  
SCTP_DISPOSITION_DISCARD
;

4197 
	}
}

4213 
sùp_di¥os™iÚ_t
 
	$sùp_sf_disÿrd_chunk
(cÚ¡ 
sùp_’dpošt
 *
•
,

4214 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4215 cÚ¡ 
sùp_subty³_t
 
ty³
,

4216 *
¬g
,

4217 
sùp_cmd_£q_t
 *
commªds
)

4219 
sùp_chunk
 *
chunk
 = 
¬g
;

4225 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

4226  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

4227 
commªds
);

4229 
	`SCTP_DEBUG_PRINTK
("Chunk %d i disÿrded\n", 
ty³
.
chunk
);

4230  
SCTP_DISPOSITION_DISCARD
;

4231 
	}
}

4251 
sùp_di¥os™iÚ_t
 
	$sùp_sf_pdisÿrd
(cÚ¡ 
sùp_’dpošt
 *
•
,

4252 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4253 cÚ¡ 
sùp_subty³_t
 
ty³
,

4254 *
¬g
,

4255 
sùp_cmd_£q_t
 *
commªds
)

4257 
	`SCTP_INC_STATS
(
SCTP_MIB_IN_PKT_DISCARDS
);

4258 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DISCARD_PACKET
, 
	`SCTP_NULL
());

4260  
SCTP_DISPOSITION_CONSUME
;

4261 
	}
}

4278 
sùp_di¥os™iÚ_t
 
	$sùp_sf_viŞ©iÚ
(cÚ¡ 
sùp_’dpošt
 *
•
,

4279 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4280 cÚ¡ 
sùp_subty³_t
 
ty³
,

4281 *
¬g
,

4282 
sùp_cmd_£q_t
 *
commªds
)

4284 
sùp_chunk
 *
chunk
 = 
¬g
;

4287 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_chunkhdr_t
)))

4288  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

4289 
commªds
);

4291  
SCTP_DISPOSITION_VIOLATION
;

4292 
	}
}

4297 
sùp_di¥os™iÚ_t
 
	$sùp_sf_abÜt_viŞ©iÚ
(

4298 cÚ¡ 
sùp_’dpošt
 *
•
,

4299 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4300 *
¬g
,

4301 
sùp_cmd_£q_t
 *
commªds
,

4302 cÚ¡ 
__u8
 *
·ylßd
,

4303 cÚ¡ 
size_t
 
·yËn
)

4305 
sùp_·ck‘
 *
·ck‘
 = 
NULL
;

4306 
sùp_chunk
 *
chunk
 = 
¬g
;

4307 
sùp_chunk
 *
abÜt
 = 
NULL
;

4320 ià(
	`sùp_auth_»cv_cid
(
SCTP_CID_ABORT
, 
asoc
))

4321 
disÿrd
;

4324 
abÜt
 = 
	`sùp_make_abÜt_viŞ©iÚ
(
asoc
, 
chunk
, 
·ylßd
, 
·yËn
);

4325 ià(!
abÜt
)

4326 
nomem
;

4328 ià(
asoc
) {

4330 ià(
chunk
->
chunk_hdr
->
ty³
 =ğ
SCTP_CID_INIT_ACK
 &&

4331 !
asoc
->
³”
.
i
.
š™_g
) {

4332 
sùp_š™ack_chunk_t
 *
š™ack
;

4334 
š™ack
 = (
sùp_š™ack_chunk_t
 *)
chunk
->
chunk_hdr
;

4335 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
,

4336 (
sùp_š™ack_chunk_t
)))

4337 
abÜt
->
chunk_hdr
->
æags
 |ğ
SCTP_CHUNK_FLAG_T
;

4339 
š™g
;

4341 
š™g
 = 
	`Áohl
(
š™ack
->
š™_hdr
.
š™_g
);

4342 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_UPDATE_INITTAG
,

4343 
	`SCTP_U32
(
š™g
));

4347 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
abÜt
));

4348 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

4350 ià(
asoc
->
¡©e
 <ğ
SCTP_STATE_COOKIE_ECHOED
) {

4351 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

4352 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

4353 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

4354 
	`SCTP_ERROR
(
ECONNREFUSED
));

4355 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_FAILED
,

4356 
	`SCTP_PERR
(
SCTP_ERROR_PROTO_VIOLATION
));

4358 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

4359 
	`SCTP_ERROR
(
ECONNABORTED
));

4360 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

4361 
	`SCTP_PERR
(
SCTP_ERROR_PROTO_VIOLATION
));

4362 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

4365 
·ck‘
 = 
	`sùp_oÙb_pkt_Ãw
(
asoc
, 
chunk
);

4367 ià(!
·ck‘
)

4368 
nomem_pkt
;

4370 ià(
	`sùp_‹¡_T_b™
(
abÜt
))

4371 
·ck‘
->
vg
 = 
	`Áohl
(
chunk
->
sùp_hdr
->vtag);

4373 
abÜt
->
skb
->
sk
 = 
•
->
ba£
.sk;

4375 
	`sùp_·ck‘_­³nd_chunk
(
·ck‘
, 
abÜt
);

4377 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_PKT
,

4378 
	`SCTP_PACKET
(
·ck‘
));

4380 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

4383 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

4385 
disÿrd
:

4386 
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
	`SCTP_ST_CHUNK
(0), 
¬g
, 
commªds
);

4387  
SCTP_DISPOSITION_ABORT
;

4389 
nomem_pkt
:

4390 
	`sùp_chunk_ä“
(
abÜt
);

4391 
nomem
:

4392  
SCTP_DISPOSITION_NOMEM
;

4393 
	}
}

4414 
sùp_di¥os™iÚ_t
 
	$sùp_sf_viŞ©iÚ_chunkËn
(

4415 cÚ¡ 
sùp_’dpošt
 *
•
,

4416 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4417 cÚ¡ 
sùp_subty³_t
 
ty³
,

4418 *
¬g
,

4419 
sùp_cmd_£q_t
 *
commªds
)

4421 cÚ¡ 
”r_¡r
[]="The following chunk had invalid†ength:";

4423  
	`sùp_sf_abÜt_viŞ©iÚ
(
•
, 
asoc
, 
¬g
, 
commªds
, 
”r_¡r
,

4424 (
”r_¡r
));

4425 
	}
}

4432 
sùp_di¥os™iÚ_t
 
	$sùp_sf_viŞ©iÚ_·¿mËn
(

4433 cÚ¡ 
sùp_’dpošt
 *
•
,

4434 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4435 cÚ¡ 
sùp_subty³_t
 
ty³
,

4436 *
¬g
, *
ext
,

4437 
sùp_cmd_£q_t
 *
commªds
)

4439 
sùp_chunk
 *
chunk
 = 
¬g
;

4440 
sùp_·¿mhdr
 *
·¿m
 = 
ext
;

4441 
sùp_chunk
 *
abÜt
 = 
NULL
;

4443 ià(
	`sùp_auth_»cv_cid
(
SCTP_CID_ABORT
, 
asoc
))

4444 
disÿrd
;

4447 
abÜt
 = 
	`sùp_make_viŞ©iÚ_·¿mËn
(
asoc
, 
chunk
, 
·¿m
);

4448 ià(!
abÜt
)

4449 
nomem
;

4451 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
abÜt
));

4452 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

4454 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

4455 
	`SCTP_ERROR
(
ECONNABORTED
));

4456 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

4457 
	`SCTP_PERR
(
SCTP_ERROR_PROTO_VIOLATION
));

4458 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

4459 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

4461 
disÿrd
:

4462 
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
	`SCTP_ST_CHUNK
(0), 
¬g
, 
commªds
);

4463  
SCTP_DISPOSITION_ABORT
;

4464 
nomem
:

4465  
SCTP_DISPOSITION_NOMEM
;

4466 
	}
}

4474 
sùp_di¥os™iÚ_t
 
	$sùp_sf_viŞ©iÚ_ù¢
(

4475 cÚ¡ 
sùp_’dpošt
 *
•
,

4476 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4477 cÚ¡ 
sùp_subty³_t
 
ty³
,

4478 *
¬g
,

4479 
sùp_cmd_£q_t
 *
commªds
)

4481 cÚ¡ 
”r_¡r
[]="The cumulativesn‡ck beyondhe maxsn currently sent:";

4483  
	`sùp_sf_abÜt_viŞ©iÚ
(
•
, 
asoc
, 
¬g
, 
commªds
, 
”r_¡r
,

4484 (
”r_¡r
));

4485 
	}
}

4493 
sùp_di¥os™iÚ_t
 
	$sùp_sf_viŞ©iÚ_chunk
(

4494 cÚ¡ 
sùp_’dpošt
 *
•
,

4495 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4496 cÚ¡ 
sùp_subty³_t
 
ty³
,

4497 *
¬g
,

4498 
sùp_cmd_£q_t
 *
commªds
)

4500 cÚ¡ 
”r_¡r
[]="The following chunk violates…rotocol:";

4502 ià(!
asoc
)

4503  
	`sùp_sf_viŞ©iÚ
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4505  
	`sùp_sf_abÜt_viŞ©iÚ
(
•
, 
asoc
, 
¬g
, 
commªds
, 
”r_¡r
,

4506 (
”r_¡r
));

4507 
	}
}

4568 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_´m_asoc
(cÚ¡ 
sùp_’dpošt
 *
•
,

4569 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4570 cÚ¡ 
sùp_subty³_t
 
ty³
,

4571 *
¬g
,

4572 
sùp_cmd_£q_t
 *
commªds
)

4574 
sùp_chunk
 *
»¶
;

4575 
sùp_assocŸtiÚ
* 
my_asoc
;

4581 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

4582 
	`SCTP_STATE
(
SCTP_STATE_COOKIE_WAIT
));

4592 
»¶
 = 
	`sùp_make_š™
(
asoc
, &asoc->
ba£
.
bšd_addr
, 
GFP_ATOMIC
, 0);

4593 ià(!
»¶
)

4594 
nomem
;

4599 
my_asoc
 = (
sùp_assocŸtiÚ
 *)
asoc
;

4600 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_ASOC
, 
	`SCTP_ASOC
(
my_asoc
));

4603 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_CHOOSE_TRANSPORT
,

4604 
	`SCTP_CHUNK
(
»¶
));

4609 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_START
,

4610 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

4611 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

4612  
SCTP_DISPOSITION_CONSUME
;

4614 
nomem
:

4615  
SCTP_DISPOSITION_NOMEM
;

4616 
	}
}

4679 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_´m_£nd
(cÚ¡ 
sùp_’dpošt
 *
•
,

4680 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4681 cÚ¡ 
sùp_subty³_t
 
ty³
,

4682 *
¬g
,

4683 
sùp_cmd_£q_t
 *
commªds
)

4685 
sùp_d©amsg
 *
msg
 = 
¬g
;

4687 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_MSG
, 
	`SCTP_DATAMSG
(
msg
));

4688  
SCTP_DISPOSITION_CONSUME
;

4689 
	}
}

4717 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_2_´m_shutdown
(

4718 cÚ¡ 
sùp_’dpošt
 *
•
,

4719 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4720 cÚ¡ 
sùp_subty³_t
 
ty³
,

4721 *
¬g
,

4722 
sùp_cmd_£q_t
 *
commªds
)

4724 
di¥os™iÚ
;

4734 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

4735 
	`SCTP_STATE
(
SCTP_STATE_SHUTDOWN_PENDING
));

4737 
di¥os™iÚ
 = 
SCTP_DISPOSITION_CONSUME
;

4738 ià(
	`sùp_outq_is_em±y
(&
asoc
->
outqueue
)) {

4739 
di¥os™iÚ
 = 
	`sùp_sf_do_9_2_¡¬t_shutdown
(
•
, 
asoc
, 
ty³
,

4740 
¬g
, 
commªds
);

4742  
di¥os™iÚ
;

4743 
	}
}

4772 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_1_´m_abÜt
(

4773 cÚ¡ 
sùp_’dpošt
 *
•
,

4774 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4775 cÚ¡ 
sùp_subty³_t
 
ty³
,

4776 *
¬g
,

4777 
sùp_cmd_£q_t
 *
commªds
)

4787 
sùp_chunk
 *
abÜt
 = 
¬g
;

4788 
sùp_di¥os™iÚ_t
 
»tv®
;

4790 
»tv®
 = 
SCTP_DISPOSITION_CONSUME
;

4792 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
abÜt
));

4798 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

4799 
	`SCTP_ERROR
(
ECONNABORTED
));

4801 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

4802 
	`SCTP_PERR
(
SCTP_ERROR_USER_ABORT
));

4804 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

4805 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

4807  
»tv®
;

4808 
	}
}

4811 
sùp_di¥os™iÚ_t
 
	$sùp_sf_”rÜ_şo£d
(cÚ¡ 
sùp_’dpošt
 *
•
,

4812 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4813 cÚ¡ 
sùp_subty³_t
 
ty³
,

4814 *
¬g
,

4815 
sùp_cmd_£q_t
 *
commªds
)

4817 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_ERROR
, 
	`SCTP_ERROR
(-
EINVAL
));

4818  
SCTP_DISPOSITION_CONSUME
;

4819 
	}
}

4824 
sùp_di¥os™iÚ_t
 
	$sùp_sf_”rÜ_shutdown
(cÚ¡ 
sùp_’dpošt
 *
•
,

4825 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4826 cÚ¡ 
sùp_subty³_t
 
ty³
,

4827 *
¬g
,

4828 
sùp_cmd_£q_t
 *
commªds
)

4830 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_ERROR
,

4831 
	`SCTP_ERROR
(-
ESHUTDOWN
));

4832  
SCTP_DISPOSITION_CONSUME
;

4833 
	}
}

4849 
sùp_di¥os™iÚ_t
 
	$sùp_sf_cook›_wa™_´m_shutdown
(

4850 cÚ¡ 
sùp_’dpošt
 *
•
,

4851 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4852 cÚ¡ 
sùp_subty³_t
 
ty³
,

4853 *
¬g
,

4854 
sùp_cmd_£q_t
 *
commªds
)

4856 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

4857 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

4859 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

4860 
	`SCTP_STATE
(
SCTP_STATE_CLOSED
));

4862 
	`SCTP_INC_STATS
(
SCTP_MIB_SHUTDOWNS
);

4864 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DELETE_TCB
, 
	`SCTP_NULL
());

4866  
SCTP_DISPOSITION_DELETE_TCB
;

4867 
	}
}

4883 
sùp_di¥os™iÚ_t
 
	$sùp_sf_cook›_echÛd_´m_shutdown
(

4884 cÚ¡ 
sùp_’dpošt
 *
•
,

4885 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4886 cÚ¡ 
sùp_subty³_t
 
ty³
,

4887 *
¬g
, 
sùp_cmd_£q_t
 *
commªds
)

4892  
	`sùp_sf_cook›_wa™_´m_shutdown
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4893 
	}
}

4909 
sùp_di¥os™iÚ_t
 
	$sùp_sf_cook›_wa™_´m_abÜt
(

4910 cÚ¡ 
sùp_’dpošt
 *
•
,

4911 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4912 cÚ¡ 
sùp_subty³_t
 
ty³
,

4913 *
¬g
,

4914 
sùp_cmd_£q_t
 *
commªds
)

4916 
sùp_chunk
 *
abÜt
 = 
¬g
;

4917 
sùp_di¥os™iÚ_t
 
»tv®
;

4920 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

4921 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

4922 
»tv®
 = 
SCTP_DISPOSITION_CONSUME
;

4924 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
abÜt
));

4926 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

4927 
	`SCTP_STATE
(
SCTP_STATE_CLOSED
));

4929 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

4935 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

4936 
	`SCTP_ERROR
(
ECONNREFUSED
));

4938 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_FAILED
,

4939 
	`SCTP_PERR
(
SCTP_ERROR_USER_ABORT
));

4941  
»tv®
;

4942 
	}
}

4958 
sùp_di¥os™iÚ_t
 
	$sùp_sf_cook›_echÛd_´m_abÜt
(

4959 cÚ¡ 
sùp_’dpošt
 *
•
,

4960 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4961 cÚ¡ 
sùp_subty³_t
 
ty³
,

4962 *
¬g
,

4963 
sùp_cmd_£q_t
 *
commªds
)

4968  
	`sùp_sf_cook›_wa™_´m_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4969 
	}
}

4983 
sùp_di¥os™iÚ_t
 
	$sùp_sf_shutdown_³ndšg_´m_abÜt
(

4984 cÚ¡ 
sùp_’dpošt
 *
•
,

4985 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

4986 cÚ¡ 
sùp_subty³_t
 
ty³
,

4987 *
¬g
,

4988 
sùp_cmd_£q_t
 *
commªds
)

4991 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

4992 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
));

4994  
	`sùp_sf_do_9_1_´m_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

4995 
	}
}

5009 
sùp_di¥os™iÚ_t
 
	$sùp_sf_shutdown_£Á_´m_abÜt
(

5010 cÚ¡ 
sùp_’dpošt
 *
•
,

5011 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5012 cÚ¡ 
sùp_subty³_t
 
ty³
,

5013 *
¬g
,

5014 
sùp_cmd_£q_t
 *
commªds
)

5017 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

5018 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

5021 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

5022 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
));

5024  
	`sùp_sf_do_9_1_´m_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

5025 
	}
}

5039 
sùp_di¥os™iÚ_t
 
	$sùp_sf_shutdown_ack_£Á_´m_abÜt
(

5040 cÚ¡ 
sùp_’dpošt
 *
•
,

5041 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5042 cÚ¡ 
sùp_subty³_t
 
ty³
,

5043 *
¬g
,

5044 
sùp_cmd_£q_t
 *
commªds
)

5049  
	`sùp_sf_shutdown_£Á_´m_abÜt
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

5050 
	}
}

5074 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_´m_»que¡h—¹b—t
(

5075 cÚ¡ 
sùp_’dpošt
 *
•
,

5076 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5077 cÚ¡ 
sùp_subty³_t
 
ty³
,

5078 *
¬g
,

5079 
sùp_cmd_£q_t
 *
commªds
)

5081 ià(
SCTP_DISPOSITION_NOMEM
 =ğ
	`sùp_sf_h—¹b—t
(
•
, 
asoc
, 
ty³
,

5082 (
sùp_Œª¥Üt
 *)
¬g
, 
commªds
))

5083  
SCTP_DISPOSITION_NOMEM
;

5096 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TRANSPORT_HB_SENT
,

5097 
	`SCTP_TRANSPORT
(
¬g
));

5098  
SCTP_DISPOSITION_CONSUME
;

5099 
	}
}

5106 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_´m_ascÚf
(cÚ¡ 
sùp_’dpošt
 *
•
,

5107 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5108 cÚ¡ 
sùp_subty³_t
 
ty³
,

5109 *
¬g
,

5110 
sùp_cmd_£q_t
 *
commªds
)

5112 
sùp_chunk
 *
chunk
 = 
¬g
;

5114 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SETUP_T4
, 
	`SCTP_CHUNK
(
chunk
));

5115 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_START
,

5116 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T4_RTO
));

5117 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
chunk
));

5118  
SCTP_DISPOSITION_CONSUME
;

5119 
	}
}

5126 
sùp_di¥os™iÚ_t
 
	$sùp_sf_ignÜe_´im™ive
(

5127 cÚ¡ 
sùp_’dpošt
 *
•
,

5128 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5129 cÚ¡ 
sùp_subty³_t
 
ty³
,

5130 *
¬g
,

5131 
sùp_cmd_£q_t
 *
commªds
)

5133 
	`SCTP_DEBUG_PRINTK
("Prim™ivty³ %d i ignÜed.\n", 
ty³
.
´im™ive
);

5134  
SCTP_DISPOSITION_DISCARD
;

5135 
	}
}

5147 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_no_³ndšg_t¢
(

5148 cÚ¡ 
sùp_’dpošt
 *
•
,

5149 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5150 cÚ¡ 
sùp_subty³_t
 
ty³
,

5151 *
¬g
,

5152 
sùp_cmd_£q_t
 *
commªds
)

5154 
sùp_uÍev’t
 *
ev’t
;

5156 
ev’t
 = 
	`sùp_uÍev’t_make_£nd”_dry_ev’t
(
asoc
, 
GFP_ATOMIC
);

5157 ià(!
ev’t
)

5158  
SCTP_DISPOSITION_NOMEM
;

5160 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_EVENT_ULP
, 
	`SCTP_ULPEVENT
(
ev’t
));

5162  
SCTP_DISPOSITION_CONSUME
;

5163 
	}
}

5178 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_2_¡¬t_shutdown
(

5179 cÚ¡ 
sùp_’dpošt
 *
•
,

5180 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5181 cÚ¡ 
sùp_subty³_t
 
ty³
,

5182 *
¬g
,

5183 
sùp_cmd_£q_t
 *
commªds
)

5185 
sùp_chunk
 *
»¶y
;

5192 
»¶y
 = 
	`sùp_make_shutdown
(
asoc
, 
NULL
);

5193 ià(!
»¶y
)

5194 
nomem
;

5199 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SETUP_T2
, 
	`SCTP_CHUNK
(
»¶y
));

5202 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_START
,

5203 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

5209 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

5210 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
));

5212 ià(
asoc
->
autoşo£
)

5213 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

5214 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_AUTOCLOSE
));

5217 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

5218 
	`SCTP_STATE
(
SCTP_STATE_SHUTDOWN_SENT
));

5225 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_HB_TIMERS_STOP
, 
	`SCTP_NULL
());

5227 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

5229  
SCTP_DISPOSITION_CONSUME
;

5231 
nomem
:

5232  
SCTP_DISPOSITION_NOMEM
;

5233 
	}
}

5247 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_9_2_shutdown_ack
(

5248 cÚ¡ 
sùp_’dpošt
 *
•
,

5249 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5250 cÚ¡ 
sùp_subty³_t
 
ty³
,

5251 *
¬g
,

5252 
sùp_cmd_£q_t
 *
commªds
)

5254 
sùp_chunk
 *
chunk
 = (sùp_chunk *è
¬g
;

5255 
sùp_chunk
 *
»¶y
;

5264 ià(
chunk
) {

5265 ià(!
	`sùp_vg_v”ify
(
chunk
, 
asoc
))

5266  
	`sùp_sf_pdisÿrd
(
•
, 
asoc
, 
ty³
, 
¬g
, 
commªds
);

5269 ià(!
	`sùp_chunk_Ëngth_v®id
(
chunk
, (
sùp_shutdown_chunk_t
)))

5270  
	`sùp_sf_viŞ©iÚ_chunkËn
(
•
, 
asoc
, 
ty³
, 
¬g
,

5271 
commªds
);

5277 
»¶y
 = 
	`sùp_make_shutdown_ack
(
asoc
, 
chunk
);

5278 ià(!
»¶y
)

5279 
nomem
;

5284 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SETUP_T2
, 
	`SCTP_CHUNK
(
»¶y
));

5287 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

5288 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

5290 ià(
asoc
->
autoşo£
)

5291 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

5292 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_AUTOCLOSE
));

5295 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

5296 
	`SCTP_STATE
(
SCTP_STATE_SHUTDOWN_ACK_SENT
));

5303 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_HB_TIMERS_STOP
, 
	`SCTP_NULL
());

5305 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

5307  
SCTP_DISPOSITION_CONSUME
;

5309 
nomem
:

5310  
SCTP_DISPOSITION_NOMEM
;

5311 
	}
}

5318 
sùp_di¥os™iÚ_t
 
	$sùp_sf_ignÜe_Ùh”
(cÚ¡ 
sùp_’dpošt
 *
•
,

5319 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5320 cÚ¡ 
sùp_subty³_t
 
ty³
,

5321 *
¬g
,

5322 
sùp_cmd_£q_t
 *
commªds
)

5324 
	`SCTP_DEBUG_PRINTK
("Thev’ˆÙh”y³ %d i ignÜed\n", 
ty³
.
Ùh”
);

5325  
SCTP_DISPOSITION_DISCARD
;

5326 
	}
}

5343 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_6_3_3_¹x
(cÚ¡ 
sùp_’dpošt
 *
•
,

5344 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5345 cÚ¡ 
sùp_subty³_t
 
ty³
,

5346 *
¬g
,

5347 
sùp_cmd_£q_t
 *
commªds
)

5349 
sùp_Œª¥Üt
 *
Œª¥Üt
 = 
¬g
;

5351 
	`SCTP_INC_STATS
(
SCTP_MIB_T3_RTX_EXPIREDS
);

5353 ià(
asoc
->
ov”®l_”rÜ_couÁ
 >ğasoc->
max_»Œªs
) {

5354 ià(
asoc
->
¡©e
 =ğ
SCTP_STATE_SHUTDOWN_PENDING
) {

5364 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_START_ONCE
,

5365 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
));

5367 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

5368 
	`SCTP_ERROR
(
ETIMEDOUT
));

5370 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

5371 
	`SCTP_PERR
(
SCTP_ERROR_NO_ERROR
));

5372 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

5373 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

5374  
SCTP_DISPOSITION_DELETE_TCB
;

5406 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_STRIKE
, 
	`SCTP_TRANSPORT
(
Œª¥Üt
));

5409 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_RETRAN
, 
	`SCTP_TRANSPORT
(
Œª¥Üt
));

5411  
SCTP_DISPOSITION_CONSUME
;

5412 
	}
}

5429 
sùp_di¥os™iÚ_t
 
	$sùp_sf_do_6_2_§ck
(cÚ¡ 
sùp_’dpošt
 *
•
,

5430 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5431 cÚ¡ 
sùp_subty³_t
 
ty³
,

5432 *
¬g
,

5433 
sùp_cmd_£q_t
 *
commªds
)

5435 
	`SCTP_INC_STATS
(
SCTP_MIB_DELAY_SACK_EXPIREDS
);

5436 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_GEN_SACK
, 
	`SCTP_FORCE
());

5437  
SCTP_DISPOSITION_CONSUME
;

5438 
	}
}

5459 
sùp_di¥os™iÚ_t
 
	$sùp_sf_t1_š™_tim”_expœe
(cÚ¡ 
sùp_’dpošt
 *
•
,

5460 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5461 cÚ¡ 
sùp_subty³_t
 
ty³
,

5462 *
¬g
,

5463 
sùp_cmd_£q_t
 *
commªds
)

5465 
sùp_chunk
 *
»¶
 = 
NULL
;

5466 
sùp_bšd_addr
 *
bp
;

5467 
©‹m±s
 = 
asoc
->
š™_”r_couÁ”
 + 1;

5469 
	`SCTP_DEBUG_PRINTK
("Timer T1ƒxpired (INIT).\n");

5470 
	`SCTP_INC_STATS
(
SCTP_MIB_T1_INIT_EXPIREDS
);

5472 ià(
©‹m±s
 <ğ
asoc
->
max_š™_©‹m±s
) {

5473 
bp
 = (
sùp_bšd_addr
 *è&
asoc
->
ba£
.
bšd_addr
;

5474 
»¶
 = 
	`sùp_make_š™
(
asoc
, 
bp
, 
GFP_ATOMIC
, 0);

5475 ià(!
»¶
)

5476  
SCTP_DISPOSITION_NOMEM
;

5479 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_CHOOSE_TRANSPORT
,

5480 
	`SCTP_CHUNK
(
»¶
));

5483 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_RESTART
,

5484 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_INIT
));

5486 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

5488 
	`SCTP_DEBUG_PRINTK
("Giving up on INIT,‡ttempts: %d"

5490 
©‹m±s
, 
asoc
->
max_š™_©‹m±s
);

5491 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

5492 
	`SCTP_ERROR
(
ETIMEDOUT
));

5493 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_FAILED
,

5494 
	`SCTP_PERR
(
SCTP_ERROR_NO_ERROR
));

5495  
SCTP_DISPOSITION_DELETE_TCB
;

5498  
SCTP_DISPOSITION_CONSUME
;

5499 
	}
}

5520 
sùp_di¥os™iÚ_t
 
	$sùp_sf_t1_cook›_tim”_expœe
(cÚ¡ 
sùp_’dpošt
 *
•
,

5521 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5522 cÚ¡ 
sùp_subty³_t
 
ty³
,

5523 *
¬g
,

5524 
sùp_cmd_£q_t
 *
commªds
)

5526 
sùp_chunk
 *
»¶
 = 
NULL
;

5527 
©‹m±s
 = 
asoc
->
š™_”r_couÁ”
 + 1;

5529 
	`SCTP_DEBUG_PRINTK
("Timer T1ƒxpired (COOKIE-ECHO).\n");

5530 
	`SCTP_INC_STATS
(
SCTP_MIB_T1_COOKIE_EXPIREDS
);

5532 ià(
©‹m±s
 <ğ
asoc
->
max_š™_©‹m±s
) {

5533 
»¶
 = 
	`sùp_make_cook›_echo
(
asoc
, 
NULL
);

5534 ià(!
»¶
)

5535  
SCTP_DISPOSITION_NOMEM
;

5537 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_CHOOSE_TRANSPORT
,

5538 
	`SCTP_CHUNK
(
»¶
));

5540 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_COOKIEECHO_RESTART
,

5541 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T1_COOKIE
));

5543 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶
));

5545 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

5546 
	`SCTP_ERROR
(
ETIMEDOUT
));

5547 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_INIT_FAILED
,

5548 
	`SCTP_PERR
(
SCTP_ERROR_NO_ERROR
));

5549  
SCTP_DISPOSITION_DELETE_TCB
;

5552  
SCTP_DISPOSITION_CONSUME
;

5553 
	}
}

5568 
sùp_di¥os™iÚ_t
 
	$sùp_sf_t2_tim”_expœe
(cÚ¡ 
sùp_’dpošt
 *
•
,

5569 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5570 cÚ¡ 
sùp_subty³_t
 
ty³
,

5571 *
¬g
,

5572 
sùp_cmd_£q_t
 *
commªds
)

5574 
sùp_chunk
 *
»¶y
 = 
NULL
;

5576 
	`SCTP_DEBUG_PRINTK
("Timer T2ƒxpired.\n");

5577 
	`SCTP_INC_STATS
(
SCTP_MIB_T2_SHUTDOWN_EXPIREDS
);

5579 ((
sùp_assocŸtiÚ
 *)
asoc
)->
shutdown_»Œ›s
++;

5581 ià(
asoc
->
ov”®l_”rÜ_couÁ
 >ğasoc->
max_»Œªs
) {

5582 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

5583 
	`SCTP_ERROR
(
ETIMEDOUT
));

5585 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

5586 
	`SCTP_PERR
(
SCTP_ERROR_NO_ERROR
));

5587 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

5588 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

5589  
SCTP_DISPOSITION_DELETE_TCB
;

5592 
asoc
->
¡©e
) {

5593 
SCTP_STATE_SHUTDOWN_SENT
:

5594 
»¶y
 = 
	`sùp_make_shutdown
(
asoc
, 
NULL
);

5597 
SCTP_STATE_SHUTDOWN_ACK_SENT
:

5598 
»¶y
 = 
	`sùp_make_shutdown_ack
(
asoc
, 
NULL
);

5602 
	`BUG
();

5606 ià(!
»¶y
)

5607 
nomem
;

5613 ià(
asoc
->
shutdown_Ï¡_£Á_to
)

5614 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_STRIKE
,

5615 
	`SCTP_TRANSPORT
(
asoc
->
shutdown_Ï¡_£Á_to
));

5620 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SETUP_T2
, 
	`SCTP_CHUNK
(
»¶y
));

5623 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

5624 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
));

5625 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

5626  
SCTP_DISPOSITION_CONSUME
;

5628 
nomem
:

5629  
SCTP_DISPOSITION_NOMEM
;

5630 
	}
}

5636 
sùp_di¥os™iÚ_t
 
	$sùp_sf_t4_tim”_expœe
(

5637 cÚ¡ 
sùp_’dpošt
 *
•
,

5638 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5639 cÚ¡ 
sùp_subty³_t
 
ty³
,

5640 *
¬g
,

5641 
sùp_cmd_£q_t
 *
commªds
)

5643 
sùp_chunk
 *
chunk
 = 
asoc
->
add_Ï¡_ascÚf
;

5644 
sùp_Œª¥Üt
 *
Œª¥Üt
 = 
chunk
->transport;

5646 
	`SCTP_INC_STATS
(
SCTP_MIB_T4_RTO_EXPIREDS
);

5652 ià(
Œª¥Üt
)

5653 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_STRIKE
,

5654 
	`SCTP_TRANSPORT
(
Œª¥Üt
));

5657 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SETUP_T4
, 
	`SCTP_CHUNK
(
chunk
));

5664 ià(
asoc
->
ov”®l_”rÜ_couÁ
 >ğasoc->
max_»Œªs
) {

5665 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_STOP
,

5666 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T4_RTO
));

5667 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

5668 
	`SCTP_ERROR
(
ETIMEDOUT
));

5669 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

5670 
	`SCTP_PERR
(
SCTP_ERROR_NO_ERROR
));

5671 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

5672 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

5673  
SCTP_DISPOSITION_ABORT
;

5687 
	`sùp_chunk_hŞd
(
asoc
->
add_Ï¡_ascÚf
);

5688 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

5689 
	`SCTP_CHUNK
(
asoc
->
add_Ï¡_ascÚf
));

5695 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_TIMER_RESTART
,

5696 
	`SCTP_TO
(
SCTP_EVENT_TIMEOUT_T4_RTO
));

5698  
SCTP_DISPOSITION_CONSUME
;

5699 
	}
}

5707 
sùp_di¥os™iÚ_t
 
	$sùp_sf_t5_tim”_expœe
(cÚ¡ 
sùp_’dpošt
 *
•
,

5708 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5709 cÚ¡ 
sùp_subty³_t
 
ty³
,

5710 *
¬g
,

5711 
sùp_cmd_£q_t
 *
commªds
)

5713 
sùp_chunk
 *
»¶y
 = 
NULL
;

5715 
	`SCTP_DEBUG_PRINTK
("Timer T5ƒxpired.\n");

5716 
	`SCTP_INC_STATS
(
SCTP_MIB_T5_SHUTDOWN_GUARD_EXPIREDS
);

5718 
»¶y
 = 
	`sùp_make_abÜt
(
asoc
, 
NULL
, 0);

5719 ià(!
»¶y
)

5720 
nomem
;

5722 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
, 
	`SCTP_CHUNK
(
»¶y
));

5723 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

5724 
	`SCTP_ERROR
(
ETIMEDOUT
));

5725 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

5726 
	`SCTP_PERR
(
SCTP_ERROR_NO_ERROR
));

5728 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

5729 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

5731  
SCTP_DISPOSITION_DELETE_TCB
;

5732 
nomem
:

5733  
SCTP_DISPOSITION_NOMEM
;

5734 
	}
}

5741 
sùp_di¥os™iÚ_t
 
	$sùp_sf_autoşo£_tim”_expœe
(

5742 cÚ¡ 
sùp_’dpošt
 *
•
,

5743 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5744 cÚ¡ 
sùp_subty³_t
 
ty³
,

5745 *
¬g
,

5746 
sùp_cmd_£q_t
 *
commªds
)

5748 
di¥os™iÚ
;

5750 
	`SCTP_INC_STATS
(
SCTP_MIB_AUTOCLOSE_EXPIREDS
);

5760 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_NEW_STATE
,

5761 
	`SCTP_STATE
(
SCTP_STATE_SHUTDOWN_PENDING
));

5763 
di¥os™iÚ
 = 
SCTP_DISPOSITION_CONSUME
;

5764 ià(
	`sùp_outq_is_em±y
(&
asoc
->
outqueue
)) {

5765 
di¥os™iÚ
 = 
	`sùp_sf_do_9_2_¡¬t_shutdown
(
•
, 
asoc
, 
ty³
,

5766 
¬g
, 
commªds
);

5768  
di¥os™iÚ
;

5769 
	}
}

5783 
sùp_di¥os™iÚ_t
 
	$sùp_sf_nÙ_im¶
(cÚ¡ 
sùp_’dpošt
 *
•
,

5784 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5785 cÚ¡ 
sùp_subty³_t
 
ty³
,

5786 *
¬g
,

5787 
sùp_cmd_£q_t
 *
commªds
)

5789  
SCTP_DISPOSITION_NOT_IMPL
;

5790 
	}
}

5800 
sùp_di¥os™iÚ_t
 
	$sùp_sf_bug
(cÚ¡ 
sùp_’dpošt
 *
•
,

5801 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5802 cÚ¡ 
sùp_subty³_t
 
ty³
,

5803 *
¬g
,

5804 
sùp_cmd_£q_t
 *
commªds
)

5806  
SCTP_DISPOSITION_BUG
;

5807 
	}
}

5820 
sùp_di¥os™iÚ_t
 
	$sùp_sf_tim”_ignÜe
(cÚ¡ 
sùp_’dpošt
 *
•
,

5821 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5822 cÚ¡ 
sùp_subty³_t
 
ty³
,

5823 *
¬g
,

5824 
sùp_cmd_£q_t
 *
commªds
)

5826 
	`SCTP_DEBUG_PRINTK
("Tim” %d ignÜed.\n", 
ty³
.
chunk
);

5827  
SCTP_DISPOSITION_CONSUME
;

5828 
	}
}

5835 
sùp_§ckhdr
 *
	$sùp_sm_puÎ_§ck
(
sùp_chunk
 *
chunk
)

5837 
sùp_§ckhdr
 *
§ck
;

5838 
Ën
;

5839 
__u16
 
num_blocks
;

5840 
__u16
 
num_dup_t¢s
;

5845 
§ck
 = (
sùp_§ckhdr
 *è
chunk
->
skb
->
d©a
;

5847 
num_blocks
 = 
	`Áohs
(
§ck
->
num_g­_ack_blocks
);

5848 
num_dup_t¢s
 = 
	`Áohs
(
§ck
->num_dup_tsns);

5849 
Ën
 = (
sùp_§ckhdr
);

5850 
Ën
 +ğ(
num_blocks
 + 
num_dup_t¢s
è* (
__u32
);

5851 ià(
Ën
 > 
chunk
->
skb
->len)

5852  
NULL
;

5854 
	`skb_puÎ
(
chunk
->
skb
, 
Ën
);

5856  
§ck
;

5857 
	}
}

5862 
sùp_·ck‘
 *
	$sùp_abÜt_pkt_Ãw
(cÚ¡ 
sùp_’dpošt
 *
•
,

5863 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5864 
sùp_chunk
 *
chunk
,

5865 cÚ¡ *
·ylßd
,

5866 
size_t
 
·yËn
)

5868 
sùp_·ck‘
 *
·ck‘
;

5869 
sùp_chunk
 *
abÜt
;

5871 
·ck‘
 = 
	`sùp_oÙb_pkt_Ãw
(
asoc
, 
chunk
);

5873 ià(
·ck‘
) {

5877 
abÜt
 = 
	`sùp_make_abÜt
(
asoc
, 
chunk
, 
·yËn
);

5878 ià(!
abÜt
) {

5879 
	`sùp_oÙb_pkt_ä“
(
·ck‘
);

5880  
NULL
;

5884 ià(
	`sùp_‹¡_T_b™
(
abÜt
))

5885 
·ck‘
->
vg
 = 
	`Áohl
(
chunk
->
sùp_hdr
->vtag);

5890 
	`sùp_addto_chunk
(
abÜt
, 
·yËn
, 
·ylßd
);

5893 
abÜt
->
skb
->
sk
 = 
•
->
ba£
.sk;

5895 
	`sùp_·ck‘_­³nd_chunk
(
·ck‘
, 
abÜt
);

5899  
·ck‘
;

5900 
	}
}

5903 
sùp_·ck‘
 *
	$sùp_oÙb_pkt_Ãw
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5904 cÚ¡ 
sùp_chunk
 *
chunk
)

5906 
sùp_·ck‘
 *
·ck‘
;

5907 
sùp_Œª¥Üt
 *
Œª¥Üt
;

5908 
__u16
 
¥Üt
;

5909 
__u16
 
dpÜt
;

5910 
__u32
 
vg
;

5913 
¥Üt
 = 
	`Áohs
(
chunk
->
sùp_hdr
->
de¡
);

5914 
dpÜt
 = 
	`Áohs
(
chunk
->
sùp_hdr
->
sourû
);

5919 ià(
asoc
) {

5923 
chunk
->
chunk_hdr
->
ty³
) {

5924 
SCTP_CID_INIT_ACK
:

5926 
sùp_š™ack_chunk_t
 *
š™ack
;

5928 
š™ack
 = (
sùp_š™ack_chunk_t
 *)
chunk
->
chunk_hdr
;

5929 
vg
 = 
	`Áohl
(
š™ack
->
š™_hdr
.
š™_g
);

5933 
vg
 = 
asoc
->
³”
.
i
.
š™_g
;

5940 
chunk
->
chunk_hdr
->
ty³
) {

5941 
SCTP_CID_INIT
:

5943 
sùp_š™_chunk_t
 *
š™
;

5945 
š™
 = (
sùp_š™_chunk_t
 *)
chunk
->
chunk_hdr
;

5946 
vg
 = 
	`Áohl
(
š™
->
š™_hdr
.
š™_g
);

5950 
vg
 = 
	`Áohl
(
chunk
->
sùp_hdr
->vtag);

5956 
Œª¥Üt
 = 
	`sùp_Œª¥Üt_Ãw
(
	`sùp_sourû
(
chunk
), 
GFP_ATOMIC
);

5957 ià(!
Œª¥Üt
)

5958 
nomem
;

5963 
	`sùp_Œª¥Üt_rou‹
(
Œª¥Üt
, (
sùp_addr
 *)&
chunk
->
de¡
,

5964 
	`sùp_sk
(
	`sùp_g‘_ùl_sock
()));

5966 
·ck‘
 = 
	`sùp_·ck‘_š™
(&
Œª¥Üt
->·ck‘,¿n¥Üt, 
¥Üt
, 
dpÜt
);

5967 
·ck‘
 = 
	`sùp_·ck‘_cÚfig
Õack‘, 
vg
, 0);

5969  
·ck‘
;

5971 
nomem
:

5972  
NULL
;

5973 
	}
}

5976 
	$sùp_oÙb_pkt_ä“
(
sùp_·ck‘
 *
·ck‘
)

5978 
	`sùp_Œª¥Üt_ä“
(
·ck‘
->
Œª¥Üt
);

5979 
	}
}

5982 
	$sùp_£nd_¡®e_cook›_”r
(cÚ¡ 
sùp_’dpošt
 *
•
,

5983 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

5984 cÚ¡ 
sùp_chunk
 *
chunk
,

5985 
sùp_cmd_£q_t
 *
commªds
,

5986 
sùp_chunk
 *
”r_chunk
)

5988 
sùp_·ck‘
 *
·ck‘
;

5990 ià(
”r_chunk
) {

5991 
·ck‘
 = 
	`sùp_oÙb_pkt_Ãw
(
asoc
, 
chunk
);

5992 ià(
·ck‘
) {

5993 
sùp_sigÃd_cook›
 *
cook›
;

5996 
cook›
 = 
chunk
->
subh
.
cook›_hdr
;

5997 
·ck‘
->
vg
 = 
cook›
->
c
.
³”_vg
;

6000 
”r_chunk
->
skb
->
sk
 = 
•
->
ba£
.sk;

6001 
	`sùp_·ck‘_­³nd_chunk
(
·ck‘
, 
”r_chunk
);

6002 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SEND_PKT
,

6003 
	`SCTP_PACKET
(
·ck‘
));

6004 
	`SCTP_INC_STATS
(
SCTP_MIB_OUTCTRLCHUNKS
);

6006 
	`sùp_chunk_ä“
 (
”r_chunk
);

6008 
	}
}

6012 
	$sùp_—t_d©a
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

6013 
sùp_chunk
 *
chunk
,

6014 
sùp_cmd_£q_t
 *
commªds
)

6016 
sùp_d©ahdr_t
 *
d©a_hdr
;

6017 
sùp_chunk
 *
”r
;

6018 
size_t
 
d©®’
;

6019 
sùp_v”b_t
 
d–iv”
;

6020 
tmp
;

6021 
__u32
 
t¢
;

6022 
sùp_assocŸtiÚ
 *
shadow
 = (sùp_assocŸtiÚ *)
asoc
;

6023 
sùp_t¢m­
 *
m­
 = (sùp_t¢m­ *)&
asoc
->
³”
.
t¢_m­
;

6024 
sùp_s¢m­
 *
s¢m
 = 
asoc
->
s¢m­
;

6025 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

6026 
u16
 
s¢
;

6027 
u16
 
sid
;

6028 
u8
 
Üd”ed
 = 0;

6030 
d©a_hdr
 = 
chunk
->
subh
.d©a_hd¸ğ(
sùp_d©ahdr_t
 *)chunk->
skb
->
d©a
;

6031 
	`skb_puÎ
(
chunk
->
skb
, (
sùp_d©ahdr_t
));

6033 
t¢
 = 
	`Áohl
(
d©a_hdr
->tsn);

6034 
	`SCTP_DEBUG_PRINTK
("—t_d©a: TSN 0x%x.\n", 
t¢
);

6048 ià(!
chunk
->
eú_û_dÚe
) {

6049 
sùp_af
 *
af
;

6050 
chunk
->
eú_û_dÚe
 = 1;

6052 
af
 = 
	`sùp_g‘_af_¥ecific
(

6053 
	`v”2af
(
	`_hdr
(
chunk
->
skb
)->
v”siÚ
));

6055 ià(
af
 &&‡f->
	`is_û
(
chunk
->
skb
è&& 
asoc
->
³”
.
eú_ÿ·bË
) {

6057 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ECN_CE
,

6058 
	`SCTP_U32
(
t¢
));

6070 
sid
 = 
	`Áohs
(
d©a_hdr
->
¡»am
);

6071 ià(
sid
 >ğ
asoc
->
c
.
sš™_max_š¡»ams
) {

6073 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_TSN
, 
	`SCTP_U32
(
t¢
));

6075 
”r
 = 
	`sùp_make_İ_”rÜ
(
asoc
, 
chunk
, 
SCTP_ERROR_INV_STRM
,

6076 &
d©a_hdr
->
¡»am
,

6077 (
d©a_hdr
->
¡»am
),

6078 (
u16
));

6079 ià(
”r
)

6080 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

6081 
	`SCTP_CHUNK
(
”r
));

6082  
SCTP_IERROR_BAD_STREAM
;

6086 if(
asoc
->
bkup_d©a
)

6088 
	`´štk
("SCTP HO:adjusting datasn\n");

6089 
s¢m
->
š
.
s¢
[
sid
] = 
	`Áohs
(
d©a_hdr
->ssn);

6090 
m­
->
cumuÏtive_t¢_ack_pošt
 = 
t¢
 - 1;

6091 
m­
->
ba£_t¢
 = 
t¢
;

6092 
shadow
->
bkup_d©a
 = 0;

6094 
tmp
 = 
	`sùp_t¢m­_check
(&
asoc
->
³”
.
t¢_m­
, 
t¢
);

6095 ià(
tmp
 < 0)

6100 
	`´štk
("sùp_t¢m­_checkƒ¼Ü¢oØhigh %d\n", 
tmp
);

6101  
SCTP_IERROR_HIGH_TSN
;

6102 } ià(
tmp
 > 0) {

6104 
	`´štk
("sùp_t¢m­_checkƒ¼Ü du¶iÿ‹ %d\n", 
tmp
);

6105 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPORT_DUP
, 
	`SCTP_U32
(
t¢
));

6106  
SCTP_IERROR_DUP_TSN
;

6114 
d©®’
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

6115 
d©®’
 -ğ(
sùp_d©a_chunk_t
);

6117 
d–iv”
 = 
SCTP_CMD_CHUNK_ULP
;

6120 ià((
d©®’
 >ğ
asoc
->
rwnd
è&& (!asoc->
uÍq
.
pd_mode
)) {

6125 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_PART_DELIVER
, 
	`SCTP_NULL
());

6133 ià((!
chunk
->
d©a_acû±ed
è&& (!
asoc
->
rwnd
 ||‡soc->
rwnd_ov”
 ||

6134 (
d©®’
 > 
asoc
->
rwnd
 +‡soc->
äag_pošt
))) {

6142 ià(
	`sùp_t¢m­_has_g­
(
m­
) &&

6143 (
	`sùp_t¢m­_g‘_ù¢
(
m­
è+ 1è=ğ
t¢
) {

6144 
	`SCTP_DEBUG_PRINTK
("R’egšg fÜ¢:%u\n", 
t¢
);

6145 
d–iv”
 = 
SCTP_CMD_RENEGE
;

6147 
	`SCTP_DEBUG_PRINTK
("Discardsn: %u†en: %Zd, "

6148 "rwnd: %d\n", 
t¢
, 
d©®’
,

6149 
asoc
->
rwnd
);

6150  
SCTP_IERROR_IGNORE_TSN
;

6161 ià(*
sk
->
sk_´Ù_ü—tÜ
->
memÜy_´essu»
) {

6162 ià(
	`sùp_t¢m­_has_g­
(
m­
) &&

6163 (
	`sùp_t¢m­_g‘_ù¢
(
m­
è+ 1è=ğ
t¢
) {

6164 
	`SCTP_DEBUG_PRINTK
("Und” P»ssu»! R’egšg fÜ¢:%u\n", 
t¢
);

6165 
d–iv”
 = 
SCTP_CMD_RENEGE
;

6177 ià(
	`uÆik–y
(0 =ğ
d©®’
)) {

6178 
”r
 = 
	`sùp_make_abÜt_no_d©a
(
asoc
, 
chunk
, 
t¢
);

6179 ià(
”r
) {

6180 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_REPLY
,

6181 
	`SCTP_CHUNK
(
”r
));

6186 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_DISCARD_PACKET
,
	`SCTP_NULL
());

6187 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_SET_SK_ERR
,

6188 
	`SCTP_ERROR
(
ECONNABORTED
));

6189 
	`sùp_add_cmd_sf
(
commªds
, 
SCTP_CMD_ASSOC_FAILED
,

6190 
	`SCTP_PERR
(
SCTP_ERROR_NO_DATA
));

6191 
	`SCTP_INC_STATS
(
SCTP_MIB_ABORTEDS
);

6192 
	`SCTP_DEC_STATS
(
SCTP_MIB_CURRESTAB
);

6193  
SCTP_IERROR_NO_DATA
;

6196 
chunk
->
d©a_acû±ed
 = 1;

6201 ià(
chunk
->
chunk_hdr
->
æags
 & 
SCTP_DATA_UNORDERED
)

6202 
	`SCTP_INC_STATS
(
SCTP_MIB_INUNORDERCHUNKS
);

6204 
	`SCTP_INC_STATS
(
SCTP_MIB_INORDERCHUNKS
);

6205 
Üd”ed
 = 1;

6217 
s¢
 = 
	`Áohs
(
d©a_hdr
->ssn);

6218 ià(
Üd”ed
 && 
	`SSN_É
(
s¢
, 
	`sùp_s¢_³ek
(&
asoc
->
s¢m­
->
š
, 
sid
))) {

6219  
SCTP_IERROR_PROTO_VIOLATION
;

6226 
	`sùp_add_cmd_sf
(
commªds
, 
d–iv”
, 
	`SCTP_CHUNK
(
chunk
));

6228  
SCTP_IERROR_NO_ERROR
;

6229 
	}
}

	@sm_statetable.c

49 
	~<lšux/skbuff.h
>

50 
	~<Ãt/sùp/sùp.h
>

51 
	~<Ãt/sùp/sm.h
>

53 cÚ¡ 
sùp_sm_bË_’Œy_t


54 
	g´im™ive_ev’t_bË
[
SCTP_NUM_PRIMITIVE_TYPES
][
SCTP_STATE_NUM_STATES
];

55 cÚ¡ 
sùp_sm_bË_’Œy_t


56 
	gÙh”_ev’t_bË
[
SCTP_NUM_OTHER_TYPES
][
SCTP_STATE_NUM_STATES
];

57 cÚ¡ 
sùp_sm_bË_’Œy_t


58 
	gtimeout_ev’t_bË
[
SCTP_NUM_TIMEOUT_TYPES
][
SCTP_STATE_NUM_STATES
];

60 cÚ¡ 
sùp_sm_bË_’Œy_t
 *
sùp_chunk_ev’t_lookup
(
sùp_cid_t
 
cid
,

61 
sùp_¡©e_t
 
¡©e
);

63 
	#SCTP_STATE_BACKUP
 
SCTP_STATE_SHUTDOWN_ACK_SENT
+1

	)

64 cÚ¡ 
sùp_sm_bË_’Œy_t
 
	gbug
 = {

65 .
â
 = 
sùp_sf_bug
,

66 .
	gÇme
 = "sctp_sf_bug"

69 
	#DO_LOOKUP
(
_max
, 
_ty³
, 
_bË
) \

70 ià((
ev’t_subty³
.
_ty³
 > (
_max
))) { \

71 
	`´štk
(
KERN_WARNING
 \

74 
_bË
, 
ev’t_subty³
.
_ty³
, 
_max
); \

75  &
bug
; \

77  &
_bË
[
ev’t_subty³
.
_ty³
][()
¡©e
];

	)

79 cÚ¡ 
sùp_sm_bË_’Œy_t
 *
	$sùp_sm_lookup_ev’t
(
sùp_ev’t_t
 
ev’t_ty³
,

80 
sùp_¡©e_t
 
¡©e
,

81 
sùp_subty³_t
 
ev’t_subty³
)

83 
ev’t_ty³
) {

84 
SCTP_EVENT_T_CHUNK
:

85  
	`sùp_chunk_ev’t_lookup
(
ev’t_subty³
.
chunk
, 
¡©e
);

87 
SCTP_EVENT_T_TIMEOUT
:

88 
	`DO_LOOKUP
(
SCTP_EVENT_TIMEOUT_MAX
, 
timeout
,

89 
timeout_ev’t_bË
);

92 
SCTP_EVENT_T_OTHER
:

93 
	`DO_LOOKUP
(
SCTP_EVENT_OTHER_MAX
, 
Ùh”
, 
Ùh”_ev’t_bË
);

96 
SCTP_EVENT_T_PRIMITIVE
:

97 
	`DO_LOOKUP
(
SCTP_EVENT_PRIMITIVE_MAX
, 
´im™ive
,

98 
´im™ive_ev’t_bË
);

103  &
bug
;

105 
	}
}

107 
	#TYPE_SCTP_FUNC
(
func
è{.
â
 = func, .
Çme
 = #func}

	)

109 
	#TYPE_SCTP_DATA
 { \

111 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

113 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

115 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

117 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

119 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_d©a_6_2
), \

121 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_d©a_6_2
), \

123 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_d©a_ç¡_4_4
), \

125 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

127 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

128 }

	)

130 
	#TYPE_SCTP_INIT
 { \

132 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

134 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_1B_š™
), \

136 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_1_simš™
), \

138 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_1_simš™
), \

140 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_2_dupš™
), \

142 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_2_dupš™
), \

144 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_2_dupš™
), \

146 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_2_dupš™
), \

148 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_»shuck
), \

149 }

	)

151 
	#TYPE_SCTP_INIT_ACK
 { \

153 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

155 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_3_š™ack
), \

157 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_1C_ack
), \

159 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

161 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

163 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

165 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

167 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

169 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

170 }

	)

172 
	#TYPE_SCTP_SACK
 { \

174 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

176 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

178 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

180 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_§ck_6_2
), \

182 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_§ck_6_2
), \

184 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_§ck_6_2
), \

186 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

188 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_§ck_6_2
), \

190 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

191 }

	)

193 
	#TYPE_SCTP_HEARTBEAT
 { \

195 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

197 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

199 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

201 
	`TYPE_SCTP_FUNC
(
sùp_sf_b—t_8_3
), \

203 
	`TYPE_SCTP_FUNC
(
sùp_sf_b—t_8_3
), \

205 
	`TYPE_SCTP_FUNC
(
sùp_sf_b—t_8_3
), \

207 
	`TYPE_SCTP_FUNC
(
sùp_sf_b—t_8_3
), \

209 
	`TYPE_SCTP_FUNC
(
sùp_sf_b—t_8_3
), \

212 
	`TYPE_SCTP_FUNC
(
sùp_sf_b—t_8_3
), \

213 }

	)

215 
	#TYPE_SCTP_HEARTBEAT_ACK
 { \

217 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

219 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

221 
	`TYPE_SCTP_FUNC
(
sùp_sf_viŞ©iÚ
), \

223 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

225 
	`TYPE_SCTP_FUNC
(
sùp_sf_backb—t_8_3
), \

227 
	`TYPE_SCTP_FUNC
(
sùp_sf_backb—t_8_3
), \

229 
	`TYPE_SCTP_FUNC
(
sùp_sf_backb—t_8_3
), \

231 
	`TYPE_SCTP_FUNC
(
sùp_sf_backb—t_8_3
), \

233 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

234 }

	)

236 
	#TYPE_SCTP_ABORT
 { \

238 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

240 
	`TYPE_SCTP_FUNC
(
sùp_sf_pdisÿrd
), \

242 
	`TYPE_SCTP_FUNC
(
sùp_sf_cook›_wa™_abÜt
), \

244 
	`TYPE_SCTP_FUNC
(
sùp_sf_cook›_echÛd_abÜt
), \

246 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_1_abÜt
), \

248 
	`TYPE_SCTP_FUNC
(
sùp_sf_shutdown_³ndšg_abÜt
), \

250 
	`TYPE_SCTP_FUNC
(
sùp_sf_shutdown_£Á_abÜt
), \

252 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_1_abÜt
), \

254 
	`TYPE_SCTP_FUNC
(
sùp_sf_shutdown_ack_£Á_abÜt
), \

255 }

	)

257 
	#TYPE_SCTP_SHUTDOWN
 { \

259 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

261 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

263 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

265 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

267 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_shutdown
), \

269 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_shutdown
), \

271 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_shutdown_ack
), \

273 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_shut_ù¢
), \

275 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

276 }

	)

278 
	#TYPE_SCTP_SHUTDOWN_ACK
 { \

280 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

282 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

284 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_8_5_1_E_§
), \

286 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_8_5_1_E_§
), \

288 
	`TYPE_SCTP_FUNC
(
sùp_sf_viŞ©iÚ
), \

290 
	`TYPE_SCTP_FUNC
(
sùp_sf_viŞ©iÚ
), \

292 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_fš®
), \

294 
	`TYPE_SCTP_FUNC
(
sùp_sf_viŞ©iÚ
), \

296 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_fš®
), \

297 }

	)

299 
	#TYPE_SCTP_ERROR
 { \

301 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

303 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

305 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

307 
	`TYPE_SCTP_FUNC
(
sùp_sf_cook›_echÛd_”r
), \

309 
	`TYPE_SCTP_FUNC
(
sùp_sf_İ”r_nÙify
), \

311 
	`TYPE_SCTP_FUNC
(
sùp_sf_İ”r_nÙify
), \

313 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

315 
	`TYPE_SCTP_FUNC
(
sùp_sf_İ”r_nÙify
), \

317 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

318 }

	)

320 
	#TYPE_SCTP_COOKIE_ECHO
 { \

322 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

324 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_1D_û
), \

326 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_4_dupcook
), \

328 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_4_dupcook
), \

330 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_4_dupcook
), \

332 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_4_dupcook
), \

334 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_4_dupcook
), \

336 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_4_dupcook
), \

338 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_2_4_dupcook
), \

339 }

	)

341 
	#TYPE_SCTP_COOKIE_ACK
 { \

343 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

345 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

347 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

349 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_5_1E_ÿ
), \

351 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

353 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

355 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

357 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

359 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

360 }

	)

362 
	#TYPE_SCTP_ECN_ECNE
 { \

364 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

366 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

368 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

370 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_eúe
), \

372 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_eúe
), \

374 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_eúe
), \

376 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_eúe
), \

378 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_eúe
), \

380 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

381 }

	)

383 
	#TYPE_SCTP_ECN_CWR
 { \

385 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

387 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

389 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

391 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

393 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_eú_cwr
), \

395 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_eú_cwr
), \

397 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_eú_cwr
), \

399 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

401 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

402 }

	)

404 
	#TYPE_SCTP_SHUTDOWN_COMPLETE
 { \

406 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

408 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

410 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

412 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

414 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

416 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

418 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

420 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

422 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_4_C
), \

423 }

	)

430 cÚ¡ 
sùp_sm_bË_’Œy_t
 
	gchunk_ev’t_bË
[
SCTP_NUM_BASE_CHUNK_TYPES
][
SCTP_STATE_NUM_STATES
] = {

431 
TYPE_SCTP_DATA
,

432 
TYPE_SCTP_INIT
,

433 
TYPE_SCTP_INIT_ACK
,

434 
TYPE_SCTP_SACK
,

435 
TYPE_SCTP_HEARTBEAT
,

436 
TYPE_SCTP_HEARTBEAT_ACK
,

437 
TYPE_SCTP_ABORT
,

438 
TYPE_SCTP_SHUTDOWN
,

439 
TYPE_SCTP_SHUTDOWN_ACK
,

440 
TYPE_SCTP_ERROR
,

441 
TYPE_SCTP_COOKIE_ECHO
,

442 
TYPE_SCTP_COOKIE_ACK
,

443 
TYPE_SCTP_ECN_ECNE
,

444 
TYPE_SCTP_ECN_CWR
,

445 
TYPE_SCTP_SHUTDOWN_COMPLETE
,

448 
	#TYPE_SCTP_ASCONF
 { \

450 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

452 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

454 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

456 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

458 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_ascÚf
), \

460 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_ascÚf
), \

462 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_ascÚf
), \

464 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_ascÚf
), \

466 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

467 }

	)

469 
	#TYPE_SCTP_ASCONF_ACK
 { \

471 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

473 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

475 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

477 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

479 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_ascÚf_ack
), \

481 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_ascÚf_ack
), \

483 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_ascÚf_ack
), \

485 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_ascÚf_ack
), \

487 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

488 }

	)

493 cÚ¡ 
sùp_sm_bË_’Œy_t
 
	gadd_chunk_ev’t_bË
[
SCTP_NUM_ADDIP_CHUNK_TYPES
][
SCTP_STATE_NUM_STATES
] = {

494 
TYPE_SCTP_ASCONF
,

495 
TYPE_SCTP_ASCONF_ACK
,

498 
	#TYPE_SCTP_FWD_TSN
 { \

500 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

502 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

504 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

506 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

508 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_fwd_t¢
), \

510 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_fwd_t¢
), \

512 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_fwd_t¢_ç¡
), \

514 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

516 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

517 }

	)

522 cÚ¡ 
sùp_sm_bË_’Œy_t
 
	g´sùp_chunk_ev’t_bË
[
SCTP_NUM_PRSCTP_CHUNK_TYPES
][
SCTP_STATE_NUM_STATES
] = {

523 
TYPE_SCTP_FWD_TSN
,

526 
	#TYPE_SCTP_AUTH
 { \

528 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

530 
	`TYPE_SCTP_FUNC
(
sùp_sf_oÙb
), \

532 
	`TYPE_SCTP_FUNC
(
sùp_sf_disÿrd_chunk
), \

534 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_auth
), \

536 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_auth
), \

538 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_auth
), \

540 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_auth
), \

542 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_auth
), \

544 
	`TYPE_SCTP_FUNC
(
sùp_sf_—t_auth
), \

545 }

	)

550 cÚ¡ 
sùp_sm_bË_’Œy_t
 
	gauth_chunk_ev’t_bË
[
SCTP_NUM_AUTH_CHUNK_TYPES
][
SCTP_STATE_NUM_STATES
] = {

551 
TYPE_SCTP_AUTH
,

554 cÚ¡ 
sùp_sm_bË_’Œy_t


555 
	gchunk_ev’t_bË_unknown
[
SCTP_STATE_NUM_STATES
] = {

557 
TYPE_SCTP_FUNC
(
sùp_sf_oÙb
),

559 
TYPE_SCTP_FUNC
(
sùp_sf_oÙb
),

561 
TYPE_SCTP_FUNC
(
sùp_sf_unk_chunk
),

563 
TYPE_SCTP_FUNC
(
sùp_sf_unk_chunk
),

565 
TYPE_SCTP_FUNC
(
sùp_sf_unk_chunk
),

567 
TYPE_SCTP_FUNC
(
sùp_sf_unk_chunk
),

569 
TYPE_SCTP_FUNC
(
sùp_sf_unk_chunk
),

571 
TYPE_SCTP_FUNC
(
sùp_sf_unk_chunk
),

573 
TYPE_SCTP_FUNC
(
sùp_sf_unk_chunk
),

577 
	#TYPE_SCTP_PRIMITIVE_ASSOCIATE
 { \

579 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

581 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_asoc
), \

583 
	`TYPE_SCTP_FUNC
(
sùp_sf_nÙ_im¶
), \

585 
	`TYPE_SCTP_FUNC
(
sùp_sf_nÙ_im¶
), \

587 
	`TYPE_SCTP_FUNC
(
sùp_sf_nÙ_im¶
), \

589 
	`TYPE_SCTP_FUNC
(
sùp_sf_nÙ_im¶
), \

591 
	`TYPE_SCTP_FUNC
(
sùp_sf_nÙ_im¶
), \

593 
	`TYPE_SCTP_FUNC
(
sùp_sf_nÙ_im¶
), \

595 
	`TYPE_SCTP_FUNC
(
sùp_sf_nÙ_im¶
), \

596 }

	)

598 
	#TYPE_SCTP_PRIMITIVE_SHUTDOWN
 { \

600 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

602 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_şo£d
), \

604 
	`TYPE_SCTP_FUNC
(
sùp_sf_cook›_wa™_´m_shutdown
), \

606 
	`TYPE_SCTP_FUNC
(
sùp_sf_cook›_echÛd_´m_shutdown
),\

608 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_´m_shutdown
), \

610 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_´im™ive
), \

612 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_´im™ive
), \

614 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_´im™ive
), \

616 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_´im™ive
), \

617 }

	)

619 
	#TYPE_SCTP_PRIMITIVE_ABORT
 { \

621 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

623 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_şo£d
), \

625 
	`TYPE_SCTP_FUNC
(
sùp_sf_cook›_wa™_´m_abÜt
), \

627 
	`TYPE_SCTP_FUNC
(
sùp_sf_cook›_echÛd_´m_abÜt
), \

629 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_1_´m_abÜt
), \

631 
	`TYPE_SCTP_FUNC
(
sùp_sf_shutdown_³ndšg_´m_abÜt
), \

633 
	`TYPE_SCTP_FUNC
(
sùp_sf_shutdown_£Á_´m_abÜt
), \

635 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_1_´m_abÜt
), \

637 
	`TYPE_SCTP_FUNC
(
sùp_sf_shutdown_ack_£Á_´m_abÜt
), \

638 }

	)

640 
	#TYPE_SCTP_PRIMITIVE_SEND
 { \

642 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

644 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_şo£d
), \

646 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_£nd
), \

648 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_£nd
), \

650 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_£nd
), \

652 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_shutdown
), \

654 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_shutdown
), \

656 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_shutdown
), \

658 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_shutdown
), \

659 }

	)

661 
	#TYPE_SCTP_PRIMITIVE_REQUESTHEARTBEAT
 { \

663 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

665 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_şo£d
), \

667 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_»que¡h—¹b—t
), \

669 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_»que¡h—¹b—t
), \

671 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_»que¡h—¹b—t
), \

673 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_»que¡h—¹b—t
), \

675 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_»que¡h—¹b—t
), \

677 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_»que¡h—¹b—t
), \

679 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_»que¡h—¹b—t
), \

680 }

	)

682 
	#TYPE_SCTP_PRIMITIVE_ASCONF
 { \

684 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

686 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_şo£d
), \

688 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_şo£d
), \

690 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_şo£d
), \

692 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_ascÚf
), \

694 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_ascÚf
), \

696 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_ascÚf
), \

698 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_´m_ascÚf
), \

700 
	`TYPE_SCTP_FUNC
(
sùp_sf_”rÜ_shutdown
), \

701 }

	)

706 cÚ¡ 
sùp_sm_bË_’Œy_t
 
	g´im™ive_ev’t_bË
[
SCTP_NUM_PRIMITIVE_TYPES
][
SCTP_STATE_NUM_STATES
] = {

707 
TYPE_SCTP_PRIMITIVE_ASSOCIATE
,

708 
TYPE_SCTP_PRIMITIVE_SHUTDOWN
,

709 
TYPE_SCTP_PRIMITIVE_ABORT
,

710 
TYPE_SCTP_PRIMITIVE_SEND
,

711 
TYPE_SCTP_PRIMITIVE_REQUESTHEARTBEAT
,

712 
TYPE_SCTP_PRIMITIVE_ASCONF
,

715 
	#TYPE_SCTP_OTHER_NO_PENDING_TSN
 { \

717 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

719 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

721 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

723 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

725 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_no_³ndšg_t¢
), \

727 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_¡¬t_shutdown
), \

729 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

731 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_9_2_shutdown_ack
), \

733 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

734 }

	)

736 
	#TYPE_SCTP_OTHER_ICMP_PROTO_UNREACH
 { \

738 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

740 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

742 
	`TYPE_SCTP_FUNC
(
sùp_sf_cook›_wa™_icmp_abÜt
), \

744 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

746 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

748 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

750 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

752 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

754 
	`TYPE_SCTP_FUNC
(
sùp_sf_ignÜe_Ùh”
), \

755 }

	)

757 cÚ¡ 
sùp_sm_bË_’Œy_t
 
	gÙh”_ev’t_bË
[
SCTP_NUM_OTHER_TYPES
][
SCTP_STATE_NUM_STATES
] = {

758 
TYPE_SCTP_OTHER_NO_PENDING_TSN
,

759 
TYPE_SCTP_OTHER_ICMP_PROTO_UNREACH
,

762 
	#TYPE_SCTP_EVENT_TIMEOUT_NONE
 { \

764 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

766 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

768 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

770 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

772 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

774 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

776 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

778 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

780 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

781 }

	)

783 
	#TYPE_SCTP_EVENT_TIMEOUT_T1_COOKIE
 { \

785 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

787 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

789 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

791 
	`TYPE_SCTP_FUNC
(
sùp_sf_t1_cook›_tim”_expœe
), \

793 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

795 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

797 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

799 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

801 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

802 }

	)

804 
	#TYPE_SCTP_EVENT_TIMEOUT_T1_INIT
 { \

806 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

808 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

810 
	`TYPE_SCTP_FUNC
(
sùp_sf_t1_š™_tim”_expœe
), \

812 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

814 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

816 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

818 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

820 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

822 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

823 }

	)

825 
	#TYPE_SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
 { \

827 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

829 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

831 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

833 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

835 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

837 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

839 
	`TYPE_SCTP_FUNC
(
sùp_sf_t2_tim”_expœe
), \

841 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

843 
	`TYPE_SCTP_FUNC
(
sùp_sf_t2_tim”_expœe
), \

844 }

	)

846 
	#TYPE_SCTP_EVENT_TIMEOUT_T3_RTX
 { \

848 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

850 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

852 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

854 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_6_3_3_¹x
), \

856 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_6_3_3_¹x
), \

858 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_6_3_3_¹x
), \

860 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

862 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_6_3_3_¹x
), \

864 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

865 }

	)

867 
	#TYPE_SCTP_EVENT_TIMEOUT_T4_RTO
 { \

869 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

871 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

873 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

875 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

877 
	`TYPE_SCTP_FUNC
(
sùp_sf_t4_tim”_expœe
), \

879 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

881 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

883 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

885 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

886 }

	)

888 
	#TYPE_SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
 { \

890 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

892 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

894 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

896 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

898 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

900 
	`TYPE_SCTP_FUNC
(
sùp_sf_t5_tim”_expœe
), \

902 
	`TYPE_SCTP_FUNC
(
sùp_sf_t5_tim”_expœe
), \

904 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

906 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

907 }

	)

909 
	#TYPE_SCTP_EVENT_TIMEOUT_HEARTBEAT
 { \

911 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

913 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

915 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

917 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

919 
	`TYPE_SCTP_FUNC
(
sùp_sf_£ndb—t_8_3
), \

921 
	`TYPE_SCTP_FUNC
(
sùp_sf_£ndb—t_8_3
), \

923 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

925 
	`TYPE_SCTP_FUNC
(
sùp_sf_£ndb—t_8_3
), \

927 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

928 }

	)

930 
	#TYPE_SCTP_EVENT_TIMEOUT_SACK
 { \

932 
	`TYPE_SCTP_FUNC
(
sùp_sf_bug
), \

934 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

936 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

938 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

940 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_6_2_§ck
), \

942 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_6_2_§ck
), \

944 
	`TYPE_SCTP_FUNC
(
sùp_sf_do_6_2_§ck
), \

946 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

948 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

949 }

	)

951 
	#TYPE_SCTP_EVENT_TIMEOUT_AUTOCLOSE
 { \

953 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

955 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

957 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

959 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

961 
	`TYPE_SCTP_FUNC
(
sùp_sf_autoşo£_tim”_expœe
), \

963 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

965 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

967 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

969 
	`TYPE_SCTP_FUNC
(
sùp_sf_tim”_ignÜe
), \

970 }

	)

972 cÚ¡ 
sùp_sm_bË_’Œy_t
 
	gtimeout_ev’t_bË
[
SCTP_NUM_TIMEOUT_TYPES
][
SCTP_STATE_NUM_STATES
] = {

973 
TYPE_SCTP_EVENT_TIMEOUT_NONE
,

974 
TYPE_SCTP_EVENT_TIMEOUT_T1_COOKIE
,

975 
TYPE_SCTP_EVENT_TIMEOUT_T1_INIT
,

976 
TYPE_SCTP_EVENT_TIMEOUT_T2_SHUTDOWN
,

977 
TYPE_SCTP_EVENT_TIMEOUT_T3_RTX
,

978 
TYPE_SCTP_EVENT_TIMEOUT_T4_RTO
,

979 
TYPE_SCTP_EVENT_TIMEOUT_T5_SHUTDOWN_GUARD
,

980 
TYPE_SCTP_EVENT_TIMEOUT_HEARTBEAT
,

981 
TYPE_SCTP_EVENT_TIMEOUT_SACK
,

982 
TYPE_SCTP_EVENT_TIMEOUT_AUTOCLOSE
,

985 cÚ¡ 
sùp_sm_bË_’Œy_t
 *
	$sùp_chunk_ev’t_lookup
(
sùp_cid_t
 
cid
,

986 
sùp_¡©e_t
 
¡©e
)

988 ià(
¡©e
 > 
SCTP_STATE_MAX
)

989  &
bug
;

991 ià(
cid
 <ğ
SCTP_CID_BASE_MAX
)

992  &
chunk_ev’t_bË
[
cid
][
¡©e
];

994 ià(
sùp_´sùp_’abË
) {

995 ià(
cid
 =ğ
SCTP_CID_FWD_TSN
)

996  &
´sùp_chunk_ev’t_bË
[0][
¡©e
];

999 ià(
sùp_add_’abË
) {

1000 ià(
cid
 =ğ
SCTP_CID_ASCONF
)

1001  &
add_chunk_ev’t_bË
[0][
¡©e
];

1003 ià(
cid
 =ğ
SCTP_CID_ASCONF_ACK
)

1004  &
add_chunk_ev’t_bË
[1][
¡©e
];

1007 ià(
sùp_auth_’abË
) {

1008 ià(
cid
 =ğ
SCTP_CID_AUTH
)

1009  &
auth_chunk_ev’t_bË
[0][
¡©e
];

1012  &
chunk_ev’t_bË_unknown
[
¡©e
];

1013 
	}
}

	@socket.c

60 
	~<lšux/ty³s.h
>

61 
	~<lšux/k”Ãl.h
>

62 
	~<lšux/wa™.h
>

63 
	~<lšux/time.h
>

64 
	~<lšux/.h
>

65 
	~<lšux/ÿ·b™y.h
>

66 
	~<lšux/fú.h
>

67 
	~<lšux/pŞl.h
>

68 
	~<lšux/š™.h
>

69 
	~<lšux/üy±o.h
>

71 
	~<Ãt/.h
>

72 
	~<Ãt/icmp.h
>

73 
	~<Ãt/rou‹.h
>

74 
	~<Ãt/v6.h
>

75 
	~<Ãt/š‘_commÚ.h
>

77 
	~<lšux/sock‘.h
>

78 
	~<Ãt/sock.h
>

79 
	~"u£r.h
"

80 
	~<Ãt/sùp/sùp.h
>

81 
	~<Ãt/sùp/sm.h
>

91 
sùp_cmd_Ãw_¡©e
(
sùp_cmd_£q_t
 *
cmds
,

92 
sùp_assocŸtiÚ
 *
asoc
,

93 
sùp_¡©e_t
 
¡©e
);

94 
	#ASOC_MSG
 1

	)

95 
	#UPDATE_MSG
 2

	)

96 
	#ASOC_CLIENT_MSG
 3

	)

98 
	s__sùp_aù


100 
sùp_addr
 
	maddr
;

101 
__u8
 
	m£ü‘_key
[
SCTP_HOW_MANY_SECRETS
][
SCTP_SECRET_SIZE
];

102 
	mcu¼’t_key
;

103 
__u32
 
	ma_rwnd
;

104 
__u32
 
	mš™Ÿl_t¢
;

105 
sùp_cook›
 
	mc
;

106 } 
	ttAsoc
;

108 
	s_upd©eEnb


110 
sùp_¡©e_t
 
	m¡©e
;

112 
__u32
 
	mÃxt_t¢
;

114 
__u32
 
	mhighe¡_§cked
;

116 
__u32
 
	mù¢_ack_pošt
;

118 
__u32
 
	madv_³”_ack_pošt
;

119 
__u32
 
	mcumuÏtive_t¢_ack_pošt
;

120 
__u32
 
	mba£_t¢
;

121 
__u32
 
	mËn
;

122 
__u16
 
	ms¢m­
[];

123 } 
	ttUpd©e
;

125 
	u_sockPL


127 
tAsoc
 
	ma
;

128 
tUpd©e
 
	mu
;

129 }
	ttSockPL
;

131 
	s_sockMsg


133 
	mty³
;

134 
sùp_assoc_t
 
	massoc_id
;

135 
tSockPL
 
	m¶
;

136 }
	ttSockMsg
;

138 
sùp_wr™—bË
(
sock
 *
sk
);

139 
sùp_wä“
(
sk_buff
 *
skb
);

140 
sùp_wa™_fÜ_¢dbuf
(
sùp_assocŸtiÚ
 *, *
timeo_p
,

141 
size_t
 
msg_Ën
);

142 
sùp_wa™_fÜ_·ck‘
(
sock
 * 
sk
, *
”r
, *
timeo_p
);

143 
sùp_wa™_fÜ_cÚÃù
(
sùp_assocŸtiÚ
 *, *
timeo_p
);

144 
sùp_wa™_fÜ_acû±
(
sock
 *
sk
, 
timeo
);

145 
sùp_wa™_fÜ_şo£
(
sock
 *
sk
, 
timeo
);

146 
sùp_af
 *
sùp_sockaddr_af
(
sùp_sock
 *
İt
,

147 
sùp_addr
 *
addr
, 
Ën
);

148 
sùp_bšdx_add
(
sock
 *, 
sockaddr
 *, );

149 
sùp_bšdx_»m
(
sock
 *, 
sockaddr
 *, );

150 
sùp_£nd_ascÚf_add_
(
sock
 *, 
sockaddr
 *, );

151 
sùp_£nd_ascÚf_d–_
(
sock
 *, 
sockaddr
 *, );

152 
sùp_£nd_ascÚf
(
sùp_assocŸtiÚ
 *
asoc
,

153 
sùp_chunk
 *
chunk
);

154 
sùp_do_bšd
(
sock
 *, 
sùp_addr
 *, );

155 
sùp_autobšd
(
sock
 *
sk
);

156 
sùp_sock_mig¿‹
(
sock
 *, sock *,

157 
sùp_assocŸtiÚ
 *, 
sùp_sock‘_ty³_t
);

158 *
	gsùp_hmac_®g
 = 
SCTP_COOKIE_HMAC_ALG
;

160 
kmem_ÿche
 *
sùp_buck‘_ÿch•
;

161 
sysùl_sùp_mem
[3];

162 
sysùl_sùp_rmem
[3];

163 
sysùl_sùp_wmem
[3];

165 
	gsùp_memÜy_´essu»
;

166 
©omic_t
 
	gsùp_memÜy_®loÿ‹d
;

167 
³rıu_couÁ”
 
	gsùp_sock‘s_®loÿ‹d
;

168 
sùp_assocŸtiÚ
 *
£tAssoc
(
sock
 *
sk
, 
tAsoc
 *
aù
, 
sùp_assoc_t
 
asocId
, 
ş›Á
);

170 
	$sùp_’‹r_memÜy_´essu»
(
sock
 *
sk
)

172 
sùp_memÜy_´essu»
 = 1;

173 
	}
}

177 
šlše
 
	$sùp_w¥aû
(
sùp_assocŸtiÚ
 *
asoc
)

179 
amt
;

181 ià(
asoc
->
•
->
¢dbuf_pŞicy
)

182 
amt
 = 
asoc
->
¢dbuf_u£d
;

184 
amt
 = 
	`sk_wmem_®loc_g‘
(
asoc
->
ba£
.
sk
);

186 ià(
amt
 >ğ
asoc
->
ba£
.
sk
->
sk_¢dbuf
) {

187 ià(
asoc
->
ba£
.
sk
->
sk_u£¾ocks
 & 
SOCK_SNDBUF_LOCK
)

188 
amt
 = 0;

190 
amt
 = 
	`sk_¡»am_w¥aû
(
asoc
->
ba£
.
sk
);

191 ià(
amt
 < 0)

192 
amt
 = 0;

195 
amt
 = 
asoc
->
ba£
.
sk
->
sk_¢dbuf
 -‡mt;

197  
amt
;

198 
	}
}

209 
šlše
 
	$sùp_£t_owÃr_w
(
sùp_chunk
 *
chunk
)

211 
sùp_assocŸtiÚ
 *
asoc
 = 
chunk
->asoc;

212 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

215 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

217 
	`skb_£t_owÃr_w
(
chunk
->
skb
, 
sk
);

219 
chunk
->
skb
->
de¡ruùÜ
 = 
sùp_wä“
;

221 *((
sùp_chunk
 **)(
chunk
->
skb
->
cb
)) = chunk;

223 
asoc
->
¢dbuf_u£d
 +ğ
	`SCTP_DATA_SNDSIZE
(
chunk
) +

224 (
sk_buff
) +

225 (
sùp_chunk
);

227 
	`©omic_add
((
sùp_chunk
), &
sk
->
sk_wmem_®loc
);

228 
sk
->
sk_wmem_queued
 +ğ
chunk
->
skb
->
Œuesize
;

229 
	`sk_mem_ch¬ge
(
sk
, 
chunk
->
skb
->
Œuesize
);

230 
	}
}

233 
šlše
 
	$sùp_v”ify_addr
(
sock
 *
sk
, 
sùp_addr
 *
addr
,

234 
Ën
)

236 
sùp_af
 *
af
;

239 
af
 = 
	`sùp_sockaddr_af
(
	`sùp_sk
(
sk
), 
addr
, 
Ën
);

240 ià(!
af
)

241  -
EINVAL
;

244 ià(!
af
->
	`addr_v®id
(
addr
, 
	`sùp_sk
(
sk
), 
NULL
))

245  -
EINVAL
;

247 ià(!
	`sùp_sk
(
sk
)->
pf
->
	`£nd_v”ify
(sùp_sk(sk), (
addr
)))

248  -
EINVAL
;

251 
	}
}

256 
sùp_assocŸtiÚ
 *
	$sùp_id2assoc
(
sock
 *
sk
, 
sùp_assoc_t
 
id
)

258 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

261 ià(!
	`sùp_¡yË
(
sk
, 
UDP
)) {

266 ià(!
	`sùp_s¡©e
(
sk
, 
ESTABLISHED
))

268 
	`´štk
("assocŸtiÚ‚Ùƒ¡ablished fÜ sock‘ %d\n",
id
);

269  
NULL
;

272 ià(!
	`li¡_em±y
(&
	`sùp_sk
(
sk
)->
•
->
asocs
))

274 
asoc
 = 
	`li¡_’Œy
(
	`sùp_sk
(
sk
)->
•
->
asocs
.
Ãxt
, 
sùp_assocŸtiÚ
,‡socs);

278 
	`´štk
("thassocŸtiÚ†i¡‡ˆfd %d i em±y\n", 
id
);

280  
asoc
;

284 ià(!
id
 || (id =ğ(
sùp_assoc_t
)-1))

285  
NULL
;

287 
	`¥š_lock_bh
(&
sùp_assocs_id_lock
);

288 
asoc
 = (
sùp_assocŸtiÚ
 *)
	`idr_fšd
(&
sùp_assocs_id
, ()
id
);

289 
	`¥š_uÆock_bh
(&
sùp_assocs_id_lock
);

291 ià(!
asoc
 || (asoc->
ba£
.
sk
 !ğskè||‡soc->ba£.
d—d
)

292  
NULL
;

294  
asoc
;

295 
	}
}

301 
sùp_Œª¥Üt
 *
	$sùp_addr_id2Œª¥Üt
(
sock
 *
sk
,

302 
sockaddr_¡Üage
 *
addr
,

303 
sùp_assoc_t
 
id
)

305 
sùp_assocŸtiÚ
 *
addr_asoc
 = 
NULL
, *
id_asoc
 = NULL;

306 
sùp_Œª¥Üt
 *
Œª¥Üt
;

307 
sùp_addr
 *
Ïddr
 = (sùp_add¸*)
addr
;

309 
addr_asoc
 = 
	`sùp_’dpošt_lookup_assoc
(
	`sùp_sk
(
sk
)->
•
,

310 
Ïddr
,

311 &
Œª¥Üt
);

313 ià(!
addr_asoc
)

314  
NULL
;

316 
id_asoc
 = 
	`sùp_id2assoc
(
sk
, 
id
);

317 ià(
id_asoc
 && (id_asoø!ğ
addr_asoc
))

318  
NULL
;

320 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
	`sùp_sk
(sk),

321 (
sùp_addr
 *)
addr
);

323  
Œª¥Üt
;

324 
	}
}

336 
SCTP_STATIC
 
	$sùp_bšd
(
sock
 *
sk
, 
sockaddr
 *
addr
, 
addr_Ën
)

338 
»tv®
 = 0;

340 
	`sùp_lock_sock
(
sk
);

342 
	`SCTP_DEBUG_PRINTK
("sctp_bind(sk: %p,‡ddr: %p,‡ddr_len: %d)\n",

343 
sk
, 
addr
, 
addr_Ën
);

346 ià(!
	`sùp_sk
(
sk
)->
•
->
ba£
.
bšd_addr
.
pÜt
)

347 
»tv®
 = 
	`sùp_do_bšd
(
sk
, (
sùp_addr
 *)
addr
,

348 
addr_Ën
);

350 
»tv®
 = -
EINVAL
;

352 
	`sùp_»Ëa£_sock
(
sk
);

354  
»tv®
;

355 
	}
}

357 
sùp_g‘_pÜt_loÿl
(
sock
 *, 
sùp_addr
 *);

360 
sùp_af
 *
	$sùp_sockaddr_af
(
sùp_sock
 *
İt
,

361 
sùp_addr
 *
addr
, 
Ën
)

363 
sùp_af
 *
af
;

366 ià(
Ën
 <  (
sockaddr
))

367  
NULL
;

370 ià(
addr
->
§
.
§_çmy
 =ğ
AF_INET6
 &&

371 
	`v6_addr_v4m­³d
(&
addr
->
v6
.
sš6_addr
)) {

372 ià(!
İt
->
pf
->
	`af_suµÜ‹d
(
AF_INET
, opt))

373  
NULL
;

376 ià(!
İt
->
pf
->
	`af_suµÜ‹d
(
addr
->
§
.
§_çmy
, opt))

377  
NULL
;

381 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§
.
§_çmy
);

383 ià(
Ën
 < 
af
->
sockaddr_Ën
)

384  
NULL
;

386  
af
;

387 
	}
}

390 
SCTP_STATIC
 
	$sùp_do_bšd
(
sock
 *
sk
, 
sùp_addr
 *
addr
, 
Ën
)

392 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

393 
sùp_’dpošt
 *
•
 = 
¥
->ep;

394 
sùp_bšd_addr
 *
bp
 = &
•
->
ba£
.
bšd_addr
;

395 
sùp_af
 *
af
;

396 
¢um
;

397 
»t
 = 0;

400 
af
 = 
	`sùp_sockaddr_af
(
¥
, 
addr
, 
Ën
);

401 ià(!
af
) {

402 
	`SCTP_DEBUG_PRINTK
("sctp_do_bind(sk: %p,‚ewaddr: %p,†en: %d) EINVAL\n",

403 
sk
, 
addr
, 
Ën
);

404  -
EINVAL
;

407 
¢um
 = 
	`Áohs
(
addr
->
v4
.
sš_pÜt
);

409 
	`SCTP_DEBUG_PRINTK_IPADDR
("sctp_do_bind(sk: %p,‚ew‡ddr: ",

411 
sk
,

412 
addr
,

413 
bp
->
pÜt
, 
¢um
,

414 
Ën
);

417 ià(!
¥
->
pf
->
	`bšd_v”ify
(¥, 
addr
))

418  -
EADDRNOTAVAIL
;

424 ià(
bp
->
pÜt
) {

425 ià(!
¢um
)

426 
¢um
 = 
bp
->
pÜt
;

427 ià(
¢um
 !ğ
bp
->
pÜt
) {

428 
	`SCTP_DEBUG_PRINTK
("sctp_do_bind:"

430 "%d.\n", 
¢um
, 
bp
->
pÜt
);

431  -
EINVAL
;

435 ià(
¢um
 && snum < 
PROT_SOCK
 && !
	`ÿ·bË
(
CAP_NET_BIND_SERVICE
))

436  -
EACCES
;

441 ià(
	`sùp_bšd_addr_m©ch
(
bp
, 
addr
, 
¥
))

442  -
EINVAL
;

448 
addr
->
v4
.
sš_pÜt
 = 
	`htÚs
(
¢um
);

449 ià((
»t
 = 
	`sùp_g‘_pÜt_loÿl
(
sk
, 
addr
))) {

450  -
EADDRINUSE
;

454 ià(!
bp
->
pÜt
)

455 
bp
->
pÜt
 = 
	`š‘_sk
(
sk
)->
num
;

460 
»t
 = 
	`sùp_add_bšd_addr
(
bp
, 
addr
, 
SCTP_ADDR_SRC
, 
GFP_ATOMIC
);

463 ià(!
»t
) {

464 
	`š‘_sk
(
sk
)->
¥Üt
 = 
	`htÚs
(š‘_sk(sk)->
num
);

465 
af
->
	`to_sk_§ddr
(
addr
, 
sk
);

468  
»t
;

469 
	}
}

481 
	$sùp_£nd_ascÚf
(
sùp_assocŸtiÚ
 *
asoc
,

482 
sùp_chunk
 *
chunk
)

484 
»tv®
 = 0;

489 ià(
asoc
->
add_Ï¡_ascÚf
) {

490 
	`li¡_add_
(&
chunk
->
li¡
, &
asoc
->
add_chunk_li¡
);

491 
out
;

495 
	`sùp_chunk_hŞd
(
chunk
);

496 
»tv®
 = 
	`sùp_´im™ive_ASCONF
(
asoc
, 
chunk
);

497 ià(
»tv®
)

498 
	`sùp_chunk_ä“
(
chunk
);

500 
asoc
->
add_Ï¡_ascÚf
 = 
chunk
;

502 
out
:

503  
»tv®
;

504 
	}
}

518 
	$sùp_bšdx_add
(
sock
 *
sk
, 
sockaddr
 *
addrs
, 
addrút
)

520 
út
;

521 
»tv®
 = 0;

522 *
addr_buf
;

523 
sockaddr
 *
§_addr
;

524 
sùp_af
 *
af
;

526 
	`SCTP_DEBUG_PRINTK
("sctp_bindx_add (sk: %p,‡ddrs: %p,‡ddrcnt: %d)\n",

527 
sk
, 
addrs
, 
addrút
);

529 
addr_buf
 = 
addrs
;

530 
út
 = 0; cÁ < 
addrút
; cnt++) {

534 
§_addr
 = (
sockaddr
 *)
addr_buf
;

535 
af
 = 
	`sùp_g‘_af_¥ecific
(
§_addr
->
§_çmy
);

536 ià(!
af
) {

537 
»tv®
 = -
EINVAL
;

538 
”r_bšdx_add
;

541 
»tv®
 = 
	`sùp_do_bšd
(
sk
, (
sùp_addr
 *)
§_addr
,

542 
af
->
sockaddr_Ën
);

544 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

546 
”r_bšdx_add
:

547 ià(
»tv®
 < 0) {

549 ià(
út
 > 0)

550 
	`sùp_bšdx_»m
(
sk
, 
addrs
, 
út
);

551  
»tv®
;

555  
»tv®
;

556 
	}
}

568 
	$sùp_£nd_ascÚf_add_
(
sock
 *
sk
,

569 
sockaddr
 *
addrs
,

570 
addrút
)

572 
sùp_sock
 *
¥
;

573 
sùp_’dpošt
 *
•
;

574 
sùp_assocŸtiÚ
 *
asoc
;

575 
sùp_bšd_addr
 *
bp
;

576 
sùp_chunk
 *
chunk
;

577 
sùp_sockaddr_’Œy
 *
Ïddr
;

578 
sùp_addr
 *
addr
;

579 
sùp_addr
 
§v—ddr
;

580 *
addr_buf
;

581 
sùp_af
 *
af
;

582 
li¡_h—d
 *
p
;

583 
i
;

584 
»tv®
 = 0;

586 ià(!
sùp_add_’abË
)

587  
»tv®
;

589 
¥
 = 
	`sùp_sk
(
sk
);

590 
•
 = 
¥
->ep;

592 
	`SCTP_DEBUG_PRINTK
("%s: (sk: %p,‡ddrs: %p,‡ddrcnt: %d)\n",

593 
__func__
, 
sk
, 
addrs
, 
addrút
);

595 
	`li¡_fÜ_—ch_’Œy
(
asoc
, &
•
->
asocs
,‡socs)

598 ià(!
asoc
->
³”
.
ascÚf_ÿ·bË
)

601 ià(
asoc
->
³”
.
add_di§bËd_mask
 & 
SCTP_PARAM_ADD_IP
)

604 ià(!
	`sùp_¡©e
(
asoc
, 
ESTABLISHED
))

612 
addr_buf
 = 
addrs
;

613 
i
 = 0; i < 
addrút
; i++)

615 
addr
 = (
sùp_addr
 *)
addr_buf
;

616 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
v4
.
sš_çmy
);

617 ià(!
af
)

619 
»tv®
 = -
EINVAL
;

620 
out
;

623 ià(
	`sùp_assoc_lookup_Ïddr
(
asoc
, 
addr
))

627 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

629 ià(
i
 < 
addrút
)

637 
bp
 = &
asoc
->
ba£
.
bšd_addr
;

638 
p
 = 
bp
->
add»ss_li¡
.
Ãxt
;

639 
Ïddr
 = 
	`li¡_’Œy
(
p
, 
sùp_sockaddr_’Œy
, 
li¡
);

640 
chunk
 = 
	`sùp_make_ascÚf_upd©e_
(
asoc
, &
Ïddr
->
a
, 
addrs
, 
addrút
, 
SCTP_PARAM_ADD_IP
);

641 ià(!
chunk
)

643 
»tv®
 = -
ENOMEM
;

644 
out
;

647 
»tv®
 = 
	`sùp_£nd_ascÚf
(
asoc
, 
chunk
);

648 ià(
»tv®
)

649 
out
;

654 
addr_buf
 = 
addrs
;

655 
i
 = 0; i < 
addrút
; i++) {

656 
addr
 = (
sùp_addr
 *)
addr_buf
;

657 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
v4
.
sš_çmy
);

658 
	`memıy
(&
§v—ddr
, 
addr
, 
af
->
sockaddr_Ën
);

659 
»tv®
 = 
	`sùp_add_bšd_addr
(
bp
, &
§v—ddr
,

660 
SCTP_ADDR_NEW
, 
GFP_ATOMIC
);

661 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

665 
out
:

666  
»tv®
;

667 
	}
}

684 
	$sùp_bšdx_»m
(
sock
 *
sk
, 
sockaddr
 *
addrs
, 
addrút
)

686 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

687 
sùp_’dpošt
 *
•
 = 
¥
->ep;

688 
út
;

689 
sùp_bšd_addr
 *
bp
 = &
•
->
ba£
.
bšd_addr
;

690 
»tv®
 = 0;

691 *
addr_buf
;

692 
sùp_addr
 *
§_addr
;

693 
sùp_af
 *
af
;

695 
	`SCTP_DEBUG_PRINTK
("sctp_bindx_rem (sk: %p,‡ddrs: %p,‡ddrcnt: %d)\n",

696 
sk
, 
addrs
, 
addrút
);

698 
addr_buf
 = 
addrs
;

699 
út
 = 0; cÁ < 
addrút
; cnt++) {

704 ià(
	`li¡_em±y
(&
bp
->
add»ss_li¡
) ||

705 (
	`sùp_li¡_sšgË_’Œy
(&
bp
->
add»ss_li¡
))) {

706 
»tv®
 = -
EBUSY
;

707 
”r_bšdx_»m
;

710 
§_addr
 = (
sùp_addr
 *)
addr_buf
;

711 
af
 = 
	`sùp_g‘_af_¥ecific
(
§_addr
->
§
.
§_çmy
);

712 ià(!
af
) {

713 
»tv®
 = -
EINVAL
;

714 
”r_bšdx_»m
;

717 ià(!
af
->
	`addr_v®id
(
§_addr
, 
¥
, 
NULL
)) {

718 
»tv®
 = -
EADDRNOTAVAIL
;

719 
”r_bšdx_»m
;

722 ià(
§_addr
->
v4
.
sš_pÜt
 &&

723 
§_addr
->
v4
.
sš_pÜt
 !ğ
	`htÚs
(
bp
->
pÜt
)) {

724 
»tv®
 = -
EINVAL
;

725 
”r_bšdx_»m
;

728 ià(!
§_addr
->
v4
.
sš_pÜt
)

729 
§_addr
->
v4
.
sš_pÜt
 = 
	`htÚs
(
bp
->
pÜt
);

738 
»tv®
 = 
	`sùp_d–_bšd_addr
(
bp
, 
§_addr
);

740 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

741 
”r_bšdx_»m
:

742 ià(
»tv®
 < 0) {

744 ià(
út
 > 0)

745 
	`sùp_bšdx_add
(
sk
, 
addrs
, 
út
);

746  
»tv®
;

750  
»tv®
;

751 
	}
}

763 
	$sùp_£nd_ascÚf_d–_
(
sock
 *
sk
,

764 
sockaddr
 *
addrs
,

765 
addrút
)

767 
sùp_sock
 *
¥
;

768 
sùp_’dpošt
 *
•
;

769 
sùp_assocŸtiÚ
 *
asoc
;

770 
sùp_Œª¥Üt
 *
Œª¥Üt
;

771 
sùp_bšd_addr
 *
bp
;

772 
sùp_chunk
 *
chunk
;

773 
sùp_addr
 *
Ïddr
;

774 *
addr_buf
;

775 
sùp_af
 *
af
;

776 
sùp_sockaddr_’Œy
 *
§ddr
;

777 
i
;

778 
»tv®
 = 0;

780 ià(!
sùp_add_’abË
)

781  
»tv®
;

783 
¥
 = 
	`sùp_sk
(
sk
);

784 
•
 = 
¥
->ep;

786 
	`SCTP_DEBUG_PRINTK
("%s: (sk: %p,‡ddrs: %p,‡ddrcnt: %d)\n",

787 
__func__
, 
sk
, 
addrs
, 
addrút
);

789 
	`li¡_fÜ_—ch_’Œy
(
asoc
, &
•
->
asocs
,‡socs) {

791 ià(!
asoc
->
³”
.
ascÚf_ÿ·bË
)

794 ià(
asoc
->
³”
.
add_di§bËd_mask
 & 
SCTP_PARAM_DEL_IP
)

797 ià(!
	`sùp_¡©e
(
asoc
, 
ESTABLISHED
))

805 
addr_buf
 = 
addrs
;

806 
i
 = 0; i < 
addrút
; i++) {

807 
Ïddr
 = (
sùp_addr
 *)
addr_buf
;

808 
af
 = 
	`sùp_g‘_af_¥ecific
(
Ïddr
->
v4
.
sš_çmy
);

809 ià(!
af
) {

810 
»tv®
 = -
EINVAL
;

811 
out
;

814 ià(!
	`sùp_assoc_lookup_Ïddr
(
asoc
, 
Ïddr
))

817 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

819 ià(
i
 < 
addrút
)

827 
bp
 = &
asoc
->
ba£
.
bšd_addr
;

828 
Ïddr
 = 
	`sùp_fšd_unm©ch_addr
(
bp
, (
sùp_addr
 *)
addrs
,

829 
addrút
, 
¥
);

830 ià(!
Ïddr
)

837 
chunk
 = 
	`sùp_make_ascÚf_upd©e_
(
asoc
, 
Ïddr
, 
addrs
, 
addrút
,

838 
SCTP_PARAM_DEL_IP
);

839 ià(!
chunk
) {

840 
»tv®
 = -
ENOMEM
;

841 
out
;

847 
addr_buf
 = 
addrs
;

848 
i
 = 0; i < 
addrút
; i++) {

849 
Ïddr
 = (
sùp_addr
 *)
addr_buf
;

850 
af
 = 
	`sùp_g‘_af_¥ecific
(
Ïddr
->
v4
.
sš_çmy
);

851 
	`li¡_fÜ_—ch_’Œy
(
§ddr
, &
bp
->
add»ss_li¡
, 
li¡
) {

852 ià(
	`sùp_cmp_addr_exaù
(&
§ddr
->
a
, 
Ïddr
))

853 
§ddr
->
¡©e
 = 
SCTP_ADDR_DEL
;

855 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

862 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

863 
Œª¥Üts
) {

864 
	`d¡_»Ëa£
(
Œª¥Üt
->
d¡
);

865 
	`sùp_Œª¥Üt_rou‹
(
Œª¥Üt
, 
NULL
,

866 
	`sùp_sk
(
asoc
->
ba£
.
sk
));

869 
»tv®
 = 
	`sùp_£nd_ascÚf
(
asoc
, 
chunk
);

871 
out
:

872  
»tv®
;

873 
	}
}

951 
SCTP_STATIC
 
	$sùp_£tsockİt_bšdx
(
sock
* 
sk
,

952 
sockaddr
 
__u£r
 *
addrs
,

953 
addrs_size
, 
İ
)

955 
sockaddr
 *
kaddrs
;

956 
”r
;

957 
addrút
 = 0;

958 
w®k_size
 = 0;

959 
sockaddr
 *
§_addr
;

960 *
addr_buf
;

961 
sùp_af
 *
af
;

963 
	`SCTP_DEBUG_PRINTK
("sctp_setsocktopt_bindx: sk %p‡ddrs %p"

964 "‡ddrs_siz%d o± %d\n", 
sk
, 
addrs
, 
addrs_size
, 
İ
);

966 ià(
	`uÆik–y
(
addrs_size
 <= 0))

967  -
EINVAL
;

970 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_READ
, 
addrs
, 
addrs_size
)))

971  -
EFAULT
;

974 
kaddrs
 = 
	`km®loc
(
addrs_size
, 
GFP_KERNEL
);

975 ià(
	`uÆik–y
(!
kaddrs
))

976  -
ENOMEM
;

978 ià(
	`__cİy_äom_u£r
(
kaddrs
, 
addrs
, 
addrs_size
)) {

979 
	`kä“
(
kaddrs
);

980  -
EFAULT
;

984 
addr_buf
 = 
kaddrs
;

985 
w®k_size
 < 
addrs_size
) {

986 ià(
w®k_size
 + (
§_çmy_t
è> 
addrs_size
) {

987 
	`kä“
(
kaddrs
);

988  -
EINVAL
;

991 
§_addr
 = (
sockaddr
 *)
addr_buf
;

992 
af
 = 
	`sùp_g‘_af_¥ecific
(
§_addr
->
§_çmy
);

997 ià(!
af
 || (
w®k_size
 +‡f->
sockaddr_Ën
è> 
addrs_size
) {

998 
	`kä“
(
kaddrs
);

999  -
EINVAL
;

1001 
addrút
++;

1002 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

1003 
w®k_size
 +ğ
af
->
sockaddr_Ën
;

1007 
İ
) {

1008 
SCTP_BINDX_ADD_ADDR
:

1009 
”r
 = 
	`sùp_bšdx_add
(
sk
, 
kaddrs
, 
addrút
);

1010 ià(
”r
)

1011 
out
;

1012 
”r
 = 
	`sùp_£nd_ascÚf_add_
(
sk
, 
kaddrs
, 
addrút
);

1015 
SCTP_BINDX_REM_ADDR
:

1016 
”r
 = 
	`sùp_bšdx_»m
(
sk
, 
kaddrs
, 
addrút
);

1017 ià(
”r
)

1018 
out
;

1019 
”r
 = 
	`sùp_£nd_ascÚf_d–_
(
sk
, 
kaddrs
, 
addrút
);

1023 
”r
 = -
EINVAL
;

1027 
out
:

1028 
	`kä“
(
kaddrs
);

1030  
”r
;

1031 
	}
}

1038 
	$__sùp_cÚÃù
(
sock
* 
sk
,

1039 
sockaddr
 *
kaddrs
,

1040 
addrs_size
,

1041 
sùp_assoc_t
 *
assoc_id
)

1043 
sùp_sock
 *
¥
;

1044 
sùp_’dpošt
 *
•
;

1045 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

1046 
sùp_assocŸtiÚ
 *
asoc2
;

1047 
sùp_Œª¥Üt
 *
Œª¥Üt
;

1048 
sùp_addr
 
to
;

1049 
sùp_af
 *
af
;

1050 
sùp_scİe_t
 
scİe
;

1051 
timeo
;

1052 
”r
 = 0;

1053 
addrút
 = 0;

1054 
w®k_size
 = 0;

1055 
sùp_addr
 *
§_addr
 = 
NULL
;

1056 *
addr_buf
;

1057 
pÜt
;

1058 
f_æags
 = 0;

1060 
¥
 = 
	`sùp_sk
(
sk
);

1061 
•
 = 
¥
->ep;

1068 ià(
	`sùp_s¡©e
(
sk
, 
ESTABLISHED
) ||

1069 (
	`sùp_¡yË
(
sk
, 
TCP
è&& 
	`sùp_s¡©e
(sk, 
LISTENING
))) {

1070 
”r
 = -
EISCONN
;

1071 
out_ä“
;

1075 
addr_buf
 = 
kaddrs
;

1076 
w®k_size
 < 
addrs_size
) {

1077 ià(
w®k_size
 + (
§_çmy_t
è> 
addrs_size
) {

1078 
”r
 = -
EINVAL
;

1079 
out_ä“
;

1082 
§_addr
 = (
sùp_addr
 *)
addr_buf
;

1083 
af
 = 
	`sùp_g‘_af_¥ecific
(
§_addr
->
§
.
§_çmy
);

1088 ià(!
af
 || (
w®k_size
 +‡f->
sockaddr_Ën
è> 
addrs_size
) {

1089 
”r
 = -
EINVAL
;

1090 
out_ä“
;

1093 
pÜt
 = 
	`Áohs
(
§_addr
->
v4
.
sš_pÜt
);

1096 
	`memıy
(&
to
, 
§_addr
, 
af
->
sockaddr_Ën
);

1098 
”r
 = 
	`sùp_v”ify_addr
(
sk
, &
to
, 
af
->
sockaddr_Ën
);

1099 ià(
”r
)

1100 
out_ä“
;

1105 ià(
asoc
 &&‡soc->
³”
.
pÜt
 &&‡soc->peer.port !=…ort)

1106 
out_ä“
;

1112 
asoc2
 = 
	`sùp_’dpošt_lookup_assoc
(
•
, &
to
, &
Œª¥Üt
);

1113 ià(
asoc2
 &&‡soc2 !ğ
asoc
) {

1114 ià(
asoc2
->
¡©e
 >ğ
SCTP_STATE_ESTABLISHED
)

1115 
”r
 = -
EISCONN
;

1117 
”r
 = -
EALREADY
;

1118 
out_ä“
;

1125 ià(
	`sùp_’dpošt_is_³–ed_off
(
•
, &
to
)) {

1126 
”r
 = -
EADDRNOTAVAIL
;

1127 
out_ä“
;

1130 ià(!
asoc
) {

1136 ià(!
•
->
ba£
.
bšd_addr
.
pÜt
) {

1137 ià(
	`sùp_autobšd
(
sk
)) {

1138 
”r
 = -
EAGAIN
;

1139 
out_ä“
;

1149 ià(
•
->
ba£
.
bšd_addr
.
pÜt
 < 
PROT_SOCK
 &&

1150 !
	`ÿ·bË
(
CAP_NET_BIND_SERVICE
)) {

1151 
”r
 = -
EACCES
;

1152 
out_ä“
;

1156 
scİe
 = 
	`sùp_scİe
(&
to
);

1157 
asoc
 = 
	`sùp_assocŸtiÚ_Ãw
(
•
, 
sk
, 
scİe
, 
GFP_KERNEL
);

1158 ià(!
asoc
) {

1159 
”r
 = -
ENOMEM
;

1160 
out_ä“
;

1163 
”r
 = 
	`sùp_assoc_£t_bšd_addr_äom_•
(
asoc
, 
scİe
,

1164 
GFP_KERNEL
);

1165 ià(
”r
 < 0) {

1166 
out_ä“
;

1172 
Œª¥Üt
 = 
	`sùp_assoc_add_³”
(
asoc
, &
to
, 
GFP_KERNEL
,

1173 
SCTP_UNKNOWN
);

1174 ià(!
Œª¥Üt
) {

1175 
”r
 = -
ENOMEM
;

1176 
out_ä“
;

1179 
addrút
++;

1180 
addr_buf
 +ğ
af
->
sockaddr_Ën
;

1181 
w®k_size
 +ğ
af
->
sockaddr_Ën
;

1187 ià(
assoc_id
) {

1188 
”r
 = 
	`sùp_assoc_£t_id
(
asoc
, 
GFP_KERNEL
);

1189 ià(
”r
 < 0)

1190 
out_ä“
;

1193 
”r
 = 
	`sùp_´im™ive_ASSOCIATE
(
asoc
, 
NULL
);

1194 ià(
”r
 < 0) {

1195 
out_ä“
;

1199 
	`š‘_sk
(
sk
)->
dpÜt
 = 
	`htÚs
(
asoc
->
³”
.
pÜt
);

1200 
af
 = 
	`sùp_g‘_af_¥ecific
(
§_addr
->
§
.
§_çmy
);

1201 
af
->
	`to_sk_daddr
(
§_addr
, 
sk
);

1202 
sk
->
sk_”r
 = 0;

1207 ià(
sk
->
sk_sock‘
->
fe
)

1208 
f_æags
 = 
sk
->
sk_sock‘
->
fe
->f_flags;

1210 
timeo
 = 
	`sock_¢dtimeo
(
sk
, 
f_æags
 & 
O_NONBLOCK
);

1212 
”r
 = 
	`sùp_wa™_fÜ_cÚÃù
(
asoc
, &
timeo
);

1213 ià((
”r
 =ğ0 ||ƒ¼ =ğ-
EINPROGRESS
è&& 
assoc_id
)

1214 *
assoc_id
 = 
asoc
->assoc_id;

1217 
asoc
 = 
NULL
;

1219 
out_ä“
:

1221 
	`SCTP_DEBUG_PRINTK
("Aboutoƒxit __sctp_connect() free‡soc: %p"

1223 
asoc
, 
kaddrs
, 
”r
);

1224 ià(
asoc
)

1225 
	`sùp_assocŸtiÚ_ä“
(
asoc
);

1226  
”r
;

1227 
	}
}

1291 
SCTP_STATIC
 
	$__sùp_£tsockİt_cÚÃùx
(
sock
* 
sk
,

1292 
sockaddr
 
__u£r
 *
addrs
,

1293 
addrs_size
,

1294 
sùp_assoc_t
 *
assoc_id
)

1296 
”r
 = 0;

1297 
sockaddr
 *
kaddrs
;

1299 
	`SCTP_DEBUG_PRINTK
("%s - sk %p‡ddrs %p‡ddrs_size %d\n",

1300 
__func__
, 
sk
, 
addrs
, 
addrs_size
);

1302 ià(
	`uÆik–y
(
addrs_size
 <= 0))

1303  -
EINVAL
;

1306 ià(
	`uÆik–y
(!
	`acûss_ok
(
VERIFY_READ
, 
addrs
, 
addrs_size
)))

1307  -
EFAULT
;

1310 
kaddrs
 = 
	`km®loc
(
addrs_size
, 
GFP_KERNEL
);

1311 ià(
	`uÆik–y
(!
kaddrs
))

1312  -
ENOMEM
;

1314 ià(
	`__cİy_äom_u£r
(
kaddrs
, 
addrs
, 
addrs_size
)) {

1315 
”r
 = -
EFAULT
;

1317 
”r
 = 
	`__sùp_cÚÃù
(
sk
, 
kaddrs
, 
addrs_size
, 
assoc_id
);

1320 
	`kä“
(
kaddrs
);

1322  
”r
;

1323 
	}
}

1329 
SCTP_STATIC
 
	$sùp_£tsockİt_cÚÃùx_Şd
(
sock
* 
sk
,

1330 
sockaddr
 
__u£r
 *
addrs
,

1331 
addrs_size
)

1333  
	`__sùp_£tsockİt_cÚÃùx
(
sk
, 
addrs
, 
addrs_size
, 
NULL
);

1334 
	}
}

1342 
SCTP_STATIC
 
	$sùp_£tsockİt_cÚÃùx
(
sock
* 
sk
,

1343 
sockaddr
 
__u£r
 *
addrs
,

1344 
addrs_size
)

1346 
sùp_assoc_t
 
assoc_id
 = 0;

1347 
”r
 = 0;

1349 
”r
 = 
	`__sùp_£tsockİt_cÚÃùx
(
sk
, 
addrs
, 
addrs_size
, &
assoc_id
);

1351 ià(
”r
)

1352  
”r
;

1354  
assoc_id
;

1355 
	}
}

1365 
SCTP_STATIC
 
	$sùp_g‘sockİt_cÚÃùx3
(
sock
* 
sk
, 
Ën
,

1366 
__u£r
 *
İtv®
,

1367 
__u£r
 *
İ’
)

1369 
sùp_g‘addrs_Şd
 
·¿m
;

1370 
sùp_assoc_t
 
assoc_id
 = 0;

1371 
”r
 = 0;

1373 ià(
Ën
 < (
·¿m
))

1374  -
EINVAL
;

1376 ià(
	`cİy_äom_u£r
(&
·¿m
, 
İtv®
, (param)))

1377  -
EFAULT
;

1379 
”r
 = 
	`__sùp_£tsockİt_cÚÃùx
(
sk
,

1380 (
sockaddr
 
__u£r
 *)
·¿m
.
addrs
,

1381 
·¿m
.
addr_num
, &
assoc_id
);

1383 ià(
”r
 =ğ0 ||ƒ¼ =ğ-
EINPROGRESS
) {

1384 ià(
	`cİy_to_u£r
(
İtv®
, &
assoc_id
, (assoc_id)))

1385  -
EFAULT
;

1386 ià(
	`put_u£r
((
assoc_id
), 
İ’
))

1387  -
EFAULT
;

1390  
”r
;

1391 
	}
}

1443 
SCTP_STATIC
 
	$sùp_şo£
(
sock
 *
sk
, 
timeout
)

1445 
sùp_’dpošt
 *
•
;

1446 
sùp_assocŸtiÚ
 *
asoc
;

1447 
li¡_h—d
 *
pos
, *
‹mp
;

1448 
d©a_was_uÄ—d
;

1450 
	`SCTP_DEBUG_PRINTK
("sùp_şo£(sk: 0x%p,imeout:%ld)\n", 
sk
, 
timeout
);

1452 
	`sùp_lock_sock
(
sk
);

1453 
sk
->
sk_shutdown
 = 
SHUTDOWN_MASK
;

1454 
sk
->
sk_¡©e
 = 
SCTP_SS_CLOSING
;

1456 
•
 = 
	`sùp_sk
(
sk
)->ep;

1459 
d©a_was_uÄ—d
 = 
	`sùp_queue_purge_uÍev’ts
(&
sk
->
sk_»ûive_queue
);

1460 
d©a_was_uÄ—d
 +ğ
	`sùp_queue_purge_uÍev’ts
(&
	`sùp_sk
(
sk
)->
pd_lobby
);

1463 
	`li¡_fÜ_—ch_§ã
(
pos
, 
‹mp
, &
•
->
asocs
) {

1464 
asoc
 = 
	`li¡_’Œy
(
pos
, 
sùp_assocŸtiÚ
, 
asocs
);

1465 
	`´štk
("sùp_şo£: closšg‡soø%°³” cook› %°pÜˆ%d\n", 
asoc
,‡soc->
³”
.
cook›
,‡soc->
c
.
my_pÜt
);

1467 ià(
	`sùp_¡yË
(
sk
, 
TCP
))

1476 
	`sùp_cmd_hb_tim”s_¡İ
(
sùp_cmd_£q_t
 *
cmds
, 
sùp_assocŸtiÚ
 *
asoc
);

1477 
	`sùp_unhash_e¡ablished
(
asoc
);

1478 
	`sùp_cmd_hb_tim”s_¡İ
(
NULL
,
asoc
);

1479 
	`sùp_assocŸtiÚ_ä“
(
asoc
);

1484 if(
asoc
->
³”
.
cook›
 &&‡soc->³”.
cook›_Ën
)

1486 
	`´štk
("sùp_şo£: shu‰šg dowÀasoø%°³” cook› %°pÜˆ%d\n", 
asoc
,‡soc->
³”
.
cook›
,‡soc->
c
.
my_pÜt
);

1488 ià(
d©a_was_uÄ—d
 || !
	`skb_queue_em±y
(&
asoc
->
uÍq
.
lobby
) ||

1489 !
	`skb_queue_em±y
(&
asoc
->
uÍq
.
»asm
) ||

1490 (
	`sock_æag
(
sk
, 
SOCK_LINGER
è&& !sk->
sk_lšg”time
))

1492 
sùp_chunk
 *
chunk
;

1494 
chunk
 = 
	`sùp_make_abÜt_u£r
(
asoc
, 
NULL
, 0);

1495 ià(
chunk
)

1497 
	`sùp_´im™ive_ABORT
(
asoc
, 
chunk
);

1502 
	`sùp_´im™ive_SHUTDOWN
(
asoc
, 
NULL
);

1512 
	`sùp_»Ëa£_sock
(
sk
);

1517 
	`sùp_loÿl_bh_di§bË
();

1518 
	`sùp_bh_lock_sock
(
sk
);

1523 
	`sock_hŞd
(
sk
);

1524 
	`sk_commÚ_»Ëa£
(
sk
);

1526 
	`sùp_bh_uÆock_sock
(
sk
);

1527 
	`sùp_loÿl_bh_’abË
();

1529 
	`sock_put
(
sk
);

1531 
	`SCTP_DBG_OBJCNT_DEC
(
sock
);

1532 
	}
}

1535 
	$sùp_”rÜ
(
sock
 *
sk
, 
æags
, 
”r
)

1537 ià(
”r
 =ğ-
EPIPE
)

1538 
”r
 = 
	`sock_”rÜ
(
sk
è? : -
EPIPE
;

1539 ià(
”r
 =ğ-
EPIPE
 && !(
æags
 & 
MSG_NOSIGNAL
))

1540 
	`£nd_sig
(
SIGPIPE
, 
cu¼’t
, 0);

1541  
”r
;

1542 
	}
}

1567 
SCTP_STATIC
 
sùp_msghdr_·r£
(cÚ¡ 
msghdr
 *, 
sùp_cmsgs_t
 *);

1569 
SCTP_STATIC
 
	$sùp_£ndmsg
(
kiocb
 *
iocb
, 
sock
 *
sk
,

1570 
msghdr
 *
msg
, 
size_t
 
msg_Ën
)

1572 
sùp_sock
 *
¥
;

1573 
sùp_’dpošt
 *
•
;

1574 
sùp_assocŸtiÚ
 *
Ãw_asoc
=
NULL
, *
asoc
=NULL;

1575 
sùp_Œª¥Üt
 *
Œª¥Üt
, *
chunk_
;

1576 
sùp_chunk
 *
chunk
;

1577 
sùp_addr
 
to
;

1578 
sockaddr
 *
msg_Çme
 = 
NULL
;

1579 
sùp_¢drcvšfo
 
deçuÉ_sšfo
 = { 0 };

1580 
sùp_¢drcvšfo
 *
sšfo
;

1581 
sùp_š™msg
 *
sš™
;

1582 
sùp_assoc_t
 
associd
 = 0;

1583 
sùp_cmsgs_t
 
cmsgs
 = { 
NULL
 };

1584 
”r
;

1585 
sùp_scİe_t
 
scİe
;

1586 
timeo
;

1587 
__u16
 
sšfo_æags
 = 0;

1588 
sùp_d©amsg
 *
d©amsg
;

1589 
msg_æags
 = 
msg
->msg_flags;

1591 
	`SCTP_DEBUG_PRINTK
("sctp_sendmsg(sk: %p, msg: %p, msg_len: %zu)\n",

1592 
sk
, 
msg
, 
msg_Ën
);

1594 
”r
 = 0;

1595 
¥
 = 
	`sùp_sk
(
sk
);

1596 
•
 = 
¥
->ep;

1598 
	`SCTP_DEBUG_PRINTK
("Usšgƒndpošt: %p.\n", 
•
);

1601 ià(
	`sùp_¡yË
(
sk
, 
TCP
è&& 
	`sùp_s¡©e
(sk, 
LISTENING
)) {

1602 
”r
 = -
EPIPE
;

1603 
out_nouÆock
;

1607 
”r
 = 
	`sùp_msghdr_·r£
(
msg
, &
cmsgs
);

1609 ià(
”r
) {

1610 
	`SCTP_DEBUG_PRINTK
("msghd¸·r£ƒ¼ = %x\n", 
”r
);

1611 
out_nouÆock
;

1619 ià(!
	`sùp_¡yË
(
sk
, 
UDP_HIGH_BANDWIDTH
è&& 
msg
->
msg_Çme
) {

1620 
msg_Çm–’
 = 
msg
->msg_namelen;

1622 
”r
 = 
	`sùp_v”ify_addr
(
sk
, (
sùp_addr
 *)
msg
->
msg_Çme
,

1623 
msg_Çm–’
);

1624 ià(
”r
)

1625  
”r
;

1627 ià(
msg_Çm–’
 > (
to
))

1628 
msg_Çm–’
 = (
to
);

1629 
	`memıy
(&
to
, 
msg
->
msg_Çme
, 
msg_Çm–’
);

1630 
msg_Çme
 = 
msg
->msg_name;

1633 
sšfo
 = 
cmsgs
.
šfo
;

1634 
sš™
 = 
cmsgs
.
š™
;

1637 ià(
sšfo
) {

1638 
sšfo_æags
 = 
sšfo
->sinfo_flags;

1639 
associd
 = 
sšfo
->
sšfo_assoc_id
;

1642 
	`SCTP_DEBUG_PRINTK
("msg_len: %zu, sinfo_flags: 0x%x\n",

1643 
msg_Ën
, 
sšfo_æags
);

1646 ià(
	`sùp_¡yË
(
sk
, 
TCP
è&& (
sšfo_æags
 & (
SCTP_EOF
 | 
SCTP_ABORT
))) {

1647 
”r
 = -
EINVAL
;

1648 
out_nouÆock
;

1656 ià(((
sšfo_æags
 & 
SCTP_EOF
è&& (
msg_Ën
 > 0)) ||

1657 (!(
sšfo_æags
 & (
SCTP_EOF
|
SCTP_ABORT
)è&& (
msg_Ën
 == 0))) {

1658 
”r
 = -
EINVAL
;

1659 
out_nouÆock
;

1665 ià((
sšfo_æags
 & 
SCTP_ADDR_OVER
è&& (!
msg
->
msg_Çme
)) {

1666 
”r
 = -
EINVAL
;

1667 
out_nouÆock
;

1670 
Œª¥Üt
 = 
NULL
;

1672 
	`SCTP_DEBUG_PRINTK
("Abouto†ook up‡ssociation.\n");

1674 
	`sùp_lock_sock
(
sk
);

1677 ià(
msg_Çme
) {

1679 
asoc
 = 
	`sùp_’dpošt_lookup_assoc
(
•
, &
to
, &
Œª¥Üt
);

1680 ià(!
asoc
) {

1686 ià((
	`sùp_¡yË
(
sk
, 
TCP
) &&

1687 
	`sùp_s¡©e
(
sk
, 
ESTABLISHED
)) ||

1688 
	`sùp_’dpošt_is_³–ed_off
(
•
, &
to
)) {

1689 
”r
 = -
EADDRNOTAVAIL
;

1690 
out_uÆock
;

1694 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
associd
);

1695 ià(!
asoc
) {

1696 
”r
 = -
EPIPE
;

1697 
out_uÆock
;

1701 ià(
asoc
) {

1702 
	`SCTP_DEBUG_PRINTK
("Ju¡†ooked u°assocŸtiÚ: %p.\n", 
asoc
);

1709 ià(
	`sùp_¡©e
(
asoc
, 
CLOSED
è&& 
	`sùp_¡yË
(
sk
, 
TCP
)) {

1710 
”r
 = -
EPIPE
;

1711 
out_uÆock
;

1714 ià(
sšfo_æags
 & 
SCTP_EOF
) {

1715 
	`SCTP_DEBUG_PRINTK
("Shutting down‡ssociation: %p\n",

1716 
asoc
);

1717 
	`sùp_´im™ive_SHUTDOWN
(
asoc
, 
NULL
);

1718 
”r
 = 0;

1719 
out_uÆock
;

1721 ià(
sšfo_æags
 & 
SCTP_ABORT
) {

1723 
chunk
 = 
	`sùp_make_abÜt_u£r
(
asoc
, 
msg
, 
msg_Ën
);

1724 ià(!
chunk
) {

1725 
”r
 = -
ENOMEM
;

1726 
out_uÆock
;

1729 
	`SCTP_DEBUG_PRINTK
("AbÜtšg‡ssocŸtiÚ: %p\n", 
asoc
);

1730 
	`sùp_´im™ive_ABORT
(
asoc
, 
chunk
);

1731 
”r
 = 0;

1732 
out_uÆock
;

1737 ià(!
asoc
) {

1738 
	`SCTP_DEBUG_PRINTK
("There is‚o‡ssociation yet.\n");

1740 ià(
sšfo_æags
 & (
SCTP_EOF
 | 
SCTP_ABORT
)) {

1741 
”r
 = -
EINVAL
;

1742 
out_uÆock
;

1748 ià(
sšfo
) {

1749 ià(!
sš™
 || (sš™ && !sš™->
sš™_num_o¡»ams
)) {

1751 ià(
sšfo
->
sšfo_¡»am
 >=

1752 
¥
->
š™msg
.
sš™_num_o¡»ams
) {

1753 
”r
 = -
EINVAL
;

1754 
out_uÆock
;

1758 ià(
sšfo
->
sšfo_¡»am
 >=

1759 
sš™
->
sš™_num_o¡»ams
) {

1760 
”r
 = -
EINVAL
;

1761 
out_uÆock
;

1773 ià(!
•
->
ba£
.
bšd_addr
.
pÜt
) {

1774 ià(
	`sùp_autobšd
(
sk
)) {

1775 
”r
 = -
EAGAIN
;

1776 
out_uÆock
;

1786 ià(
•
->
ba£
.
bšd_addr
.
pÜt
 < 
PROT_SOCK
 &&

1787 !
	`ÿ·bË
(
CAP_NET_BIND_SERVICE
)) {

1788 
”r
 = -
EACCES
;

1789 
out_uÆock
;

1793 
scİe
 = 
	`sùp_scİe
(&
to
);

1794 
Ãw_asoc
 = 
	`sùp_assocŸtiÚ_Ãw
(
•
, 
sk
, 
scİe
, 
GFP_KERNEL
);

1795 ià(!
Ãw_asoc
) {

1796 
”r
 = -
ENOMEM
;

1797 
out_uÆock
;

1799 
asoc
 = 
Ãw_asoc
;

1800 
”r
 = 
	`sùp_assoc_£t_bšd_addr_äom_•
(
asoc
, 
scİe
, 
GFP_KERNEL
);

1801 ià(
”r
 < 0) {

1802 
”r
 = -
ENOMEM
;

1803 
out_ä“
;

1809 ià(
sš™
) {

1810 ià(
sš™
->
sš™_num_o¡»ams
) {

1811 
asoc
->
c
.
sš™_num_o¡»ams
 =

1812 
sš™
->
sš™_num_o¡»ams
;

1814 ià(
sš™
->
sš™_max_š¡»ams
) {

1815 
asoc
->
c
.
sš™_max_š¡»ams
 =

1816 
sš™
->
sš™_max_š¡»ams
;

1818 ià(
sš™
->
sš™_max_©‹m±s
) {

1819 
asoc
->
max_š™_©‹m±s


1820 ğ
sš™
->
sš™_max_©‹m±s
;

1822 ià(
sš™
->
sš™_max_š™_timeo
) {

1823 
asoc
->
max_š™_timeo
 =

1824 
	`m£cs_to_jiff›s
(
sš™
->
sš™_max_š™_timeo
);

1829 
Œª¥Üt
 = 
	`sùp_assoc_add_³”
(
asoc
, &
to
, 
GFP_KERNEL
, 
SCTP_UNKNOWN
);

1830 ià(!
Œª¥Üt
) {

1831 
”r
 = -
ENOMEM
;

1832 
out_ä“
;

1837 
	`SCTP_DEBUG_PRINTK
("We have‡ valid‡ssociation.\n");

1839 ià(!
sšfo
) {

1843 
deçuÉ_sšfo
.
sšfo_¡»am
 = 
asoc
->
deçuÉ_¡»am
;

1844 
deçuÉ_sšfo
.
sšfo_æags
 = 
asoc
->
deçuÉ_æags
;

1845 
deçuÉ_sšfo
.
sšfo_µid
 = 
asoc
->
deçuÉ_µid
;

1846 
deçuÉ_sšfo
.
sšfo_cÚ‹xt
 = 
asoc
->
deçuÉ_cÚ‹xt
;

1847 
deçuÉ_sšfo
.
sšfo_tim‘Şive
 = 
asoc
->
deçuÉ_tim‘Şive
;

1848 
deçuÉ_sšfo
.
sšfo_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

1849 
sšfo
 = &
deçuÉ_sšfo
;

1855 ià(
msg_Ën
 > 
sk
->
sk_¢dbuf
) {

1856 
”r
 = -
EMSGSIZE
;

1857 
out_ä“
;

1860 ià(
asoc
->
pmtu_³ndšg
)

1861 
	`sùp_assoc_³ndšg_pmtu
(
asoc
);

1868 ià(
	`sùp_sk
(
sk
)->
di§bË_äagm’ts
 && (
msg_Ën
 > 
asoc
->
äag_pošt
)) {

1869 
”r
 = -
EMSGSIZE
;

1870 
out_ä“
;

1873 ià(
sšfo
) {

1875 ià(
sšfo
->
sšfo_¡»am
 >ğ
asoc
->
c
.
sš™_num_o¡»ams
) {

1876 
”r
 = -
EINVAL
;

1877 
out_ä“
;

1881 
timeo
 = 
	`sock_¢dtimeo
(
sk
, 
msg
->
msg_æags
 & 
MSG_DONTWAIT
);

1882 ià(!
	`sùp_w¥aû
(
asoc
)) {

1883 
”r
 = 
	`sùp_wa™_fÜ_¢dbuf
(
asoc
, &
timeo
, 
msg_Ën
);

1884 ià(
”r
)

1885 
out_ä“
;

1892 ià((
	`sùp_¡yË
(
sk
, 
TCP
è&& 
msg_Çme
) ||

1893 (
sšfo_æags
 & 
SCTP_ADDR_OVER
)) {

1894 
chunk_
 = 
	`sùp_assoc_lookup_·ddr
(
asoc
, &
to
);

1895 ià(!
chunk_
) {

1896 
”r
 = -
EINVAL
;

1897 
out_ä“
;

1900 
chunk_
 = 
NULL
;

1903 ià(
	`sùp_¡©e
(
asoc
, 
CLOSED
)) {

1904 
”r
 = 
	`sùp_´im™ive_ASSOCIATE
(
asoc
, 
NULL
);

1905 ià(
”r
 < 0)

1906 
out_ä“
;

1907 
	`SCTP_DEBUG_PRINTK
("We‡ssociated…rimitively.\n");

1911 
d©amsg
 = 
	`sùp_d©amsg_äom_u£r
(
asoc
, 
sšfo
, 
msg
, 
msg_Ën
);

1912 ià(!
d©amsg
) {

1913 
”r
 = -
ENOMEM
;

1914 
out_ä“
;

1918 
	`li¡_fÜ_—ch_’Œy
(
chunk
, &
d©amsg
->
chunks
, 
äag_li¡
) {

1919 
	`sùp_chunk_hŞd
(
chunk
);

1922 
	`sùp_£t_owÃr_w
(
chunk
);

1924 
chunk
->
Œª¥Üt
 = 
chunk_
;

1932 
”r
 = 
	`sùp_´im™ive_SEND
(
asoc
, 
d©amsg
);

1934 ià(
”r
)

1935 
	`sùp_d©amsg_ä“
(
d©amsg
);

1937 
	`sùp_d©amsg_put
(
d©amsg
);

1939 
	`SCTP_DEBUG_PRINTK
("We sent…rimitively.\n");

1941 ià(
”r
)

1942 
out_ä“
;

1944 
”r
 = 
msg_Ën
;

1949 
out_uÆock
;

1951 
out_ä“
:

1952 ià(
Ãw_asoc
)

1953 
	`sùp_assocŸtiÚ_ä“
(
asoc
);

1954 
out_uÆock
:

1955 
	`sùp_»Ëa£_sock
(
sk
);

1957 
out_nouÆock
:

1958  
	`sùp_”rÜ
(
sk
, 
msg_æags
, 
”r
);

1961 
do_sock_”r
:

1962 ià(
msg_Ën
)

1963 
”r
 = 
msg_Ën
;

1965 
”r
 = 
	`sock_”rÜ
(
sk
);

1966 
out
;

1968 
do_š‹¼u±ed
:

1969 ià(
msg_Ën
)

1970 
”r
 = 
msg_Ën
;

1971 
out
;

1973 
	}
}

1982 
	$sùp_skb_puÎ
(
sk_buff
 *
skb
, 
Ën
)

1984 
sk_buff
 *
li¡
;

1985 
skb_Ën
 = 
	`skb_h—dËn
(
skb
);

1986 
¾’
;

1988 ià(
Ën
 <ğ
skb_Ën
) {

1989 
	`__skb_puÎ
(
skb
, 
Ën
);

1992 
Ën
 -ğ
skb_Ën
;

1993 
	`__skb_puÎ
(
skb
, 
skb_Ën
);

1995 
	`skb_w®k_äags
(
skb
, 
li¡
) {

1996 
¾’
 = 
	`sùp_skb_puÎ
(
li¡
, 
Ën
);

1997 
skb
->
Ën
 -ğÖ’-
¾’
);

1998 
skb
->
d©a_Ën
 -ğ(
Ën
-
¾’
);

2000 ià(!
¾’
)

2003 
Ën
 = 
¾’
;

2006  
Ën
;

2007 
	}
}

2024 
sk_buff
 *
sùp_skb_»cv_d©ag¿m
(
sock
 *, , , *);

2026 
SCTP_STATIC
 
	$sùp_»cvmsg
(
kiocb
 *
iocb
, 
sock
 *
sk
,

2027 
msghdr
 *
msg
, 
size_t
 
Ën
, 
noblock
,

2028 
æags
, *
addr_Ën
)

2030 
sùp_uÍev’t
 *
ev’t
 = 
NULL
;

2031 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2032 
sk_buff
 *
skb
;

2033 
cİ›d
;

2034 
”r
 = 0;

2035 
skb_Ën
;

2037 
	`SCTP_DEBUG_PRINTK
("sctp_recvmsg(%s: %p, %s: %p, %s: %zd, %s: %d, %s: "

2038 "0x%x, %s: %p)\n", "sk", 
sk
, "msghdr", 
msg
,

2039 "Ën", 
Ën
, "knobÏuch", 
noblock
,

2040 "æags", 
æags
, "addr_Ën", 
addr_Ën
);

2042 
	`sùp_lock_sock
(
sk
);

2044 ià(
	`sùp_¡yË
(
sk
, 
TCP
è&& !
	`sùp_s¡©e
(sk, 
ESTABLISHED
)) {

2045 
”r
 = -
ENOTCONN
;

2046 
out
;

2049 
skb
 = 
	`sùp_skb_»cv_d©ag¿m
(
sk
, 
æags
, 
noblock
, &
”r
);

2050 ià(!
skb
)

2051 
out
;

2056 
skb_Ën
 = 
skb
->
Ën
;

2058 
cİ›d
 = 
skb_Ën
;

2059 ià(
cİ›d
 > 
Ën
)

2060 
cİ›d
 = 
Ën
;

2062 
”r
 = 
	`skb_cİy_d©ag¿m_iovec
(
skb
, 0, 
msg
->
msg_iov
, 
cİ›d
);

2064 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

2066 ià(
”r
)

2067 
out_ä“
;

2069 
	`sock_»cv_ts_ªd_drİs
(
msg
, 
sk
, 
skb
);

2070 ià(
	`sùp_uÍev’t_is_nÙifiÿtiÚ
(
ev’t
)) {

2071 
msg
->
msg_æags
 |ğ
MSG_NOTIFICATION
;

2072 
¥
->
pf
->
	`ev’t_msgÇme
(
ev’t
, 
msg
->
msg_Çme
, 
addr_Ën
);

2074 
¥
->
pf
->
	`skb_msgÇme
(
skb
, 
msg
->
msg_Çme
, 
addr_Ën
);

2078 ià(
¥
->
subsüibe
.
sùp_d©a_io_ev’t
)

2079 
	`sùp_uÍev’t_»ad_¢drcvšfo
(
ev’t
, 
msg
);

2082 ià(
sk
->
sk_´Ùšfo
.
af_š‘
.
cmsg_æags
)

2083 
	`_cmsg_»cv
(
msg
, 
skb
);

2086 
”r
 = 
cİ›d
;

2092 ià(
skb_Ën
 > 
cİ›d
) {

2093 
msg
->
msg_æags
 &ğ~
MSG_EOR
;

2094 ià(
æags
 & 
MSG_PEEK
)

2095 
out_ä“
;

2096 
	`sùp_skb_puÎ
(
skb
, 
cİ›d
);

2097 
	`skb_queue_h—d
(&
sk
->
sk_»ûive_queue
, 
skb
);

2103 ià(!
	`sùp_uÍev’t_is_nÙifiÿtiÚ
(
ev’t
))

2104 
	`sùp_assoc_rwnd_šü—£
(
ev’t
->
asoc
, 
cİ›d
);

2105 
out
;

2106 } ià((
ev’t
->
msg_æags
 & 
MSG_NOTIFICATION
) ||

2107 (
ev’t
->
msg_æags
 & 
MSG_EOR
))

2108 
msg
->
msg_æags
 |ğ
MSG_EOR
;

2110 
msg
->
msg_æags
 &ğ~
MSG_EOR
;

2112 
out_ä“
:

2113 ià(
æags
 & 
MSG_PEEK
) {

2117 
	`kä“_skb
(
skb
);

2123 
	`sùp_uÍev’t_ä“
(
ev’t
);

2125 
out
:

2126 
	`sùp_»Ëa£_sock
(
sk
);

2127  
”r
;

2128 
	}
}

2137 
	$sùp_£tsockİt_di§bË_äagm’ts
(
sock
 *
sk
,

2138 
__u£r
 *
İtv®
,

2139 
İ’
)

2141 
v®
;

2143 ià(
İ’
 < ())

2144  -
EINVAL
;

2146 ià(
	`g‘_u£r
(
v®
, (
__u£r
 *)
İtv®
))

2147  -
EFAULT
;

2149 
	`sùp_sk
(
sk
)->
di§bË_äagm’ts
 = (
v®
 == 0) ? 0 : 1;

2152 
	}
}

2154 
	$sùp_£tsockİt_ev’ts
(
sock
 *
sk
, 
__u£r
 *
İtv®
,

2155 
İ’
)

2157 ià(
İ’
 > (
sùp_ev’t_subsüibe
))

2158  -
EINVAL
;

2159 ià(
	`cİy_äom_u£r
(&
	`sùp_sk
(
sk
)->
subsüibe
, 
İtv®
, 
İ’
))

2160  -
EFAULT
;

2162 
	}
}

2175 
	$sùp_£tsockİt_autoşo£
(
sock
 *
sk
, 
__u£r
 *
İtv®
,

2176 
İ’
)

2178 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2181 ià(
	`sùp_¡yË
(
sk
, 
TCP
))

2182  -
EOPNOTSUPP
;

2183 ià(
İ’
 != ())

2184  -
EINVAL
;

2185 ià(
	`cİy_äom_u£r
(&
¥
->
autoşo£
, 
İtv®
, 
İ’
))

2186  -
EFAULT
;

2188 
¥
->
autoşo£
 = 
	`mš_t
(, sp->autoşo£, 
MAX_SCHEDULE_TIMEOUT
 / 
HZ
);

2191 
	}
}

2290 
	$sùp_­¶y_³”_addr_·¿ms
(
sùp_·dd½¬ams
 *
·¿ms
,

2291 
sùp_Œª¥Üt
 *
Œªs
,

2292 
sùp_assocŸtiÚ
 *
asoc
,

2293 
sùp_sock
 *
¥
,

2294 
hb_chªge
,

2295 
pmtud_chªge
,

2296 
§ckd–ay_chªge
)

2298 
”rÜ
;

2300 ià(
·¿ms
->
¥p_æags
 & 
SPP_HB_DEMAND
 && 
Œªs
) {

2301 
”rÜ
 = 
	`sùp_´im™ive_REQUESTHEARTBEAT
 (
Œªs
->
asoc
,rans);

2302 ià(
”rÜ
)

2303  
”rÜ
;

2310 ià(
·¿ms
->
¥p_æags
 & 
SPP_HB_ENABLE
) {

2316 ià(
·¿ms
->
¥p_æags
 & 
SPP_HB_TIME_IS_ZERO
)

2317 
·¿ms
->
¥p_hbš‹rv®
 = 0;

2319 ià(
·¿ms
->
¥p_hbš‹rv®
 ||

2320 (
·¿ms
->
¥p_æags
 & 
SPP_HB_TIME_IS_ZERO
)) {

2321 ià(
Œªs
) {

2322 
Œªs
->
hbš‹rv®
 =

2323 
	`m£cs_to_jiff›s
(
·¿ms
->
¥p_hbš‹rv®
);

2324 } ià(
asoc
) {

2325 
asoc
->
hbš‹rv®
 =

2326 
	`m£cs_to_jiff›s
(
·¿ms
->
¥p_hbš‹rv®
);

2328 
¥
->
hbš‹rv®
 = 
·¿ms
->
¥p_hbš‹rv®
;

2333 ià(
hb_chªge
) {

2334 ià(
Œªs
) {

2335 
Œªs
->
·¿m_æags
 =

2336 (
Œªs
->
·¿m_æags
 & ~
SPP_HB
è| 
hb_chªge
;

2337 } ià(
asoc
) {

2338 
asoc
->
·¿m_æags
 =

2339 (
asoc
->
·¿m_æags
 & ~
SPP_HB
è| 
hb_chªge
;

2341 
¥
->
·¿m_æags
 =

2342 (
¥
->
·¿m_æags
 & ~
SPP_HB
è| 
hb_chªge
;

2351 ià((
·¿ms
->
¥p_æags
 & 
SPP_PMTUD_DISABLE
è&&…¬ams->
¥p_·thmtu
) {

2352 ià(
Œªs
) {

2353 
Œªs
->
·thmtu
 = 
·¿ms
->
¥p_·thmtu
;

2354 
	`sùp_assoc_sync_pmtu
(
asoc
);

2355 } ià(
asoc
) {

2356 
asoc
->
·thmtu
 = 
·¿ms
->
¥p_·thmtu
;

2357 
	`sùp_äag_pošt
(
asoc
, 
·¿ms
->
¥p_·thmtu
);

2359 
¥
->
·thmtu
 = 
·¿ms
->
¥p_·thmtu
;

2363 ià(
pmtud_chªge
) {

2364 ià(
Œªs
) {

2365 
upd©e
 = (
Œªs
->
·¿m_æags
 & 
SPP_PMTUD_DISABLE
) &&

2366 (
·¿ms
->
¥p_æags
 & 
SPP_PMTUD_ENABLE
);

2367 
Œªs
->
·¿m_æags
 =

2368 (
Œªs
->
·¿m_æags
 & ~
SPP_PMTUD
è| 
pmtud_chªge
;

2369 ià(
upd©e
) {

2370 
	`sùp_Œª¥Üt_pmtu
(
Œªs
, 
	`sùp_İt2sk
(
¥
));

2371 
	`sùp_assoc_sync_pmtu
(
asoc
);

2373 } ià(
asoc
) {

2374 
asoc
->
·¿m_æags
 =

2375 (
asoc
->
·¿m_æags
 & ~
SPP_PMTUD
è| 
pmtud_chªge
;

2377 
¥
->
·¿m_æags
 =

2378 (
¥
->
·¿m_æags
 & ~
SPP_PMTUD
è| 
pmtud_chªge
;

2386 ià((
·¿ms
->
¥p_æags
 & 
SPP_SACKDELAY_ENABLE
è&&…¬ams->
¥p_§ckd–ay
) {

2387 ià(
Œªs
) {

2388 
Œªs
->
§ckd–ay
 =

2389 
	`m£cs_to_jiff›s
(
·¿ms
->
¥p_§ckd–ay
);

2390 } ià(
asoc
) {

2391 
asoc
->
§ckd–ay
 =

2392 
	`m£cs_to_jiff›s
(
·¿ms
->
¥p_§ckd–ay
);

2394 
¥
->
§ckd–ay
 = 
·¿ms
->
¥p_§ckd–ay
;

2398 ià(
§ckd–ay_chªge
) {

2399 ià(
Œªs
) {

2400 
Œªs
->
·¿m_æags
 =

2401 (
Œªs
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2402 
§ckd–ay_chªge
;

2403 } ià(
asoc
) {

2404 
asoc
->
·¿m_æags
 =

2405 (
asoc
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2406 
§ckd–ay_chªge
;

2408 
¥
->
·¿m_æags
 =

2409 (
¥
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2410 
§ckd–ay_chªge
;

2417 ià(
·¿ms
->
¥p_·thmaxrxt
) {

2418 ià(
Œªs
) {

2419 
Œªs
->
·thmaxrxt
 = 
·¿ms
->
¥p_·thmaxrxt
;

2420 } ià(
asoc
) {

2421 
asoc
->
·thmaxrxt
 = 
·¿ms
->
¥p_·thmaxrxt
;

2423 
¥
->
·thmaxrxt
 = 
·¿ms
->
¥p_·thmaxrxt
;

2428 
	}
}

2430 
	$sùp_£tsockİt_³”_addr_·¿ms
(
sock
 *
sk
,

2431 
__u£r
 *
İtv®
,

2432 
İ’
)

2434 
sùp_·dd½¬ams
 
·¿ms
;

2435 
sùp_Œª¥Üt
 *
Œªs
 = 
NULL
;

2436 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

2437 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2438 
”rÜ
;

2439 
hb_chªge
, 
pmtud_chªge
, 
§ckd–ay_chªge
;

2441 ià(
İ’
 !ğ(
sùp_·dd½¬ams
))

2442  - 
EINVAL
;

2444 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
İ’
))

2445  -
EFAULT
;

2448 
hb_chªge
 = 
·¿ms
.
¥p_æags
 & 
SPP_HB
;

2449 
pmtud_chªge
 = 
·¿ms
.
¥p_æags
 & 
SPP_PMTUD
;

2450 
§ckd–ay_chªge
 = 
·¿ms
.
¥p_æags
 & 
SPP_SACKDELAY
;

2452 ià(
hb_chªge
 =ğ
SPP_HB
 ||

2453 
pmtud_chªge
 =ğ
SPP_PMTUD
 ||

2454 
§ckd–ay_chªge
 =ğ
SPP_SACKDELAY
 ||

2455 
·¿ms
.
¥p_§ckd–ay
 > 500 ||

2456 (
·¿ms
.
¥p_·thmtu


2457 && 
·¿ms
.
¥p_·thmtu
 < 
SCTP_DEFAULT_MINSEGMENT
))

2458  -
EINVAL
;

2463 ià(!
	`sùp_is_ªy
(
sk
, ( 
sùp_addr
 *)&
·¿ms
.
¥p_add»ss
)) {

2464 
Œªs
 = 
	`sùp_addr_id2Œª¥Üt
(
sk
, &
·¿ms
.
¥p_add»ss
,

2465 
·¿ms
.
¥p_assoc_id
);

2466 ià(!
Œªs
)

2467  -
EINVAL
;

2474 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
¥p_assoc_id
);

2475 ià(!
asoc
 && 
·¿ms
.
¥p_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

2476  -
EINVAL
;

2481 ià(
·¿ms
.
¥p_æags
 & 
SPP_HB_DEMAND
 && !
Œªs
 && !
asoc
)

2482  -
EINVAL
;

2485 
”rÜ
 = 
	`sùp_­¶y_³”_addr_·¿ms
(&
·¿ms
, 
Œªs
, 
asoc
, 
¥
,

2486 
hb_chªge
, 
pmtud_chªge
,

2487 
§ckd–ay_chªge
);

2489 ià(
”rÜ
)

2490  
”rÜ
;

2495 ià(!
Œªs
 && 
asoc
) {

2496 
	`li¡_fÜ_—ch_’Œy
(
Œªs
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

2497 
Œª¥Üts
) {

2498 
	`sùp_­¶y_³”_addr_·¿ms
(&
·¿ms
, 
Œªs
, 
asoc
, 
¥
,

2499 
hb_chªge
, 
pmtud_chªge
,

2500 
§ckd–ay_chªge
);

2505 
	}
}

2543 
	$sùp_£tsockİt_d–ayed_ack
(
sock
 *
sk
,

2544 
__u£r
 *
İtv®
, 
İ’
)

2546 
sùp_§ck_šfo
 
·¿ms
;

2547 
sùp_Œª¥Üt
 *
Œªs
 = 
NULL
;

2548 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

2549 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2551 ià(
İ’
 =ğ(
sùp_§ck_šfo
)) {

2552 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
İ’
))

2553  -
EFAULT
;

2555 ià(
·¿ms
.
§ck_d–ay
 =ğ0 &&…¬ams.
§ck_äeq
 == 0)

2557 } ià(
İ’
 =ğ(
sùp_assoc_v®ue
)) {

2558 
	`´štk
(
KERN_WARNING
 "SCTP: Use of struct sctp_assoc_value "

2560 
	`´štk
(
KERN_WARNING
 "SCTP: Use struct sctp_sack_info instead\n");

2561 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
İ’
))

2562  -
EFAULT
;

2564 ià(
·¿ms
.
§ck_d–ay
 == 0)

2565 
·¿ms
.
§ck_äeq
 = 1;

2567 
·¿ms
.
§ck_äeq
 = 0;

2569  - 
EINVAL
;

2572 ià(
·¿ms
.
§ck_d–ay
 > 500)

2573  -
EINVAL
;

2579 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
§ck_assoc_id
);

2580 ià(!
asoc
 && 
·¿ms
.
§ck_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

2581  -
EINVAL
;

2583 ià(
·¿ms
.
§ck_d–ay
) {

2584 ià(
asoc
) {

2585 
asoc
->
§ckd–ay
 =

2586 
	`m£cs_to_jiff›s
(
·¿ms
.
§ck_d–ay
);

2587 
asoc
->
·¿m_æags
 =

2588 (
asoc
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2589 
SPP_SACKDELAY_ENABLE
;

2591 
¥
->
§ckd–ay
 = 
·¿ms
.
§ck_d–ay
;

2592 
¥
->
·¿m_æags
 =

2593 (
¥
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2594 
SPP_SACKDELAY_ENABLE
;

2598 ià(
·¿ms
.
§ck_äeq
 == 1) {

2599 ià(
asoc
) {

2600 
asoc
->
·¿m_æags
 =

2601 (
asoc
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2602 
SPP_SACKDELAY_DISABLE
;

2604 
¥
->
·¿m_æags
 =

2605 (
¥
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2606 
SPP_SACKDELAY_DISABLE
;

2608 } ià(
·¿ms
.
§ck_äeq
 > 1) {

2609 ià(
asoc
) {

2610 
asoc
->
§ckäeq
 = 
·¿ms
.
§ck_äeq
;

2611 
asoc
->
·¿m_æags
 =

2612 (
asoc
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2613 
SPP_SACKDELAY_ENABLE
;

2615 
¥
->
§ckäeq
 = 
·¿ms
.
§ck_äeq
;

2616 
¥
->
·¿m_æags
 =

2617 (
¥
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2618 
SPP_SACKDELAY_ENABLE
;

2623 ià(
asoc
) {

2624 
	`li¡_fÜ_—ch_’Œy
(
Œªs
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

2625 
Œª¥Üts
) {

2626 ià(
·¿ms
.
§ck_d–ay
) {

2627 
Œªs
->
§ckd–ay
 =

2628 
	`m£cs_to_jiff›s
(
·¿ms
.
§ck_d–ay
);

2629 
Œªs
->
·¿m_æags
 =

2630 (
Œªs
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2631 
SPP_SACKDELAY_ENABLE
;

2633 ià(
·¿ms
.
§ck_äeq
 == 1) {

2634 
Œªs
->
·¿m_æags
 =

2635 (
Œªs
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2636 
SPP_SACKDELAY_DISABLE
;

2637 } ià(
·¿ms
.
§ck_äeq
 > 1) {

2638 
Œªs
->
§ckäeq
 = 
·¿ms
.
§ck_äeq
;

2639 
Œªs
->
·¿m_æags
 =

2640 (
Œªs
->
·¿m_æags
 & ~
SPP_SACKDELAY
) |

2641 
SPP_SACKDELAY_ENABLE
;

2647 
	}
}

2660 
	$sùp_£tsockİt_š™msg
(
sock
 *
sk
, 
__u£r
 *
İtv®
, 
İ’
)

2662 
sùp_š™msg
 
sš™
;

2663 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2665 ià(
İ’
 !ğ(
sùp_š™msg
))

2666  -
EINVAL
;

2667 ià(
	`cİy_äom_u£r
(&
sš™
, 
İtv®
, 
İ’
))

2668  -
EFAULT
;

2670 ià(
sš™
.
sš™_num_o¡»ams
)

2671 
¥
->
š™msg
.
sš™_num_o¡»ams
 = 
sš™
.sinit_num_ostreams;

2672 ià(
sš™
.
sš™_max_š¡»ams
)

2673 
¥
->
š™msg
.
sš™_max_š¡»ams
 = 
sš™
.sinit_max_instreams;

2674 ià(
sš™
.
sš™_max_©‹m±s
)

2675 
¥
->
š™msg
.
sš™_max_©‹m±s
 = 
sš™
.sinit_max_attempts;

2676 ià(
sš™
.
sš™_max_š™_timeo
)

2677 
¥
->
š™msg
.
sš™_max_š™_timeo
 = 
sš™
.sinit_max_init_timeo;

2680 
	}
}

2696 
	$sùp_£tsockİt_deçuÉ_£nd_·¿m
(
sock
 *
sk
,

2697 
__u£r
 *
İtv®
,

2698 
İ’
)

2700 
sùp_¢drcvšfo
 
šfo
;

2701 
sùp_assocŸtiÚ
 *
asoc
;

2702 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2704 ià(
İ’
 !ğ(
sùp_¢drcvšfo
))

2705  -
EINVAL
;

2706 ià(
	`cİy_äom_u£r
(&
šfo
, 
İtv®
, 
İ’
))

2707  -
EFAULT
;

2709 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
šfo
.
sšfo_assoc_id
);

2710 ià(!
asoc
 && 
šfo
.
sšfo_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

2711  -
EINVAL
;

2713 ià(
asoc
) {

2714 
asoc
->
deçuÉ_¡»am
 = 
šfo
.
sšfo_¡»am
;

2715 
asoc
->
deçuÉ_æags
 = 
šfo
.
sšfo_æags
;

2716 
asoc
->
deçuÉ_µid
 = 
šfo
.
sšfo_µid
;

2717 
asoc
->
deçuÉ_cÚ‹xt
 = 
šfo
.
sšfo_cÚ‹xt
;

2718 
asoc
->
deçuÉ_tim‘Şive
 = 
šfo
.
sšfo_tim‘Şive
;

2720 
¥
->
deçuÉ_¡»am
 = 
šfo
.
sšfo_¡»am
;

2721 
¥
->
deçuÉ_æags
 = 
šfo
.
sšfo_æags
;

2722 
¥
->
deçuÉ_µid
 = 
šfo
.
sšfo_µid
;

2723 
¥
->
deçuÉ_cÚ‹xt
 = 
šfo
.
sšfo_cÚ‹xt
;

2724 
¥
->
deçuÉ_tim‘Şive
 = 
šfo
.
sšfo_tim‘Şive
;

2728 
	}
}

2736 
	$sùp_£tsockİt_´im¬y_addr
(
sock
 *
sk
, 
__u£r
 *
İtv®
,

2737 
İ’
)

2739 
sùp_´im
 
´im
;

2740 
sùp_Œª¥Üt
 *
Œªs
;

2742 ià(
İ’
 !ğ(
sùp_´im
))

2743  -
EINVAL
;

2745 ià(
	`cİy_äom_u£r
(&
´im
, 
İtv®
, (
sùp_´im
)))

2746  -
EFAULT
;

2748 
Œªs
 = 
	`sùp_addr_id2Œª¥Üt
(
sk
, &
´im
.
s¥_addr
,…rim.
s¥_assoc_id
);

2749 ià(!
Œªs
)

2750  -
EINVAL
;

2752 
	`sùp_assoc_£t_´im¬y
(
Œªs
->
asoc
,rans);

2755 
	}
}

2765 
	$sùp_£tsockİt_nod–ay
(
sock
 *
sk
, 
__u£r
 *
İtv®
,

2766 
İ’
)

2768 
v®
;

2770 ià(
İ’
 < ())

2771  -
EINVAL
;

2772 ià(
	`g‘_u£r
(
v®
, (
__u£r
 *)
İtv®
))

2773  -
EFAULT
;

2775 
	`sùp_sk
(
sk
)->
nod–ay
 = (
v®
 == 0) ? 0 : 1;

2777 
	}
}

2791 
	$sùp_£tsockİt_¹ošfo
(
sock
 *
sk
, 
__u£r
 *
İtv®
, 
İ’
)

2793 
sùp_¹ošfo
 
¹ošfo
;

2794 
sùp_assocŸtiÚ
 *
asoc
;

2796 ià(
İ’
 !ğ (
sùp_¹ošfo
))

2797  -
EINVAL
;

2799 ià(
	`cİy_äom_u£r
(&
¹ošfo
, 
İtv®
, 
İ’
))

2800  -
EFAULT
;

2802 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
¹ošfo
.
¤to_assoc_id
);

2805 ià(!
asoc
 && 
¹ošfo
.
¤to_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

2806  -
EINVAL
;

2808 ià(
asoc
) {

2809 ià(
¹ošfo
.
¤to_š™Ÿl
 != 0)

2810 
asoc
->
¹o_š™Ÿl
 =

2811 
	`m£cs_to_jiff›s
(
¹ošfo
.
¤to_š™Ÿl
);

2812 ià(
¹ošfo
.
¤to_max
 != 0)

2813 
asoc
->
¹o_max
 = 
	`m£cs_to_jiff›s
(
¹ošfo
.
¤to_max
);

2814 ià(
¹ošfo
.
¤to_mš
 != 0)

2815 
asoc
->
¹o_mš
 = 
	`m£cs_to_jiff›s
(
¹ošfo
.
¤to_mš
);

2820 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2822 ià(
¹ošfo
.
¤to_š™Ÿl
 != 0)

2823 
¥
->
¹ošfo
.
¤to_š™Ÿl
 =„toinfo.srto_initial;

2824 ià(
¹ošfo
.
¤to_max
 != 0)

2825 
¥
->
¹ošfo
.
¤to_max
 =„toinfo.srto_max;

2826 ià(
¹ošfo
.
¤to_mš
 != 0)

2827 
¥
->
¹ošfo
.
¤to_mš
 =„toinfo.srto_min;

2831 
	}
}

2844 
	$sùp_£tsockİt_assocšfo
(
sock
 *
sk
, 
__u£r
 *
İtv®
, 
İ’
)

2847 
sùp_assoı¬ams
 
assoı¬ams
;

2848 
sùp_assocŸtiÚ
 *
asoc
;

2850 ià(
İ’
 !ğ(
sùp_assoı¬ams
))

2851  -
EINVAL
;

2852 ià(
	`cİy_äom_u£r
(&
assoı¬ams
, 
İtv®
, 
İ’
))

2853  -
EFAULT
;

2855 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
assoı¬ams
.
§soc_assoc_id
);

2857 ià(!
asoc
 && 
assoı¬ams
.
§soc_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

2858  -
EINVAL
;

2861 ià(
asoc
) {

2862 ià(
assoı¬ams
.
§soc_asocmaxrxt
 != 0) {

2863 
__u32
 
·th_sum
 = 0;

2864 
·ths
 = 0;

2865 
sùp_Œª¥Üt
 *
³”_addr
;

2867 
	`li¡_fÜ_—ch_’Œy
(
³”_addr
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

2868 
Œª¥Üts
) {

2869 
·th_sum
 +ğ
³”_addr
->
·thmaxrxt
;

2870 
·ths
++;

2878 ià(
·ths
 > 1 &&

2879 
assoı¬ams
.
§soc_asocmaxrxt
 > 
·th_sum
)

2880  -
EINVAL
;

2882 
asoc
->
max_»Œªs
 = 
assoı¬ams
.
§soc_asocmaxrxt
;

2885 ià(
assoı¬ams
.
§soc_cook›_liã
 != 0) {

2886 
asoc
->
cook›_liã
.
tv_£c
 =

2887 
assoı¬ams
.
§soc_cook›_liã
 / 1000;

2888 
asoc
->
cook›_liã
.
tv_u£c
 =

2889 (
assoı¬ams
.
§soc_cook›_liã
 % 1000)

2894 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2896 ià(
assoı¬ams
.
§soc_asocmaxrxt
 != 0)

2897 
¥
->
assoı¬ams
.
§soc_asocmaxrxt
 =

2898 
assoı¬ams
.
§soc_asocmaxrxt
;

2899 ià(
assoı¬ams
.
§soc_cook›_liã
 != 0)

2900 
¥
->
assoı¬ams
.
§soc_cook›_liã
 =

2901 
assoı¬ams
.
§soc_cook›_liã
;

2904 
	}
}

2916 
	$sùp_£tsockİt_m­³dv4
(
sock
 *
sk
, 
__u£r
 *
İtv®
, 
İ’
)

2918 
v®
;

2919 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2921 ià(
İ’
 < ())

2922  -
EINVAL
;

2923 ià(
	`g‘_u£r
(
v®
, (
__u£r
 *)
İtv®
))

2924  -
EFAULT
;

2925 ià(
v®
)

2926 
¥
->
v4m­³d
 = 1;

2928 
¥
->
v4m­³d
 = 0;

2931 
	}
}

2960 
	$sùp_£tsockİt_max£g
(
sock
 *
sk
, 
__u£r
 *
İtv®
, 
İ’
)

2962 
sùp_assoc_v®ue
 
·¿ms
;

2963 
sùp_assocŸtiÚ
 *
asoc
;

2964 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

2965 
v®
;

2967 ià(
İ’
 == ()) {

2968 
	`´štk
(
KERN_WARNING


2970 
	`´štk
(
KERN_WARNING


2972 ià(
	`cİy_äom_u£r
(&
v®
, 
İtv®
, 
İ’
))

2973  -
EFAULT
;

2974 
·¿ms
.
assoc_id
 = 0;

2975 } ià(
İ’
 =ğ(
sùp_assoc_v®ue
)) {

2976 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
İ’
))

2977  -
EFAULT
;

2978 
v®
 = 
·¿ms
.
assoc_v®ue
;

2980  -
EINVAL
;

2982 ià((
v®
 !ğ0è&& ((v® < 8è|| (v® > 
SCTP_MAX_CHUNK_LEN
)))

2983  -
EINVAL
;

2985 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
assoc_id
);

2986 ià(!
asoc
 && 
·¿ms
.
assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

2987  -
EINVAL
;

2989 ià(
asoc
) {

2990 ià(
v®
 == 0) {

2991 
v®
 = 
asoc
->
·thmtu
;

2992 
v®
 -ğ
¥
->
pf
->
af
->
Ãt_h—d”_Ën
;

2993 
v®
 -ğ(
sùphdr
) +

2994 (
sùp_d©a_chunk
);

2996 
asoc
->
u£r_äag
 = 
v®
;

2997 
asoc
->
äag_pošt
 = 
	`sùp_äag_pošt
×soc,‡soc->
·thmtu
);

2999 
¥
->
u£r_äag
 = 
v®
;

3003 
	}
}

3014 
	$sùp_£tsockİt_³”_´im¬y_addr
(
sock
 *
sk
, 
__u£r
 *
İtv®
,

3015 
İ’
)

3017 
sùp_sock
 *
¥
;

3018 
sùp_’dpošt
 *
•
;

3019 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

3020 
sùp_£“½rim
 
´im
;

3021 
sùp_chunk
 *
chunk
;

3022 
sùp_af
 *
af
;

3023 
”r
;

3025 
¥
 = 
	`sùp_sk
(
sk
);

3026 
•
 = 
¥
->ep;

3028 ià(!
sùp_add_’abË
)

3029  -
EPERM
;

3031 ià(
İ’
 !ğ(
sùp_£“½rim
))

3032  -
EINVAL
;

3034 ià(
	`cİy_äom_u£r
(&
´im
, 
İtv®
, 
İ’
))

3035  -
EFAULT
;

3037 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
´im
.
s¥p_assoc_id
);

3038 ià(!
asoc
)

3039  -
EINVAL
;

3041 ià(!
asoc
->
³”
.
ascÚf_ÿ·bË
)

3042  -
EPERM
;

3044 ià(
asoc
->
³”
.
add_di§bËd_mask
 & 
SCTP_PARAM_SET_PRIMARY
)

3045  -
EPERM
;

3047 ià(!
	`sùp_¡©e
(
asoc
, 
ESTABLISHED
))

3048  -
ENOTCONN
;

3050 
af
 = 
	`sùp_g‘_af_¥ecific
(
´im
.
s¥p_addr
.
ss_çmy
);

3051 ià(!
af
)

3052  -
EINVAL
;

3054 ià(!
af
->
	`addr_v®id
((
sùp_addr
 *)&
´im
.
s¥p_addr
, 
¥
, 
NULL
))

3055  -
EADDRNOTAVAIL
;

3057 ià(!
	`sùp_assoc_lookup_Ïddr
(
asoc
, (
sùp_addr
 *)&
´im
.
s¥p_addr
))

3058  -
EADDRNOTAVAIL
;

3061 
chunk
 = 
	`sùp_make_ascÚf_£t_´im
(
asoc
,

3062 (
sùp_addr
 *)&
´im
.
s¥p_addr
);

3063 ià(!
chunk
)

3064  -
ENOMEM
;

3066 
”r
 = 
	`sùp_£nd_ascÚf
(
asoc
, 
chunk
);

3068 
	`SCTP_DEBUG_PRINTK
("We set…eer…rimary‡ddr…rimitively.\n");

3070  
”r
;

3071 
	}
}

3073 
	$sùp_£tsockİt_ad­tiÚ_Ïy”
(
sock
 *
sk
, 
__u£r
 *
İtv®
,

3074 
İ’
)

3076 
sùp_£d­tiÚ
 
ad­tiÚ
;

3078 ià(
İ’
 !ğ(
sùp_£d­tiÚ
))

3079  -
EINVAL
;

3080 ià(
	`cİy_äom_u£r
(&
ad­tiÚ
, 
İtv®
, 
İ’
))

3081  -
EFAULT
;

3083 
	`sùp_sk
(
sk
)->
ad­tiÚ_šd
 = 
ad­tiÚ
.
ssb_ad­tiÚ_šd
;

3086 
	}
}

3102 
	$sùp_£tsockİt_cÚ‹xt
(
sock
 *
sk
, 
__u£r
 *
İtv®
,

3103 
İ’
)

3105 
sùp_assoc_v®ue
 
·¿ms
;

3106 
sùp_sock
 *
¥
;

3107 
sùp_assocŸtiÚ
 *
asoc
;

3109 ià(
İ’
 !ğ(
sùp_assoc_v®ue
))

3110  -
EINVAL
;

3111 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
İ’
))

3112  -
EFAULT
;

3114 
¥
 = 
	`sùp_sk
(
sk
);

3116 ià(
·¿ms
.
assoc_id
 != 0) {

3117 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
assoc_id
);

3118 ià(!
asoc
)

3119  -
EINVAL
;

3120 
asoc
->
deçuÉ_rcv_cÚ‹xt
 = 
·¿ms
.
assoc_v®ue
;

3122 
¥
->
deçuÉ_rcv_cÚ‹xt
 = 
·¿ms
.
assoc_v®ue
;

3126 
	}
}

3152 
	$sùp_£tsockİt_äagm’t_š‹¾—ve
(
sock
 *
sk
,

3153 
__u£r
 *
İtv®
,

3154 
İ’
)

3156 
v®
;

3158 ià(
İ’
 != ())

3159  -
EINVAL
;

3160 ià(
	`g‘_u£r
(
v®
, (
__u£r
 *)
İtv®
))

3161  -
EFAULT
;

3163 
	`sùp_sk
(
sk
)->
äag_š‹¾—ve
 = (
v®
 == 0) ? 0 : 1;

3166 
	}
}

3185 
	$sùp_£tsockİt_·¹Ÿl_d–iv”y_pošt
(
sock
 *
sk
,

3186 
__u£r
 *
İtv®
,

3187 
İ’
)

3189 
u32
 
v®
;

3191 ià(
İ’
 !ğ(
u32
))

3192  -
EINVAL
;

3193 ià(
	`g‘_u£r
(
v®
, (
__u£r
 *)
İtv®
))

3194  -
EFAULT
;

3199 ià(
v®
 > (
sk
->
sk_rcvbuf
 >> 1))

3200  -
EINVAL
;

3202 
	`sùp_sk
(
sk
)->
pd_pošt
 = 
v®
;

3205 
	}
}

3218 
	$sùp_£tsockİt_maxbur¡
(
sock
 *
sk
,

3219 
__u£r
 *
İtv®
,

3220 
İ’
)

3222 
sùp_assoc_v®ue
 
·¿ms
;

3223 
sùp_sock
 *
¥
;

3224 
sùp_assocŸtiÚ
 *
asoc
;

3225 
v®
;

3226 
assoc_id
 = 0;

3228 ià(
İ’
 == ()) {

3229 
	`´štk
(
KERN_WARNING


3231 
	`´štk
(
KERN_WARNING


3233 ià(
	`cİy_äom_u£r
(&
v®
, 
İtv®
, 
İ’
))

3234  -
EFAULT
;

3235 } ià(
İ’
 =ğ(
sùp_assoc_v®ue
)) {

3236 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
İ’
))

3237  -
EFAULT
;

3238 
v®
 = 
·¿ms
.
assoc_v®ue
;

3239 
assoc_id
 = 
·¿ms
.assoc_id;

3241  -
EINVAL
;

3243 
¥
 = 
	`sùp_sk
(
sk
);

3245 ià(
assoc_id
 != 0) {

3246 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
assoc_id
);

3247 ià(!
asoc
)

3248  -
EINVAL
;

3249 
asoc
->
max_bur¡
 = 
v®
;

3251 
¥
->
max_bur¡
 = 
v®
;

3254 
	}
}

3263 
	$sùp_£tsockİt_auth_chunk
(
sock
 *
sk
,

3264 
__u£r
 *
İtv®
,

3265 
İ’
)

3267 
sùp_authchunk
 
v®
;

3269 ià(!
sùp_auth_’abË
)

3270  -
EACCES
;

3272 ià(
İ’
 !ğ(
sùp_authchunk
))

3273  -
EINVAL
;

3274 ià(
	`cİy_äom_u£r
(&
v®
, 
İtv®
, 
İ’
))

3275  -
EFAULT
;

3277 
v®
.
§uth_chunk
) {

3278 
SCTP_CID_INIT
:

3279 
SCTP_CID_INIT_ACK
:

3280 
SCTP_CID_SHUTDOWN_COMPLETE
:

3281 
SCTP_CID_AUTH
:

3282  -
EINVAL
;

3286  
	`sùp_auth_•_add_chunkid
(
	`sùp_sk
(
sk
)->
•
, 
v®
.
§uth_chunk
);

3287 
	}
}

3295 
	$sùp_£tsockİt_hmac_id’t
(
sock
 *
sk
,

3296 
__u£r
 *
İtv®
,

3297 
İ’
)

3299 
sùp_hmaÿlgo
 *
hmacs
;

3300 
u32
 
id’ts
;

3301 
”r
;

3303 ià(!
sùp_auth_’abË
)

3304  -
EACCES
;

3306 ià(
İ’
 < (
sùp_hmaÿlgo
))

3307  -
EINVAL
;

3309 
hmacs
 = 
	`km®loc
(
İ’
, 
GFP_KERNEL
);

3310 ià(!
hmacs
)

3311  -
ENOMEM
;

3313 ià(
	`cİy_äom_u£r
(
hmacs
, 
İtv®
, 
İ’
)) {

3314 
”r
 = -
EFAULT
;

3315 
out
;

3318 
id’ts
 = 
hmacs
->
shmac_num_id’ts
;

3319 ià(
id’ts
 =ğ0 || id’t > 
SCTP_AUTH_NUM_HMACS
 ||

3320 (
id’ts
 * (
u16
)è> (
İ’
 - (
sùp_hmaÿlgo
))) {

3321 
”r
 = -
EINVAL
;

3322 
out
;

3325 
”r
 = 
	`sùp_auth_•_£t_hmacs
(
	`sùp_sk
(
sk
)->
•
, 
hmacs
);

3326 
out
:

3327 
	`kä“
(
hmacs
);

3328  
”r
;

3329 
	}
}

3337 
	$sùp_£tsockİt_auth_key
(
sock
 *
sk
,

3338 
__u£r
 *
İtv®
,

3339 
İ’
)

3341 
sùp_authkey
 *
authkey
;

3342 
sùp_assocŸtiÚ
 *
asoc
;

3343 
»t
;

3345 ià(!
sùp_auth_’abË
)

3346  -
EACCES
;

3348 ià(
İ’
 <ğ(
sùp_authkey
))

3349  -
EINVAL
;

3351 
authkey
 = 
	`km®loc
(
İ’
, 
GFP_KERNEL
);

3352 ià(!
authkey
)

3353  -
ENOMEM
;

3355 ià(
	`cİy_äom_u£r
(
authkey
, 
İtv®
, 
İ’
)) {

3356 
»t
 = -
EFAULT
;

3357 
out
;

3360 ià(
authkey
->
sÿ_keyËngth
 > 
İ’
 - (
sùp_authkey
)) {

3361 
»t
 = -
EINVAL
;

3362 
out
;

3365 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
authkey
->
sÿ_assoc_id
);

3366 ià(!
asoc
 && 
authkey
->
sÿ_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
)) {

3367 
»t
 = -
EINVAL
;

3368 
out
;

3371 
»t
 = 
	`sùp_auth_£t_key
(
	`sùp_sk
(
sk
)->
•
, 
asoc
, 
authkey
);

3372 
out
:

3373 
	`kä“
(
authkey
);

3374  
»t
;

3375 
	}
}

3377 
sùp_assocŸtiÚ
 *
	$£tAssoc
(
sock
 *
sk
, 
tAsoc
 *
aù
, 
sùp_assoc_t
 
asocId
, 
ş›Á
)

3379 
sùp_sock
 *
ss
 = 
	`sùp_sk
(
sk
);

3380 
sùp_’dpošt
 *
•
 = 
ss
->ep;

3381 
sùp_cook›
 *
b—r_cook›
 = &(
aù
->
c
);

3382 
sùp_uÍev’t
 *
ev
;

3383 
sùp_Œª¥Üt
 *
Œª¥Üt
;

3384 
sùp_assocŸtiÚ
 *
»tv®
 = 
NULL
;

3386 
”r
;

3388 
sùp_cmd_£q_t
 
commªds
;

3392 
sùp_scİe_t
 
scİe
;

3395 
	`memıy
(
•
->
£ü‘_key
, 
aù
->secret_key, (ep->secret_key));

3396 
•
->
cu¼’t_key
 = 
aù
->current_key;

3399 if(
ş›Á
)

3401 
scİe
 = 
	`sùp_scİe
(&
b—r_cook›
->
³”_addr
);

3402 if(!(
»tv®
 = 
	`sùp_assocŸtiÚ_Ãw
(
•
, 
sk
, 
scİe
, 
GFP_KERNEL
)))

3404 
”r
 = -
ENOMEM
;

3405 
ç
;

3408 if((
	`sùp_assoc_£t_bšd_addr_äom_•
(
»tv®
, 
scİe
, 
GFP_KERNEL
)))

3410 
ç
;

3415 
scİe
 = 
	`sùp_scİe
(&
aù
->
addr
);

3416 
»tv®
 = 
	`sùp_assocŸtiÚ_Ãw
(
•
,ƒp->
ba£
.
sk
, 
scİe
, 
GFP_KERNEL
);

3418 ià(!
»tv®
)

3420 
	`´štk
("sctp_association_new failed\n");

3421 
ç
;

3423 
»tv®
->
assoc_id
 = 
asocId
;

3440 
	`memıy
(&
»tv®
->
c
, 
b—r_cook›
, (
sùp_cook›
));

3441 
»tv®
->
³”
.
pÜt
 = 
	`Áohs
(
b—r_cook›
->
³”_addr
.
v4
.
sš_pÜt
);

3443 if(
ş›Á
)

3446 if(!(
	`sùp_assoc_add_³”
(
»tv®
, &»tv®->
c
.
³”_addr
, 
GFP_KERNEL
, 
SCTP_UNKNOWN
)))

3449 
ç
;

3452 if(!
	`sùp_assoc_add_³”
(
»tv®
, &»tv®->
c
.
³”_addr
, 
GFP_ATOMIC
, 
SCTP_ACTIVE
))

3454 
	`´štk
("sctp_assoc_add_peer failed\n");

3456 
ç
;

3460 
»tv®
->
³”
.
´sùp_ÿ·bË
 =„‘v®->
c
.prsctp_capable;

3461 
»tv®
->
³”
.
ad­tiÚ_šd
 =„‘v®->
c
.adaptation_ind;

3462 
»tv®
->
³”
.
i
.
š™_g
 =„‘v®->
c
.
³”_vg
;

3463 
»tv®
->
³”
.
i
.
num_outbound_¡»ams
 =„‘v®->
c
.
sš™_max_š¡»ams
;

3464 
»tv®
->
³”
.
i
.
num_šbound_¡»ams
 =„‘v®->
c
.
sš™_num_o¡»ams
;

3465 
»tv®
->
³”
.
i
.
a_rwnd
 = 
aù
->a_rwnd;

3466 
»tv®
->
³”
.
i
.
š™Ÿl_t¢
 = 
aù
->initial_tsn;

3467 
»tv®
->
bkup_d©a
 = 1;

3468 
»tv®
->
bkup_§ck
 = 1;

3471 ià(
	`li¡_em±y
(&
»tv®
->
ba£
.
bšd_addr
.
add»ss_li¡
))

3473 
	`sùp_add_bšd_addr
(&
»tv®
->
ba£
.
bšd_addr
, &
aù
->
addr
, 
SCTP_ADDR_SRC
, 
GFP_ATOMIC
);

3476 
»tv®
->
Ãxt_t¢
 =„‘v®->
c
.
š™Ÿl_t¢
;

3477 
»tv®
->
ù¢_ack_pošt
 =„‘v®->
Ãxt_t¢
 - 1;

3478 
»tv®
->
add_£rŸl
 =„‘v®->
c
.
š™Ÿl_t¢
;

3479 
»tv®
->
adv_³”_ack_pošt
 =„‘v®->
ù¢_ack_pošt
;

3481 
»tv®
->
s¢m­
 = 
	`sùp_s¢m­_Ãw
Ô‘v®->
c
.
sš™_max_š¡»ams
,»tv®->c.
sš™_num_o¡»ams
, 
GFP_ATOMIC
);

3482 ià(!
»tv®
->
s¢m­
)

3484 
	`´štk
("sctp_ssnmap_new failed\n");

3486 
ç
;

3488 
	`li¡_fÜ_—ch_’Œy
(
Œª¥Üt
, &
»tv®
->
³”
.
Œª¥Üt_addr_li¡
,
Œª¥Üts
)

3490 
Œª¥Üt
->
s¡h»sh
 = 
»tv®
->
³”
.
i
.
a_rwnd
;

3494 ià(!
	`sùp_t¢m­_š™
(&
»tv®
->
³”
.
t¢_m­
, 
SCTP_TSN_MAP_INITIAL
,»tv®->³”.
i
.
š™Ÿl_t¢
, 
GFP_ATOMIC
))

3496 
	`´štk
("sctp_tsnmap_init failed\n");

3497 
ç
;

3504 
	`sùp_’dpošt_add_asoc
(
•
, 
»tv®
);

3505 
	`sùp_hash_e¡ablished
(
»tv®
);

3510 
	`sùp_š™_cmd_£q
(&
commªds
);

3511 
	`sùp_add_cmd_sf
(&
commªds
, 
SCTP_CMD_NEW_STATE
,
	`SCTP_STATE
(
SCTP_STATE_ESTABLISHED
));

3512 
	`sùp_cmd_Ãw_¡©e
(&
commªds
, 
»tv®
, 
SCTP_STATE_ESTABLISHED
);

3514 
ev
 = 
	`sùp_uÍev’t_make_assoc_chªge
(
»tv®
, 0, 
SCTP_COMM_UP
, 0,

3515 
»tv®
->
c
.
sš™_num_o¡»ams
,

3516 
»tv®
->
c
.
sš™_max_š¡»ams
,

3517 
NULL
, 
GFP_ATOMIC
);

3518 ià(!
ev
)

3520 
	`´štk
("ERROR: Can't createƒvent set sock failed\n");

3521 
ç
;

3525 
	`sùp_uÍq__ev’t
(&
»tv®
->
uÍq
, 
ev
);

3527  
»tv®
;

3529 
ç
:

3530 ià(
»tv®
 && !
ş›Á
)

3532 
	`sùp_assocŸtiÚ_ä“
(
»tv®
);

3534  
NULL
;

3535 
	}
}

3537 
	$sùp_£tsockİt_£t_assoc
(
sock
 *
sk
,
__u£r
 *
İtv®
, 
İ’
)

3539 
tSockMsg
 *
msg
;

3540 
»t
 = 0;

3542 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

3545 
msg
 = 
	`km®loc
(
İ’
, 
GFP_KERNEL
);

3547 if(!
msg
)

3549 
	`´štk
("OuˆoàmemÜy fÜ s‘_assoø%d\n",
İ’
);

3550  -
EFAULT
;

3553 ià(
	`cİy_äom_u£r
(
msg
, 
İtv®
, 
İ’
))

3555 
»t
 = -
EFAULT
;

3556 
ç
;

3559 
msg
->
ty³
)

3561 
ASOC_MSG
:

3562 
ASOC_CLIENT_MSG
:

3564 
	`sùp_cmd_hb_tim”s_¡İ
(
sùp_cmd_£q_t
 *
cmds
, 
sùp_assocŸtiÚ
 *
asoc
);

3566 
tAsoc
 *
aù
 = &(
msg
->
¶
.
a
);

3569 if(
İ’
 < (
tAsoc
))

3571 
	`´štk
("ERROR: s‘_assoø- IncÜ»ù†’gth %d", 
İ’
);

3572 
»t
 = -
EFAULT
;

3573 
ç
;

3577 
ş›Á
 = 0;

3578 if(
msg
->
ty³
 !ğ
ASOC_MSG
)

3580 
ş›Á
 = -1;

3582 
asoc
 = 
	`£tAssoc
(
sk
, 
aù
, 
msg
->
assoc_id
, 
ş›Á
);

3583 if(
asoc
)

3585 
	`sùp_cmd_hb_tim”s_¡İ
(
NULL
,
asoc
);

3586 
asoc
->
bkup_£t
 = 1;

3587 
	`´štk
("£tAssoøsucûs ş›Á = %d‡ssoøid = %d!!!\n", 
ş›Á
, 
asoc
->
assoc_id
);

3591 
	`´štk
("ERROR:£tAssoøçed cl›Á = %d‡ssoøid = %d???\n", 
ş›Á
, 
asoc
->
assoc_id
);

3592 
»t
 = -
EFAULT
;

3593 
ç
;

3599 
UPDATE_MSG
:

3601 
	`sùp_cmd_hb_tim”s_¡¬t
(
sùp_cmd_£q_t
 *
cmds
, 
sùp_assocŸtiÚ
 *
asoc
);

3603 
tUpd©e
 *
upd
 = &(
msg
->
¶
.
u
);

3606 if(
İ’
 < ((
tUpd©e
)+
upd
->
Ën
+((
__u32
)upd-(__u32)
msg
) ) )

3608 
	`´štk
("ssnmap is out of boundƒnd of msg (msg %p + optlen %d) < (update %p + sizeof %d +%d)\n",

3609 
msg
,
İ’
,
upd
,(
tUpd©e
),upd->
Ën
);

3611 ià(
msg
->
assoc_id
)

3613 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
msg
->
assoc_id
);

3615 ià(!
asoc
)

3617 
	`´štk
("ERROR: No‡ssociation\n");

3618 
»t
 = -
EINVAL
;

3619 
ç
;

3624 
	`´štk
("ERROR: User didn't sent‡ny‡ssociation\n");

3625 
»t
 = -
EINVAL
;

3626 
ç
;

3630 if(
upd
->
¡©e
)

3632 
asoc
->
adv_³”_ack_pošt
 = 
upd
->adv_peer_ack_point;

3633 
asoc
->
ù¢_ack_pošt
 = 
upd
->ctsn_ack_point;

3634 
asoc
->
highe¡_§cked
 = 
upd
->highest_sacked;

3635 
asoc
->
Ãxt_t¢
 = 
upd
->next_tsn;

3636 
asoc
->
¡©e
 = 
upd
->state;

3637 
asoc
->
³”
.
t¢_m­
.
ba£_t¢
 = 
upd
->base_tsn;

3638 
asoc
->
³”
.
t¢_m­
.
cumuÏtive_t¢_ack_pošt
 = 
upd
->cumulative_tsn_ack_point;

3639 
	`memıy
(
asoc
->
s¢m­
->
š
.
s¢
, 
upd
->s¢m­, upd->
Ën
);

3643 
	`´štk
("Activate HB-timers\n");

3644 
	`sùp_cmd_hb_tim”s_¡¬t
(
NULL
,
asoc
);

3651 
»t
 = -
EFAULT
;

3652 
ç
;

3658 
ç
:

3659 
	`kä“
(
msg
);

3660  
»t
;

3662 
	}
}

3670 
	$sùp_£tsockİt_aùive_key
(
sock
 *
sk
,

3671 
__u£r
 *
İtv®
,

3672 
İ’
)

3674 
sùp_authkeyid
 
v®
;

3675 
sùp_assocŸtiÚ
 *
asoc
;

3677 ià(!
sùp_auth_’abË
)

3678  -
EACCES
;

3680 ià(
İ’
 !ğ(
sùp_authkeyid
))

3681  -
EINVAL
;

3682 ià(
	`cİy_äom_u£r
(&
v®
, 
İtv®
, 
İ’
))

3683  -
EFAULT
;

3685 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
v®
.
sÿù_assoc_id
);

3686 ià(!
asoc
 && 
v®
.
sÿù_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

3687  -
EINVAL
;

3689  
	`sùp_auth_£t_aùive_key
(
	`sùp_sk
(
sk
)->
•
, 
asoc
,

3690 
v®
.
sÿù_keynumb”
);

3691 
	}
}

3698 
	$sùp_£tsockİt_d–_key
(
sock
 *
sk
,

3699 
__u£r
 *
İtv®
,

3700 
İ’
)

3702 
sùp_authkeyid
 
v®
;

3703 
sùp_assocŸtiÚ
 *
asoc
;

3705 ià(!
sùp_auth_’abË
)

3706  -
EACCES
;

3708 ià(
İ’
 !ğ(
sùp_authkeyid
))

3709  -
EINVAL
;

3710 ià(
	`cİy_äom_u£r
(&
v®
, 
İtv®
, 
İ’
))

3711  -
EFAULT
;

3713 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
v®
.
sÿù_assoc_id
);

3714 ià(!
asoc
 && 
v®
.
sÿù_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

3715  -
EINVAL
;

3717  
	`sùp_auth_d–_key_id
(
	`sùp_sk
(
sk
)->
•
, 
asoc
,

3718 
v®
.
sÿù_keynumb”
);

3720 
	}
}

3730 
	$sùp_£tsockİt_·ddr_th»shŞds
(
sock
 *
sk
,

3731 
__u£r
 *
İtv®
,

3732 
İ’
)

3734 
sùp_·dd¹hlds
 
v®
;

3735 
sùp_Œª¥Üt
 *
Œªs
;

3736 
sùp_assocŸtiÚ
 *
asoc
;

3738 ià(
İ’
 < (
sùp_·dd¹hlds
))

3739  -
EINVAL
;

3740 ià(
	`cİy_äom_u£r
(&
v®
, (
sùp_·dd¹hlds
 
__u£r
 *)
İtv®
,

3741 (
sùp_·dd¹hlds
)))

3742  -
EFAULT
;

3745 ià(
	`sùp_is_ªy
(
sk
, (cÚ¡ 
sùp_addr
 *)&
v®
.
¥t_add»ss
)) {

3746 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
v®
.
¥t_assoc_id
);

3747 ià(!
asoc
)

3748  -
ENOENT
;

3749 
	`li¡_fÜ_—ch_’Œy
(
Œªs
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

3750 
Œª¥Üts
) {

3751 ià(
v®
.
¥t_·thmaxrxt
)

3752 
Œªs
->
·thmaxrxt
 = 
v®
.
¥t_·thmaxrxt
;

3753 
Œªs
->
pf_»Œªs
 = 
v®
.
¥t_·thpáhld
;

3756 ià(
v®
.
¥t_·thmaxrxt
)

3757 
asoc
->
·thmaxrxt
 = 
v®
.
¥t_·thmaxrxt
;

3758 
asoc
->
pf_»Œªs
 = 
v®
.
¥t_·thpáhld
;

3760 
Œªs
 = 
	`sùp_addr_id2Œª¥Üt
(
sk
, &
v®
.
¥t_add»ss
,

3761 
v®
.
¥t_assoc_id
);

3762 ià(!
Œªs
)

3763  -
ENOENT
;

3765 ià(
v®
.
¥t_·thmaxrxt
)

3766 
Œªs
->
·thmaxrxt
 = 
v®
.
¥t_·thmaxrxt
;

3767 
Œªs
->
pf_»Œªs
 = 
v®
.
¥t_·thpáhld
;

3771 
	}
}

3792 
SCTP_STATIC
 
	$sùp_£tsockİt
(
sock
 *
sk
, 
Ëv–
, 
İŠame
,

3793 
__u£r
 *
İtv®
, 
İ’
)

3795 
»tv®
 = 0;

3797 
	`SCTP_DEBUG_PRINTK
("sctp_setsockopt(sk: %p... optname: %d)\n",

3798 
sk
, 
İŠame
);

3806 ià(
Ëv–
 !ğ
SOL_SCTP
) {

3807 
sùp_af
 *
af
 = 
	`sùp_sk
(
sk
)->
pf
->af;

3808 
»tv®
 = 
af
->
	`£tsockİt
(
sk
, 
Ëv–
, 
İŠame
, 
İtv®
, 
İ’
);

3809 
out_nouÆock
;

3812 
	`sùp_lock_sock
(
sk
);

3814 
İŠame
) {

3815 
SCTP_SOCKOPT_BINDX_ADD
:

3817 
»tv®
 = 
	`sùp_£tsockİt_bšdx
(
sk
, (
sockaddr
 
__u£r
 *)
İtv®
,

3818 
İ’
, 
SCTP_BINDX_ADD_ADDR
);

3821 
SCTP_SOCKOPT_BINDX_REM
:

3823 
»tv®
 = 
	`sùp_£tsockİt_bšdx
(
sk
, (
sockaddr
 
__u£r
 *)
İtv®
,

3824 
İ’
, 
SCTP_BINDX_REM_ADDR
);

3827 
SCTP_SOCKOPT_CONNECTX_OLD
:

3829 
»tv®
 = 
	`sùp_£tsockİt_cÚÃùx_Şd
(
sk
,

3830 (
sockaddr
 
__u£r
 *)
İtv®
,

3831 
İ’
);

3834 
SCTP_SOCKOPT_CONNECTX
:

3836 
»tv®
 = 
	`sùp_£tsockİt_cÚÃùx
(
sk
,

3837 (
sockaddr
 
__u£r
 *)
İtv®
,

3838 
İ’
);

3841 
SCTP_DISABLE_FRAGMENTS
:

3842 
»tv®
 = 
	`sùp_£tsockİt_di§bË_äagm’ts
(
sk
, 
İtv®
, 
İ’
);

3845 
SCTP_EVENTS
:

3846 
»tv®
 = 
	`sùp_£tsockİt_ev’ts
(
sk
, 
İtv®
, 
İ’
);

3849 
SCTP_AUTOCLOSE
:

3850 
»tv®
 = 
	`sùp_£tsockİt_autoşo£
(
sk
, 
İtv®
, 
İ’
);

3853 
SCTP_PEER_ADDR_PARAMS
:

3854 
»tv®
 = 
	`sùp_£tsockİt_³”_addr_·¿ms
(
sk
, 
İtv®
, 
İ’
);

3857 
SCTP_DELAYED_SACK
:

3858 
»tv®
 = 
	`sùp_£tsockİt_d–ayed_ack
(
sk
, 
İtv®
, 
İ’
);

3860 
SCTP_PARTIAL_DELIVERY_POINT
:

3861 
»tv®
 = 
	`sùp_£tsockİt_·¹Ÿl_d–iv”y_pošt
(
sk
, 
İtv®
, 
İ’
);

3864 
SCTP_INITMSG
:

3865 
»tv®
 = 
	`sùp_£tsockİt_š™msg
(
sk
, 
İtv®
, 
İ’
);

3867 
SCTP_DEFAULT_SEND_PARAM
:

3868 
»tv®
 = 
	`sùp_£tsockİt_deçuÉ_£nd_·¿m
(
sk
, 
İtv®
,

3869 
İ’
);

3871 
SCTP_PRIMARY_ADDR
:

3872 
»tv®
 = 
	`sùp_£tsockİt_´im¬y_addr
(
sk
, 
İtv®
, 
İ’
);

3874 
SCTP_SET_PEER_PRIMARY_ADDR
:

3875 
»tv®
 = 
	`sùp_£tsockİt_³”_´im¬y_addr
(
sk
, 
İtv®
, 
İ’
);

3877 
SCTP_NODELAY
:

3878 
»tv®
 = 
	`sùp_£tsockİt_nod–ay
(
sk
, 
İtv®
, 
İ’
);

3880 
SCTP_RTOINFO
:

3881 
»tv®
 = 
	`sùp_£tsockİt_¹ošfo
(
sk
, 
İtv®
, 
İ’
);

3883 
SCTP_ASSOCINFO
:

3884 
»tv®
 = 
	`sùp_£tsockİt_assocšfo
(
sk
, 
İtv®
, 
İ’
);

3886 
SCTP_I_WANT_MAPPED_V4_ADDR
:

3887 
»tv®
 = 
	`sùp_£tsockİt_m­³dv4
(
sk
, 
İtv®
, 
İ’
);

3889 
SCTP_MAXSEG
:

3890 
»tv®
 = 
	`sùp_£tsockİt_max£g
(
sk
, 
İtv®
, 
İ’
);

3892 
SCTP_ADAPTATION_LAYER
:

3893 
»tv®
 = 
	`sùp_£tsockİt_ad­tiÚ_Ïy”
(
sk
, 
İtv®
, 
İ’
);

3895 
SCTP_CONTEXT
:

3896 
»tv®
 = 
	`sùp_£tsockİt_cÚ‹xt
(
sk
, 
İtv®
, 
İ’
);

3898 
SCTP_FRAGMENT_INTERLEAVE
:

3899 
»tv®
 = 
	`sùp_£tsockİt_äagm’t_š‹¾—ve
(
sk
, 
İtv®
, 
İ’
);

3901 
SCTP_MAX_BURST
:

3902 
»tv®
 = 
	`sùp_£tsockİt_maxbur¡
(
sk
, 
İtv®
, 
İ’
);

3904 
SCTP_AUTH_CHUNK
:

3905 
»tv®
 = 
	`sùp_£tsockİt_auth_chunk
(
sk
, 
İtv®
, 
İ’
);

3907 
SCTP_HMAC_IDENT
:

3908 
»tv®
 = 
	`sùp_£tsockİt_hmac_id’t
(
sk
, 
İtv®
, 
İ’
);

3910 
SCTP_AUTH_KEY
:

3911 
»tv®
 = 
	`sùp_£tsockİt_auth_key
(
sk
, 
İtv®
, 
İ’
);

3913 
SCTP_AUTH_ACTIVE_KEY
:

3914 
»tv®
 = 
	`sùp_£tsockİt_aùive_key
(
sk
, 
İtv®
, 
İ’
);

3916 
SCTP_AUTH_DELETE_KEY
:

3917 
»tv®
 = 
	`sùp_£tsockİt_d–_key
(
sk
, 
İtv®
, 
İ’
);

3919 
SCTP_PEER_ADDR_THLDS
:

3920 
»tv®
 = 
	`sùp_£tsockİt_·ddr_th»shŞds
(
sk
, 
İtv®
, 
İ’
);

3922 
SCTP_SET_ASSOC
:

3923 
»tv®
 = 
	`sùp_£tsockİt_£t_assoc
(
sk
, 
İtv®
, 
İ’
);

3926 
»tv®
 = -
ENOPROTOOPT
;

3930 
	`sùp_»Ëa£_sock
(
sk
);

3932 
out_nouÆock
:

3933  
»tv®
;

3934 
	}
}

3952 
SCTP_STATIC
 
	$sùp_cÚÃù
(
sock
 *
sk
, 
sockaddr
 *
addr
,

3953 
addr_Ën
)

3955 
”r
 = 0;

3956 
sùp_af
 *
af
;

3958 
	`sùp_lock_sock
(
sk
);

3960 
	`SCTP_DEBUG_PRINTK
("%s - sk: %p, sockaddr: %p,‡ddr_len: %d\n",

3961 
__func__
, 
sk
, 
addr
, 
addr_Ën
);

3964 
af
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§_çmy
);

3965 ià(!
af
 || 
addr_Ën
 <‡f->
sockaddr_Ën
) {

3966 
”r
 = -
EINVAL
;

3971 
”r
 = 
	`__sùp_cÚÃù
(
sk
, 
addr
, 
af
->
sockaddr_Ën
, 
NULL
);

3974 
	`sùp_»Ëa£_sock
(
sk
);

3975  
”r
;

3976 
	}
}

3979 
SCTP_STATIC
 
	$sùp_discÚÃù
(
sock
 *
sk
, 
æags
)

3981  -
EOPNOTSUPP
;

3982 
	}
}

3991 
SCTP_STATIC
 
sock
 *
	$sùp_acû±
(
sock
 *
sk
, 
æags
, *
”r
)

3993 
sùp_sock
 *
¥
;

3994 
sùp_’dpošt
 *
•
;

3995 
sock
 *
Ãwsk
 = 
NULL
;

3996 
sùp_assocŸtiÚ
 *
asoc
;

3997 
timeo
;

3998 
”rÜ
 = 0;

4000 
	`sùp_lock_sock
(
sk
);

4002 
¥
 = 
	`sùp_sk
(
sk
);

4003 
•
 = 
¥
->ep;

4005 ià(!
	`sùp_¡yË
(
sk
, 
TCP
)) {

4006 
”rÜ
 = -
EOPNOTSUPP
;

4007 
out
;

4010 ià(!
	`sùp_s¡©e
(
sk
, 
LISTENING
)) {

4011 
”rÜ
 = -
EINVAL
;

4012 
out
;

4015 
timeo
 = 
	`sock_rcvtimeo
(
sk
, 
æags
 & 
O_NONBLOCK
);

4017 
”rÜ
 = 
	`sùp_wa™_fÜ_acû±
(
sk
, 
timeo
);

4018 ià(
”rÜ
)

4019 
out
;

4024 
asoc
 = 
	`li¡_’Œy
(
•
->
asocs
.
Ãxt
, 
sùp_assocŸtiÚ
,‡socs);

4026 
Ãwsk
 = 
¥
->
pf
->
	`ü—‹_acû±_sk
(
sk
, 
asoc
);

4027 ià(!
Ãwsk
) {

4028 
”rÜ
 = -
ENOMEM
;

4029 
out
;

4035 
	`sùp_sock_mig¿‹
(
sk
, 
Ãwsk
, 
asoc
, 
SCTP_SOCKET_TCP
);

4037 
out
:

4038 
	`sùp_»Ëa£_sock
(
sk
);

4039 *
”r
 = 
”rÜ
;

4040  
Ãwsk
;

4041 
	}
}

4044 
SCTP_STATIC
 
	$sùp_ioùl
(
sock
 *
sk
, 
cmd
, 
¬g
)

4046  -
ENOIOCTLCMD
;

4047 
	}
}

4053 
SCTP_STATIC
 
	$sùp_š™_sock
(
sock
 *
sk
)

4055 
sùp_’dpošt
 *
•
;

4056 
sùp_sock
 *
¥
;

4058 
	`SCTP_DEBUG_PRINTK
("sùp_š™_sock(sk: %p)\n", 
sk
);

4060 
¥
 = 
	`sùp_sk
(
sk
);

4063 
sk
->
sk_ty³
) {

4064 
SOCK_SEQPACKET
:

4065 
¥
->
ty³
 = 
SCTP_SOCKET_UDP
;

4067 
SOCK_STREAM
:

4068 
¥
->
ty³
 = 
SCTP_SOCKET_TCP
;

4071  -
ESOCKTNOSUPPORT
;

4077 
¥
->
deçuÉ_¡»am
 = 0;

4078 
¥
->
deçuÉ_µid
 = 0;

4079 
¥
->
deçuÉ_æags
 = 0;

4080 
¥
->
deçuÉ_cÚ‹xt
 = 0;

4081 
¥
->
deçuÉ_tim‘Şive
 = 0;

4083 
¥
->
deçuÉ_rcv_cÚ‹xt
 = 0;

4084 
¥
->
max_bur¡
 = 
sùp_max_bur¡
;

4090 
¥
->
š™msg
.
sš™_num_o¡»ams
 = 
sùp_max_out¡»ams
;

4091 
¥
->
š™msg
.
sš™_max_š¡»ams
 = 
sùp_max_š¡»ams
;

4092 
¥
->
š™msg
.
sš™_max_©‹m±s
 = 
sùp_max_»Œªs_š™
;

4093 
¥
->
š™msg
.
sš™_max_š™_timeo
 = 
sùp_¹o_max
;

4098 
¥
->
¹ošfo
.
¤to_š™Ÿl
 = 
sùp_¹o_š™Ÿl
;

4099 
¥
->
¹ošfo
.
¤to_max
 = 
sùp_¹o_max
;

4100 
¥
->
¹ošfo
.
¤to_mš
 = 
sùp_¹o_mš
;

4105 
¥
->
assoı¬ams
.
§soc_asocmaxrxt
 = 
sùp_max_»Œªs_assocŸtiÚ
;

4106 
¥
->
assoı¬ams
.
§soc_numb”_³”_de¡š©iÚs
 = 0;

4107 
¥
->
assoı¬ams
.
§soc_³”_rwnd
 = 0;

4108 
¥
->
assoı¬ams
.
§soc_loÿl_rwnd
 = 0;

4109 
¥
->
assoı¬ams
.
§soc_cook›_liã
 = 
sùp_v®id_cook›_liã
;

4114 
	`mem£t
(&
¥
->
subsüibe
, 0, (
sùp_ev’t_subsüibe
));

4119 
¥
->
hbš‹rv®
 = 
sùp_hb_š‹rv®
;

4120 
¥
->
·thmaxrxt
 = 
sùp_max_»Œªs_·th
;

4121 
¥
->
·thmtu
 = 0;

4122 
¥
->
§ckd–ay
 = 
sùp_§ck_timeout
;

4123 
¥
->
§ckäeq
 = 2;

4124 
¥
->
·¿m_æags
 = 
SPP_HB_ENABLE
 |

4125 
SPP_PMTUD_ENABLE
 |

4126 
SPP_SACKDELAY_ENABLE
;

4131 
¥
->
di§bË_äagm’ts
 = 0;

4134 
¥
->
nod–ay
 = 0;

4137 
¥
->
v4m­³d
 = 1;

4144 
¥
->
autoşo£
 = 0;

4147 
¥
->
u£r_äag
 = 0;

4149 
¥
->
ad­tiÚ_šd
 = 0;

4151 
¥
->
pf
 = 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
);

4154 
	`©omic_£t
(&
¥
->
pd_mode
, 0);

4155 
	`skb_queue_h—d_š™
(&
¥
->
pd_lobby
);

4156 
¥
->
äag_š‹¾—ve
 = 0;

4162 
•
 = 
	`sùp_’dpošt_Ãw
(
sk
, 
GFP_KERNEL
);

4163 ià(!
•
)

4164  -
ENOMEM
;

4166 
¥
->
•
 =ƒp;

4167 
¥
->
hmac
 = 
NULL
;

4169 
	`SCTP_DBG_OBJCNT_INC
(
sock
);

4171 
	`loÿl_bh_di§bË
();

4172 
	`³rıu_couÁ”_šc
(&
sùp_sock‘s_®loÿ‹d
);

4173 
	`sock_´Ù_šu£_add
(
	`sock_Ãt
(
sk
), sk->
sk_´Ù
, 1);

4174 
	`loÿl_bh_’abË
();

4177 
	}
}

4180 
SCTP_STATIC
 
	$sùp_de¡roy_sock
(
sock
 *
sk
)

4182 
sùp_’dpošt
 *
•
;

4184 
	`SCTP_DEBUG_PRINTK
("sùp_de¡roy_sock(sk: %p)\n", 
sk
);

4187 
•
 = 
	`sùp_sk
(
sk
)->ep;

4188 
	`sùp_’dpošt_ä“
(
•
);

4189 
	`loÿl_bh_di§bË
();

4190 
	`³rıu_couÁ”_dec
(&
sùp_sock‘s_®loÿ‹d
);

4191 
	`sock_´Ù_šu£_add
(
	`sock_Ãt
(
sk
), sk->
sk_´Ù
, -1);

4192 
	`loÿl_bh_’abË
();

4193 
	}
}

4211 
SCTP_STATIC
 
	$sùp_shutdown
(
sock
 *
sk
, 
how
)

4213 
sùp_’dpošt
 *
•
;

4214 
sùp_assocŸtiÚ
 *
asoc
;

4216 ià(!
	`sùp_¡yË
(
sk
, 
TCP
))

4219 ià(
how
 & 
SEND_SHUTDOWN
) {

4220 
•
 = 
	`sùp_sk
(
sk
)->ep;

4221 ià(!
	`li¡_em±y
(&
•
->
asocs
))

4223 
asoc
 = 
	`li¡_’Œy
(
•
->
asocs
.
Ãxt
, 
sùp_assocŸtiÚ
,‡socs);

4225 if(
asoc
->
³”
.
cook›
 &&‡soc->³”.
cook›_Ën
)

4227 
	`´štk
("shu‰šg‡soø%°³” cook› %°pÜˆ%d\n", 
asoc
,‡soc->
³”
.
cook›
,‡soc->
c
.
my_pÜt
);

4228 
	`sùp_´im™ive_SHUTDOWN
(
asoc
, 
NULL
);

4232 
	}
}

4241 
	$sùp_g‘sockİt_sùp_¡©us
(
sock
 *
sk
, 
Ën
,

4242 
__u£r
 *
İtv®
,

4243 
__u£r
 *
İ’
)

4245 
sùp_¡©us
 
¡©us
;

4246 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

4247 
sùp_Œª¥Üt
 *
Œª¥Üt
;

4248 
sùp_assoc_t
 
associd
;

4249 
»tv®
 = 0;

4251 ià(
Ën
 < (
¡©us
)) {

4252 
»tv®
 = -
EINVAL
;

4253 
out
;

4256 
Ën
 = (
¡©us
);

4257 ià(
	`cİy_äom_u£r
(&
¡©us
, 
İtv®
, 
Ën
)) {

4258 
»tv®
 = -
EFAULT
;

4259 
out
;

4262 
associd
 = 
¡©us
.
s¡©_assoc_id
;

4263 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
associd
);

4264 ià(!
asoc
) {

4265 
»tv®
 = -
EINVAL
;

4266 
out
;

4269 
Œª¥Üt
 = 
asoc
->
³”
.
´im¬y_·th
;

4271 
¡©us
.
s¡©_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

4272 
¡©us
.
s¡©_¡©e
 = 
asoc
->
¡©e
;

4273 
¡©us
.
s¡©_rwnd
 = 
asoc
->
³”
.
rwnd
;

4274 
¡©us
.
s¡©_uÇckd©a
 = 
asoc
->
uÇck_d©a
;

4276 
¡©us
.
s¡©_³ndd©a
 = 
	`sùp_t¢m­_³ndšg
(&
asoc
->
³”
.
t¢_m­
);

4277 
¡©us
.
s¡©_š¡rms
 = 
asoc
->
c
.
sš™_max_š¡»ams
;

4278 
¡©us
.
s¡©_out¡rms
 = 
asoc
->
c
.
sš™_num_o¡»ams
;

4279 
¡©us
.
s¡©_äagm’tiÚ_pošt
 = 
asoc
->
äag_pošt
;

4280 
¡©us
.
s¡©_´im¬y
.
¥šfo_assoc_id
 = 
	`sùp_assoc2id
(
Œª¥Üt
->
asoc
);

4281 
	`memıy
(&
¡©us
.
s¡©_´im¬y
.
¥šfo_add»ss
, &
Œª¥Üt
->
addr
,

4282 
Œª¥Üt
->
af_¥ecific
->
sockaddr_Ën
);

4284 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
	`sùp_sk
(sk),

4285 (
sùp_addr
 *)&
¡©us
.
s¡©_´im¬y
.
¥šfo_add»ss
);

4286 
¡©us
.
s¡©_´im¬y
.
¥šfo_¡©e
 = 
Œª¥Üt
->
¡©e
;

4287 
¡©us
.
s¡©_´im¬y
.
¥šfo_cwnd
 = 
Œª¥Üt
->
cwnd
;

4288 
¡©us
.
s¡©_´im¬y
.
¥šfo_¤‰
 = 
Œª¥Üt
->
¤‰
;

4289 
¡©us
.
s¡©_´im¬y
.
¥šfo_¹o
 = 
	`jiff›s_to_m£cs
(
Œª¥Üt
->
¹o
);

4290 
¡©us
.
s¡©_´im¬y
.
¥šfo_mtu
 = 
Œª¥Üt
->
·thmtu
;

4292 ià(
¡©us
.
s¡©_´im¬y
.
¥šfo_¡©e
 =ğ
SCTP_UNKNOWN
)

4293 
¡©us
.
s¡©_´im¬y
.
¥šfo_¡©e
 = 
SCTP_ACTIVE
;

4295 ià(
	`put_u£r
(
Ën
, 
İ’
)) {

4296 
»tv®
 = -
EFAULT
;

4297 
out
;

4300 
	`SCTP_DEBUG_PRINTK
("sctp_getsockopt_sctp_status(%d): %d %d %d\n",

4301 
Ën
, 
¡©us
.
s¡©_¡©e
, stus.
s¡©_rwnd
,

4302 
¡©us
.
s¡©_assoc_id
);

4304 ià(
	`cİy_to_u£r
(
İtv®
, &
¡©us
, 
Ën
)) {

4305 
»tv®
 = -
EFAULT
;

4306 
out
;

4309 
out
:

4310  (
»tv®
);

4311 
	}
}

4321 
	$sùp_g‘sockİt_³”_addr_šfo
(
sock
 *
sk
, 
Ën
,

4322 
__u£r
 *
İtv®
,

4323 
__u£r
 *
İ’
)

4325 
sùp_·ddršfo
 
pšfo
;

4326 
sùp_Œª¥Üt
 *
Œª¥Üt
;

4327 
»tv®
 = 0;

4329 ià(
Ën
 < (
pšfo
)) {

4330 
»tv®
 = -
EINVAL
;

4331 
out
;

4334 
Ën
 = (
pšfo
);

4335 ià(
	`cİy_äom_u£r
(&
pšfo
, 
İtv®
, 
Ën
)) {

4336 
»tv®
 = -
EFAULT
;

4337 
out
;

4340 
Œª¥Üt
 = 
	`sùp_addr_id2Œª¥Üt
(
sk
, &
pšfo
.
¥šfo_add»ss
,

4341 
pšfo
.
¥šfo_assoc_id
);

4342 ià(!
Œª¥Üt
)

4343  -
EINVAL
;

4345 
pšfo
.
¥šfo_assoc_id
 = 
	`sùp_assoc2id
(
Œª¥Üt
->
asoc
);

4346 
pšfo
.
¥šfo_¡©e
 = 
Œª¥Üt
->
¡©e
;

4347 
pšfo
.
¥šfo_cwnd
 = 
Œª¥Üt
->
cwnd
;

4348 
pšfo
.
¥šfo_¤‰
 = 
Œª¥Üt
->
¤‰
;

4349 
pšfo
.
¥šfo_¹o
 = 
	`jiff›s_to_m£cs
(
Œª¥Üt
->
¹o
);

4350 
pšfo
.
¥šfo_mtu
 = 
Œª¥Üt
->
·thmtu
;

4352 ià(
pšfo
.
¥šfo_¡©e
 =ğ
SCTP_UNKNOWN
)

4353 
pšfo
.
¥šfo_¡©e
 = 
SCTP_ACTIVE
;

4355 ià(
	`put_u£r
(
Ën
, 
İ’
)) {

4356 
»tv®
 = -
EFAULT
;

4357 
out
;

4360 ià(
	`cİy_to_u£r
(
İtv®
, &
pšfo
, 
Ën
)) {

4361 
»tv®
 = -
EFAULT
;

4362 
out
;

4365 
out
:

4366  (
»tv®
);

4367 
	}
}

4376 
	$sùp_g‘sockİt_di§bË_äagm’ts
(
sock
 *
sk
, 
Ën
,

4377 
__u£r
 *
İtv®
, __u£¸*
İ’
)

4379 
v®
;

4381 ià(
Ën
 < ())

4382  -
EINVAL
;

4384 
Ën
 = ();

4385 
v®
 = (
	`sùp_sk
(
sk
)->
di§bË_äagm’ts
 == 1);

4386 ià(
	`put_u£r
(
Ën
, 
İ’
))

4387  -
EFAULT
;

4388 ià(
	`cİy_to_u£r
(
İtv®
, &
v®
, 
Ën
))

4389  -
EFAULT
;

4391 
	}
}

4394 
	ssùp_ev’t_subsüibe_rh–6_kabi
 {

4395 
__u8
 
	msùp_d©a_io_ev’t
;

4396 
__u8
 
	msùp_assocŸtiÚ_ev’t
;

4397 
__u8
 
	msùp_add»ss_ev’t
;

4398 
__u8
 
	msùp_£nd_çu»_ev’t
;

4399 
__u8
 
	msùp_³”_”rÜ_ev’t
;

4400 
__u8
 
	msùp_shutdown_ev’t
;

4401 
__u8
 
	msùp_·¹Ÿl_d–iv”y_ev’t
;

4402 
__u8
 
	msùp_ad­tiÚ_Ïy”_ev’t
;

4403 
__u8
 
	msùp_auth’tiÿtiÚ_ev’t
;

4411 
	$sùp_g‘sockİt_ev’ts
(
sock
 *
sk
, 
Ën
, 
__u£r
 *
İtv®
,

4412 
__u£r
 *
İ’
)

4415 
	`BUILD_BUG_ON
((
sùp_ev’t_subsüibe
)

4416 < (
sùp_ev’t_subsüibe_rh–6_kabi
));

4425 ià(
Ën
 < (
sùp_ev’t_subsüibe_rh–6_kabi
))

4426  -
EINVAL
;

4434 ià(
Ën
 > (
sùp_ev’t_subsüibe
))

4435 
Ën
 = (
sùp_ev’t_subsüibe
);

4437 ià(
	`put_u£r
(
Ën
, 
İ’
))

4438  -
EFAULT
;

4439 ià(
	`cİy_to_u£r
(
İtv®
, &
	`sùp_sk
(
sk
)->
subsüibe
, 
Ën
))

4440  -
EFAULT
;

4442 
	}
}

4455 
	$sùp_g‘sockİt_autoşo£
(
sock
 *
sk
, 
Ën
, 
__u£r
 *
İtv®
, __u£¸*
İ’
)

4458 ià(
	`sùp_¡yË
(
sk
, 
TCP
))

4459  -
EOPNOTSUPP
;

4460 ià(
Ën
 < ())

4461  -
EINVAL
;

4462 
Ën
 = ();

4463 ià(
	`put_u£r
(
Ën
, 
İ’
))

4464  -
EFAULT
;

4465 ià(
	`cİy_to_u£r
(
İtv®
, &
	`sùp_sk
(
sk
)->
autoşo£
, ()))

4466  -
EFAULT
;

4468 
	}
}

4471 
SCTP_STATIC
 
	$sùp_do_³–off
(
sùp_assocŸtiÚ
 *
asoc
,

4472 
sock‘
 **
sockp
)

4474 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

4475 
sock‘
 *
sock
;

4476 
sùp_af
 *
af
;

4477 
”r
 = 0;

4482 ià(!
	`sùp_¡yË
(
sk
, 
UDP
))

4483  -
EINVAL
;

4486 
”r
 = 
	`sock_ü—‹
(
sk
->
sk_çmy
, 
SOCK_SEQPACKET
, 
IPPROTO_SCTP
, &
sock
);

4487 ià(
”r
 < 0)

4488  
”r
;

4490 
	`sùp_cİy_sock
(
sock
->
sk
, sk, 
asoc
);

4495 
af
 = 
	`sùp_g‘_af_¥ecific
(
asoc
->
³”
.
´im¬y_addr
.
§
.
§_çmy
);

4496 
af
->
	`to_sk_daddr
(&
asoc
->
³”
.
´im¬y_addr
, 
sk
);

4501 
	`sùp_sock_mig¿‹
(
sk
, 
sock
->sk, 
asoc
, 
SCTP_SOCKET_UDP_HIGH_BANDWIDTH
);

4503 *
sockp
 = 
sock
;

4505  
”r
;

4506 
	}
}

4508 
	$sùp_g‘sockİt_³–off
(
sock
 *
sk
, 
Ën
, 
__u£r
 *
İtv®
, __u£¸*
İ’
)

4510 
sùp_³–off_¬g_t
 
³–off
;

4511 
sock‘
 *
Ãwsock
;

4512 
»tv®
 = 0;

4513 
sùp_assocŸtiÚ
 *
asoc
;

4515 ià(
Ën
 < (
sùp_³–off_¬g_t
))

4516  -
EINVAL
;

4517 
Ën
 = (
sùp_³–off_¬g_t
);

4518 ià(
	`cİy_äom_u£r
(&
³–off
, 
İtv®
, 
Ën
))

4519  -
EFAULT
;

4521 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
³–off
.
associd
);

4522 ià(!
asoc
) {

4523 
»tv®
 = -
EINVAL
;

4524 
out
;

4527 
	`SCTP_DEBUG_PRINTK
("%s: sk: %°asoc: %p\n", 
__func__
, 
sk
, 
asoc
);

4529 
»tv®
 = 
	`sùp_do_³–off
(
asoc
, &
Ãwsock
);

4530 ià(
»tv®
 < 0)

4531 
out
;

4534 
»tv®
 = 
	`sock_m­_fd
(
Ãwsock
, 0);

4535 ià(
»tv®
 < 0) {

4536 
	`sock_»Ëa£
(
Ãwsock
);

4537 
out
;

4540 
	`SCTP_DEBUG_PRINTK
("%s: sk: %p‡soc: %p‚ewsk: %p sd: %d\n",

4541 
__func__
, 
sk
, 
asoc
, 
Ãwsock
->sk, 
»tv®
);

4544 
³–off
.
sd
 = 
»tv®
;

4545 ià(
	`put_u£r
(
Ën
, 
İ’
))

4546  -
EFAULT
;

4547 ià(
	`cİy_to_u£r
(
İtv®
, &
³–off
, 
Ën
))

4548 
»tv®
 = -
EFAULT
;

4550 
out
:

4551  
»tv®
;

4552 
	}
}

4647 
	$sùp_g‘sockİt_³”_addr_·¿ms
(
sock
 *
sk
, 
Ën
,

4648 
__u£r
 *
İtv®
, __u£¸*
İ’
)

4650 
sùp_·dd½¬ams
 
·¿ms
;

4651 
sùp_Œª¥Üt
 *
Œªs
 = 
NULL
;

4652 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

4653 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

4655 ià(
Ën
 < (
sùp_·dd½¬ams
))

4656  -
EINVAL
;

4657 
Ën
 = (
sùp_·dd½¬ams
);

4658 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
Ën
))

4659  -
EFAULT
;

4664 ià(!
	`sùp_is_ªy
(
sk
, ( 
sùp_addr
 *)&
·¿ms
.
¥p_add»ss
)) {

4665 
Œªs
 = 
	`sùp_addr_id2Œª¥Üt
(
sk
, &
·¿ms
.
¥p_add»ss
,

4666 
·¿ms
.
¥p_assoc_id
);

4667 ià(!
Œªs
) {

4668 
	`SCTP_DEBUG_PRINTK
("Failed‚oransport\n");

4669  -
EINVAL
;

4677 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
¥p_assoc_id
);

4678 ià(!
asoc
 && 
·¿ms
.
¥p_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
)) {

4679 
	`SCTP_DEBUG_PRINTK
("Failed‚o‡ssociation\n");

4680  -
EINVAL
;

4683 ià(
Œªs
) {

4685 
·¿ms
.
¥p_hbš‹rv®
 = 
	`jiff›s_to_m£cs
(
Œªs
->
hbš‹rv®
);

4686 
·¿ms
.
¥p_·thmtu
 = 
Œªs
->
·thmtu
;

4687 
·¿ms
.
¥p_·thmaxrxt
 = 
Œªs
->
·thmaxrxt
;

4688 
·¿ms
.
¥p_§ckd–ay
 = 
	`jiff›s_to_m£cs
(
Œªs
->
§ckd–ay
);

4691 
·¿ms
.
¥p_æags
 = 
Œªs
->
·¿m_æags
;

4692 } ià(
asoc
) {

4694 
·¿ms
.
¥p_hbš‹rv®
 = 
	`jiff›s_to_m£cs
(
asoc
->
hbš‹rv®
);

4695 
·¿ms
.
¥p_·thmtu
 = 
asoc
->
·thmtu
;

4696 
·¿ms
.
¥p_·thmaxrxt
 = 
asoc
->
·thmaxrxt
;

4697 
·¿ms
.
¥p_§ckd–ay
 = 
	`jiff›s_to_m£cs
(
asoc
->
§ckd–ay
);

4700 
·¿ms
.
¥p_æags
 = 
asoc
->
·¿m_æags
;

4703 
·¿ms
.
¥p_hbš‹rv®
 = 
¥
->
hbš‹rv®
;

4704 
·¿ms
.
¥p_·thmtu
 = 
¥
->
·thmtu
;

4705 
·¿ms
.
¥p_§ckd–ay
 = 
¥
->
§ckd–ay
;

4706 
·¿ms
.
¥p_·thmaxrxt
 = 
¥
->
·thmaxrxt
;

4709 
·¿ms
.
¥p_æags
 = 
¥
->
·¿m_æags
;

4712 ià(
	`cİy_to_u£r
(
İtv®
, &
·¿ms
, 
Ën
))

4713  -
EFAULT
;

4715 ià(
	`put_u£r
(
Ën
, 
İ’
))

4716  -
EFAULT
;

4719 
	}
}

4756 
	$sùp_g‘sockİt_d–ayed_ack
(
sock
 *
sk
, 
Ën
,

4757 
__u£r
 *
İtv®
,

4758 
__u£r
 *
İ’
)

4760 
sùp_§ck_šfo
 
·¿ms
;

4761 
sùp_assocŸtiÚ
 *
asoc
 = 
NULL
;

4762 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

4764 ià(
Ën
 >ğ(
sùp_§ck_šfo
)) {

4765 
Ën
 = (
sùp_§ck_šfo
);

4767 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
Ën
))

4768  -
EFAULT
;

4769 } ià(
Ën
 =ğ(
sùp_assoc_v®ue
)) {

4770 
	`´štk
(
KERN_WARNING
 "SCTP: Use of struct sctp_assoc_value "

4772 
	`´štk
(
KERN_WARNING
 "SCTP: Use struct sctp_sack_info instead\n");

4773 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
Ën
))

4774  -
EFAULT
;

4776  - 
EINVAL
;

4782 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
§ck_assoc_id
);

4783 ià(!
asoc
 && 
·¿ms
.
§ck_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

4784  -
EINVAL
;

4786 ià(
asoc
) {

4788 ià(
asoc
->
·¿m_æags
 & 
SPP_SACKDELAY_ENABLE
) {

4789 
·¿ms
.
§ck_d–ay
 = 
	`jiff›s_to_m£cs
(

4790 
asoc
->
§ckd–ay
);

4791 
·¿ms
.
§ck_äeq
 = 
asoc
->
§ckäeq
;

4794 
·¿ms
.
§ck_d–ay
 = 0;

4795 
·¿ms
.
§ck_äeq
 = 1;

4799 ià(
¥
->
·¿m_æags
 & 
SPP_SACKDELAY_ENABLE
) {

4800 
·¿ms
.
§ck_d–ay
 = 
¥
->
§ckd–ay
;

4801 
·¿ms
.
§ck_äeq
 = 
¥
->
§ckäeq
;

4803 
·¿ms
.
§ck_d–ay
 = 0;

4804 
·¿ms
.
§ck_äeq
 = 1;

4808 ià(
	`cİy_to_u£r
(
İtv®
, &
·¿ms
, 
Ën
))

4809  -
EFAULT
;

4811 ià(
	`put_u£r
(
Ën
, 
İ’
))

4812  -
EFAULT
;

4815 
	}
}

4828 
	$sùp_g‘sockİt_š™msg
(
sock
 *
sk
, 
Ën
, 
__u£r
 *
İtv®
, __u£¸*
İ’
)

4830 ià(
Ën
 < (
sùp_š™msg
))

4831  -
EINVAL
;

4832 
Ën
 = (
sùp_š™msg
);

4833 ià(
	`put_u£r
(
Ën
, 
İ’
))

4834  -
EFAULT
;

4835 ià(
	`cİy_to_u£r
(
İtv®
, &
	`sùp_sk
(
sk
)->
š™msg
, 
Ën
))

4836  -
EFAULT
;

4838 
	}
}

4840 
	$sùp_g‘sockİt_³”_addrs_num_Şd
(
sock
 *
sk
, 
Ën
,

4841 
__u£r
 *
İtv®
,

4842 
__u£r
 *
İ’
)

4844 
sùp_assoc_t
 
id
;

4845 
sùp_assocŸtiÚ
 *
asoc
;

4846 
li¡_h—d
 *
pos
;

4847 
út
 = 0;

4849 ià(
Ën
 < (
sùp_assoc_t
))

4850  -
EINVAL
;

4852 ià(
	`cİy_äom_u£r
(&
id
, 
İtv®
, (
sùp_assoc_t
)))

4853  -
EFAULT
;

4855 
	`´štk
(
KERN_WARNING
 "SCTP: Use of SCTP_GET_PEER_ADDRS_NUM_OLD "

4858 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
id
);

4859 ià(!
asoc
)

4860  -
EINVAL
;

4862 
	`li¡_fÜ_—ch
(
pos
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
) {

4863 
út
 ++;

4866  
út
;

4867 
	}
}

4873 
	$sùp_g‘sockİt_³”_addrs_Şd
(
sock
 *
sk
, 
Ën
,

4874 
__u£r
 *
İtv®
,

4875 
__u£r
 *
İ’
)

4877 
sùp_assocŸtiÚ
 *
asoc
;

4878 
út
 = 0;

4879 
sùp_g‘addrs_Şd
 
g‘addrs
;

4880 
sùp_Œª¥Üt
 *
äom
;

4881 
__u£r
 *
to
;

4882 
sùp_addr
 
‹mp
;

4883 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

4884 
add¾’
;

4886 ià(
Ën
 < (
sùp_g‘addrs_Şd
))

4887  -
EINVAL
;

4889 
Ën
 = (
sùp_g‘addrs_Şd
);

4891 ià(
	`cİy_äom_u£r
(&
g‘addrs
, 
İtv®
, 
Ën
))

4892  -
EFAULT
;

4894 ià(
g‘addrs
.
addr_num
 <ğ0è -
EINVAL
;

4896 
	`´štk
(
KERN_WARNING
 "SCTP: Use of SCTP_GET_PEER_ADDRS_OLD "

4900 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
g‘addrs
.
assoc_id
);

4901 ià(!
asoc
)

4902  -
EINVAL
;

4904 
to
 = (
__u£r
 *)
g‘addrs
.
addrs
;

4905 
	`li¡_fÜ_—ch_’Œy
(
äom
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

4906 
Œª¥Üts
) {

4907 
	`memıy
(&
‹mp
, &
äom
->
addr
, (temp));

4908 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
¥
, &
‹mp
);

4909 
add¾’
 = 
	`sùp_g‘_af_¥ecific
(
sk
->
sk_çmy
)->
sockaddr_Ën
;

4910 ià(
	`cİy_to_u£r
(
to
, &
‹mp
, 
add¾’
))

4911  -
EFAULT
;

4912 
to
 +ğ
add¾’
 ;

4913 
út
 ++;

4914 ià(
út
 >ğ
g‘addrs
.
addr_num
) ;

4916 
g‘addrs
.
addr_num
 = 
út
;

4917 ià(
	`put_u£r
(
Ën
, 
İ’
))

4918  -
EFAULT
;

4919 ià(
	`cİy_to_u£r
(
İtv®
, &
g‘addrs
, 
Ën
))

4920  -
EFAULT
;

4923 
	}
}

4925 
	$sùp_g‘sockİt_³”_addrs
(
sock
 *
sk
, 
Ën
,

4926 
__u£r
 *
İtv®
, __u£¸*
İ’
)

4928 
sùp_assocŸtiÚ
 *
asoc
;

4929 
út
 = 0;

4930 
sùp_g‘addrs
 
g‘addrs
;

4931 
sùp_Œª¥Üt
 *
äom
;

4932 
__u£r
 *
to
;

4933 
sùp_addr
 
‹mp
;

4934 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

4935 
add¾’
;

4936 
size_t
 
¥aû_Ëá
;

4937 
by‹s_cİ›d
;

4939 ià(
Ën
 < (
sùp_g‘addrs
))

4940  -
EINVAL
;

4942 ià(
	`cİy_äom_u£r
(&
g‘addrs
, 
İtv®
, (
sùp_g‘addrs
)))

4943  -
EFAULT
;

4946 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
g‘addrs
.
assoc_id
);

4947 ià(!
asoc
)

4948  -
EINVAL
;

4950 
to
 = 
İtv®
 + 
	`off£tof
(
sùp_g‘addrs
,
addrs
);

4951 
¥aû_Ëá
 = 
Ën
 - 
	`off£tof
(
sùp_g‘addrs
,
addrs
);

4953 
	`li¡_fÜ_—ch_’Œy
(
äom
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
,

4954 
Œª¥Üts
) {

4955 
	`memıy
(&
‹mp
, &
äom
->
addr
, (temp));

4956 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
¥
, &
‹mp
);

4957 
add¾’
 = 
	`sùp_g‘_af_¥ecific
(
‹mp
.
§
.
§_çmy
)->
sockaddr_Ën
;

4958 ià(
¥aû_Ëá
 < 
add¾’
)

4959  -
ENOMEM
;

4960 ià(
	`cİy_to_u£r
(
to
, &
‹mp
, 
add¾’
))

4961  -
EFAULT
;

4962 
to
 +ğ
add¾’
;

4963 
út
++;

4964 
¥aû_Ëá
 -ğ
add¾’
;

4967 ià(
	`put_u£r
(
út
, &((
sùp_g‘addrs
 
__u£r
 *)
İtv®
)->
addr_num
))

4968  -
EFAULT
;

4969 
by‹s_cİ›d
 = ((
__u£r
 *)
to
è- 
İtv®
;

4970 ià(
	`put_u£r
(
by‹s_cİ›d
, 
İ’
))

4971  -
EFAULT
;

4974 
	}
}

4976 
	$sùp_g‘sockİt_loÿl_addrs_num_Şd
(
sock
 *
sk
, 
Ën
,

4977 
__u£r
 *
İtv®
,

4978 
__u£r
 *
İ’
)

4980 
sùp_assoc_t
 
id
;

4981 
sùp_bšd_addr
 *
bp
;

4982 
sùp_assocŸtiÚ
 *
asoc
;

4983 
sùp_sockaddr_’Œy
 *
addr
;

4984 
út
 = 0;

4986 ià(
Ën
 < (
sùp_assoc_t
))

4987  -
EINVAL
;

4989 ià(
	`cİy_äom_u£r
(&
id
, 
İtv®
, (
sùp_assoc_t
)))

4990  -
EFAULT
;

4992 
	`´štk
(
KERN_WARNING
 "SCTP: Use of SCTP_GET_LOCAL_ADDRS_NUM_OLD "

5001 ià(0 =ğ
id
) {

5002 
bp
 = &
	`sùp_sk
(
sk
)->
•
->
ba£
.
bšd_addr
;

5004 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
id
);

5005 ià(!
asoc
)

5006  -
EINVAL
;

5007 
bp
 = &
asoc
->
ba£
.
bšd_addr
;

5013 ià(
	`sùp_li¡_sšgË_’Œy
(&
bp
->
add»ss_li¡
)) {

5014 
addr
 = 
	`li¡_’Œy
(
bp
->
add»ss_li¡
.
Ãxt
,

5015 
sùp_sockaddr_’Œy
, 
li¡
);

5016 ià(
	`sùp_is_ªy
(
sk
, &
addr
->
a
)) {

5017 
	`rcu_»ad_lock
();

5018 
	`li¡_fÜ_—ch_’Œy_rcu
(
addr
,

5019 &
sùp_loÿl_addr_li¡
, 
li¡
) {

5020 ià(!
addr
->
v®id
)

5023 ià((
PF_INET
 =ğ
sk
->
sk_çmy
) &&

5024 (
AF_INET6
 =ğ
addr
->
a
.
§
.
§_çmy
))

5027 ià((
PF_INET6
 =ğ
sk
->
sk_çmy
) &&

5028 
	`š‘_v6_v6Úly
(
sk
) &&

5029 (
AF_INET
 =ğ
addr
->
a
.
§
.
§_çmy
))

5032 
út
++;

5034 
	`rcu_»ad_uÆock
();

5036 
út
 = 1;

5038 
dÚe
;

5045 
	`li¡_fÜ_—ch_’Œy
(
addr
, &
bp
->
add»ss_li¡
, 
li¡
) {

5046 
út
 ++;

5048 
dÚe
:

5049  
út
;

5050 
	}
}

5055 
	$sùp_cİy_Ïddrs_Şd
(
sock
 *
sk
, 
__u16
 
pÜt
,

5056 
max_addrs
, *
to
,

5057 *
by‹s_cİ›d
)

5059 
sùp_sockaddr_’Œy
 *
addr
;

5060 
sùp_addr
 
‹mp
;

5061 
út
 = 0;

5062 
add¾’
;

5064 
	`rcu_»ad_lock
();

5065 
	`li¡_fÜ_—ch_’Œy_rcu
(
addr
, &
sùp_loÿl_addr_li¡
, 
li¡
) {

5066 ià(!
addr
->
v®id
)

5069 ià((
PF_INET
 =ğ
sk
->
sk_çmy
) &&

5070 (
AF_INET6
 =ğ
addr
->
a
.
§
.
§_çmy
))

5072 ià((
PF_INET6
 =ğ
sk
->
sk_çmy
) &&

5073 
	`š‘_v6_v6Úly
(
sk
) &&

5074 (
AF_INET
 =ğ
addr
->
a
.
§
.
§_çmy
))

5076 
	`memıy
(&
‹mp
, &
addr
->
a
, (temp));

5077 ià(!
‹mp
.
v4
.
sš_pÜt
)

5078 
‹mp
.
v4
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

5080 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
	`sùp_sk
(sk),

5081 &
‹mp
);

5082 
add¾’
 = 
	`sùp_g‘_af_¥ecific
(
‹mp
.
§
.
§_çmy
)->
sockaddr_Ën
;

5083 
	`memıy
(
to
, &
‹mp
, 
add¾’
);

5085 
to
 +ğ
add¾’
;

5086 *
by‹s_cİ›d
 +ğ
add¾’
;

5087 
út
 ++;

5088 ià(
út
 >ğ
max_addrs
) ;

5090 
	`rcu_»ad_uÆock
();

5092  
út
;

5093 
	}
}

5095 
	$sùp_cİy_Ïddrs
(
sock
 *
sk
, 
__u16
 
pÜt
, *
to
,

5096 
size_t
 
¥aû_Ëá
, *
by‹s_cİ›d
)

5098 
sùp_sockaddr_’Œy
 *
addr
;

5099 
sùp_addr
 
‹mp
;

5100 
út
 = 0;

5101 
add¾’
;

5103 
	`rcu_»ad_lock
();

5104 
	`li¡_fÜ_—ch_’Œy_rcu
(
addr
, &
sùp_loÿl_addr_li¡
, 
li¡
) {

5105 ià(!
addr
->
v®id
)

5108 ià((
PF_INET
 =ğ
sk
->
sk_çmy
) &&

5109 (
AF_INET6
 =ğ
addr
->
a
.
§
.
§_çmy
))

5111 ià((
PF_INET6
 =ğ
sk
->
sk_çmy
) &&

5112 
	`š‘_v6_v6Úly
(
sk
) &&

5113 (
AF_INET
 =ğ
addr
->
a
.
§
.
§_çmy
))

5115 
	`memıy
(&
‹mp
, &
addr
->
a
, (temp));

5116 ià(!
‹mp
.
v4
.
sš_pÜt
)

5117 
‹mp
.
v4
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

5119 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
	`sùp_sk
(sk),

5120 &
‹mp
);

5121 
add¾’
 = 
	`sùp_g‘_af_¥ecific
(
‹mp
.
§
.
§_çmy
)->
sockaddr_Ën
;

5122 ià(
¥aû_Ëá
 < 
add¾’
) {

5123 
út
 = -
ENOMEM
;

5126 
	`memıy
(
to
, &
‹mp
, 
add¾’
);

5128 
to
 +ğ
add¾’
;

5129 
út
 ++;

5130 
¥aû_Ëá
 -ğ
add¾’
;

5131 *
by‹s_cİ›d
 +ğ
add¾’
;

5133 
	`rcu_»ad_uÆock
();

5135  
út
;

5136 
	}
}

5141 
	$sùp_g‘sockİt_loÿl_addrs_Şd
(
sock
 *
sk
, 
Ën
,

5142 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5144 
sùp_bšd_addr
 *
bp
;

5145 
sùp_assocŸtiÚ
 *
asoc
;

5146 
út
 = 0;

5147 
sùp_g‘addrs_Şd
 
g‘addrs
;

5148 
sùp_sockaddr_’Œy
 *
addr
;

5149 
__u£r
 *
to
;

5150 
sùp_addr
 
‹mp
;

5151 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

5152 
add¾’
;

5153 
”r
 = 0;

5154 *
addrs
;

5155 *
buf
;

5156 
by‹s_cİ›d
 = 0;

5158 ià(
Ën
 < (
sùp_g‘addrs_Şd
))

5159  -
EINVAL
;

5161 
Ën
 = (
sùp_g‘addrs_Şd
);

5162 ià(
	`cİy_äom_u£r
(&
g‘addrs
, 
İtv®
, 
Ën
))

5163  -
EFAULT
;

5165 ià(
g‘addrs
.
addr_num
 <= 0 ||

5166 
g‘addrs
.
addr_num
 >ğ(
INT_MAX
 / (
sùp_addr
)))

5167  -
EINVAL
;

5169 
	`´štk
(
KERN_WARNING
 "SCTP: Use of SCTP_GET_LOCAL_ADDRS_OLD "

5178 ià(0 =ğ
g‘addrs
.
assoc_id
) {

5179 
bp
 = &
	`sùp_sk
(
sk
)->
•
->
ba£
.
bšd_addr
;

5181 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
g‘addrs
.
assoc_id
);

5182 ià(!
asoc
)

5183  -
EINVAL
;

5184 
bp
 = &
asoc
->
ba£
.
bšd_addr
;

5187 
to
 = 
g‘addrs
.
addrs
;

5193 
addrs
 = 
	`km®loc
((
sùp_addr
è* 
g‘addrs
.
addr_num
,

5194 
GFP_KERNEL
);

5195 ià(!
addrs
)

5196  -
ENOMEM
;

5201 ià(
	`sùp_li¡_sšgË_’Œy
(&
bp
->
add»ss_li¡
)) {

5202 
addr
 = 
	`li¡_’Œy
(
bp
->
add»ss_li¡
.
Ãxt
,

5203 
sùp_sockaddr_’Œy
, 
li¡
);

5204 ià(
	`sùp_is_ªy
(
sk
, &
addr
->
a
)) {

5205 
út
 = 
	`sùp_cİy_Ïddrs_Şd
(
sk
, 
bp
->
pÜt
,

5206 
g‘addrs
.
addr_num
,

5207 
addrs
, &
by‹s_cİ›d
);

5208 
cİy_g‘addrs
;

5212 
buf
 = 
addrs
;

5217 
	`li¡_fÜ_—ch_’Œy
(
addr
, &
bp
->
add»ss_li¡
, 
li¡
) {

5218 
	`memıy
(&
‹mp
, &
addr
->
a
, (temp));

5219 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
¥
, &
‹mp
);

5220 
add¾’
 = 
	`sùp_g‘_af_¥ecific
(
‹mp
.
§
.
§_çmy
)->
sockaddr_Ën
;

5221 
	`memıy
(
buf
, &
‹mp
, 
add¾’
);

5222 
buf
 +ğ
add¾’
;

5223 
by‹s_cİ›d
 +ğ
add¾’
;

5224 
út
 ++;

5225 ià(
út
 >ğ
g‘addrs
.
addr_num
) ;

5228 
cİy_g‘addrs
:

5230 ià(
	`cİy_to_u£r
(
to
, 
addrs
, 
by‹s_cİ›d
)) {

5231 
”r
 = -
EFAULT
;

5232 
”rÜ
;

5236 
g‘addrs
.
addr_num
 = 
út
;

5237 ià(
	`cİy_to_u£r
(
İtv®
, &
g‘addrs
, 
Ën
))

5238 
”r
 = -
EFAULT
;

5240 
”rÜ
:

5241 
	`kä“
(
addrs
);

5242  
”r
;

5243 
	}
}

5245 
	$sùp_g‘sockİt_loÿl_addrs
(
sock
 *
sk
, 
Ën
,

5246 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5248 
sùp_bšd_addr
 *
bp
;

5249 
sùp_assocŸtiÚ
 *
asoc
;

5250 
út
 = 0;

5251 
sùp_g‘addrs
 
g‘addrs
;

5252 
sùp_sockaddr_’Œy
 *
addr
;

5253 
__u£r
 *
to
;

5254 
sùp_addr
 
‹mp
;

5255 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

5256 
add¾’
;

5257 
”r
 = 0;

5258 
size_t
 
¥aû_Ëá
;

5259 
by‹s_cİ›d
 = 0;

5260 *
addrs
;

5261 *
buf
;

5263 ià(
Ën
 < (
sùp_g‘addrs
))

5264  -
EINVAL
;

5266 ià(
	`cİy_äom_u£r
(&
g‘addrs
, 
İtv®
, (
sùp_g‘addrs
)))

5267  -
EFAULT
;

5275 ià(0 =ğ
g‘addrs
.
assoc_id
) {

5276 
bp
 = &
	`sùp_sk
(
sk
)->
•
->
ba£
.
bšd_addr
;

5278 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
g‘addrs
.
assoc_id
);

5279 ià(!
asoc
)

5280  -
EINVAL
;

5281 
bp
 = &
asoc
->
ba£
.
bšd_addr
;

5284 
to
 = 
İtv®
 + 
	`off£tof
(
sùp_g‘addrs
,
addrs
);

5285 
¥aû_Ëá
 = 
Ën
 - 
	`off£tof
(
sùp_g‘addrs
,
addrs
);

5287 
addrs
 = 
	`km®loc
(
¥aû_Ëá
, 
GFP_KERNEL
);

5288 ià(!
addrs
)

5289  -
ENOMEM
;

5294 ià(
	`sùp_li¡_sšgË_’Œy
(&
bp
->
add»ss_li¡
)) {

5295 
addr
 = 
	`li¡_’Œy
(
bp
->
add»ss_li¡
.
Ãxt
,

5296 
sùp_sockaddr_’Œy
, 
li¡
);

5297 ià(
	`sùp_is_ªy
(
sk
, &
addr
->
a
)) {

5298 
út
 = 
	`sùp_cİy_Ïddrs
(
sk
, 
bp
->
pÜt
, 
addrs
,

5299 
¥aû_Ëá
, &
by‹s_cİ›d
);

5300 ià(
út
 < 0) {

5301 
”r
 = 
út
;

5302 
out
;

5304 
cİy_g‘addrs
;

5308 
buf
 = 
addrs
;

5313 
	`li¡_fÜ_—ch_’Œy
(
addr
, &
bp
->
add»ss_li¡
, 
li¡
) {

5314 
	`memıy
(&
‹mp
, &
addr
->
a
, (temp));

5315 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
¥
, &
‹mp
);

5316 
add¾’
 = 
	`sùp_g‘_af_¥ecific
(
‹mp
.
§
.
§_çmy
)->
sockaddr_Ën
;

5317 ià(
¥aû_Ëá
 < 
add¾’
) {

5318 
”r
 = -
ENOMEM
;

5319 
out
;

5321 
	`memıy
(
buf
, &
‹mp
, 
add¾’
);

5322 
buf
 +ğ
add¾’
;

5323 
by‹s_cİ›d
 +ğ
add¾’
;

5324 
út
 ++;

5325 
¥aû_Ëá
 -ğ
add¾’
;

5328 
cİy_g‘addrs
:

5329 ià(
	`cİy_to_u£r
(
to
, 
addrs
, 
by‹s_cİ›d
)) {

5330 
”r
 = -
EFAULT
;

5331 
out
;

5333 ià(
	`put_u£r
(
út
, &((
sùp_g‘addrs
 
__u£r
 *)
İtv®
)->
addr_num
)) {

5334 
”r
 = -
EFAULT
;

5335 
out
;

5337 ià(
	`put_u£r
(
by‹s_cİ›d
, 
İ’
))

5338 
”r
 = -
EFAULT
;

5339 
out
:

5340 
	`kä“
(
addrs
);

5341  
”r
;

5342 
	}
}

5350 
	$sùp_g‘sockİt_´im¬y_addr
(
sock
 *
sk
, 
Ën
,

5351 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5353 
sùp_´im
 
´im
;

5354 
sùp_assocŸtiÚ
 *
asoc
;

5355 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

5357 ià(
Ën
 < (
sùp_´im
))

5358  -
EINVAL
;

5360 
Ën
 = (
sùp_´im
);

5362 ià(
	`cİy_äom_u£r
(&
´im
, 
İtv®
, 
Ën
))

5363  -
EFAULT
;

5365 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
´im
.
s¥_assoc_id
);

5366 ià(!
asoc
)

5367  -
EINVAL
;

5369 ià(!
asoc
->
³”
.
´im¬y_·th
)

5370  -
ENOTCONN
;

5372 
	`memıy
(&
´im
.
s¥_addr
, &
asoc
->
³”
.
´im¬y_·th
->
addr
,

5373 
asoc
->
³”
.
´im¬y_·th
->
af_¥ecific
->
sockaddr_Ën
);

5375 
	`sùp_g‘_pf_¥ecific
(
sk
->
sk_çmy
)->
	`addr_v4m­
(
¥
,

5376 (
sùp_addr
 *)&
´im
.
s¥_addr
);

5378 ià(
	`put_u£r
(
Ën
, 
İ’
))

5379  -
EFAULT
;

5380 ià(
	`cİy_to_u£r
(
İtv®
, &
´im
, 
Ën
))

5381  -
EFAULT
;

5384 
	}
}

5392 
	$sùp_g‘sockİt_ad­tiÚ_Ïy”
(
sock
 *
sk
, 
Ën
,

5393 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5395 
sùp_£d­tiÚ
 
ad­tiÚ
;

5397 ià(
Ën
 < (
sùp_£d­tiÚ
))

5398  -
EINVAL
;

5400 
Ën
 = (
sùp_£d­tiÚ
);

5402 
ad­tiÚ
.
ssb_ad­tiÚ_šd
 = 
	`sùp_sk
(
sk
)->
ad­tiÚ_šd
;

5404 ià(
	`put_u£r
(
Ën
, 
İ’
))

5405  -
EFAULT
;

5406 ià(
	`cİy_to_u£r
(
İtv®
, &
ad­tiÚ
, 
Ën
))

5407  -
EFAULT
;

5410 
	}
}

5431 
	$sùp_g‘sockİt_deçuÉ_£nd_·¿m
(
sock
 *
sk
,

5432 
Ën
, 
__u£r
 *
İtv®
,

5433 
__u£r
 *
İ’
)

5435 
sùp_¢drcvšfo
 
šfo
;

5436 
sùp_assocŸtiÚ
 *
asoc
;

5437 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

5439 ià(
Ën
 < (
sùp_¢drcvšfo
))

5440  -
EINVAL
;

5442 
Ën
 = (
sùp_¢drcvšfo
);

5444 ià(
	`cİy_äom_u£r
(&
šfo
, 
İtv®
, 
Ën
))

5445  -
EFAULT
;

5447 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
šfo
.
sšfo_assoc_id
);

5448 ià(!
asoc
 && 
šfo
.
sšfo_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

5449  -
EINVAL
;

5451 ià(
asoc
) {

5452 
šfo
.
sšfo_¡»am
 = 
asoc
->
deçuÉ_¡»am
;

5453 
šfo
.
sšfo_æags
 = 
asoc
->
deçuÉ_æags
;

5454 
šfo
.
sšfo_µid
 = 
asoc
->
deçuÉ_µid
;

5455 
šfo
.
sšfo_cÚ‹xt
 = 
asoc
->
deçuÉ_cÚ‹xt
;

5456 
šfo
.
sšfo_tim‘Şive
 = 
asoc
->
deçuÉ_tim‘Şive
;

5458 
šfo
.
sšfo_¡»am
 = 
¥
->
deçuÉ_¡»am
;

5459 
šfo
.
sšfo_æags
 = 
¥
->
deçuÉ_æags
;

5460 
šfo
.
sšfo_µid
 = 
¥
->
deçuÉ_µid
;

5461 
šfo
.
sšfo_cÚ‹xt
 = 
¥
->
deçuÉ_cÚ‹xt
;

5462 
šfo
.
sšfo_tim‘Şive
 = 
¥
->
deçuÉ_tim‘Şive
;

5465 ià(
	`put_u£r
(
Ën
, 
İ’
))

5466  -
EFAULT
;

5467 ià(
	`cİy_to_u£r
(
İtv®
, &
šfo
, 
Ën
))

5468  -
EFAULT
;

5471 
	}
}

5483 
	$sùp_g‘sockİt_nod–ay
(
sock
 *
sk
, 
Ën
,

5484 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5486 
v®
;

5488 ià(
Ën
 < ())

5489  -
EINVAL
;

5491 
Ën
 = ();

5492 
v®
 = (
	`sùp_sk
(
sk
)->
nod–ay
 == 1);

5493 ià(
	`put_u£r
(
Ën
, 
İ’
))

5494  -
EFAULT
;

5495 ià(
	`cİy_to_u£r
(
İtv®
, &
v®
, 
Ën
))

5496  -
EFAULT
;

5498 
	}
}

5512 
	$sùp_g‘sockİt_¹ošfo
(
sock
 *
sk
, 
Ën
,

5513 
__u£r
 *
İtv®
,

5514 
__u£r
 *
İ’
) {

5515 
sùp_¹ošfo
 
¹ošfo
;

5516 
sùp_assocŸtiÚ
 *
asoc
;

5518 ià(
Ën
 <  (
sùp_¹ošfo
))

5519  -
EINVAL
;

5521 
Ën
 = (
sùp_¹ošfo
);

5523 ià(
	`cİy_äom_u£r
(&
¹ošfo
, 
İtv®
, 
Ën
))

5524  -
EFAULT
;

5526 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
¹ošfo
.
¤to_assoc_id
);

5528 ià(!
asoc
 && 
¹ošfo
.
¤to_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

5529  -
EINVAL
;

5532 ià(
asoc
) {

5533 
¹ošfo
.
¤to_š™Ÿl
 = 
	`jiff›s_to_m£cs
(
asoc
->
¹o_š™Ÿl
);

5534 
¹ošfo
.
¤to_max
 = 
	`jiff›s_to_m£cs
(
asoc
->
¹o_max
);

5535 
¹ošfo
.
¤to_mš
 = 
	`jiff›s_to_m£cs
(
asoc
->
¹o_mš
);

5538 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

5540 
¹ošfo
.
¤to_š™Ÿl
 = 
¥
->rtoinfo.srto_initial;

5541 
¹ošfo
.
¤to_max
 = 
¥
->rtoinfo.srto_max;

5542 
¹ošfo
.
¤to_mš
 = 
¥
->rtoinfo.srto_min;

5545 ià(
	`put_u£r
(
Ën
, 
İ’
))

5546  -
EFAULT
;

5548 ià(
	`cİy_to_u£r
(
İtv®
, &
¹ošfo
, 
Ën
))

5549  -
EFAULT
;

5552 
	}
}

5565 
	$sùp_g‘sockİt_assocšfo
(
sock
 *
sk
, 
Ën
,

5566 
__u£r
 *
İtv®
,

5567 
__u£r
 *
İ’
)

5570 
sùp_assoı¬ams
 
assoı¬ams
;

5571 
sùp_assocŸtiÚ
 *
asoc
;

5572 
li¡_h—d
 *
pos
;

5573 
út
 = 0;

5575 ià(
Ën
 <  (
sùp_assoı¬ams
))

5576  -
EINVAL
;

5578 
Ën
 = (
sùp_assoı¬ams
);

5580 ià(
	`cİy_äom_u£r
(&
assoı¬ams
, 
İtv®
, 
Ën
))

5581  -
EFAULT
;

5583 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
assoı¬ams
.
§soc_assoc_id
);

5585 ià(!
asoc
 && 
assoı¬ams
.
§soc_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

5586  -
EINVAL
;

5589 ià(
asoc
) {

5590 
assoı¬ams
.
§soc_asocmaxrxt
 = 
asoc
->
max_»Œªs
;

5591 
assoı¬ams
.
§soc_³”_rwnd
 = 
asoc
->
³”
.
rwnd
;

5592 
assoı¬ams
.
§soc_loÿl_rwnd
 = 
asoc
->
a_rwnd
;

5593 
assoı¬ams
.
§soc_cook›_liã
 = (
asoc
->
cook›_liã
.
tv_£c


5595 (
asoc
->
cook›_liã
.
tv_u£c


5598 
	`li¡_fÜ_—ch
(
pos
, &
asoc
->
³”
.
Œª¥Üt_addr_li¡
) {

5599 
út
 ++;

5602 
assoı¬ams
.
§soc_numb”_³”_de¡š©iÚs
 = 
út
;

5605 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

5607 
assoı¬ams
.
§soc_asocmaxrxt
 = 
¥
->assocparams.sasoc_asocmaxrxt;

5608 
assoı¬ams
.
§soc_³”_rwnd
 = 
¥
->assocparams.sasoc_peer_rwnd;

5609 
assoı¬ams
.
§soc_loÿl_rwnd
 = 
¥
->assocparams.sasoc_local_rwnd;

5610 
assoı¬ams
.
§soc_cook›_liã
 =

5611 
¥
->
assoı¬ams
.
§soc_cook›_liã
;

5612 
assoı¬ams
.
§soc_numb”_³”_de¡š©iÚs
 =

5613 
¥
->
assoı¬ams
.

5614 
§soc_numb”_³”_de¡š©iÚs
;

5617 ià(
	`put_u£r
(
Ën
, 
İ’
))

5618  -
EFAULT
;

5620 ià(
	`cİy_to_u£r
(
İtv®
, &
assoı¬ams
, 
Ën
))

5621  -
EFAULT
;

5624 
	}
}

5636 
	$sùp_g‘sockİt_m­³dv4
(
sock
 *
sk
, 
Ën
,

5637 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5639 
v®
;

5640 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

5642 ià(
Ën
 < ())

5643  -
EINVAL
;

5645 
Ën
 = ();

5646 
v®
 = 
¥
->
v4m­³d
;

5647 ià(
	`put_u£r
(
Ën
, 
İ’
))

5648  -
EFAULT
;

5649 ià(
	`cİy_to_u£r
(
İtv®
, &
v®
, 
Ën
))

5650  -
EFAULT
;

5653 
	}
}

5659 
	$sùp_g‘sockİt_cÚ‹xt
(
sock
 *
sk
, 
Ën
,

5660 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5662 
sùp_assoc_v®ue
 
·¿ms
;

5663 
sùp_sock
 *
¥
;

5664 
sùp_assocŸtiÚ
 *
asoc
;

5666 ià(
Ën
 < (
sùp_assoc_v®ue
))

5667  -
EINVAL
;

5669 
Ën
 = (
sùp_assoc_v®ue
);

5671 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
Ën
))

5672  -
EFAULT
;

5674 
¥
 = 
	`sùp_sk
(
sk
);

5676 ià(
·¿ms
.
assoc_id
 != 0) {

5677 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
assoc_id
);

5678 ià(!
asoc
)

5679  -
EINVAL
;

5680 
·¿ms
.
assoc_v®ue
 = 
asoc
->
deçuÉ_rcv_cÚ‹xt
;

5682 
·¿ms
.
assoc_v®ue
 = 
¥
->
deçuÉ_rcv_cÚ‹xt
;

5685 ià(
	`put_u£r
(
Ën
, 
İ’
))

5686  -
EFAULT
;

5687 ià(
	`cİy_to_u£r
(
İtv®
, &
·¿ms
, 
Ën
))

5688  -
EFAULT
;

5691 
	}
}

5720 
	$sùp_g‘sockİt_max£g
(
sock
 *
sk
, 
Ën
,

5721 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5723 
sùp_assoc_v®ue
 
·¿ms
;

5724 
sùp_assocŸtiÚ
 *
asoc
;

5726 ià(
Ën
 == ()) {

5727 
	`´štk
(
KERN_WARNING


5729 
	`´štk
(
KERN_WARNING


5731 
·¿ms
.
assoc_id
 = 0;

5732 } ià(
Ën
 >ğ(
sùp_assoc_v®ue
)) {

5733 
Ën
 = (
sùp_assoc_v®ue
);

5734 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, (params)))

5735  -
EFAULT
;

5737  -
EINVAL
;

5739 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
assoc_id
);

5740 ià(!
asoc
 && 
·¿ms
.
assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

5741  -
EINVAL
;

5743 ià(
asoc
)

5744 
·¿ms
.
assoc_v®ue
 = 
asoc
->
äag_pošt
;

5746 
·¿ms
.
assoc_v®ue
 = 
	`sùp_sk
(
sk
)->
u£r_äag
;

5748 ià(
	`put_u£r
(
Ën
, 
İ’
))

5749  -
EFAULT
;

5750 ià(
Ën
 == ()) {

5751 ià(
	`cİy_to_u£r
(
İtv®
, &
·¿ms
.
assoc_v®ue
, 
Ën
))

5752  -
EFAULT
;

5754 ià(
	`cİy_to_u£r
(
İtv®
, &
·¿ms
, 
Ën
))

5755  -
EFAULT
;

5759 
	}
}

5765 
	$sùp_g‘sockİt_äagm’t_š‹¾—ve
(
sock
 *
sk
, 
Ën
,

5766 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5768 
v®
;

5770 ià(
Ën
 < ())

5771  -
EINVAL
;

5773 
Ën
 = ();

5775 
v®
 = 
	`sùp_sk
(
sk
)->
äag_š‹¾—ve
;

5776 ià(
	`put_u£r
(
Ën
, 
İ’
))

5777  -
EFAULT
;

5778 ià(
	`cİy_to_u£r
(
İtv®
, &
v®
, 
Ën
))

5779  -
EFAULT
;

5782 
	}
}

5788 
	$sùp_g‘sockİt_·¹Ÿl_d–iv”y_pošt
(
sock
 *
sk
, 
Ën
,

5789 
__u£r
 *
İtv®
,

5790 
__u£r
 *
İ’
)

5792 
u32
 
v®
;

5794 ià(
Ën
 < (
u32
))

5795  -
EINVAL
;

5797 
Ën
 = (
u32
);

5799 
v®
 = 
	`sùp_sk
(
sk
)->
pd_pošt
;

5800 ià(
	`put_u£r
(
Ën
, 
İ’
))

5801  -
EFAULT
;

5802 ià(
	`cİy_to_u£r
(
İtv®
, &
v®
, 
Ën
))

5803  -
EFAULT
;

5806 
	}
}

5812 
	$sùp_g‘sockİt_maxbur¡
(
sock
 *
sk
, 
Ën
,

5813 
__u£r
 *
İtv®
,

5814 
__u£r
 *
İ’
)

5816 
sùp_assoc_v®ue
 
·¿ms
;

5817 
sùp_sock
 *
¥
;

5818 
sùp_assocŸtiÚ
 *
asoc
;

5820 ià(
Ën
 == ()) {

5821 
	`´štk
(
KERN_WARNING


5823 
	`´štk
(
KERN_WARNING


5825 
·¿ms
.
assoc_id
 = 0;

5826 } ià(
Ën
 >ğ(
sùp_assoc_v®ue
)) {

5827 
Ën
 = (
sùp_assoc_v®ue
);

5828 ià(
	`cİy_äom_u£r
(&
·¿ms
, 
İtv®
, 
Ën
))

5829  -
EFAULT
;

5831  -
EINVAL
;

5833 
¥
 = 
	`sùp_sk
(
sk
);

5835 ià(
·¿ms
.
assoc_id
 != 0) {

5836 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
·¿ms
.
assoc_id
);

5837 ià(!
asoc
)

5838  -
EINVAL
;

5839 
·¿ms
.
assoc_v®ue
 = 
asoc
->
max_bur¡
;

5841 
·¿ms
.
assoc_v®ue
 = 
¥
->
max_bur¡
;

5843 ià(
Ën
 == ()) {

5844 ià(
	`cİy_to_u£r
(
İtv®
, &
·¿ms
.
assoc_v®ue
, 
Ën
))

5845  -
EFAULT
;

5847 ià(
	`cİy_to_u£r
(
İtv®
, &
·¿ms
, 
Ën
))

5848  -
EFAULT
;

5853 
	}
}

5855 
	$sùp_g‘sockİt_hmac_id’t
(
sock
 *
sk
, 
Ën
,

5856 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5858 
sùp_hmaÿlgo
 
__u£r
 *
p
 = (__u£¸*)
İtv®
;

5859 
sùp_hmac_®go_·¿m
 *
hmacs
;

5860 
__u16
 
d©a_Ën
 = 0;

5861 
u32
 
num_id’ts
;

5863 ià(!
sùp_auth_’abË
)

5864  -
EACCES
;

5866 
hmacs
 = 
	`sùp_sk
(
sk
)->
•
->
auth_hmacs_li¡
;

5867 
d©a_Ën
 = 
	`Áohs
(
hmacs
->
·¿m_hdr
.
Ëngth
è- (
sùp_·¿mhdr_t
);

5869 ià(
Ën
 < (
sùp_hmaÿlgo
è+ 
d©a_Ën
)

5870  -
EINVAL
;

5872 
Ën
 = (
sùp_hmaÿlgo
è+ 
d©a_Ën
;

5873 
num_id’ts
 = 
d©a_Ën
 / (
u16
);

5875 ià(
	`put_u£r
(
Ën
, 
İ’
))

5876  -
EFAULT
;

5877 ià(
	`put_u£r
(
num_id’ts
, &
p
->
shmac_num_id’ts
))

5878  -
EFAULT
;

5879 ià(
	`cİy_to_u£r
(
p
->
shmac_id’ts
, 
hmacs
->
hmac_ids
, 
d©a_Ën
))

5880  -
EFAULT
;

5882 
	}
}

5884 
	$sùp_g‘sockİt_aùive_key
(
sock
 *
sk
, 
Ën
,

5885 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5887 
sùp_authkeyid
 
v®
;

5888 
sùp_assocŸtiÚ
 *
asoc
;

5890 ià(!
sùp_auth_’abË
)

5891  -
EACCES
;

5893 ià(
Ën
 < (
sùp_authkeyid
))

5894  -
EINVAL
;

5895 ià(
	`cİy_äom_u£r
(&
v®
, 
İtv®
, (
sùp_authkeyid
)))

5896  -
EFAULT
;

5898 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
v®
.
sÿù_assoc_id
);

5899 ià(!
asoc
 && 
v®
.
sÿù_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

5900  -
EINVAL
;

5902 ià(
asoc
)

5903 
v®
.
sÿù_keynumb”
 = 
asoc
->
aùive_key_id
;

5905 
v®
.
sÿù_keynumb”
 = 
	`sùp_sk
(
sk
)->
•
->
aùive_key_id
;

5907 
Ën
 = (
sùp_authkeyid
);

5908 ià(
	`put_u£r
(
Ën
, 
İ’
))

5909  -
EFAULT
;

5910 ià(
	`cİy_to_u£r
(
İtv®
, &
v®
, 
Ën
))

5911  -
EFAULT
;

5914 
	}
}

5916 
	$sùp_g‘sockİt_³”_auth_chunks
(
sock
 *
sk
, 
Ën
,

5917 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5919 
sùp_authchunks
 
__u£r
 *
p
 = (__u£¸*)
İtv®
;

5920 
sùp_authchunks
 
v®
;

5921 
sùp_assocŸtiÚ
 *
asoc
;

5922 
sùp_chunks_·¿m
 *
ch
;

5923 
u32
 
num_chunks
 = 0;

5924 
__u£r
 *
to
;

5926 ià(!
sùp_auth_’abË
)

5927  -
EACCES
;

5929 ià(
Ën
 < (
sùp_authchunks
))

5930  -
EINVAL
;

5932 ià(
	`cİy_äom_u£r
(&
v®
, 
İtv®
, (
sùp_authchunks
)))

5933  -
EFAULT
;

5935 
to
 = 
p
->
gauth_chunks
;

5936 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
v®
.
gauth_assoc_id
);

5937 ià(!
asoc
)

5938  -
EINVAL
;

5940 
ch
 = 
asoc
->
³”
.
³”_chunks
;

5941 ià(!
ch
)

5942 
num
;

5945 
num_chunks
 = 
	`Áohs
(
ch
->
·¿m_hdr
.
Ëngth
è- (
sùp_·¿mhdr_t
);

5946 ià(
Ën
 < 
num_chunks
)

5947  -
EINVAL
;

5949 ià(
	`cİy_to_u£r
(
to
, 
ch
->
chunks
, 
num_chunks
))

5950  -
EFAULT
;

5951 
num
:

5952 
Ën
 = (
sùp_authchunks
è+ 
num_chunks
;

5953 ià(
	`put_u£r
(
Ën
, 
İ’
)è -
EFAULT
;

5954 ià(
	`put_u£r
(
num_chunks
, &
p
->
gauth_numb”_of_chunks
))

5955  -
EFAULT
;

5957 
	}
}

5959 
	$sùp_g‘sockİt_loÿl_auth_chunks
(
sock
 *
sk
, 
Ën
,

5960 
__u£r
 *
İtv®
, __u£¸*
İ’
)

5962 
sùp_authchunks
 
__u£r
 *
p
 = (__u£¸*)
İtv®
;

5963 
sùp_authchunks
 
v®
;

5964 
sùp_assocŸtiÚ
 *
asoc
;

5965 
sùp_chunks_·¿m
 *
ch
;

5966 
u32
 
num_chunks
 = 0;

5967 
__u£r
 *
to
;

5969 ià(!
sùp_auth_’abË
)

5970  -
EACCES
;

5972 ià(
Ën
 < (
sùp_authchunks
))

5973  -
EINVAL
;

5975 ià(
	`cİy_äom_u£r
(&
v®
, 
İtv®
, (
sùp_authchunks
)))

5976  -
EFAULT
;

5978 
to
 = 
p
->
gauth_chunks
;

5979 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
v®
.
gauth_assoc_id
);

5980 ià(!
asoc
 && 
v®
.
gauth_assoc_id
 && 
	`sùp_¡yË
(
sk
, 
UDP
))

5981  -
EINVAL
;

5983 ià(
asoc
)

5984 
ch
 = (
sùp_chunks_·¿m
*)
asoc
->
c
.
auth_chunks
;

5986 
ch
 = 
	`sùp_sk
(
sk
)->
•
->
auth_chunk_li¡
;

5988 ià(!
ch
)

5989 
num
;

5991 
num_chunks
 = 
	`Áohs
(
ch
->
·¿m_hdr
.
Ëngth
è- (
sùp_·¿mhdr_t
);

5992 ià(
Ën
 < (
sùp_authchunks
è+ 
num_chunks
)

5993  -
EINVAL
;

5995 ià(
	`cİy_to_u£r
(
to
, 
ch
->
chunks
, 
num_chunks
))

5996  -
EFAULT
;

5997 
num
:

5998 
Ën
 = (
sùp_authchunks
è+ 
num_chunks
;

5999 ià(
	`put_u£r
(
Ën
, 
İ’
))

6000  -
EFAULT
;

6001 ià(
	`put_u£r
(
num_chunks
, &
p
->
gauth_numb”_of_chunks
))

6002  -
EFAULT
;

6005 
	}
}

6012 
	$sùp_g‘sockİt_assoc_numb”
(
sock
 *
sk
, 
Ën
,

6013 
__u£r
 *
İtv®
, __u£¸*
İ’
)

6015 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

6016 
sùp_assocŸtiÚ
 *
asoc
;

6017 
u32
 
v®
 = 0;

6019 ià(
	`sùp_¡yË
(
sk
, 
TCP
))

6020  -
EOPNOTSUPP
;

6022 ià(
Ën
 < (
u32
))

6023  -
EINVAL
;

6025 
Ën
 = (
u32
);

6027 
	`li¡_fÜ_—ch_’Œy
(
asoc
, &(
¥
->
•
->
asocs
),‡socs) {

6028 
v®
++;

6031 ià(
	`put_u£r
(
Ën
, 
İ’
))

6032  -
EFAULT
;

6033 ià(
	`cİy_to_u£r
(
İtv®
, &
v®
, 
Ën
))

6034  -
EFAULT
;

6037 
	}
}

6039 
	$sùp_g‘sockİt_g‘_assoc
(
sock
 *
sk
, 
Ën
, 
__u£r
 *
İtv®
, __u£¸*
İ’
)

6041 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

6042 
sùp_’dpošt
 *
•
 = 
¥
->ep;

6044 
sùp_assocŸtiÚ
 *
asoc
;

6045 
tSockMsg
 
msg
;

6050 ià(
	`cİy_äom_u£r
(&
msg
, 
İtv®
, (msg.
ty³
è+ (msg.
assoc_id
)))

6052  -
EFAULT
;

6056 ià(
msg
.
assoc_id
)

6058 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
msg
.
assoc_id
);

6060 ià(!
asoc
)

6062 
	`´štk
("ERROR: No‡ssociation\n");

6063  -
EINVAL
;

6068 
	`´štk
("KERN_INFO ERROR: User didn't sent‡ny‡ssociation\n");

6069  -
EINVAL
;

6073 
msg
.
ty³
)

6075 
ASOC_MSG
:

6076 
ASOC_CLIENT_MSG
:

6078 
tAsoc
 *
aù
 = &(
msg
.
¶
.
a
);

6079 
Ën1
 = (
tAsoc
)+ (
msg
.
ty³
è+ (msg.
assoc_id
);

6082 if(
Ën
 < 
Ën1
)

6084 
	`´štk
("ERROR:†’ %d <†’1 %d\n", 
Ën
, 
Ën1
);

6085  -
EINVAL
;

6088 
Ën
 = 
Ën1
;

6090 
msg
.
assoc_id
 = 
asoc
->assoc_id;

6091 
	`memıy
(&
aù
->
c
, &
asoc
->c,(act->c) );

6092 
	`memıy
(
aù
->
£ü‘_key
,
•
->secret_key, (ep->secret_key));

6093 
aù
->
cu¼’t_key
 = 
•
->current_key;

6094 
aù
->
a_rwnd
 = 
asoc
->
³”
.
i
.a_rwnd;

6095 
aù
->
š™Ÿl_t¢
 = 
asoc
->
³”
.
i
.initial_tsn;

6103 
UPDATE_MSG
:

6105 
tUpd©e
 *
upd
 = &(
msg
.
¶
.
u
);

6106 
Ën1
 = (
tUpd©e
)+ (
msg
.
ty³
è+ (msg.
assoc_id
);

6109 if(
Ën
 < 
Ën1
)

6111  -
EINVAL
;

6114 
Ën
 = 
Ën1
;

6115 
upd
->
adv_³”_ack_pošt
 = 
asoc
->adv_peer_ack_point;

6116 
upd
->
ù¢_ack_pošt
 = 
asoc
->ctsn_ack_point;

6117 
upd
->
highe¡_§cked
 = 
asoc
->highest_sacked;

6118 
upd
->
Ãxt_t¢
 = 
asoc
->next_tsn;

6119 
upd
->
¡©e
 = 
asoc
->state;

6120 
upd
->
ba£_t¢
 = 
asoc
->
³”
.
t¢_m­
.base_tsn;

6121 
upd
->
cumuÏtive_t¢_ack_pošt
 = 
asoc
->
³”
.
t¢_m­
.cumulative_tsn_ack_point;

6122 
upd
->
Ën
 = (
asoc
->
s¢m­
->
š
.ËÀ+‡soc->s¢m­->
out
.Ënè* (
__u16
);

6123 
	`memıy
(
upd
->
s¢m­
, 
asoc
->s¢m­->
š
.
s¢
, upd->
Ën
);

6124 
Ën
 = 
Ën1
+
upd
->len;

6129 
	`´štk
("ERROR:šv®id msgy³ %d", 
msg
.
ty³
);

6130  -
EFAULT
;

6133 ià(
	`put_u£r
(
Ën
, 
İ’
è|| 
	`cİy_to_u£r
(
İtv®
, &
msg
,†en))

6135  -
EFAULT
;

6138 
	}
}

6146 
	$sùp_g‘sockİt_assoc_ids
(
sock
 *
sk
, 
Ën
,

6147 
__u£r
 *
İtv®
, __u£¸*
İ’
)

6149 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

6150 
sùp_assocŸtiÚ
 *
asoc
;

6151 
sùp_assoc_ids
 *
ids
;

6152 
u32
 
num
 = 0;

6154 ià(
	`sùp_¡yË
(
sk
, 
TCP
))

6155  -
EOPNOTSUPP
;

6157 ià(
Ën
 < (
sùp_assoc_ids
))

6158  -
EINVAL
;

6160 
	`li¡_fÜ_—ch_’Œy
(
asoc
, &(
¥
->
•
->
asocs
),‡socs) {

6161 
num
++;

6164 ià(
Ën
 < (
sùp_assoc_ids
è+ (
sùp_assoc_t
è* 
num
)

6165  -
EINVAL
;

6167 
Ën
 = (
sùp_assoc_ids
è+ (
sùp_assoc_t
è* 
num
;

6169 
ids
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

6170 ià(
	`uÆik–y
(!
ids
))

6171  -
ENOMEM
;

6173 
ids
->
gaids_numb”_of_ids
 = 
num
;

6174 
num
 = 0;

6175 
	`li¡_fÜ_—ch_’Œy
(
asoc
, &(
¥
->
•
->
asocs
),‡socs) {

6176 
ids
->
gaids_assoc_id
[
num
++] = 
asoc
->
assoc_id
;

6179 ià(
	`put_u£r
(
Ën
, 
İ’
è|| 
	`cİy_to_u£r
(
İtv®
, 
ids
,†en)) {

6180 
	`kä“
(
ids
);

6181  -
EFAULT
;

6184 
	`kä“
(
ids
);

6186 
	}
}

6195 
	$sùp_g‘sockİt_·ddr_th»shŞds
(
sock
 *
sk
,

6196 
__u£r
 *
İtv®
,

6197 
Ën
,

6198 
__u£r
 *
İ’
)

6200 
sùp_·dd¹hlds
 
v®
;

6201 
sùp_Œª¥Üt
 *
Œªs
;

6202 
sùp_assocŸtiÚ
 *
asoc
;

6204 ià(
Ën
 < (
sùp_·dd¹hlds
))

6205  -
EINVAL
;

6206 
Ën
 = (
sùp_·dd¹hlds
);

6207 ià(
	`cİy_äom_u£r
(&
v®
, (
sùp_·dd¹hlds
 
__u£r
 *)
İtv®
, 
Ën
))

6208  -
EFAULT
;

6210 ià(
	`sùp_is_ªy
(
sk
, (cÚ¡ 
sùp_addr
 *)&
v®
.
¥t_add»ss
)) {

6211 
asoc
 = 
	`sùp_id2assoc
(
sk
, 
v®
.
¥t_assoc_id
);

6212 ià(!
asoc
)

6213  -
ENOENT
;

6215 
v®
.
¥t_·thpáhld
 = 
asoc
->
pf_»Œªs
;

6216 
v®
.
¥t_·thmaxrxt
 = 
asoc
->
·thmaxrxt
;

6218 
Œªs
 = 
	`sùp_addr_id2Œª¥Üt
(
sk
, &
v®
.
¥t_add»ss
,

6219 
v®
.
¥t_assoc_id
);

6220 ià(!
Œªs
)

6221  -
ENOENT
;

6223 
v®
.
¥t_·thmaxrxt
 = 
Œªs
->
·thmaxrxt
;

6224 
v®
.
¥t_·thpáhld
 = 
Œªs
->
pf_»Œªs
;

6227 ià(
	`put_u£r
(
Ën
, 
İ’
è|| 
	`cİy_to_u£r
(
İtv®
, &
v®
,†en))

6228  -
EFAULT
;

6231 
	}
}

6233 
SCTP_STATIC
 
	$sùp_g‘sockİt
(
sock
 *
sk
, 
Ëv–
, 
İŠame
,

6234 
__u£r
 *
İtv®
, __u£¸*
İ’
)

6236 
»tv®
 = 0;

6237 
Ën
;

6239 
	`SCTP_DEBUG_PRINTK
("sctp_getsockopt(sk: %p... optname: %d)\n",

6240 
sk
, 
İŠame
);

6248 ià(
Ëv–
 !ğ
SOL_SCTP
) {

6249 
sùp_af
 *
af
 = 
	`sùp_sk
(
sk
)->
pf
->af;

6251 
»tv®
 = 
af
->
	`g‘sockİt
(
sk
, 
Ëv–
, 
İŠame
, 
İtv®
, 
İ’
);

6252  
»tv®
;

6255 ià(
	`g‘_u£r
(
Ën
, 
İ’
))

6256  -
EFAULT
;

6258 
	`sùp_lock_sock
(
sk
);

6260 
İŠame
) {

6261 
SCTP_STATUS
:

6262 
»tv®
 = 
	`sùp_g‘sockİt_sùp_¡©us
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6264 
SCTP_DISABLE_FRAGMENTS
:

6265 
»tv®
 = 
	`sùp_g‘sockİt_di§bË_äagm’ts
(
sk
, 
Ën
, 
İtv®
,

6266 
İ’
);

6268 
SCTP_EVENTS
:

6269 
»tv®
 = 
	`sùp_g‘sockİt_ev’ts
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6271 
SCTP_AUTOCLOSE
:

6272 
»tv®
 = 
	`sùp_g‘sockİt_autoşo£
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6274 
SCTP_SOCKOPT_PEELOFF
:

6275 
»tv®
 = 
	`sùp_g‘sockİt_³–off
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6277 
SCTP_PEER_ADDR_PARAMS
:

6278 
»tv®
 = 
	`sùp_g‘sockİt_³”_addr_·¿ms
(
sk
, 
Ën
, 
İtv®
,

6279 
İ’
);

6281 
SCTP_DELAYED_SACK
:

6282 
»tv®
 = 
	`sùp_g‘sockİt_d–ayed_ack
(
sk
, 
Ën
, 
İtv®
,

6283 
İ’
);

6285 
SCTP_INITMSG
:

6286 
»tv®
 = 
	`sùp_g‘sockİt_š™msg
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6288 
SCTP_GET_PEER_ADDRS_NUM_OLD
:

6289 
»tv®
 = 
	`sùp_g‘sockİt_³”_addrs_num_Şd
(
sk
, 
Ën
, 
İtv®
,

6290 
İ’
);

6292 
SCTP_GET_LOCAL_ADDRS_NUM_OLD
:

6293 
»tv®
 = 
	`sùp_g‘sockİt_loÿl_addrs_num_Şd
(
sk
, 
Ën
, 
İtv®
,

6294 
İ’
);

6296 
SCTP_GET_PEER_ADDRS_OLD
:

6297 
»tv®
 = 
	`sùp_g‘sockİt_³”_addrs_Şd
(
sk
, 
Ën
, 
İtv®
,

6298 
İ’
);

6300 
SCTP_GET_LOCAL_ADDRS_OLD
:

6301 
»tv®
 = 
	`sùp_g‘sockİt_loÿl_addrs_Şd
(
sk
, 
Ën
, 
İtv®
,

6302 
İ’
);

6304 
SCTP_GET_PEER_ADDRS
:

6305 
»tv®
 = 
	`sùp_g‘sockİt_³”_addrs
(
sk
, 
Ën
, 
İtv®
,

6306 
İ’
);

6308 
SCTP_GET_LOCAL_ADDRS
:

6309 
»tv®
 = 
	`sùp_g‘sockİt_loÿl_addrs
(
sk
, 
Ën
, 
İtv®
,

6310 
İ’
);

6312 
SCTP_SOCKOPT_CONNECTX3
:

6313 
»tv®
 = 
	`sùp_g‘sockİt_cÚÃùx3
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6315 
SCTP_DEFAULT_SEND_PARAM
:

6316 
»tv®
 = 
	`sùp_g‘sockİt_deçuÉ_£nd_·¿m
(
sk
, 
Ën
,

6317 
İtv®
, 
İ’
);

6319 
SCTP_PRIMARY_ADDR
:

6320 
»tv®
 = 
	`sùp_g‘sockİt_´im¬y_addr
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6322 
SCTP_NODELAY
:

6323 
»tv®
 = 
	`sùp_g‘sockİt_nod–ay
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6325 
SCTP_RTOINFO
:

6326 
»tv®
 = 
	`sùp_g‘sockİt_¹ošfo
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6328 
SCTP_ASSOCINFO
:

6329 
»tv®
 = 
	`sùp_g‘sockİt_assocšfo
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6331 
SCTP_I_WANT_MAPPED_V4_ADDR
:

6332 
»tv®
 = 
	`sùp_g‘sockİt_m­³dv4
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6334 
SCTP_MAXSEG
:

6335 
»tv®
 = 
	`sùp_g‘sockİt_max£g
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6337 
SCTP_GET_PEER_ADDR_INFO
:

6338 
»tv®
 = 
	`sùp_g‘sockİt_³”_addr_šfo
(
sk
, 
Ën
, 
İtv®
,

6339 
İ’
);

6341 
SCTP_ADAPTATION_LAYER
:

6342 
»tv®
 = 
	`sùp_g‘sockİt_ad­tiÚ_Ïy”
(
sk
, 
Ën
, 
İtv®
,

6343 
İ’
);

6345 
SCTP_CONTEXT
:

6346 
»tv®
 = 
	`sùp_g‘sockİt_cÚ‹xt
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6348 
SCTP_FRAGMENT_INTERLEAVE
:

6349 
»tv®
 = 
	`sùp_g‘sockİt_äagm’t_š‹¾—ve
(
sk
, 
Ën
, 
İtv®
,

6350 
İ’
);

6352 
SCTP_PARTIAL_DELIVERY_POINT
:

6353 
»tv®
 = 
	`sùp_g‘sockİt_·¹Ÿl_d–iv”y_pošt
(
sk
, 
Ën
, 
İtv®
,

6354 
İ’
);

6356 
SCTP_MAX_BURST
:

6357 
»tv®
 = 
	`sùp_g‘sockİt_maxbur¡
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6359 
SCTP_AUTH_KEY
:

6360 
SCTP_AUTH_CHUNK
:

6361 
SCTP_AUTH_DELETE_KEY
:

6362 
»tv®
 = -
EOPNOTSUPP
;

6364 
SCTP_HMAC_IDENT
:

6365 
»tv®
 = 
	`sùp_g‘sockİt_hmac_id’t
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6367 
SCTP_AUTH_ACTIVE_KEY
:

6368 
»tv®
 = 
	`sùp_g‘sockİt_aùive_key
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6370 
SCTP_PEER_AUTH_CHUNKS
:

6371 
»tv®
 = 
	`sùp_g‘sockİt_³”_auth_chunks
(
sk
, 
Ën
, 
İtv®
,

6372 
İ’
);

6374 
SCTP_LOCAL_AUTH_CHUNKS
:

6375 
»tv®
 = 
	`sùp_g‘sockİt_loÿl_auth_chunks
(
sk
, 
Ën
, 
İtv®
,

6376 
İ’
);

6378 
SCTP_GET_ASSOC_NUMBER
:

6379 
»tv®
 = 
	`sùp_g‘sockİt_assoc_numb”
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6381 
SCTP_GET_ASSOC_ID_LIST
:

6382 
»tv®
 = 
	`sùp_g‘sockİt_assoc_ids
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6384 
SCTP_PEER_ADDR_THLDS
:

6385 
»tv®
 = 
	`sùp_g‘sockİt_·ddr_th»shŞds
(
sk
, 
İtv®
, 
Ën
, 
İ’
);

6387 
SCTP_GET_ASSOC
:

6389 
»tv®
 = 
	`sùp_g‘sockİt_g‘_assoc
(
sk
, 
Ën
, 
İtv®
, 
İ’
);

6392 
»tv®
 = -
ENOPROTOOPT
;

6396 
	`sùp_»Ëa£_sock
(
sk
);

6397  
»tv®
;

6398 
	}
}

6400 
	$sùp_hash
(
sock
 *
sk
)

6403 
	}
}

6405 
	$sùp_unhash
(
sock
 *
sk
)

6408 
	}
}

6422 
sùp_bšd_buck‘
 *
sùp_buck‘_ü—‹
(

6423 
sùp_bšd_hashbuck‘
 *
h—d
, 
¢um
);

6425 
	$sùp_g‘_pÜt_loÿl
(
sock
 *
sk
, 
sùp_addr
 *
addr
)

6427 
sùp_bšd_hashbuck‘
 *
h—d
;

6428 
sùp_bšd_buck‘
 *
µ
;

6429 
hli¡_node
 *
node
;

6430 
¢um
;

6431 
»t
;

6433 
¢um
 = 
	`Áohs
(
addr
->
v4
.
sš_pÜt
);

6435 
	`SCTP_DEBUG_PRINTK
("sùp_g‘_pÜt(èbegšs, snum=%d\n", 
¢um
);

6436 
	`sùp_loÿl_bh_di§bË
();

6438 ià(
¢um
 == 0) {

6440 
low
, 
high
, 
»maššg
, 
šdex
;

6441 
rov”
;

6443 
	`š‘_g‘_loÿl_pÜt_¿nge
(&
low
, &
high
);

6444 
»maššg
 = (
high
 - 
low
) + 1;

6445 
rov”
 = 
	`Ãt_¿ndom
(è% 
»maššg
 + 
low
;

6448 
rov”
++;

6449 ià((
rov”
 < 
low
è|| (rov” > 
high
))

6450 
rov”
 = 
low
;

6451 ià(
	`š‘_is_»£rved_loÿl_pÜt
(
rov”
))

6453 
šdex
 = 
	`sùp_phashâ
(
rov”
);

6454 
h—d
 = &
sùp_pÜt_hashbË
[
šdex
];

6455 
	`sùp_¥š_lock
(&
h—d
->
lock
);

6456 
	`sùp_fÜ_—ch_h’Œy
(
µ
, 
node
, &
h—d
->
chaš
)

6457 ià(
µ
->
pÜt
 =ğ
rov”
)

6458 
Ãxt
;

6460 
Ãxt
:

6461 
	`sùp_¥š_uÆock
(&
h—d
->
lock
);

6462 } --
»maššg
 > 0);

6465 
»t
 = 1;

6466 ià(
»maššg
 <= 0)

6467 
ç
;

6473 
¢um
 = 
rov”
;

6481 
h—d
 = &
sùp_pÜt_hashbË
[
	`sùp_phashâ
(
¢um
)];

6482 
	`sùp_¥š_lock
(&
h—d
->
lock
);

6483 
	`sùp_fÜ_—ch_h’Œy
(
µ
, 
node
, &
h—d
->
chaš
) {

6484 ià(
µ
->
pÜt
 =ğ
¢um
)

6485 
µ_found
;

6488 
µ
 = 
NULL
;

6489 
µ_nÙ_found
;

6490 
µ_found
:

6491 ià(!
	`hli¡_em±y
(&
µ
->
owÃr
)) {

6497 
»u£
 = 
sk
->
sk_»u£
;

6498 
sock
 *
sk2
;

6500 
	`SCTP_DEBUG_PRINTK
("sctp_get_port() found‡…ossible match\n");

6501 ià(
µ
->
ç¡»u£
 && 
sk
->
sk_»u£
 &&

6502 
sk
->
sk_¡©e
 !ğ
SCTP_SS_LISTENING
)

6503 
sucûss
;

6515 
	`sk_fÜ_—ch_bound
(
sk2
, 
node
, &
µ
->
owÃr
) {

6516 
sùp_’dpošt
 *
•2
;

6517 
•2
 = 
	`sùp_sk
(
sk2
)->
•
;

6519 ià(
sk
 =ğ
sk2
 ||

6520 (
»u£
 && 
sk2
->
sk_»u£
 &&

6521 
sk2
->
sk_¡©e
 !ğ
SCTP_SS_LISTENING
))

6524 ià(
	`sùp_bšd_addr_cÚæiù
(&
•2
->
ba£
.
bšd_addr
, 
addr
,

6525 
	`sùp_sk
(
sk2
), sùp_sk(
sk
))) {

6526 
»t
 = ()
sk2
;

6527 
ç_uÆock
;

6530 
	`SCTP_DEBUG_PRINTK
("sctp_get_port(): Found‡ match\n");

6532 
µ_nÙ_found
:

6534 
»t
 = 1;

6535 ià(!
µ
 && !Õ°ğ
	`sùp_buck‘_ü—‹
(
h—d
, 
¢um
)))

6536 
ç_uÆock
;

6542 ià(
	`hli¡_em±y
(&
µ
->
owÃr
)) {

6543 ià(
sk
->
sk_»u£
 && sk->
sk_¡©e
 !ğ
SCTP_SS_LISTENING
)

6544 
µ
->
ç¡»u£
 = 1;

6546 
µ
->
ç¡»u£
 = 0;

6547 } ià(
µ
->
ç¡»u£
 &&

6548 (!
sk
->
sk_»u£
 || sk->
sk_¡©e
 =ğ
SCTP_SS_LISTENING
))

6549 
µ
->
ç¡»u£
 = 0;

6555 
sucûss
:

6556 ià(!
	`sùp_sk
(
sk
)->
bšd_hash
) {

6557 
	`š‘_sk
(
sk
)->
num
 = 
¢um
;

6558 
	`sk_add_bšd_node
(
sk
, &
µ
->
owÃr
);

6559 
	`sùp_sk
(
sk
)->
bšd_hash
 = 
µ
;

6561 
»t
 = 0;

6563 
ç_uÆock
:

6564 
	`sùp_¥š_uÆock
(&
h—d
->
lock
);

6566 
ç
:

6567 
	`sùp_loÿl_bh_’abË
();

6568  
»t
;

6569 
	}
}

6574 
	$sùp_g‘_pÜt
(
sock
 *
sk
, 
¢um
)

6576 
»t
;

6577 
sùp_addr
 
addr
;

6578 
sùp_af
 *
af
 = 
	`sùp_sk
(
sk
)->
pf
->af;

6581 
af
->
	`äom_sk
(&
addr
, 
sk
);

6582 
addr
.
v4
.
sš_pÜt
 = 
	`htÚs
(
¢um
);

6585 
»t
 = 
	`sùp_g‘_pÜt_loÿl
(
sk
, &
addr
);

6587  (
»t
 ? 1 : 0);

6588 
	}
}

6593 
SCTP_STATIC
 
	$sùp_li¡’_¡¬t
(
sock
 *
sk
, 
backlog
)

6595 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

6596 
sùp_’dpošt
 *
•
 = 
¥
->ep;

6597 
üy±o_hash
 *
tfm
 = 
NULL
;

6600 ià(!
	`sùp_sk
(
sk
)->
hmac
 && 
sùp_hmac_®g
) {

6601 
tfm
 = 
	`üy±o_®loc_hash
(
sùp_hmac_®g
, 0, 
CRYPTO_ALG_ASYNC
);

6602 ià(
	`IS_ERR
(
tfm
)) {

6603 ià(
	`Ãt_¿‹lim™
()) {

6604 
	`´štk
(
KERN_INFO


6606 
sùp_hmac_®g
, 
	`PTR_ERR
(
tfm
));

6608  -
ENOSYS
;

6610 
	`sùp_sk
(
sk
)->
hmac
 = 
tfm
;

6624 
sk
->
sk_¡©e
 = 
SCTP_SS_LISTENING
;

6625 ià(!
•
->
ba£
.
bšd_addr
.
pÜt
) {

6626 ià(
	`sùp_autobšd
(
sk
))

6627  -
EAGAIN
;

6629 ià(
	`sùp_g‘_pÜt
(
sk
, 
	`š‘_sk
(sk)->
num
)) {

6630 
sk
->
sk_¡©e
 = 
SCTP_SS_CLOSED
;

6631  -
EADDRINUSE
;

6635 
sk
->
sk_max_ack_backlog
 = 
backlog
;

6636 
	`sùp_hash_’dpošt
(
•
);

6638 
	}
}

6654 
	$sùp_š‘_li¡’
(
sock‘
 *
sock
, 
backlog
)

6656 
sock
 *
sk
 = sock->sk;

6657 
sùp_’dpošt
 *
•
 = 
	`sùp_sk
(
sk
)->ep;

6658 
”r
 = -
EINVAL
;

6660 ià(
	`uÆik–y
(
backlog
 < 0))

6661  
”r
;

6663 
	`sùp_lock_sock
(
sk
);

6666 ià(
	`sùp_¡yË
(
sk
, 
UDP_HIGH_BANDWIDTH
))

6667 
out
;

6669 ià(
sock
->
¡©e
 !ğ
SS_UNCONNECTED
)

6670 
out
;

6673 ià(!
backlog
) {

6674 ià(
	`sùp_s¡©e
(
sk
, 
CLOSED
))

6675 
out
;

6677 
”r
 = 0;

6678 
	`sùp_unhash_’dpošt
(
•
);

6679 
sk
->
sk_¡©e
 = 
SCTP_SS_CLOSED
;

6680 ià(
sk
->
sk_»u£
)

6681 
	`sùp_sk
(
sk
)->
bšd_hash
->
ç¡»u£
 = 1;

6682 
out
;

6686 ià(
	`sùp_s¡©e
(
sk
, 
LISTENING
))

6687 
sk
->
sk_max_ack_backlog
 = 
backlog
;

6689 
”r
 = 
	`sùp_li¡’_¡¬t
(
sk
, 
backlog
);

6690 ià(
”r
)

6691 
out
;

6694 
”r
 = 0;

6695 
out
:

6696 
	`sùp_»Ëa£_sock
(
sk
);

6697  
”r
;

6698 
	}
}

6713 
	$sùp_pŞl
(
fe
 *fe, 
sock‘
 *
sock
, 
pŞl_bË
 *
wa™
)

6715 
sock
 *
sk
 = sock->sk;

6716 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

6717 
mask
;

6719 
	`pŞl_wa™
(
fe
, 
sk
->
sk_¦“p
, 
wa™
);

6724 ià(
	`sùp_¡yË
(
sk
, 
TCP
è&& 
	`sùp_s¡©e
(sk, 
LISTENING
))

6725  (!
	`li¡_em±y
(&
¥
->
•
->
asocs
)) ?

6726 (
POLLIN
 | 
POLLRDNORM
) : 0;

6728 
mask
 = 0;

6731 ià(
sk
->
sk_”r
 || !
	`skb_queue_em±y
(&sk->
sk_”rÜ_queue
))

6732 
mask
 |ğ
POLLERR
;

6733 ià(
sk
->
sk_shutdown
 & 
RCV_SHUTDOWN
)

6734 
mask
 |ğ
POLLRDHUP
;

6735 ià(
sk
->
sk_shutdown
 =ğ
SHUTDOWN_MASK
)

6736 
mask
 |ğ
POLLHUP
;

6739 ià(!
	`skb_queue_em±y
(&
sk
->
sk_»ûive_queue
) ||

6740 (
sk
->
sk_shutdown
 & 
RCV_SHUTDOWN
))

6741 
mask
 |ğ
POLLIN
 | 
POLLRDNORM
;

6744 ià(!
	`sùp_¡yË
(
sk
, 
UDP
è&& 
	`sùp_s¡©e
(sk, 
CLOSED
))

6745  
mask
;

6748 ià(
	`sùp_wr™—bË
(
sk
)) {

6749 
mask
 |ğ
POLLOUT
 | 
POLLWRNORM
;

6751 
	`£t_b™
(
SOCK_ASYNC_NOSPACE
, &
sk
->
sk_sock‘
->
æags
);

6760 ià(
	`sùp_wr™—bË
(
sk
))

6761 
mask
 |ğ
POLLOUT
 | 
POLLWRNORM
;

6763  
mask
;

6764 
	}
}

6770 
sùp_bšd_buck‘
 *
	$sùp_buck‘_ü—‹
(

6771 
sùp_bšd_hashbuck‘
 *
h—d
, 
¢um
)

6773 
sùp_bšd_buck‘
 *
µ
;

6775 
µ
 = 
	`kmem_ÿche_®loc
(
sùp_buck‘_ÿch•
, 
GFP_ATOMIC
);

6776 ià(
µ
) {

6777 
	`SCTP_DBG_OBJCNT_INC
(
bšd_buck‘
);

6778 
µ
->
pÜt
 = 
¢um
;

6779 
µ
->
ç¡»u£
 = 0;

6780 
	`INIT_HLIST_HEAD
(&
µ
->
owÃr
);

6781 
	`hli¡_add_h—d
(&
µ
->
node
, &
h—d
->
chaš
);

6783  
µ
;

6784 
	}
}

6787 
	$sùp_buck‘_de¡roy
(
sùp_bšd_buck‘
 *
µ
)

6789 ià(
µ
 && 
	`hli¡_em±y
(&µ->
owÃr
)) {

6790 
	`__hli¡_d–
(&
µ
->
node
);

6791 
	`kmem_ÿche_ä“
(
sùp_buck‘_ÿch•
, 
µ
);

6792 
	`SCTP_DBG_OBJCNT_DEC
(
bšd_buck‘
);

6794 
	}
}

6797 
šlše
 
	$__sùp_put_pÜt
(
sock
 *
sk
)

6799 
sùp_bšd_hashbuck‘
 *
h—d
 =

6800 &
sùp_pÜt_hashbË
[
	`sùp_phashâ
(
	`š‘_sk
(
sk
)->
num
)];

6801 
sùp_bšd_buck‘
 *
µ
;

6803 
	`sùp_¥š_lock
(&
h—d
->
lock
);

6804 
µ
 = 
	`sùp_sk
(
sk
)->
bšd_hash
;

6805 
	`__sk_d–_bšd_node
(
sk
);

6806 
	`sùp_sk
(
sk
)->
bšd_hash
 = 
NULL
;

6807 
	`š‘_sk
(
sk
)->
num
 = 0;

6808 
	`sùp_buck‘_de¡roy
(
µ
);

6809 
	`sùp_¥š_uÆock
(&
h—d
->
lock
);

6810 
	}
}

6812 
	$sùp_put_pÜt
(
sock
 *
sk
)

6814 
	`sùp_loÿl_bh_di§bË
();

6815 
	`__sùp_put_pÜt
(
sk
);

6816 
	`sùp_loÿl_bh_’abË
();

6817 
	}
}

6825 
	$sùp_autobšd
(
sock
 *
sk
)

6827 
sùp_addr
 
autßddr
;

6828 
sùp_af
 *
af
;

6829 
__be16
 
pÜt
;

6832 
af
 = 
	`sùp_sk
(
sk
)->
pf
->af;

6834 
pÜt
 = 
	`htÚs
(
	`š‘_sk
(
sk
)->
num
);

6835 
af
->
	`šaddr_ªy
(&
autßddr
, 
pÜt
);

6837  
	`sùp_do_bšd
(
sk
, &
autßddr
, 
af
->
sockaddr_Ën
);

6838 
	}
}

6879 
SCTP_STATIC
 
	$sùp_msghdr_·r£
(cÚ¡ 
msghdr
 *
msg
,

6880 
sùp_cmsgs_t
 *
cmsgs
)

6882 
cmsghdr
 *
cmsg
;

6883 
msghdr
 *
my_msg
 = (msghd¸*)
msg
;

6885 
cmsg
 = 
	`CMSG_FIRSTHDR
(
msg
);

6886 
cmsg
 !ğ
NULL
;

6887 
cmsg
 = 
	`CMSG_NXTHDR
(
my_msg
, cmsg)) {

6888 ià(!
	`CMSG_OK
(
my_msg
, 
cmsg
))

6889  -
EINVAL
;

6892 ià(
cmsg
->
cmsg_Ëv–
 !ğ
IPPROTO_SCTP
)

6896 
cmsg
->
cmsg_ty³
) {

6897 
SCTP_INIT
:

6911 ià(
cmsg
->
cmsg_Ën
 !=

6912 
	`CMSG_LEN
((
sùp_š™msg
)))

6913  -
EINVAL
;

6914 
cmsgs
->
š™
 = (
sùp_š™msg
 *)
	`CMSG_DATA
(
cmsg
);

6917 
SCTP_SNDRCV
:

6929 ià(
cmsg
->
cmsg_Ën
 !=

6930 
	`CMSG_LEN
((
sùp_¢drcvšfo
)))

6931  -
EINVAL
;

6933 
cmsgs
->
šfo
 =

6934 (
sùp_¢drcvšfo
 *)
	`CMSG_DATA
(
cmsg
);

6937 ià(
cmsgs
->
šfo
->
sšfo_æags
 &

6938 ~(
SCTP_UNORDERED
 | 
SCTP_ADDR_OVER
 |

6939 
SCTP_ABORT
 | 
SCTP_EOF
))

6940  -
EINVAL
;

6944  -
EINVAL
;

6948 
	}
}

6955 
	$sùp_wa™_fÜ_·ck‘
(
sock
 * 
sk
, *
”r
, *
timeo_p
)

6957 
”rÜ
;

6958 
	`DEFINE_WAIT
(
wa™
);

6960 
	`´•¬e_to_wa™_exşusive
(
sk
->
sk_¦“p
, &
wa™
, 
TASK_INTERRUPTIBLE
);

6963 
”rÜ
 = 
	`sock_”rÜ
(
sk
);

6964 ià(
”rÜ
)

6965 
out
;

6967 ià(!
	`skb_queue_em±y
(&
sk
->
sk_»ûive_queue
))

6968 
»ady
;

6971 ià(
sk
->
sk_shutdown
 & 
RCV_SHUTDOWN
)

6972 
out
;

6977 
”rÜ
 = -
ENOTCONN
;

6980 ià(
	`li¡_em±y
(&
	`sùp_sk
(
sk
)->
•
->
asocs
è&& !
	`sùp_s¡©e
(sk, 
LISTENING
))

6981 
out
;

6984 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

6985 
š‹¼u±ed
;

6992 
	`sùp_»Ëa£_sock
(
sk
);

6993 *
timeo_p
 = 
	`scheduË_timeout
(*timeo_p);

6994 
	`sùp_lock_sock
(
sk
);

6996 
»ady
:

6997 
	`fšish_wa™
(
sk
->
sk_¦“p
, &
wa™
);

7000 
š‹¼u±ed
:

7001 
”rÜ
 = 
	`sock_šŒ_”ºo
(*
timeo_p
);

7003 
out
:

7004 
	`fšish_wa™
(
sk
->
sk_¦“p
, &
wa™
);

7005 *
”r
 = 
”rÜ
;

7006  
”rÜ
;

7007 
	}
}

7013 
sk_buff
 *
	$sùp_skb_»cv_d©ag¿m
(
sock
 *
sk
, 
æags
,

7014 
noblock
, *
”r
)

7016 
”rÜ
;

7017 
sk_buff
 *
skb
;

7018 
timeo
;

7020 
timeo
 = 
	`sock_rcvtimeo
(
sk
, 
noblock
);

7022 
	`SCTP_DEBUG_PRINTK
("Timeout:imeo: %ld, MAX: %ld.\n",

7023 
timeo
, 
MAX_SCHEDULE_TIMEOUT
);

7033 ià(
æags
 & 
MSG_PEEK
) {

7034 
	`¥š_lock_bh
(&
sk
->
sk_»ûive_queue
.
lock
);

7035 
skb
 = 
	`skb_³ek
(&
sk
->
sk_»ûive_queue
);

7036 ià(
skb
)

7037 
	`©omic_šc
(&
skb
->
u£rs
);

7038 
	`¥š_uÆock_bh
(&
sk
->
sk_»ûive_queue
.
lock
);

7040 
skb
 = 
	`skb_dequeue
(&
sk
->
sk_»ûive_queue
);

7043 ià(
skb
)

7044  
skb
;

7047 
”rÜ
 = 
	`sock_”rÜ
(
sk
);

7048 ià(
”rÜ
)

7049 
no_·ck‘
;

7051 ià(
sk
->
sk_shutdown
 & 
RCV_SHUTDOWN
)

7055 
”rÜ
 = -
EAGAIN
;

7056 ià(!
timeo
)

7057 
no_·ck‘
;

7058 } 
	`sùp_wa™_fÜ_·ck‘
(
sk
, 
”r
, &
timeo
) == 0);

7060  
NULL
;

7062 
no_·ck‘
:

7063 *
”r
 = 
”rÜ
;

7064  
NULL
;

7065 
	}
}

7068 
	$__sùp_wr™e_¥aû
(
sùp_assocŸtiÚ
 *
asoc
)

7070 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

7071 
sock‘
 *
sock
 = 
sk
->
sk_sock‘
;

7073 ià((
	`sùp_w¥aû
(
asoc
è> 0è&& 
sock
) {

7074 ià(
	`wa™queue_aùive
(&
asoc
->
wa™
))

7075 
	`wake_up_š‹¼u±ibË
(&
asoc
->
wa™
);

7077 ià(
	`sùp_wr™—bË
(
sk
)) {

7078 ià(
sk
->
sk_¦“p
 && 
	`wa™queue_aùive
(sk->sk_sleep))

7079 
	`wake_up_š‹¼u±ibË
(
sk
->
sk_¦“p
);

7085 ià(
sock
->
çsync_li¡
 &&

7086 !(
sk
->
sk_shutdown
 & 
SEND_SHUTDOWN
))

7087 
	`sock_wake_async
(
sock
,

7088 
SOCK_WAKE_SPACE
, 
POLL_OUT
);

7091 
	}
}

7097 
	$sùp_wä“
(
sk_buff
 *
skb
)

7099 
sùp_assocŸtiÚ
 *
asoc
;

7100 
sùp_chunk
 *
chunk
;

7101 
sock
 *
sk
;

7104 
chunk
 = *((
sùp_chunk
 **)(
skb
->
cb
));

7105 
asoc
 = 
chunk
->asoc;

7106 
sk
 = 
asoc
->
ba£
.sk;

7107 
asoc
->
¢dbuf_u£d
 -ğ
	`SCTP_DATA_SNDSIZE
(
chunk
) +

7108 (
sk_buff
) +

7109 (
sùp_chunk
);

7111 
	`©omic_sub
((
sùp_chunk
), &
sk
->
sk_wmem_®loc
);

7116 
sk
->
sk_wmem_queued
 -ğ
skb
->
Œuesize
;

7117 
	`sk_mem_unch¬ge
(
sk
, 
skb
->
Œuesize
);

7119 
	`sock_wä“
(
skb
);

7120 
	`__sùp_wr™e_¥aû
(
asoc
);

7122 
	`sùp_assocŸtiÚ_put
(
asoc
);

7123 
	}
}

7130 
	$sùp_sock_rä“
(
sk_buff
 *
skb
)

7132 
sock
 *
sk
 = 
skb
->sk;

7133 
sùp_uÍev’t
 *
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

7135 
	`©omic_sub
(
ev’t
->
rmem_Ën
, &
sk
->
sk_rmem_®loc
);

7140 
	`sk_mem_unch¬ge
(
sk
, 
ev’t
->
rmem_Ën
);

7141 
	}
}

7145 
	$sùp_wa™_fÜ_¢dbuf
(
sùp_assocŸtiÚ
 *
asoc
, *
timeo_p
,

7146 
size_t
 
msg_Ën
)

7148 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

7149 
”r
 = 0;

7150 
cu¼’t_timeo
 = *
timeo_p
;

7151 
	`DEFINE_WAIT
(
wa™
);

7153 
	`SCTP_DEBUG_PRINTK
("wait_for_sndbuf:‡soc=%p,imeo=%ld, msg_len=%zu\n",

7154 
asoc
, ()(*
timeo_p
), 
msg_Ën
);

7157 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

7161 
	`´•¬e_to_wa™_exşusive
(&
asoc
->
wa™
, &wait,

7162 
TASK_INTERRUPTIBLE
);

7163 ià(!*
timeo_p
)

7164 
do_nÚblock
;

7165 ià(
sk
->
sk_”r
 || 
asoc
->
¡©e
 >ğ
SCTP_STATE_SHUTDOWN_PENDING
 ||

7166 
asoc
->
ba£
.
d—d
)

7167 
do_”rÜ
;

7168 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

7169 
do_š‹¼u±ed
;

7170 ià(
msg_Ën
 <ğ
	`sùp_w¥aû
(
asoc
))

7176 
	`sùp_»Ëa£_sock
(
sk
);

7177 
cu¼’t_timeo
 = 
	`scheduË_timeout
(current_timeo);

7178 
	`BUG_ON
(
sk
 !ğ
asoc
->
ba£
.sk);

7179 
	`sùp_lock_sock
(
sk
);

7181 *
timeo_p
 = 
cu¼’t_timeo
;

7184 
out
:

7185 
	`fšish_wa™
(&
asoc
->
wa™
, &wait);

7188 
	`sùp_assocŸtiÚ_put
(
asoc
);

7190  
”r
;

7192 
do_”rÜ
:

7193 
”r
 = -
EPIPE
;

7194 
out
;

7196 
do_š‹¼u±ed
:

7197 
”r
 = 
	`sock_šŒ_”ºo
(*
timeo_p
);

7198 
out
;

7200 
do_nÚblock
:

7201 
”r
 = -
EAGAIN
;

7202 
out
;

7203 
	}
}

7205 
	$sùp_d©a_»ady
(
sock
 *
sk
, 
Ën
)

7207 
	`»ad_lock_bh
(&
sk
->
sk_ÿÎback_lock
);

7208 ià(
	`sk_has_¦“³r
(
sk
))

7209 
	`wake_up_š‹¼u±ibË_sync_pŞl
(
sk
->
sk_¦“p
, 
POLLIN
 |

7210 
POLLRDNORM
 | 
POLLRDBAND
);

7211 
	`sk_wake_async
(
sk
, 
SOCK_WAKE_WAITD
, 
POLL_IN
);

7212 
	`»ad_uÆock_bh
(&
sk
->
sk_ÿÎback_lock
);

7213 
	}
}

7216 
	$sùp_wr™e_¥aû
(
sock
 *
sk
)

7218 
sùp_assocŸtiÚ
 *
asoc
;

7221 
	`li¡_fÜ_—ch_’Œy
(
asoc
, &((
	`sùp_sk
(
sk
))->
•
->
asocs
),‡socs) {

7222 
	`__sùp_wr™e_¥aû
(
asoc
);

7224 
	}
}

7237 
	$sùp_wr™—bË
(
sock
 *
sk
)

7239 
amt
 = 0;

7241 
amt
 = 
sk
->
sk_¢dbuf
 - 
	`sk_wmem_®loc_g‘
(sk);

7242 ià(
amt
 < 0)

7243 
amt
 = 0;

7244  
amt
;

7245 
	}
}

7250 
	$sùp_wa™_fÜ_cÚÃù
(
sùp_assocŸtiÚ
 *
asoc
, *
timeo_p
)

7252 
sock
 *
sk
 = 
asoc
->
ba£
.sk;

7253 
”r
 = 0;

7254 
cu¼’t_timeo
 = *
timeo_p
;

7255 
	`DEFINE_WAIT
(
wa™
);

7257 
	`SCTP_DEBUG_PRINTK
("%s:‡soc=%p,imeo=%ld\n", 
__func__
, 
asoc
,

7258 ()(*
timeo_p
));

7261 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

7264 
	`´•¬e_to_wa™_exşusive
(&
asoc
->
wa™
, &wait,

7265 
TASK_INTERRUPTIBLE
);

7266 ià(!*
timeo_p
)

7267 
do_nÚblock
;

7268 ià(
sk
->
sk_shutdown
 & 
RCV_SHUTDOWN
)

7270 ià(
sk
->
sk_”r
 || 
asoc
->
¡©e
 >ğ
SCTP_STATE_SHUTDOWN_PENDING
 ||

7271 
asoc
->
ba£
.
d—d
)

7272 
do_”rÜ
;

7273 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

7274 
do_š‹¼u±ed
;

7276 ià(
	`sùp_¡©e
(
asoc
, 
ESTABLISHED
))

7282 
	`sùp_»Ëa£_sock
(
sk
);

7283 
cu¼’t_timeo
 = 
	`scheduË_timeout
(current_timeo);

7284 
	`sùp_lock_sock
(
sk
);

7286 *
timeo_p
 = 
cu¼’t_timeo
;

7289 
out
:

7290 
	`fšish_wa™
(&
asoc
->
wa™
, &wait);

7293 
	`sùp_assocŸtiÚ_put
(
asoc
);

7295  
”r
;

7297 
do_”rÜ
:

7298 ià(
asoc
->
š™_”r_couÁ”
 + 1 >‡soc->
max_š™_©‹m±s
)

7299 
”r
 = -
ETIMEDOUT
;

7301 
”r
 = -
ECONNREFUSED
;

7302 
out
;

7304 
do_š‹¼u±ed
:

7305 
”r
 = 
	`sock_šŒ_”ºo
(*
timeo_p
);

7306 
out
;

7308 
do_nÚblock
:

7309 
”r
 = -
EINPROGRESS
;

7310 
out
;

7311 
	}
}

7313 
	$sùp_wa™_fÜ_acû±
(
sock
 *
sk
, 
timeo
)

7315 
sùp_’dpošt
 *
•
;

7316 
”r
 = 0;

7317 
	`DEFINE_WAIT
(
wa™
);

7319 
•
 = 
	`sùp_sk
(
sk
)->ep;

7323 
	`´•¬e_to_wa™_exşusive
(
sk
->
sk_¦“p
, &
wa™
,

7324 
TASK_INTERRUPTIBLE
);

7326 ià(
	`li¡_em±y
(&
•
->
asocs
)) {

7327 
	`sùp_»Ëa£_sock
(
sk
);

7328 
timeo
 = 
	`scheduË_timeout
(timeo);

7329 
	`sùp_lock_sock
(
sk
);

7332 
”r
 = -
EINVAL
;

7333 ià(!
	`sùp_s¡©e
(
sk
, 
LISTENING
))

7336 
”r
 = 0;

7337 ià(!
	`li¡_em±y
(&
•
->
asocs
))

7340 
”r
 = 
	`sock_šŒ_”ºo
(
timeo
);

7341 ià(
	`sigÇl_³ndšg
(
cu¼’t
))

7344 
”r
 = -
EAGAIN
;

7345 ià(!
timeo
)

7349 
	`fšish_wa™
(
sk
->
sk_¦“p
, &
wa™
);

7351  
”r
;

7352 
	}
}

7354 
	$sùp_wa™_fÜ_şo£
(
sock
 *
sk
, 
timeout
)

7356 
	`DEFINE_WAIT
(
wa™
);

7359 
	`´•¬e_to_wa™
(
sk
->
sk_¦“p
, &
wa™
, 
TASK_INTERRUPTIBLE
);

7360 ià(
	`li¡_em±y
(&
	`sùp_sk
(
sk
)->
•
->
asocs
))

7362 
	`sùp_»Ëa£_sock
(
sk
);

7363 
timeout
 = 
	`scheduË_timeout
(timeout);

7364 
	`sùp_lock_sock
(
sk
);

7365 } !
	`sigÇl_³ndšg
(
cu¼’t
è&& 
timeout
);

7367 
	`fšish_wa™
(
sk
->
sk_¦“p
, &
wa™
);

7368 
	}
}

7370 
	$sùp_skb_£t_owÃr_r_äag
(
sk_buff
 *
skb
, 
sock
 *
sk
)

7372 
sk_buff
 *
äag
;

7374 ià(!
skb
->
d©a_Ën
)

7375 
dÚe
;

7378 
	`skb_w®k_äags
(
skb
, 
äag
)

7379 
	`sùp_skb_£t_owÃr_r_äag
(
äag
, 
sk
);

7381 
dÚe
:

7382 
	`sùp_skb_£t_owÃr_r
(
skb
, 
sk
);

7383 
	}
}

7385 
	$sùp_cİy_sock
(
sock
 *
Ãwsk
, sock *
sk
,

7386 
sùp_assocŸtiÚ
 *
asoc
)

7388 
š‘_sock
 *
š‘
 = 
	`š‘_sk
(
sk
);

7389 
š‘_sock
 *
Ãwš‘
 = 
	`š‘_sk
(
Ãwsk
);

7391 
Ãwsk
->
sk_ty³
 = 
sk
->sk_type;

7392 
Ãwsk
->
sk_bound_dev_if
 = 
sk
->sk_bound_dev_if;

7393 
Ãwsk
->
sk_æags
 = 
sk
->sk_flags;

7394 
Ãwsk
->
sk_no_check
 = 
sk
->sk_no_check;

7395 
Ãwsk
->
sk_»u£
 = 
sk
->sk_reuse;

7397 
Ãwsk
->
sk_shutdown
 = 
sk
->sk_shutdown;

7398 
Ãwsk
->
sk_de¡ruù
 = 
š‘_sock_de¡ruù
;

7399 
Ãwsk
->
sk_çmy
 = 
sk
->sk_family;

7400 
Ãwsk
->
sk_´ÙocŞ
 = 
IPPROTO_SCTP
;

7401 
Ãwsk
->
sk_backlog_rcv
 = 
sk
->
sk_´Ù
->
backlog_rcv
;

7402 
Ãwsk
->
sk_¢dbuf
 = 
sk
->sk_sndbuf;

7403 
Ãwsk
->
sk_rcvbuf
 = 
sk
->sk_rcvbuf;

7404 
Ãwsk
->
sk_lšg”time
 = 
sk
->sk_lingertime;

7405 
Ãwsk
->
sk_rcvtimeo
 = 
sk
->sk_rcvtimeo;

7406 
Ãwsk
->
sk_¢dtimeo
 = 
sk
->sk_sndtimeo;

7408 
Ãwš‘
 = 
	`š‘_sk
(
Ãwsk
);

7413 
Ãwš‘
->
¥Üt
 = 
š‘
->sport;

7414 
Ãwš‘
->
§ddr
 = 
š‘
->saddr;

7415 
Ãwš‘
->
rcv_§ddr
 = 
š‘
->rcv_saddr;

7416 
Ãwš‘
->
dpÜt
 = 
	`htÚs
(
asoc
->
³”
.
pÜt
);

7417 
Ãwš‘
->
pmtudisc
 = 
š‘
->pmtudisc;

7418 
Ãwš‘
->
id
 = 
asoc
->
Ãxt_t¢
 ^ 
jiff›s
;

7420 
Ãwš‘
->
uc_‰l
 = 
š‘
->uc_ttl;

7421 
Ãwš‘
->
mc_loİ
 = 1;

7422 
Ãwš‘
->
mc_‰l
 = 1;

7423 
Ãwš‘
->
mc_šdex
 = 0;

7424 
Ãwš‘
->
mc_li¡
 = 
NULL
;

7425 
	}
}

7430 
	$sùp_sock_mig¿‹
(
sock
 *
Şdsk
, sock *
Ãwsk
,

7431 
sùp_assocŸtiÚ
 *
assoc
,

7432 
sùp_sock‘_ty³_t
 
ty³
)

7434 
sùp_sock
 *
Şd¥
 = 
	`sùp_sk
(
Şdsk
);

7435 
sùp_sock
 *
Ãw¥
 = 
	`sùp_sk
(
Ãwsk
);

7436 
sùp_bšd_buck‘
 *
µ
;

7437 
sùp_’dpošt
 *
Ãw•
 = 
Ãw¥
->
•
;

7438 
sk_buff
 *
skb
, *
tmp
;

7439 
sùp_uÍev’t
 *
ev’t
;

7440 
sùp_bšd_hashbuck‘
 *
h—d
;

7445 
Ãwsk
->
sk_¢dbuf
 = 
Şdsk
->sk_sndbuf;

7446 
Ãwsk
->
sk_rcvbuf
 = 
Şdsk
->sk_rcvbuf;

7448 
	`š‘_sk_cİy_desûndªt
(
Ãwsk
, 
Şdsk
);

7453 
Ãw¥
->
•
 = 
Ãw•
;

7454 
Ãw¥
->
hmac
 = 
NULL
;

7457 
h—d
 = &
sùp_pÜt_hashbË
[
	`sùp_phashâ
(
	`š‘_sk
(
Şdsk
)->
num
)];

7458 
	`sùp_loÿl_bh_di§bË
();

7459 
	`sùp_¥š_lock
(&
h—d
->
lock
);

7460 
µ
 = 
	`sùp_sk
(
Şdsk
)->
bšd_hash
;

7461 
	`sk_add_bšd_node
(
Ãwsk
, &
µ
->
owÃr
);

7462 
	`sùp_sk
(
Ãwsk
)->
bšd_hash
 = 
µ
;

7463 
	`š‘_sk
(
Ãwsk
)->
num
 = iÃt_sk(
Şdsk
)->num;

7464 
	`sùp_¥š_uÆock
(&
h—d
->
lock
);

7465 
	`sùp_loÿl_bh_’abË
();

7470 
	`sùp_bšd_addr_dup
(&
Ãw¥
->
•
->
ba£
.
bšd_addr
,

7471 &
Şd¥
->
•
->
ba£
.
bšd_addr
, 
GFP_KERNEL
);

7476 
	`sùp_skb_fÜ_—ch
(
skb
, &
Şdsk
->
sk_»ûive_queue
, 
tmp
) {

7477 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

7478 ià(
ev’t
->
asoc
 =ğ
assoc
) {

7479 
	`__skb_uÆšk
(
skb
, &
Şdsk
->
sk_»ûive_queue
);

7480 
	`__skb_queue_
(&
Ãwsk
->
sk_»ûive_queue
, 
skb
);

7481 
	`sùp_skb_£t_owÃr_r_äag
(
skb
, 
Ãwsk
);

7491 
	`skb_queue_h—d_š™
(&
Ãw¥
->
pd_lobby
);

7492 
	`©omic_£t
(&
	`sùp_sk
(
Ãwsk
)->
pd_mode
, 
assoc
->
uÍq
.pd_mode);

7494 ià(
	`©omic_»ad
(&
	`sùp_sk
(
Şdsk
)->
pd_mode
)) {

7495 
sk_buff_h—d
 *
queue
;

7498 ià(
assoc
->
uÍq
.
pd_mode
) {

7499 
queue
 = &
Ãw¥
->
pd_lobby
;

7501 
queue
 = &
Ãwsk
->
sk_»ûive_queue
;

7506 
	`sùp_skb_fÜ_—ch
(
skb
, &
Şd¥
->
pd_lobby
, 
tmp
) {

7507 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

7508 ià(
ev’t
->
asoc
 =ğ
assoc
) {

7509 
	`__skb_uÆšk
(
skb
, &
Şd¥
->
pd_lobby
);

7510 
	`__skb_queue_
(
queue
, 
skb
);

7511 
	`sùp_skb_£t_owÃr_r_äag
(
skb
, 
Ãwsk
);

7518 ià(
assoc
->
uÍq
.
pd_mode
)

7519 
	`sùp_ş—r_pd
(
Şdsk
, 
NULL
);

7523 
	`sùp_skb_fÜ_—ch
(
skb
, &
assoc
->
uÍq
.
»asm
, 
tmp
)

7524 
	`sùp_skb_£t_owÃr_r_äag
(
skb
, 
Ãwsk
);

7526 
	`sùp_skb_fÜ_—ch
(
skb
, &
assoc
->
uÍq
.
lobby
, 
tmp
)

7527 
	`sùp_skb_£t_owÃr_r_äag
(
skb
, 
Ãwsk
);

7533 
Ãw¥
->
ty³
 =ype;

7544 
	`lock_sock_Ã¡ed
(
Ãwsk
, 
SINGLE_DEPTH_NESTING
);

7545 
	`sùp_assoc_mig¿‹
(
assoc
, 
Ãwsk
);

7550 ià(
	`sùp_¡©e
(
assoc
, 
CLOSED
è&& 
	`sùp_¡yË
(
Ãwsk
, 
TCP
))

7551 
Ãwsk
->
sk_shutdown
 |ğ
RCV_SHUTDOWN
;

7553 
Ãwsk
->
sk_¡©e
 = 
SCTP_SS_ESTABLISHED
;

7554 
	`sùp_»Ëa£_sock
(
Ãwsk
);

7555 
	}
}

7559 
´Ùo
 
	gsùp_´Ù
 = {

7560 .
Çme
 = "SCTP",

7561 .
	gowÃr
 = 
THIS_MODULE
,

7562 .
	gşo£
 = 
sùp_şo£
,

7563 .
	gcÚÃù
 = 
sùp_cÚÃù
,

7564 .
	gdiscÚÃù
 = 
sùp_discÚÃù
,

7565 .
	gacû±
 = 
sùp_acû±
,

7566 .
	gioùl
 = 
sùp_ioùl
,

7567 .
	gš™
 = 
sùp_š™_sock
,

7568 .
	gde¡roy
 = 
sùp_de¡roy_sock
,

7569 .
	gshutdown
 = 
sùp_shutdown
,

7570 .
	g£tsockİt
 = 
sùp_£tsockİt
,

7571 .
	gg‘sockİt
 = 
sùp_g‘sockİt
,

7572 .
	g£ndmsg
 = 
sùp_£ndmsg
,

7573 .
	g»cvmsg
 = 
sùp_»cvmsg
,

7574 .
	gbšd
 = 
sùp_bšd
,

7575 .
	gbacklog_rcv
 = 
sùp_backlog_rcv
,

7576 .
	ghash
 = 
sùp_hash
,

7577 .
	gunhash
 = 
sùp_unhash
,

7578 .
	gg‘_pÜt
 = 
sùp_g‘_pÜt
,

7579 .
	gobj_size
 = (
sùp_sock
),

7580 .
	gsysùl_mem
 = 
sysùl_sùp_mem
,

7581 .
	gsysùl_rmem
 = 
sysùl_sùp_rmem
,

7582 .
	gsysùl_wmem
 = 
sysùl_sùp_wmem
,

7583 .
	gmemÜy_´essu»
 = &
sùp_memÜy_´essu»
,

7584 .
	g’‹r_memÜy_´essu»
 = 
sùp_’‹r_memÜy_´essu»
,

7585 .
	gmemÜy_®loÿ‹d
 = &
sùp_memÜy_®loÿ‹d
,

7586 .
	gsock‘s_®loÿ‹d
 = &
sùp_sock‘s_®loÿ‹d
,

7589 #ià
defšed
(
CONFIG_IPV6
è|| defšed(
CONFIG_IPV6_MODULE
)

7591 
´Ùo
 
	gsùpv6_´Ù
 = {

7592 .
Çme
 = "SCTPv6",

7593 .
	gowÃr
 = 
THIS_MODULE
,

7594 .
	gşo£
 = 
sùp_şo£
,

7595 .
	gcÚÃù
 = 
sùp_cÚÃù
,

7596 .
	gdiscÚÃù
 = 
sùp_discÚÃù
,

7597 .
	gacû±
 = 
sùp_acû±
,

7598 .
	gioùl
 = 
sùp_ioùl
,

7599 .
	gš™
 = 
sùp_š™_sock
,

7600 .
	gde¡roy
 = 
sùp_de¡roy_sock
,

7601 .
	gshutdown
 = 
sùp_shutdown
,

7602 .
	g£tsockİt
 = 
sùp_£tsockİt
,

7603 .
	gg‘sockİt
 = 
sùp_g‘sockİt
,

7604 .
	g£ndmsg
 = 
sùp_£ndmsg
,

7605 .
	g»cvmsg
 = 
sùp_»cvmsg
,

7606 .
	gbšd
 = 
sùp_bšd
,

7607 .
	gbacklog_rcv
 = 
sùp_backlog_rcv
,

7608 .
	ghash
 = 
sùp_hash
,

7609 .
	gunhash
 = 
sùp_unhash
,

7610 .
	gg‘_pÜt
 = 
sùp_g‘_pÜt
,

7611 .
	gobj_size
 = (
sùp6_sock
),

7612 .
	gsysùl_mem
 = 
sysùl_sùp_mem
,

7613 .
	gsysùl_rmem
 = 
sysùl_sùp_rmem
,

7614 .
	gsysùl_wmem
 = 
sysùl_sùp_wmem
,

7615 .
	gmemÜy_´essu»
 = &
sùp_memÜy_´essu»
,

7616 .
	g’‹r_memÜy_´essu»
 = 
sùp_’‹r_memÜy_´essu»
,

7617 .
	gmemÜy_®loÿ‹d
 = &
sùp_memÜy_®loÿ‹d
,

7618 .
	gsock‘s_®loÿ‹d
 = &
sùp_sock‘s_®loÿ‹d
,

	@ssnmap.c

39 
	~<lšux/ty³s.h
>

40 
	~<Ãt/sùp/sùp.h
>

41 
	~<Ãt/sùp/sm.h
>

43 
	#MAX_KMALLOC_SIZE
 131072

	)

45 
sùp_s¢m­
 *
sùp_s¢m­_š™
(sùp_s¢m­ *
m­
, 
__u16
 
š
,

46 
__u16
 
out
);

51 
šlše
 
size_t
 
	$sùp_s¢m­_size
(
__u16
 
š
, __u16 
out
)

53  (
sùp_s¢m­
è+ (
š
 + 
out
è* (
__u16
);

54 
	}
}

60 
sùp_s¢m­
 *
	$sùp_s¢m­_Ãw
(
__u16
 
š
, __u16 
out
,

61 
gå_t
 
gå
)

63 
sùp_s¢m­
 *
»tv®
;

64 
size
;

66 
size
 = 
	`sùp_s¢m­_size
(
š
, 
out
);

67 ià(
size
 <ğ
MAX_KMALLOC_SIZE
)

68 
»tv®
 = 
	`km®loc
(
size
, 
gå
);

70 
»tv®
 = (
sùp_s¢m­
 *)

71 
	`__g‘_ä“_·ges
(
gå
, 
	`g‘_Üd”
(
size
));

72 ià(!
»tv®
)

73 
ç
;

75 ià(!
	`sùp_s¢m­_š™
(
»tv®
, 
š
, 
out
))

76 
ç_m­
;

78 
»tv®
->
m®loûd
 = 1;

79 
	`SCTP_DBG_OBJCNT_INC
(
s¢m­
);

81  
»tv®
;

83 
ç_m­
:

84 ià(
size
 <ğ
MAX_KMALLOC_SIZE
)

85 
	`kä“
(
»tv®
);

87 
	`ä“_·ges
(()
»tv®
, 
	`g‘_Üd”
(
size
));

88 
ç
:

89  
NULL
;

90 
	}
}

94 
sùp_s¢m­
 *
	$sùp_s¢m­_š™
(
sùp_s¢m­
 *
m­
, 
__u16
 
š
,

95 
__u16
 
out
)

97 
	`mem£t
(
m­
, 0x00, 
	`sùp_s¢m­_size
(
š
, 
out
));

100 
m­
->
š
.
s¢
 = (
__u16
 *)&map[1];

101 
m­
->
š
.
Ën
 = in;

104 
m­
->
out
.
s¢
 = &m­->
š
.ssn[in];

105 
m­
->
out
.
Ën
 = out;

107  
m­
;

108 
	}
}

111 
	$sùp_s¢m­_ş—r
(
sùp_s¢m­
 *
m­
)

113 
size_t
 
size
;

115 
size
 = (
m­
->
š
.
Ën
 + m­->
out
.Ënè* (
__u16
);

116 
	`mem£t
(
m­
->
š
.
s¢
, 0x00, 
size
);

117 
	}
}

120 
	$sùp_s¢m­_ä“
(
sùp_s¢m­
 *
m­
)

122 ià(
m­
 && m­->
m®loûd
) {

123 
size
;

125 
size
 = 
	`sùp_s¢m­_size
(
m­
->
š
.
Ën
, m­->
out
.len);

126 ià(
size
 <ğ
MAX_KMALLOC_SIZE
)

127 
	`kä“
(
m­
);

129 
	`ä“_·ges
(()
m­
, 
	`g‘_Üd”
(
size
));

130 
	`SCTP_DBG_OBJCNT_DEC
(
s¢m­
);

132 
	}
}

	@structs.h

54 #iâdeà
__sùp_¡ruùs_h__


55 
	#__sùp_¡ruùs_h__


	)

57 
	~<lšux/time.h
>

58 
	~<lšux/sock‘.h
>

59 
	~<lšux/š.h
>

60 
	~<lšux/š6.h
>

61 
	~<lšux/v6.h
>

62 
	~<asm/·¿m.h
>

63 
	~<asm/©omic.h
>

64 
	~<lšux/skbuff.h
>

65 
	~<lšux/wÜkqueue.h
>

66 
	~<lšux/sùp.h
>

67 
	~<Ãt/sùp/auth.h
>

72 
	usùp_addr
 {

73 
sockaddr_š
 
	mv4
;

74 
sockaddr_š6
 
	mv6
;

75 
sockaddr
 
	m§
;

79 
	gsùp_glob®s
;

80 
	gsùp_’dpošt
;

81 
	gsùp_assocŸtiÚ
;

82 
	gsùp_Œª¥Üt
;

83 
	gsùp_·ck‘
;

84 
	gsùp_chunk
;

85 
	gsùp_šq
;

86 
	gsùp_outq
;

87 
	gsùp_bšd_addr
;

88 
	gsùp_uÍq
;

89 
	gsùp_•_commÚ
;

90 
	gsùp_s¢m­
;

91 
	güy±o_hash
;

94 
	~<Ãt/sùp/t¢m­.h
>

95 
	~<Ãt/sùp/uÍev’t.h
>

96 
	~<Ãt/sùp/uÍqueue.h
>

100 
	ssùp_bšd_buck‘
 {

101 
	mpÜt
;

102 
	mç¡»u£
;

103 
hli¡_node
 
	mnode
;

104 
hli¡_h—d
 
	mowÃr
;

107 
	ssùp_bšd_hashbuck‘
 {

108 
¥šlock_t
 
	mlock
;

109 
hli¡_h—d
 
	mchaš
;

113 
	ssùp_hashbuck‘
 {

114 
rwlock_t
 
	mlock
;

115 
hli¡_h—d
 
	mchaš
;

116 } 
__©Œibu‹__
((
__®igÃd__
(8)));

120 
	ssùp_glob®s
 {

131 
¹o_š™Ÿl
;

132 
¹o_mš
;

133 
¹o_max
;

138 
¹o_®pha
;

139 
¹o_b‘a
;

142 
max_bur¡
;

145 
cook›_´e£rve_’abË
;

148 
v®id_cook›_liã
;

151 
§ck_timeout
;

154 
hb_š‹rv®
;

160 
max_»Œªs_assocŸtiÚ
;

161 
max_»Œªs_·th
;

162 
max_»Œªs_š™
;

168 
pf_»Œªs
;

175 
¢dbuf_pŞicy
;

182 
rcvbuf_pŞicy
;

187 
__u16
 
max_š¡»ams
;

188 
__u16
 
max_out¡»ams
;

193 
li¡_h—d
 
add»ss_çm›s
;

196 
•_hashsize
;

197 
sùp_hashbuck‘
 *
•_hashbË
;

200 
assoc_hashsize
;

201 
sùp_hashbuck‘
 *
assoc_hashbË
;

204 
pÜt_hashsize
;

205 
sùp_bšd_hashbuck‘
 *
pÜt_hashbË
;

213 
li¡_h—d
 
loÿl_addr_li¡
;

216 
¥šlock_t
 
addr_li¡_lock
;

219 
add_’abË
;

220 
add_nßuth_’abË
;

223 
´sùp_’abË
;

226 
auth_’abË
;

235 
v4_scİe_pŞicy
;

239 
checksum_di§bË
;

244 
rwnd_upd©e_shiá
;

245 } 
sùp_glob®s
;

247 
	#sùp_¹o_š™Ÿl
 (
sùp_glob®s
.
¹o_š™Ÿl
)

	)

248 
	#sùp_¹o_mš
 (
sùp_glob®s
.
¹o_mš
)

	)

249 
	#sùp_¹o_max
 (
sùp_glob®s
.
¹o_max
)

	)

250 
	#sùp_¹o_®pha
 (
sùp_glob®s
.
¹o_®pha
)

	)

251 
	#sùp_¹o_b‘a
 (
sùp_glob®s
.
¹o_b‘a
)

	)

252 
	#sùp_max_bur¡
 (
sùp_glob®s
.
max_bur¡
)

	)

253 
	#sùp_v®id_cook›_liã
 (
sùp_glob®s
.
v®id_cook›_liã
)

	)

254 
	#sùp_cook›_´e£rve_’abË
 (
sùp_glob®s
.
cook›_´e£rve_’abË
)

	)

255 
	#sùp_max_»Œªs_assocŸtiÚ
 (
sùp_glob®s
.
max_»Œªs_assocŸtiÚ
)

	)

256 
	#sùp_¢dbuf_pŞicy
 (
sùp_glob®s
.
¢dbuf_pŞicy
)

	)

257 
	#sùp_rcvbuf_pŞicy
 (
sùp_glob®s
.
rcvbuf_pŞicy
)

	)

258 
	#sùp_max_»Œªs_·th
 (
sùp_glob®s
.
max_»Œªs_·th
)

	)

259 
	#sùp_pf_»Œªs
 (
sùp_glob®s
.
pf_»Œªs
)

	)

260 
	#sùp_max_»Œªs_š™
 (
sùp_glob®s
.
max_»Œªs_š™
)

	)

261 
	#sùp_§ck_timeout
 (
sùp_glob®s
.
§ck_timeout
)

	)

262 
	#sùp_hb_š‹rv®
 (
sùp_glob®s
.
hb_š‹rv®
)

	)

263 
	#sùp_max_š¡»ams
 (
sùp_glob®s
.
max_š¡»ams
)

	)

264 
	#sùp_max_out¡»ams
 (
sùp_glob®s
.
max_out¡»ams
)

	)

265 
	#sùp_add»ss_çm›s
 (
sùp_glob®s
.
add»ss_çm›s
)

	)

266 
	#sùp_•_hashsize
 (
sùp_glob®s
.
•_hashsize
)

	)

267 
	#sùp_•_hashbË
 (
sùp_glob®s
.
•_hashbË
)

	)

268 
	#sùp_assoc_hashsize
 (
sùp_glob®s
.
assoc_hashsize
)

	)

269 
	#sùp_assoc_hashbË
 (
sùp_glob®s
.
assoc_hashbË
)

	)

270 
	#sùp_pÜt_hashsize
 (
sùp_glob®s
.
pÜt_hashsize
)

	)

271 
	#sùp_pÜt_rov”
 (
sùp_glob®s
.
pÜt_rov”
)

	)

272 
	#sùp_pÜt_®loc_lock
 (
sùp_glob®s
.
pÜt_®loc_lock
)

	)

273 
	#sùp_pÜt_hashbË
 (
sùp_glob®s
.
pÜt_hashbË
)

	)

274 
	#sùp_loÿl_addr_li¡
 (
sùp_glob®s
.
loÿl_addr_li¡
)

	)

275 
	#sùp_loÿl_addr_lock
 (
sùp_glob®s
.
addr_li¡_lock
)

	)

276 
	#sùp_scİe_pŞicy
 (
sùp_glob®s
.
v4_scİe_pŞicy
)

	)

277 
	#sùp_add_’abË
 (
sùp_glob®s
.
add_’abË
)

	)

278 
	#sùp_add_nßuth
 (
sùp_glob®s
.
add_nßuth_’abË
)

	)

279 
	#sùp_´sùp_’abË
 (
sùp_glob®s
.
´sùp_’abË
)

	)

280 
	#sùp_auth_’abË
 (
sùp_glob®s
.
auth_’abË
)

	)

281 
	#sùp_checksum_di§bË
 (
sùp_glob®s
.
checksum_di§bË
)

	)

282 
	#sùp_rwnd_upd_shiá
 (
sùp_glob®s
.
rwnd_upd©e_shiá
)

	)

286 
	mSCTP_SOCKET_UDP
 = 0,

287 
	mSCTP_SOCKET_UDP_HIGH_BANDWIDTH
,

288 
	mSCTP_SOCKET_TCP


289 } 
	tsùp_sock‘_ty³_t
;

292 
	ssùp_sock
 {

294 
š‘_sock
 
	mš‘
;

296 
sùp_sock‘_ty³_t
 
	mty³
;

299 
sùp_pf
 *
	mpf
;

302 
üy±o_hash
 *
	mhmac
;

305 
sùp_’dpošt
 *
	m•
;

307 
sùp_bšd_buck‘
 *
	mbšd_hash
;

309 
__u16
 
	mdeçuÉ_¡»am
;

310 
__u32
 
	mdeçuÉ_µid
;

311 
__u16
 
	mdeçuÉ_æags
;

312 
__u32
 
	mdeçuÉ_cÚ‹xt
;

313 
__u32
 
	mdeçuÉ_tim‘Şive
;

314 
__u32
 
	mdeçuÉ_rcv_cÚ‹xt
;

315 
	mmax_bur¡
;

321 
__u32
 
	mhbš‹rv®
;

324 
__u16
 
	m·thmaxrxt
;

327 
__u32
 
	m·thmtu
;

330 
__u32
 
	m§ckd–ay
;

331 
__u32
 
	m§ckäeq
;

334 
__u32
 
	m·¿m_æags
;

336 
sùp_š™msg
 
	mš™msg
;

337 
sùp_¹ošfo
 
	m¹ošfo
;

338 
sùp_·dd½¬ams
 
	m·dd½¬am
;

339 
sùp_ev’t_subsüibe
 
	msubsüibe
;

340 
sùp_assoı¬ams
 
	massoı¬ams
;

341 
	mu£r_äag
;

342 
__u32
 
	mautoşo£
;

343 
__u8
 
	mnod–ay
;

344 
__u8
 
	mdi§bË_äagm’ts
;

345 
__u8
 
	mv4m­³d
;

346 
__u8
 
	mäag_š‹¾—ve
;

347 
__u32
 
	mad­tiÚ_šd
;

348 
__u32
 
	mpd_pošt
;

350 
©omic_t
 
	mpd_mode
;

352 
sk_buff_h—d
 
	mpd_lobby
;

355 
šlše
 
sùp_sock
 *
	$sùp_sk
(cÚ¡ 
sock
 *
sk
)

357  (
sùp_sock
 *)
sk
;

358 
	}
}

360 
šlše
 
sock
 *
	$sùp_İt2sk
(cÚ¡ 
sùp_sock
 *
¥
)

362  (
sock
 *)
¥
;

363 
	}
}

365 #ià
defšed
(
CONFIG_IPV6
è|| defšed(
CONFIG_IPV6_MODULE
)

366 
	ssùp6_sock
 {

367 
sùp_sock
 
	msùp
;

368 
v6_pšfo
 
	mš‘6
;

382 
	ssùp_cook›
 {

388 
__u32
 
	mmy_vg
;

394 
__u32
 
	m³”_vg
;

401 
__u32
 
	mmy_‰ag
;

404 
__u32
 
	m³”_‰ag
;

407 
timev®
 
	mexpœ©iÚ
;

412 
__u16
 
	msš™_num_o¡»ams
;

413 
__u16
 
	msš™_max_š¡»ams
;

416 
__u32
 
	mš™Ÿl_t¢
;

419 
sùp_addr
 
	m³”_addr
;

424 
__u16
 
	mmy_pÜt
;

426 
__u8
 
	m´sùp_ÿ·bË
;

429 
__u8
 
	m·ddšg
;

431 
__u32
 
	mad­tiÚ_šd
;

433 
__u8
 
	mauth_¿ndom
[(
sùp_·¿mhdr_t
è+ 
SCTP_AUTH_RANDOM_LENGTH
];

434 
__u8
 
	mauth_hmacs
[
SCTP_AUTH_NUM_HMACS
 * (
__u16
) + 2];

435 
__u8
 
	mauth_chunks
[(
sùp_·¿mhdr_t
è+ 
SCTP_AUTH_MAX_CHUNKS
];

443 
__u32
 
	m¿w_addr_li¡_Ën
;

444 
sùp_š™_chunk
 
	m³”_š™
[0];

449 
	ssùp_sigÃd_cook›
 {

450 
__u8
 
	msigÇtu»
[
SCTP_SECRET_SIZE
];

451 
__u32
 
	m__·d
;

452 
sùp_cook›
 
	mc
;

453 } 
__©Œibu‹__
((
·cked
));

459 
	usùp_addr_·¿m
 {

460 
sùp_·¿mhdr
 
	mp
;

461 
sùp_v4addr_·¿m
 
	mv4
;

462 
sùp_v6addr_·¿m
 
	mv6
;

468 
	usùp_·¿ms
 {

469 *
	mv
;

470 
sùp_·¿mhdr
 *
	mp
;

471 
sùp_cook›_´e£rve_·¿m
 *
	mliã
;

472 
sùp_ho¡Çme_·¿m
 *
	mdns
;

473 
sùp_cook›_·¿m
 *
	mcook›
;

474 
sùp_suµÜ‹d_addrs_·¿m
 *
	m§t
;

475 
sùp_v4addr_·¿m
 *
	mv4
;

476 
sùp_v6addr_·¿m
 *
	mv6
;

477 
sùp_addr_·¿m
 *
	maddr
;

478 
sùp_ad­tiÚ_šd_·¿m
 *
	mašd
;

479 
sùp_suµÜ‹d_ext_·¿m
 *
	mext
;

480 
sùp_¿ndom_·¿m
 *
	m¿ndom
;

481 
sùp_chunks_·¿m
 *
	mchunks
;

482 
sùp_hmac_®go_·¿m
 *
	mhmac_®go
;

483 
sùp_add_·¿m
 *
	madd
;

493 
	ssùp_£nd”_hb_šfo
 {

494 
sùp_·¿mhdr
 
	m·¿m_hdr
;

495 
sùp_addr
 
	mdaddr
;

496 
	m£Á_©
;

497 
__u64
 
	mhb_nÚû
;

498 } 
	t__©Œibu‹__
((
	t·cked
)è
	tsùp_£nd”_hb_šfo_t
;

514 
	ssùp_¡»am
 {

515 
__u16
 *
	ms¢
;

516 
	mËn
;

519 
	ssùp_s¢m­
 {

520 
sùp_¡»am
 
	mš
;

521 
sùp_¡»am
 
	mout
;

522 
	mm®loûd
;

525 
sùp_s¢m­
 *
sùp_s¢m­_Ãw
(
__u16
 
š
, __u16 
out
,

526 
gå_t
 
gå
);

527 
sùp_s¢m­_ä“
(
sùp_s¢m­
 *
m­
);

528 
sùp_s¢m­_ş—r
(
sùp_s¢m­
 *
m­
);

531 
šlše
 
__u16
 
	$sùp_s¢_³ek
(
sùp_¡»am
 *
¡»am
, 
__u16
 
id
)

533  
¡»am
->
s¢
[
id
];

534 
	}
}

537 
šlše
 
__u16
 
	$sùp_s¢_Ãxt
(
sùp_¡»am
 *
¡»am
, 
__u16
 
id
)

539  
¡»am
->
s¢
[
id
]++;

540 
	}
}

543 
šlše
 
	$sùp_s¢_sk
(
sùp_¡»am
 *
¡»am
, 
__u16
 
id
,

544 
__u16
 
s¢
)

546 
¡»am
->
s¢
[
id
] = ssn+1;

547 
	}
}

553 
	ssùp_af
 {

554 (*
	msùp_xm™
è(
sk_buff
 *
	mskb
,

555 
	msùp_Œª¥Üt
 *);

556 (*
	m£tsockİt
è(
sock
 *
	msk
,

557 
	mËv–
,

558 
	mİŠame
,

559 
__u£r
 *
	mİtv®
,

560 
	mİ’
);

561 (*
	mg‘sockİt
è(
sock
 *
	msk
,

562 
	mËv–
,

563 
	mİŠame
,

564 
__u£r
 *
	mİtv®
,

565 
__u£r
 *
	mİ’
);

566 (*
	mcom·t_£tsockİt
è(
sock
 *
	msk
,

567 
	mËv–
,

568 
	mİŠame
,

569 
__u£r
 *
	mİtv®
,

570 
	mİ’
);

571 (*
	mcom·t_g‘sockİt
è(
sock
 *
	msk
,

572 
	mËv–
,

573 
	mİŠame
,

574 
__u£r
 *
	mİtv®
,

575 
__u£r
 *
	mİ’
);

576 
	md¡_’Œy
 *(*
	mg‘_d¡
è(
sùp_assocŸtiÚ
 *
	masoc
,

577 
sùp_addr
 *
	mdaddr
,

578 
sùp_addr
 *
	m§ddr
,

579 
æowi
 *
	mæ
,

580 
sock
 *
	msk
);

581 (*
	mg‘_§ddr
è(
sùp_sock
 *
	msk
,

582 
sùp_Œª¥Üt
 *
	mt
,

583 
sùp_addr
 *
	mdaddr
,

584 
æowi
 *
	mæ
);

585 (*
	mcİy_add¾i¡
è(
	mli¡_h—d
 *,

586 
	mÃt_deviû
 *);

587 (*
	md¡_§ddr
è(
sùp_addr
 *
	m§ddr
,

588 
d¡_’Œy
 *
	md¡
,

589 
__be16
 
	mpÜt
);

590 (*
	mcmp_addr
è(cÚ¡ 
sùp_addr
 *
	maddr1
,

591 cÚ¡ 
sùp_addr
 *
	maddr2
);

592 (*
	maddr_cİy
è(
sùp_addr
 *
	md¡
,

593 
sùp_addr
 *
	m¤c
);

594 (*
	mäom_skb
è(
	msùp_addr
 *,

595 
sk_buff
 *
	mskb
,

596 
	m§ddr
);

597 (*
	mäom_sk
è(
	msùp_addr
 *,

598 
sock
 *
	msk
);

599 (*
	mto_sk_§ddr
è(
	msùp_addr
 *,

600 
sock
 *
	msk
);

601 (*
	mto_sk_daddr
è(
	msùp_addr
 *,

602 
sock
 *
	msk
);

603 (*
	mäom_addr_·¿m
è(
	msùp_addr
 *,

604 
	msùp_addr_·¿m
 *,

605 
__be16
 
	mpÜt
, 
	miif
);

606 (*
	mto_addr_·¿m
è(cÚ¡ 
	msùp_addr
 *,

607 
	msùp_addr_·¿m
 *);

608 (*
	maddr_v®id
è(
	msùp_addr
 *,

609 
	msùp_sock
 *,

610 cÚ¡ 
	msk_buff
 *);

611 
sùp_scİe_t
 (*
scİe
è(
	msùp_addr
 *);

612 (*
	mšaddr_ªy
è(
	msùp_addr
 *, 
	m__be16
);

613 (*
	mis_ªy
è(cÚ¡ 
	msùp_addr
 *);

614 (*
	mavaabË
è(
	msùp_addr
 *,

615 
	msùp_sock
 *);

616 (*
	mskb_iif
è(cÚ¡ 
sk_buff
 *
	msk
);

617 (*
	mis_û
è(cÚ¡ 
sk_buff
 *
	msk
);

618 (*
	m£q_dump_addr
)(
£q_fe
 *
	m£q
,

619 
sùp_addr
 *
	maddr
);

620 (*
	meú_ÿ·bË
)(
sock
 *
	msk
);

621 
__u16
 
	mÃt_h—d”_Ën
;

622 
	msockaddr_Ën
;

623 
§_çmy_t
 
	m§_çmy
;

624 
li¡_h—d
 
	mli¡
;

627 
sùp_af
 *
sùp_g‘_af_¥ecific
(
§_çmy_t
);

628 
sùp_»gi¡”_af
(
sùp_af
 *);

631 
	ssùp_pf
 {

632 (*
	mev’t_msgÇme
)(
	msùp_uÍev’t
 *, *, *);

633 (*
	mskb_msgÇme
è(
	msk_buff
 *, *, *);

634 (*
	maf_suµÜ‹d
è(
	m§_çmy_t
, 
	msùp_sock
 *);

635 (*
	mcmp_addr
è(cÚ¡ 
	msùp_addr
 *,

636 cÚ¡ 
	msùp_addr
 *,

637 
	msùp_sock
 *);

638 (*
	mbšd_v”ify
è(
	msùp_sock
 *, 
	msùp_addr
 *);

639 (*
	m£nd_v”ify
è(
	msùp_sock
 *, 
	msùp_addr
 *);

640 (*
	msuµÜ‹d_addrs
)(cÚ¡ 
	msùp_sock
 *, 
	m__be16
 *);

641 
	msock
 *(*
	mü—‹_acû±_sk
è(
sock
 *
	msk
,

642 
sùp_assocŸtiÚ
 *
	masoc
);

643 (*
	maddr_v4m­
è(
	msùp_sock
 *, 
	msùp_addr
 *);

644 
sùp_af
 *
	maf
;

651 
	ssùp_d©amsg
 {

653 
li¡_h—d
 
	mchunks
;

655 
©omic_t
 
	m»fút
;

657 
	mexpœes_©
;

659 
	m£nd_”rÜ
;

660 
u8
 
	m£nd_çed
:1,

661 
	mÿn_abªdÚ
:1,

662 
	mÿn_d–ay
;

665 
sùp_d©amsg
 *
sùp_d©amsg_äom_u£r
(
sùp_assocŸtiÚ
 *,

666 
sùp_¢drcvšfo
 *,

667 
msghdr
 *, 
Ën
);

668 
sùp_d©amsg_ä“
(
sùp_d©amsg
 *);

669 
sùp_d©amsg_put
(
sùp_d©amsg
 *);

670 
sùp_chunk_ç
(
sùp_chunk
 *, 
”rÜ
);

671 
sùp_chunk_abªdÚed
(
sùp_chunk
 *);

681 
	ssùp_chunk
 {

682 
li¡_h—d
 
	mli¡
;

684 
©omic_t
 
	m»fút
;

687 
li¡_h—d
 
	mŒªsm™‹d_li¡
;

694 
li¡_h—d
 
	mäag_li¡
;

697 
sk_buff
 *
	mskb
;

706 
sùp_·¿ms
 
	m·¿m_hdr
;

708 
__u8
 *
	mv
;

709 
sùp_d©ahdr
 *
	md©a_hdr
;

710 
sùp_š™hdr
 *
	mš™_hdr
;

711 
sùp_§ckhdr
 *
	m§ck_hdr
;

712 
sùp_h—¹b—thdr
 *
	mhb_hdr
;

713 
sùp_£nd”_hb_šfo
 *
	mhbs_hdr
;

714 
sùp_shutdownhdr
 *
	mshutdown_hdr
;

715 
sùp_sigÃd_cook›
 *
	mcook›_hdr
;

716 
sùp_eúehdr
 *
	meúe_hdr
;

717 
sùp_cwrhdr
 *
	meú_cwr_hdr
;

718 
sùp_”rhdr
 *
	m”r_hdr
;

719 
sùp_addhdr
 *
	madd_hdr
;

720 
sùp_fwdt¢_hdr
 *
	mfwdt¢_hdr
;

721 
sùp_authhdr
 *
	mauth_hdr
;

722 } 
	msubh
;

724 
__u8
 *
	mchunk_’d
;

726 
sùp_chunkhdr
 *
	mchunk_hdr
;

727 
sùphdr
 *
	msùp_hdr
;

730 
sùp_¢drcvšfo
 
	msšfo
;

733 
sùp_assocŸtiÚ
 *
	masoc
;

736 
sùp_•_commÚ
 *
	mrcvr
;

739 
	m£Á_©
;

742 
sùp_addr
 
	msourû
;

744 
sùp_addr
 
	mde¡
;

747 
sùp_d©amsg
 *
	mmsg
;

753 
sùp_Œª¥Üt
 *
	mŒª¥Üt
;

760 
sk_buff
 *
	mauth_chunk
;

762 
	#SCTP_CAN_FRTX
 0x0

	)

763 
	#SCTP_NEED_FRTX
 0x1

	)

764 
	#SCTP_DONT_FRTX
 0x2

	)

765 
__u16
 
	m¹t_š_´og»ss
:1,

766 
	mhas_t¢
:1,

767 
	mhas_s¢
:1,

768 
	msšgËtÚ
:1,

769 
	m’d_of_·ck‘
:1,

770 
	meú_û_dÚe
:1,

771 
	mpdisÿrd
:1,

772 
	mt¢_g­_acked
:1,

773 
	md©a_acû±ed
:1,

774 
	mauth
:1,

775 
	mhas_ascÚf
:1,

776 
	mt¢_missšg_»pÜt
:2,

777 
	mç¡_»Œªsm™
:2;

780 
sùp_chunk_hŞd
(
sùp_chunk
 *);

781 
sùp_chunk_put
(
sùp_chunk
 *);

782 
sùp_u£r_addto_chunk
(
sùp_chunk
 *
chunk
, 
off
, 
Ën
,

783 
iovec
 *
d©a
);

784 
sùp_chunk_ä“
(
sùp_chunk
 *);

785 *
sùp_addto_chunk
(
sùp_chunk
 *, 
Ën
, cÚ¡ *
d©a
);

786 *
sùp_addto_chunk_fixed
(
sùp_chunk
 *, 
Ën
, cÚ¡ *
d©a
);

787 
sùp_chunk
 *
sùp_chunkify
(
sk_buff
 *,

788 cÚ¡ 
sùp_assocŸtiÚ
 *,

789 
sock
 *);

790 
sùp_š™_addrs
(
sùp_chunk
 *, 
sùp_addr
 *,

791 
sùp_addr
 *);

792 cÚ¡ 
sùp_addr
 *
sùp_sourû
(cÚ¡ 
sùp_chunk
 *
chunk
);

795 
	mSCTP_ADDR_NEW
,

796 
	mSCTP_ADDR_SRC
,

797 
	mSCTP_ADDR_DEL
,

801 
	ssùp_sockaddr_’Œy
 {

802 
li¡_h—d
 
	mli¡
;

803 
rcu_h—d
 
	mrcu
;

804 
sùp_addr
 
	ma
;

805 
__u8
 
	m¡©e
;

806 
__u8
 
	mv®id
;

809 
	gsùp_chunk
 *(
	tsùp_·ck‘_phªdËr_t
)(
	tsùp_assocŸtiÚ
 *);

814 
	ssùp_·ck‘
 {

816 
__u16
 
	msourû_pÜt
;

817 
__u16
 
	mde¡š©iÚ_pÜt
;

818 
__u32
 
	mvg
;

821 
li¡_h—d
 
	mchunk_li¡
;

824 
size_t
 
	mov”h—d
;

826 
size_t
 
	msize
;

832 
sùp_Œª¥Üt
 *
	mŒª¥Üt
;

835 
sùp_chunk
 *
	mauth
;

837 
u8
 
	mhas_cook›_echo
:1,

838 
	mhas_§ck
:1,

839 
	mhas_auth
:1,

840 
	mhas_d©a
:1,

841 
	mäagok
:1,

842 
	mm®loûd
:1;

845 
sùp_·ck‘
 *
sùp_·ck‘_š™
(sctp_packet *,

846 
sùp_Œª¥Üt
 *,

847 
__u16
 
¥Üt
, __u16 
dpÜt
);

848 
sùp_·ck‘
 *
sùp_·ck‘_cÚfig
(sùp_·ck‘ *, 
__u32
 
vg
, );

849 
sùp_xm™_t
 
sùp_·ck‘_Œªsm™_chunk
(
sùp_·ck‘
 *,

850 
sùp_chunk
 *, );

851 
sùp_xm™_t
 
sùp_·ck‘_­³nd_chunk
(
sùp_·ck‘
 *,

852 
sùp_chunk
 *);

853 
sùp_·ck‘_Œªsm™
(
sùp_·ck‘
 *);

854 
sùp_·ck‘_ä“
(
sùp_·ck‘
 *);

856 
šlše
 
	$sùp_·ck‘_em±y
(
sùp_·ck‘
 *
·ck‘
)

858  (
·ck‘
->
size
 =ğ·ck‘->
ov”h—d
);

859 
	}
}

881 
	ssùp_Œª¥Üt
 {

883 
li¡_h—d
 
	mŒª¥Üts
;

886 
©omic_t
 
	m»fút
;

887 
__u32
 
	md—d
:1,

897 
	m¹o_³ndšg
:1,

903 
	mhb_£Á
:1,

906 
	mpmtu_³ndšg
:1,

909 
	mm®loûd
:1;

912 
__u32
 
	m§ck_g’”©iÚ
;

915 
sùp_addr
 
	maddr
;

918 
sùp_af
 *
	maf_¥ecific
;

921 
sùp_assocŸtiÚ
 *
	masoc
;

932 
	m¹o
;

934 
__u32
 
	m¹t
;

937 
__u32
 
	m¹tv¬
;

940 
__u32
 
	m¤‰
;

946 
__u32
 
	mcwnd
;

949 
__u32
 
	ms¡h»sh
;

954 
__u32
 
	m·¹Ÿl_by‹s_acked
;

957 
__u32
 
	mæight_size
;

959 
__u32
 
	mbur¡_lim™ed
;

962 
d¡_’Œy
 *
	md¡
;

964 
sùp_addr
 
	m§ddr
;

969 
	mhbš‹rv®
;

972 
	m§ckd–ay
;

973 
__u32
 
	m§ckäeq
;

978 
	mÏ¡_time_h—rd
;

983 
	mÏ¡_time_eúe_»duûd
;

989 
__u16
 
	m·thmaxrxt
;

995 
	mpf_»Œªs
;

997 
__u32
 
	m·thmtu
;

1000 
__u32
 
	m·¿m_æags
;

1003 
	mš™_£Á_couÁ
;

1008 
	m¡©e
;

1013 
	m”rÜ_couÁ
;

1021 
tim”_li¡
 
	mT3_¹x_tim”
;

1024 
tim”_li¡
 
	mhb_tim”
;

1027 
tim”_li¡
 
	m´Ùo_uÄ—ch_tim”
;

1034 
li¡_h—d
 
	mŒªsm™‹d
;

1037 
sùp_·ck‘
 
	m·ck‘
;

1040 
li¡_h—d
 
	m£nd_»ady
;

1054 
__u32
 
	mÃxt_t¢_©_chªge
;

1057 
	mchªgeov”_aùive
;

1063 
	mcyşšg_chªgeov”
;

1068 
	mÿcc_§w_Ãwack
;

1069 } 
	mÿcc
;

1072 
__u64
 
	mhb_nÚû
;

1074 
rcu_h—d
 
	mrcu
;

1077 
sùp_Œª¥Üt
 *
sùp_Œª¥Üt_Ãw
(cÚ¡ 
sùp_addr
 *,

1078 
gå_t
);

1079 
sùp_Œª¥Üt_£t_owÃr
(
sùp_Œª¥Üt
 *,

1080 
sùp_assocŸtiÚ
 *);

1081 
sùp_Œª¥Üt_rou‹
(
sùp_Œª¥Üt
 *, 
sùp_addr
 *,

1082 
sùp_sock
 *);

1083 
sùp_Œª¥Üt_pmtu
(
sùp_Œª¥Üt
 *, 
sock
 *
sk
);

1084 
sùp_Œª¥Üt_ä“
(
sùp_Œª¥Üt
 *);

1085 
sùp_Œª¥Üt_»£t_tim”s
(
sùp_Œª¥Üt
 *);

1086 
sùp_Œª¥Üt_hŞd
(
sùp_Œª¥Üt
 *);

1087 
sùp_Œª¥Üt_put
(
sùp_Œª¥Üt
 *);

1088 
sùp_Œª¥Üt_upd©e_¹o
(
sùp_Œª¥Üt
 *, 
__u32
);

1089 
sùp_Œª¥Üt_¿i£_cwnd
(
sùp_Œª¥Üt
 *, 
__u32
, __u32);

1090 
sùp_Œª¥Üt_low”_cwnd
(
sùp_Œª¥Üt
 *, 
sùp_low”_cwnd_t
);

1091 
sùp_Œª¥Üt_bur¡_lim™ed
(
sùp_Œª¥Üt
 *);

1092 
sùp_Œª¥Üt_bur¡_»£t
(
sùp_Œª¥Üt
 *);

1093 
sùp_Œª¥Üt_timeout
(
sùp_Œª¥Üt
 *);

1094 
sùp_Œª¥Üt_»£t
(
sùp_Œª¥Üt
 *);

1095 
sùp_Œª¥Üt_upd©e_pmtu
(
sùp_Œª¥Üt
 *, 
u32
);

1101 
	ssùp_šq
 {

1105 
li¡_h—d
 
	mš_chunk_li¡
;

1109 
sùp_chunk
 *
	mš_´og»ss
;

1114 
wÜk_¡ruù
 
	mimmedŸ‹
;

1116 
	mm®loûd
;

1119 
sùp_šq_š™
(
sùp_šq
 *);

1120 
sùp_šq_ä“
(
sùp_šq
 *);

1121 
sùp_šq_push
(
sùp_šq
 *, 
sùp_chunk
 *
·ck‘
);

1122 
sùp_chunk
 *
sùp_šq_pİ
(
sùp_šq
 *);

1123 
sùp_chunkhdr
 *
sùp_šq_³ek
(
sùp_šq
 *);

1124 
sùp_šq_£t_th_hªdËr
(
sùp_šq
 *, 
wÜk_func_t
);

1145 
	ssùp_outq
 {

1146 
sùp_assocŸtiÚ
 *
	masoc
;

1149 
li¡_h—d
 
	mout_chunk_li¡
;

1151 
	mout_qËn
;

1154 
	m”rÜ
;

1157 
li¡_h—d
 
	mcÚŒŞ_chunk_li¡
;

1162 
li¡_h—d
 
	m§cked
;

1167 
li¡_h—d
 
	m»Œªsm™
;

1172 
li¡_h—d
 
	mabªdÚed
;

1175 
__u32
 
	mout¡ªdšg_by‹s
;

1178 
	mç¡_¹x
;

1181 
	mcÜk
;

1184 
	mem±y
;

1187 
	mm®loûd
;

1190 
sùp_outq_š™
(
sùp_assocŸtiÚ
 *, 
sùp_outq
 *);

1191 
sùp_outq_‹¬down
(
sùp_outq
 *);

1192 
sùp_outq_ä“
(
sùp_outq
*);

1193 
sùp_outq_
(
sùp_outq
 *, 
sùp_chunk
 *
chunk
);

1194 
sùp_outq_§ck
(
sùp_outq
 *, 
sùp_§ckhdr
 *);

1195 
sùp_outq_is_em±y
(cÚ¡ 
sùp_outq
 *);

1196 
sùp_outq_»¡¬t
(
sùp_outq
 *);

1198 
sùp_»Œªsm™
(
sùp_outq
 *, 
sùp_Œª¥Üt
 *,

1199 
sùp_»Œªsm™_»asÚ_t
);

1200 
sùp_»Œªsm™_m¬k
(
sùp_outq
 *, 
sùp_Œª¥Üt
 *, 
__u8
);

1201 
sùp_outq_uncÜk
(
sùp_outq
 *);

1203 
šlše
 
	$sùp_outq_cÜk
(
sùp_outq
 *
q
)

1205 
q
->
cÜk
 = 1;

1206 
	}
}

1209 
	ssùp_bšd_addr
 {

1216 
__u16
 
	mpÜt
;

1224 
li¡_h—d
 
	madd»ss_li¡
;

1226 
	mm®loûd
;

1229 
sùp_bšd_addr_š™
(
sùp_bšd_addr
 *, 
__u16
 
pÜt
);

1230 
sùp_bšd_addr_ä“
(
sùp_bšd_addr
 *);

1231 
sùp_bšd_addr_cİy
(
sùp_bšd_addr
 *
de¡
,

1232 cÚ¡ 
sùp_bšd_addr
 *
¤c
,

1233 
sùp_scİe_t
 
scİe
, 
gå_t
 
gå
,

1234 
æags
);

1235 
sùp_bšd_addr_dup
(
sùp_bšd_addr
 *
de¡
,

1236 cÚ¡ 
sùp_bšd_addr
 *
¤c
,

1237 
gå_t
 
gå
);

1238 
sùp_add_bšd_addr
(
sùp_bšd_addr
 *, 
sùp_addr
 *,

1239 
__u8
 
addr_¡©e
, 
gå_t
 
gå
);

1240 
sùp_d–_bšd_addr
(
sùp_bšd_addr
 *, 
sùp_addr
 *);

1241 
sùp_bšd_addr_m©ch
(
sùp_bšd_addr
 *, cÚ¡ 
sùp_addr
 *,

1242 
sùp_sock
 *);

1243 
sùp_bšd_addr_cÚæiù
(
sùp_bšd_addr
 *, cÚ¡ 
sùp_addr
 *,

1244 
sùp_sock
 *, sctp_sock *);

1245 
sùp_bšd_addr_¡©e
(cÚ¡ 
sùp_bšd_addr
 *
bp
,

1246 cÚ¡ 
sùp_addr
 *
addr
);

1247 
sùp_addr
 *
sùp_fšd_unm©ch_addr
(
sùp_bšd_addr
 *
bp
,

1248 cÚ¡ 
sùp_addr
 *
addrs
,

1249 
addrút
,

1250 
sùp_sock
 *
İt
);

1251 
sùp_·¿ms
 
sùp_bšd_addrs_to_¿w
(cÚ¡ 
sùp_bšd_addr
 *
bp
,

1252 *
addrs_Ën
,

1253 
gå_t
 
gå
);

1254 
sùp_¿w_to_bšd_addrs
(
sùp_bšd_addr
 *
bp
, 
__u8
 *
¿w
, 
Ën
,

1255 
__u16
 
pÜt
, 
gå_t
 
gå
);

1257 
sùp_scİe_t
 
sùp_scİe
(cÚ¡ 
sùp_addr
 *);

1258 
sùp_š_scİe
(cÚ¡ 
sùp_addr
 *
addr
, cÚ¡ 
sùp_scİe_t
 
scİe
);

1259 
sùp_is_ªy
(
sock
 *
sk
, cÚ¡ 
sùp_addr
 *
addr
);

1260 
sùp_addr_is_v®id
(cÚ¡ 
sùp_addr
 *
addr
);

1265 
	mSCTP_EP_TYPE_SOCKET
,

1266 
	mSCTP_EP_TYPE_ASSOCIATION
,

1267 } 
	tsùp_’dpošt_ty³_t
;

1285 
	ssùp_•_commÚ
 {

1287 
hli¡_node
 
	mnode
;

1288 
	mhash’t
;

1291 
sùp_’dpošt_ty³_t
 
	mty³
;

1298 
©omic_t
 
	m»fút
;

1299 
	md—d
;

1300 
	mm®loûd
;

1303 
sock
 *
	msk
;

1306 
sùp_šq
 
	mšqueue
;

1313 
sùp_bšd_addr
 
	mbšd_addr
;

1336 
	ssùp_’dpošt
 {

1338 
sùp_•_commÚ
 
	mba£
;

1350 
li¡_h—d
 
	masocs
;

1358 
__u8
 
	m£ü‘_key
[
SCTP_HOW_MANY_SECRETS
][
SCTP_SECRET_SIZE
];

1359 
	mcu¼’t_key
;

1360 
	mÏ¡_key
;

1361 
	mkey_chªged_©
;

1369 
__u8
 *
	mdige¡
;

1372 
__u32
 
	m¢dbuf_pŞicy
;

1375 
__u32
 
	mrcvbuf_pŞicy
;

1380 
üy±o_hash
 **
	mauth_hmacs
;

1383 
sùp_hmac_®go_·¿m
 *
	mauth_hmacs_li¡
;

1386 
sùp_chunks_·¿m
 *
	mauth_chunk_li¡
;

1389 
li¡_h—d
 
	m’dpošt_sh¬ed_keys
;

1390 
__u16
 
	maùive_key_id
;

1394 
šlše
 
sùp_’dpošt
 *
	$sùp_•
(
sùp_•_commÚ
 *
ba£
)

1396 
sùp_’dpošt
 *
•
;

1398 
•
 = 
	`cÚš”_of
(
ba£
, 
sùp_’dpošt
, base);

1399  
•
;

1400 
	}
}

1403 
sùp_’dpošt
 *
sùp_’dpošt_Ãw
(
sock
 *, 
gå_t
);

1404 
sùp_’dpošt_ä“
(
sùp_’dpošt
 *);

1405 
sùp_’dpošt_put
(
sùp_’dpošt
 *);

1406 
sùp_’dpošt_hŞd
(
sùp_’dpošt
 *);

1407 
sùp_’dpošt_add_asoc
(
sùp_’dpošt
 *, 
sùp_assocŸtiÚ
 *);

1408 
sùp_assocŸtiÚ
 *
sùp_’dpošt_lookup_assoc
(

1409 cÚ¡ 
sùp_’dpošt
 *
•
,

1410 cÚ¡ 
sùp_addr
 *
·ddr
,

1411 
sùp_Œª¥Üt
 **);

1412 
sùp_’dpošt_is_³–ed_off
(
sùp_’dpošt
 *,

1413 cÚ¡ 
sùp_addr
 *);

1414 
sùp_’dpošt
 *
sùp_’dpošt_is_m©ch
(sctp_endpoint *,

1415 cÚ¡ 
sùp_addr
 *);

1416 
sùp_has_assocŸtiÚ
(cÚ¡ 
sùp_addr
 *
Ïddr
,

1417 cÚ¡ 
sùp_addr
 *
·ddr
);

1419 
sùp_v”ify_š™
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
sùp_cid_t
,

1420 
sùp_š™_chunk_t
 *
³”_š™
, 
sùp_chunk
 *
chunk
,

1421 
sùp_chunk
 **
”r_chunk
);

1422 
sùp_´oûss_š™
(
sùp_assocŸtiÚ
 *, 
sùp_chunk
 *
chunk
,

1423 cÚ¡ 
sùp_addr
 *
³”
,

1424 
sùp_š™_chunk_t
 *
š™
, 
gå_t
 
gå
);

1425 
__u32
 
sùp_g’”©e_g
(cÚ¡ 
sùp_’dpošt
 *);

1426 
__u32
 
sùp_g’”©e_t¢
(cÚ¡ 
sùp_’dpošt
 *);

1428 
	ssùp_š™hdr_ho¡
 {

1429 
__u32
 
	mš™_g
;

1430 
__u32
 
	ma_rwnd
;

1431 
__u16
 
	mnum_outbound_¡»ams
;

1432 
__u16
 
	mnum_šbound_¡»ams
;

1433 
__u32
 
	mš™Ÿl_t¢
;

1450 
	ssùp_assocŸtiÚ
 {

1456 
sùp_•_commÚ
 
	mba£
;

1459 
li¡_h—d
 
	masocs
;

1462 
sùp_assoc_t
 
	massoc_id
;

1465 
sùp_’dpošt
 *
	m•
;

1468 
sùp_cook›
 
	mc
;

1476 
__u32
 
	mrwnd
;

1493 
li¡_h—d
 
	mŒª¥Üt_addr_li¡
;

1502 
__u16
 
	mŒª¥Üt_couÁ
;

1507 
__u16
 
	mpÜt
;

1524 
sùp_Œª¥Üt
 *
	m´im¬y_·th
;

1529 
sùp_addr
 
	m´im¬y_addr
;

1535 
sùp_Œª¥Üt
 *
	maùive_·th
;

1547 
sùp_Œª¥Üt
 *
	m»Œª_·th
;

1550 
sùp_Œª¥Üt
 *
	mÏ¡_£Á_to
;

1553 
sùp_Œª¥Üt
 *
	mÏ¡_d©a_äom
;

1575 
sùp_t¢m­
 
	mt¢_m­
;

1587 
__u8
 
	m§ck_Ãeded
;

1588 
__u32
 
	m§ck_út
;

1589 
__u32
 
	m§ck_g’”©iÚ
;

1592 
__u8
 
	meú_ÿ·bË
:1,

1593 
	mv4_add»ss
:1,

1594 
	mv6_add»ss
:1,

1595 
	mho¡Çme_add»ss
:1,

1596 
	mascÚf_ÿ·bË
:1,

1597 
	m´sùp_ÿ·bË
:1,

1598 
	mauth_ÿ·bË
:1;

1600 
__u32
 
	mad­tiÚ_šd
;

1605 
__be16
 
	madd_di§bËd_mask
;

1607 
sùp_š™hdr_ho¡
 
	mi
;

1608 
	mcook›_Ën
;

1609 *
	mcook›
;

1615 
__u32
 
	madd_£rŸl
;

1621 
sùp_¿ndom_·¿m_t
 *
	m³”_¿ndom
;

1622 
sùp_chunks_·¿m_t
 *
	m³”_chunks
;

1623 
sùp_hmac_®go_·¿m_t
 *
	m³”_hmacs
;

1624 } 
	m³”
;

1639 
sùp_¡©e_t
 
	m¡©e
;

1642 
timev®
 
	mcook›_liã
;

1647 
	mov”®l_”rÜ_couÁ
;

1653 
	m¹o_š™Ÿl
;

1654 
	m¹o_max
;

1655 
	m¹o_mš
;

1658 
	mmax_bur¡
;

1664 
	mmax_»Œªs
;

1670 
	mpf_»Œªs
;

1673 
__u16
 
	mmax_š™_©‹m±s
;

1676 
__u16
 
	mš™_»Œ›s
;

1679 
	mmax_š™_timeo
;

1685 
	mhbš‹rv®
;

1690 
__u16
 
	m·thmaxrxt
;

1693 
__u8
 
	mpmtu_³ndšg
;

1698 
__u32
 
	m·thmtu
;

1701 
__u32
 
	m·¿m_æags
;

1704 
	m§ckd–ay
;

1705 
__u32
 
	m§ckäeq
;

1708 
	mtimeouts
[
SCTP_NUM_TIMEOUT_TYPES
];

1709 
tim”_li¡
 
	mtim”s
[
SCTP_NUM_TIMEOUT_TYPES
];

1712 
sùp_Œª¥Üt
 *
	mshutdown_Ï¡_£Á_to
;

1715 
	mshutdown_»Œ›s
;

1718 
sùp_Œª¥Üt
 *
	mš™_Ï¡_£Á_to
;

1727 
__u32
 
	mÃxt_t¢
;

1738 
__u32
 
	mù¢_ack_pošt
;

1741 
__u32
 
	madv_³”_ack_pošt
;

1744 
__u32
 
	mhighe¡_§cked
;

1747 
__u32
 
	mç¡_»cov”y_ex™
;

1750 
__u8
 
	mç¡_»cov”y
;

1755 
__u16
 
	muÇck_d©a
;

1760 
__u32
 
	m¹x_d©a_chunks
;

1765 
__u32
 
	mrwnd
;

1768 
__u32
 
	ma_rwnd
;

1773 
__u32
 
	mrwnd_ov”
;

1779 
__u32
 
	mrwnd_´ess
;

1785 
	m¢dbuf_u£d
;

1790 
©omic_t
 
	mrmem_®loc
;

1795 
wa™_queue_h—d_t
 
	mwa™
;

1798 
__u32
 
	mäag_pošt
;

1799 
__u32
 
	mu£r_äag
;

1802 
	mš™_”r_couÁ”
;

1805 
	mš™_cyşe
;

1808 
__u16
 
	mdeçuÉ_¡»am
;

1809 
__u16
 
	mdeçuÉ_æags
;

1810 
__u32
 
	mdeçuÉ_µid
;

1811 
__u32
 
	mdeçuÉ_cÚ‹xt
;

1812 
__u32
 
	mdeçuÉ_tim‘Şive
;

1815 
__u32
 
	mdeçuÉ_rcv_cÚ‹xt
;

1818 
sùp_s¢m­
 *
	ms¢m­
;

1821 
sùp_outq
 
	moutqueue
;

1826 
sùp_uÍq
 
	muÍq
;

1829 
__u32
 
	mÏ¡_eúe_t¢
;

1832 
__u32
 
	mÏ¡_cwr_t¢
;

1835 
	mnumdu±¢s
;

1841 
__u32
 
	mautoşo£
;

1866 
sùp_chunk
 *
	madd_Ï¡_ascÚf
;

1877 
li¡_h—d
 
	mascÚf_ack_li¡
;

1907 
li¡_h—d
 
	madd_chunk_li¡
;

1929 
__u32
 
	madd_£rŸl
;

1935 
li¡_h—d
 
	m’dpošt_sh¬ed_keys
;

1940 
sùp_auth_by‹s
 *
	masoc_sh¬ed_key
;

1945 
__u16
 
	mdeçuÉ_hmac_id
;

1947 
__u16
 
	maùive_key_id
;

1949 
__u8
 
	mÃed_eúe
:1,

1950 
	m‹mp
:1,

1951 
	mbkup_d©a
:1,

1952 
	mbkup_§ck
:1,

1953 
	mbkup_£t
;

1961 
	mSCTP_ASSOC_EYECATCHER
 = 0xa550c123,

1965 
šlše
 
sùp_assocŸtiÚ
 *
	$sùp_assoc
(
sùp_•_commÚ
 *
ba£
)

1967 
sùp_assocŸtiÚ
 *
asoc
;

1969 
asoc
 = 
	`cÚš”_of
(
ba£
, 
sùp_assocŸtiÚ
, base);

1970  
asoc
;

1971 
	}
}

1976 
sùp_assocŸtiÚ
 *

1977 
sùp_assocŸtiÚ_Ãw
(cÚ¡ 
sùp_’dpošt
 *, cÚ¡ 
sock
 *,

1978 
sùp_scİe_t
 
scİe
, 
gå_t
 
gå
);

1979 
sùp_assocŸtiÚ_ä“
(
sùp_assocŸtiÚ
 *);

1980 
sùp_assocŸtiÚ_put
(
sùp_assocŸtiÚ
 *);

1981 
sùp_assocŸtiÚ_hŞd
(
sùp_assocŸtiÚ
 *);

1983 
sùp_Œª¥Üt
 *
sùp_assoc_choo£_®‹r_Œª¥Üt
(

1984 
sùp_assocŸtiÚ
 *, 
sùp_Œª¥Üt
 *);

1985 
sùp_assoc_upd©e_»Œª_·th
(
sùp_assocŸtiÚ
 *);

1986 
sùp_Œª¥Üt
 *
sùp_assoc_lookup_·ddr
(cÚ¡ 
sùp_assocŸtiÚ
 *,

1987 cÚ¡ 
sùp_addr
 *);

1988 
sùp_assoc_lookup_Ïddr
(
sùp_assocŸtiÚ
 *
asoc
,

1989 cÚ¡ 
sùp_addr
 *
Ïddr
);

1990 
sùp_Œª¥Üt
 *
sùp_assoc_add_³”
(
sùp_assocŸtiÚ
 *,

1991 cÚ¡ 
sùp_addr
 *
add»ss
,

1992 cÚ¡ 
gå_t
 
gå
,

1993 cÚ¡ 
³”_¡©e
);

1994 
sùp_assoc_d–_³”
(
sùp_assocŸtiÚ
 *
asoc
,

1995 cÚ¡ 
sùp_addr
 *
addr
);

1996 
sùp_assoc_rm_³”
(
sùp_assocŸtiÚ
 *
asoc
,

1997 
sùp_Œª¥Üt
 *
³”
);

1998 
sùp_assoc_cÚŒŞ_Œª¥Üt
(
sùp_assocŸtiÚ
 *,

1999 
sùp_Œª¥Üt
 *,

2000 
sùp_Œª¥Üt_cmd_t
, 
sùp_¢_”rÜ_t
);

2001 
sùp_Œª¥Üt
 *
sùp_assoc_lookup_t¢
(
sùp_assocŸtiÚ
 *, 
__u32
);

2002 
sùp_Œª¥Üt
 *
sùp_assoc_is_m©ch
(
sùp_assocŸtiÚ
 *,

2003 cÚ¡ 
sùp_addr
 *,

2004 cÚ¡ 
sùp_addr
 *);

2005 
sùp_assoc_mig¿‹
(
sùp_assocŸtiÚ
 *, 
sock
 *);

2006 
sùp_assoc_upd©e
(
sùp_assocŸtiÚ
 *
Şd
,

2007 
sùp_assocŸtiÚ
 *
Ãw
);

2009 
__u32
 
sùp_assocŸtiÚ_g‘_Ãxt_t¢
(
sùp_assocŸtiÚ
 *);

2011 
sùp_assoc_sync_pmtu
(
sùp_assocŸtiÚ
 *);

2012 
sùp_assoc_rwnd_šü—£
(
sùp_assocŸtiÚ
 *, );

2013 
sùp_assoc_rwnd_deü—£
(
sùp_assocŸtiÚ
 *, );

2014 
sùp_assoc_£t_´im¬y
(
sùp_assocŸtiÚ
 *,

2015 
sùp_Œª¥Üt
 *);

2016 
sùp_assoc_d–_nÚ´im¬y_³”s
(
sùp_assocŸtiÚ
 *,

2017 
sùp_Œª¥Üt
 *);

2018 
sùp_assoc_£t_bšd_addr_äom_•
(
sùp_assocŸtiÚ
 *,

2019 
sùp_scİe_t
, 
gå_t
);

2020 
sùp_assoc_£t_bšd_addr_äom_cook›
(
sùp_assocŸtiÚ
 *,

2021 
sùp_cook›
*,

2022 
gå_t
 
gå
);

2023 
sùp_assoc_£t_id
(
sùp_assocŸtiÚ
 *, 
gå_t
);

2024 
sùp_assoc_ş—n_ascÚf_ack_ÿche
(cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
);

2025 
sùp_chunk
 *
sùp_assoc_lookup_ascÚf_ack
(

2026 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

2027 
__be32
 
£rŸl
);

2028 
sùp_ascÚf_queue_‹¬down
(
sùp_assocŸtiÚ
 *
asoc
);

2030 
sùp_cmp_addr_exaù
(cÚ¡ 
sùp_addr
 *
ss1
,

2031 cÚ¡ 
sùp_addr
 *
ss2
);

2032 
sùp_chunk
 *
sùp_g‘_eúe_´•’d
(
sùp_assocŸtiÚ
 *
asoc
);

2035 
	ssùp_cmsgs
 {

2036 
sùp_š™msg
 *
	mš™
;

2037 
sùp_¢drcvšfo
 *
	mšfo
;

2038 } 
	tsùp_cmsgs_t
;

2042 *
	mÏb–
;

2043 
©omic_t
 *
	mcouÁ”
;

2044 } 
	tsùp_dbg_objút_’Œy_t
;

	@sysctl.c

44 
	~<Ãt/sùp/¡ruùs.h
>

45 
	~<Ãt/sùp/sùp.h
>

46 
	~<lšux/sysùl.h
>

48 
	gz”o
 = 0;

49 
	gÚe
 = 1;

50 
	gtim”_max
 = 86400000;

51 
	gšt_max
 = 
INT_MAX
;

52 
	g§ck_tim”_mš
 = 1;

53 
	g§ck_tim”_max
 = 500;

54 
	gaddr_scİe_max
 = 3;

55 
	grwnd_sÿË_max
 = 16;

57 
sysùl_sùp_mem
[3];

58 
sysùl_sùp_rmem
[3];

59 
sysùl_sùp_wmem
[3];

61 
ùl_bË
 
	gsùp_bË
[] = {

63 .
ùl_Çme
 = 
NET_SCTP_RTO_INITIAL
,

64 .
	g´oúame
 = "rto_initial",

65 .
	gd©a
 = &
sùp_¹o_š™Ÿl
,

66 .
	gmaxËn
 = (),

67 .
	gmode
 = 0644,

68 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

69 .
	g¡¿‹gy
 = 
sysùl_štvec
,

70 .
	gexŒa1
 = &
Úe
,

71 .
	gexŒa2
 = &
tim”_max


74 .
	gùl_Çme
 = 
NET_SCTP_RTO_MIN
,

75 .
	g´oúame
 = "rto_min",

76 .
	gd©a
 = &
sùp_¹o_mš
,

77 .
	gmaxËn
 = (),

78 .
	gmode
 = 0644,

79 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

80 .
	g¡¿‹gy
 = 
sysùl_štvec
,

81 .
	gexŒa1
 = &
Úe
,

82 .
	gexŒa2
 = &
tim”_max


85 .
	gùl_Çme
 = 
NET_SCTP_RTO_MAX
,

86 .
	g´oúame
 = "rto_max",

87 .
	gd©a
 = &
sùp_¹o_max
,

88 .
	gmaxËn
 = (),

89 .
	gmode
 = 0644,

90 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

91 .
	g¡¿‹gy
 = 
sysùl_štvec
,

92 .
	gexŒa1
 = &
Úe
,

93 .
	gexŒa2
 = &
tim”_max


96 .
	gùl_Çme
 = 
NET_SCTP_VALID_COOKIE_LIFE
,

97 .
	g´oúame
 = "valid_cookie_life",

98 .
	gd©a
 = &
sùp_v®id_cook›_liã
,

99 .
	gmaxËn
 = (),

100 .
	gmode
 = 0644,

101 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

102 .
	g¡¿‹gy
 = 
sysùl_štvec
,

103 .
	gexŒa1
 = &
Úe
,

104 .
	gexŒa2
 = &
tim”_max


107 .
	gùl_Çme
 = 
NET_SCTP_MAX_BURST
,

108 .
	g´oúame
 = "max_burst",

109 .
	gd©a
 = &
sùp_max_bur¡
,

110 .
	gmaxËn
 = (),

111 .
	gmode
 = 0644,

112 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

113 .
	g¡¿‹gy
 = 
sysùl_štvec
,

114 .
	gexŒa1
 = &
z”o
,

115 .
	gexŒa2
 = &
št_max


118 .
	gùl_Çme
 = 
NET_SCTP_ASSOCIATION_MAX_RETRANS
,

119 .
	g´oúame
 = "association_max_retrans",

120 .
	gd©a
 = &
sùp_max_»Œªs_assocŸtiÚ
,

121 .
	gmaxËn
 = (),

122 .
	gmode
 = 0644,

123 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

124 .
	g¡¿‹gy
 = 
sysùl_štvec
,

125 .
	gexŒa1
 = &
Úe
,

126 .
	gexŒa2
 = &
št_max


129 .
	gùl_Çme
 = 
NET_SCTP_SNDBUF_POLICY
,

130 .
	g´oúame
 = "sndbuf_policy",

131 .
	gd©a
 = &
sùp_¢dbuf_pŞicy
,

132 .
	gmaxËn
 = (),

133 .
	gmode
 = 0644,

134 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

135 .
	g¡¿‹gy
 = 
sysùl_štvec


138 .
	gùl_Çme
 = 
NET_SCTP_RCVBUF_POLICY
,

139 .
	g´oúame
 = "rcvbuf_policy",

140 .
	gd©a
 = &
sùp_rcvbuf_pŞicy
,

141 .
	gmaxËn
 = (),

142 .
	gmode
 = 0644,

143 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

144 .
	g¡¿‹gy
 = 
sysùl_štvec


147 .
	gùl_Çme
 = 
NET_SCTP_PATH_MAX_RETRANS
,

148 .
	g´oúame
 = "path_max_retrans",

149 .
	gd©a
 = &
sùp_max_»Œªs_·th
,

150 .
	gmaxËn
 = (),

151 .
	gmode
 = 0644,

152 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

153 .
	g¡¿‹gy
 = 
sysùl_štvec
,

154 .
	gexŒa1
 = &
Úe
,

155 .
	gexŒa2
 = &
št_max


158 .
	gùl_Çme
 = 
CTL_UNNUMBERED
,

159 .
	g´oúame
 = "pf_retrans",

160 .
	gd©a
 = &
sùp_pf_»Œªs
,

161 .
	gmaxËn
 = (),

162 .
	gmode
 = 0644,

163 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

164 .
	gexŒa1
 = &
z”o
,

165 .
	gexŒa2
 = &
št_max


168 .
	gùl_Çme
 = 
NET_SCTP_MAX_INIT_RETRANSMITS
,

169 .
	g´oúame
 = "max_init_retransmits",

170 .
	gd©a
 = &
sùp_max_»Œªs_š™
,

171 .
	gmaxËn
 = (),

172 .
	gmode
 = 0644,

173 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

174 .
	g¡¿‹gy
 = 
sysùl_štvec
,

175 .
	gexŒa1
 = &
Úe
,

176 .
	gexŒa2
 = &
št_max


179 .
	gùl_Çme
 = 
NET_SCTP_HB_INTERVAL
,

180 .
	g´oúame
 = "hb_interval",

181 .
	gd©a
 = &
sùp_hb_š‹rv®
,

182 .
	gmaxËn
 = (),

183 .
	gmode
 = 0644,

184 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

185 .
	g¡¿‹gy
 = 
sysùl_štvec
,

186 .
	gexŒa1
 = &
Úe
,

187 .
	gexŒa2
 = &
tim”_max


190 .
	gùl_Çme
 = 
NET_SCTP_PRESERVE_ENABLE
,

191 .
	g´oúame
 = "cookie_preserve_enable",

192 .
	gd©a
 = &
sùp_cook›_´e£rve_’abË
,

193 .
	gmaxËn
 = (),

194 .
	gmode
 = 0644,

195 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

196 .
	g¡¿‹gy
 = 
sysùl_štvec


199 .
	gùl_Çme
 = 
NET_SCTP_RTO_ALPHA
,

200 .
	g´oúame
 = "rto_alpha_exp_divisor",

201 .
	gd©a
 = &
sùp_¹o_®pha
,

202 .
	gmaxËn
 = (),

203 .
	gmode
 = 0444,

204 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

205 .
	g¡¿‹gy
 = 
sysùl_štvec


208 .
	gùl_Çme
 = 
NET_SCTP_RTO_BETA
,

209 .
	g´oúame
 = "rto_beta_exp_divisor",

210 .
	gd©a
 = &
sùp_¹o_b‘a
,

211 .
	gmaxËn
 = (),

212 .
	gmode
 = 0444,

213 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

214 .
	g¡¿‹gy
 = 
sysùl_štvec


217 .
	gùl_Çme
 = 
NET_SCTP_ADDIP_ENABLE
,

218 .
	g´oúame
 = "addip_enable",

219 .
	gd©a
 = &
sùp_add_’abË
,

220 .
	gmaxËn
 = (),

221 .
	gmode
 = 0644,

222 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

223 .
	g¡¿‹gy
 = 
sysùl_štvec


226 .
	gùl_Çme
 = 
NET_SCTP_PRSCTP_ENABLE
,

227 .
	g´oúame
 = "prsctp_enable",

228 .
	gd©a
 = &
sùp_´sùp_’abË
,

229 .
	gmaxËn
 = (),

230 .
	gmode
 = 0644,

231 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

232 .
	g¡¿‹gy
 = 
sysùl_štvec


235 .
	gùl_Çme
 = 
NET_SCTP_SACK_TIMEOUT
,

236 .
	g´oúame
 = "sack_timeout",

237 .
	gd©a
 = &
sùp_§ck_timeout
,

238 .
	gmaxËn
 = (),

239 .
	gmode
 = 0644,

240 .
	g´oc_hªdËr
 = 
´oc_doštvec_mšmax
,

241 .
	g¡¿‹gy
 = 
sysùl_štvec
,

242 .
	gexŒa1
 = &
§ck_tim”_mš
,

243 .
	gexŒa2
 = &
§ck_tim”_max
,

246 .
	gùl_Çme
 = 
CTL_UNNUMBERED
,

247 .
	g´oúame
 = "sctp_mem",

248 .
	gd©a
 = &
sysùl_sùp_mem
,

249 .
	gmaxËn
 = (
sysùl_sùp_mem
),

250 .
	gmode
 = 0644,

251 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

254 .
	gùl_Çme
 = 
CTL_UNNUMBERED
,

255 .
	g´oúame
 = "sctp_rmem",

256 .
	gd©a
 = &
sysùl_sùp_rmem
,

257 .
	gmaxËn
 = (
sysùl_sùp_rmem
),

258 .
	gmode
 = 0644,

259 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

262 .
	gùl_Çme
 = 
CTL_UNNUMBERED
,

263 .
	g´oúame
 = "sctp_wmem",

264 .
	gd©a
 = &
sysùl_sùp_wmem
,

265 .
	gmaxËn
 = (
sysùl_sùp_wmem
),

266 .
	gmode
 = 0644,

267 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

270 .
	gùl_Çme
 = 
CTL_UNNUMBERED
,

271 .
	g´oúame
 = "auth_enable",

272 .
	gd©a
 = &
sùp_auth_’abË
,

273 .
	gmaxËn
 = (),

274 .
	gmode
 = 0644,

275 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

276 .
	g¡¿‹gy
 = 
sysùl_štvec


279 .
	gùl_Çme
 = 
CTL_UNNUMBERED
,

280 .
	g´oúame
 = "addip_noauth_enable",

281 .
	gd©a
 = &
sùp_add_nßuth
,

282 .
	gmaxËn
 = (),

283 .
	gmode
 = 0644,

284 .
	g´oc_hªdËr
 = 
´oc_doštvec
,

285 .
	g¡¿‹gy
 = 
sysùl_štvec


288 .
	gùl_Çme
 = 
CTL_UNNUMBERED
,

289 .
	g´oúame
 = "addr_scope_policy",

290 .
	gd©a
 = &
sùp_scİe_pŞicy
,

291 .
	gmaxËn
 = (),

292 .
	gmode
 = 0644,

293 .
	g´oc_hªdËr
 = &
´oc_doštvec_mšmax
,

294 .
	g¡¿‹gy
 = &
sysùl_štvec
,

295 .
	gexŒa1
 = &
z”o
,

296 .
	gexŒa2
 = &
addr_scİe_max
,

299 .
	gùl_Çme
 = 
CTL_UNNUMBERED
,

300 .
	g´oúame
 = "rwnd_update_shift",

301 .
	gd©a
 = &
sùp_rwnd_upd_shiá
,

302 .
	gmaxËn
 = (),

303 .
	gmode
 = 0644,

304 .
	g´oc_hªdËr
 = &
´oc_doštvec_mšmax
,

305 .
	g¡¿‹gy
 = &
sysùl_štvec
,

306 .
	gexŒa1
 = &
Úe
,

307 .
	gexŒa2
 = &
rwnd_sÿË_max
,

310 { .
	gùl_Çme
 = 0 }

313 
ùl_·th
 
	gsùp_·th
[] = {

314 { .
´oúame
 = "Ãt", .
	gùl_Çme
 = 
CTL_NET
, },

315 { .
	g´oúame
 = "sùp", .
	gùl_Çme
 = 
NET_SCTP
, },

319 
ùl_bË_h—d”
 * 
	gsùp_sysùl_h—d”
;

322 
	$sùp_sysùl_»gi¡”
()

324 
sùp_sysùl_h—d”
 = 
	`»gi¡”_sysùl_·ths
(
sùp_·th
, 
sùp_bË
);

325 
	}
}

328 
	$sùp_sysùl_uÄegi¡”
()

330 
	`uÄegi¡”_sysùl_bË
(
sùp_sysùl_h—d”
);

331 
	}
}

	@transport.c

51 
	~<lšux/ty³s.h
>

52 
	~<lšux/¿ndom.h
>

53 
	~<Ãt/sùp/sùp.h
>

54 
	~<Ãt/sùp/sm.h
>

59 
sùp_Œª¥Üt
 *
	$sùp_Œª¥Üt_š™
(
sùp_Œª¥Üt
 *
³”
,

60 cÚ¡ 
sùp_addr
 *
addr
,

61 
gå_t
 
gå
)

64 
³”
->
addr
 = *
addr
;

65 
³”
->
af_¥ecific
 = 
	`sùp_g‘_af_¥ecific
(
addr
->
§
.
§_çmy
);

66 
	`mem£t
(&
³”
->
§ddr
, 0, (
sùp_addr
));

68 
³”
->
§ck_g’”©iÚ
 = 0;

76 
³”
->
¹o
 = 
	`m£cs_to_jiff›s
(
sùp_¹o_š™Ÿl
);

78 
³”
->
Ï¡_time_h—rd
.
tv64
 = 
jiff›s
;

79 
³”
->
Ï¡_time_eúe_»duûd
 = 
jiff›s
;

81 
³”
->
·¿m_æags
 = 
SPP_HB_DISABLE
 |

82 
SPP_PMTUD_ENABLE
 |

83 
SPP_SACKDELAY_ENABLE
;

86 
³”
->
·thmaxrxt
 = 
sùp_max_»Œªs_·th
;

87 
³”
->
pf_»Œªs
 = 
sùp_pf_»Œªs
;

89 
	`INIT_LIST_HEAD
(&
³”
->
Œªsm™‹d
);

90 
	`INIT_LIST_HEAD
(&
³”
->
£nd_»ady
);

91 
	`INIT_LIST_HEAD
(&
³”
->
Œª¥Üts
);

93 
	`£tup_tim”
(&
³”
->
T3_¹x_tim”
, 
sùp_g’”©e_t3_¹x_ev’t
,

94 ()
³”
);

95 
	`£tup_tim”
(&
³”
->
hb_tim”
, 
sùp_g’”©e_h—¹b—t_ev’t
,

96 ()
³”
);

97 
	`£tup_tim”
(&
³”
->
´Ùo_uÄ—ch_tim”
,

98 
sùp_g’”©e_´Ùo_uÄ—ch_ev’t
, ()
³”
);

100 
	`š™_tim”
(&
³”
->
´Ùo_uÄ—ch_tim”
);

101 
³”
->
´Ùo_uÄ—ch_tim”
.
funùiÚ
 = 
sùp_g’”©e_´Ùo_uÄ—ch_ev’t
;

102 
³”
->
´Ùo_uÄ—ch_tim”
.
d©a
 = ()peer;

105 
	`g‘_¿ndom_by‹s
(&
³”
->
hb_nÚû
, (peer->hb_nonce));

107 
	`©omic_£t
(&
³”
->
»fút
, 1);

109  
³”
;

110 
	}
}

113 
sùp_Œª¥Üt
 *
	$sùp_Œª¥Üt_Ãw
(cÚ¡ 
sùp_addr
 *
addr
,

114 
gå_t
 
gå
)

116 
sùp_Œª¥Üt
 *
Œª¥Üt
;

118 
Œª¥Üt
 = 
	`t_Ãw
(
sùp_Œª¥Üt
, 
gå
);

119 ià(!
Œª¥Üt
)

120 
ç
;

122 ià(!
	`sùp_Œª¥Üt_š™
(
Œª¥Üt
, 
addr
, 
gå
))

123 
ç_š™
;

125 
Œª¥Üt
->
m®loûd
 = 1;

126 
	`SCTP_DBG_OBJCNT_INC
(
Œª¥Üt
);

128  
Œª¥Üt
;

130 
ç_š™
:

131 
	`kä“
(
Œª¥Üt
);

133 
ç
:

134  
NULL
;

135 
	}
}

140 
	$sùp_Œª¥Üt_ä“
(
sùp_Œª¥Üt
 *
Œª¥Üt
)

142 
Œª¥Üt
->
d—d
 = 1;

145 ià(
	`d–_tim”
(&
Œª¥Üt
->
hb_tim”
))

146 
	`sùp_Œª¥Üt_put
(
Œª¥Üt
);

153 ià(
	`tim”_³ndšg
(&
Œª¥Üt
->
T3_¹x_tim”
) &&

154 
	`d–_tim”
(&
Œª¥Üt
->
T3_¹x_tim”
))

155 
	`sùp_Œª¥Üt_put
(
Œª¥Üt
);

158 ià(
	`tim”_³ndšg
(&
Œª¥Üt
->
´Ùo_uÄ—ch_tim”
) &&

159 
	`d–_tim”
(&
Œª¥Üt
->
´Ùo_uÄ—ch_tim”
))

160 
	`sùp_assocŸtiÚ_put
(
Œª¥Üt
->
asoc
);

162 
	`sùp_Œª¥Üt_put
(
Œª¥Üt
);

163 
	}
}

165 
	$sùp_Œª¥Üt_de¡roy_rcu
(
rcu_h—d
 *
h—d
)

167 
sùp_Œª¥Üt
 *
Œª¥Üt
;

169 
Œª¥Üt
 = 
	`cÚš”_of
(
h—d
, 
sùp_Œª¥Üt
, 
rcu
);

170 ià(
Œª¥Üt
->
asoc
)

171 
	`sùp_assocŸtiÚ_put
(
Œª¥Üt
->
asoc
);

173 
	`sùp_·ck‘_ä“
(&
Œª¥Üt
->
·ck‘
);

175 
	`d¡_»Ëa£
(
Œª¥Üt
->
d¡
);

176 
	`kä“
(
Œª¥Üt
);

177 
	`SCTP_DBG_OBJCNT_DEC
(
Œª¥Üt
);

178 
	}
}

183 
	$sùp_Œª¥Üt_de¡roy
(
sùp_Œª¥Üt
 *
Œª¥Üt
)

185 
	`SCTP_ASSERT
(
Œª¥Üt
->
d—d
, "Transport is‚ot dead", );

187 
	`ÿÎ_rcu
(&
Œª¥Üt
->
rcu
, 
sùp_Œª¥Üt_de¡roy_rcu
);

188 
	}
}

193 
	$sùp_Œª¥Üt_»£t_tim”s
(
sùp_Œª¥Üt
 *
Œª¥Üt
)

203 ià(!
	`tim”_³ndšg
(&
Œª¥Üt
->
T3_¹x_tim”
))

204 ià(!
	`mod_tim”
(&
Œª¥Üt
->
T3_¹x_tim”
,

205 
jiff›s
 + 
Œª¥Üt
->
¹o
))

206 
	`sùp_Œª¥Üt_hŞd
(
Œª¥Üt
);

209 ià(!
	`mod_tim”
(&
Œª¥Üt
->
hb_tim”
,

210 
	`sùp_Œª¥Üt_timeout
(
Œª¥Üt
)))

211 
	`sùp_Œª¥Üt_hŞd
(
Œª¥Üt
);

212 
	}
}

218 
	$sùp_Œª¥Üt_£t_owÃr
(
sùp_Œª¥Üt
 *
Œª¥Üt
,

219 
sùp_assocŸtiÚ
 *
asoc
)

221 
Œª¥Üt
->
asoc
 =‡soc;

222 
	`sùp_assocŸtiÚ_hŞd
(
asoc
);

223 
	}
}

226 
	$sùp_Œª¥Üt_pmtu
(
sùp_Œª¥Üt
 *
Œª¥Üt
, 
sock
 *
sk
)

228 
d¡_’Œy
 *
d¡
;

229 
æowi
 
æ
;

231 
d¡
 = 
Œª¥Üt
->
af_¥ecific
->
	`g‘_d¡
Ñ¿n¥Üt->
asoc
,

232 &
Œª¥Üt
->
addr
,

233 &
Œª¥Üt
->
§ddr
,

234 &
æ
, 
sk
);

236 ià(
d¡
) {

237 
Œª¥Üt
->
·thmtu
 = 
	`d¡_mtu
(
d¡
);

238 
	`d¡_»Ëa£
(
d¡
);

240 
Œª¥Üt
->
·thmtu
 = 
SCTP_DEFAULT_MAXSEGMENT
;

241 
	}
}

247 
d¡_’Œy
 *
	$sùp_Œª¥Üt_d¡_check
(
sùp_Œª¥Üt
 *
t
)

249 
d¡_’Œy
 *
d¡
 = 
t
->dst;

251 ià(
d¡
 && d¡->
obsŞ‘e
 && d¡->
İs
->
	`check
(d¡, 0è=ğ
NULL
) {

252 
	`d¡_»Ëa£
(
t
->
d¡
);

253 
t
->
d¡
 = 
NULL
;

254  
NULL
;

257  
d¡
;

258 
	}
}

260 
	$sùp_Œª¥Üt_upd©e_pmtu
(
sùp_Œª¥Üt
 *
t
, 
u32
 
pmtu
)

262 
d¡_’Œy
 *
d¡
;

264 ià(
	`uÆik–y
(
pmtu
 < 
SCTP_DEFAULT_MINSEGMENT
)) {

265 
	`´štk
(
KERN_WARNING
 "%s: Reported…mtu %doo†ow, "

267 
__func__
, 
pmtu
,

268 
SCTP_DEFAULT_MINSEGMENT
);

272 
t
->
·thmtu
 = 
SCTP_DEFAULT_MINSEGMENT
;

274 
t
->
·thmtu
 = 
pmtu
;

277 
d¡
 = 
	`sùp_Œª¥Üt_d¡_check
(
t
);

278 ià(
d¡
)

279 
d¡
->
İs
->
	`upd©e_pmtu
(d¡, 
pmtu
);

280 
	}
}

285 
	$sùp_Œª¥Üt_rou‹
(
sùp_Œª¥Üt
 *
Œª¥Üt
,

286 
sùp_addr
 *
§ddr
, 
sùp_sock
 *
İt
)

288 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

289 
sùp_af
 *
af
 = 
Œª¥Üt
->
af_¥ecific
;

290 
sùp_addr
 *
daddr
 = &
Œª¥Üt
->
addr
;

291 
d¡_’Œy
 *
d¡
;

292 
æowi
 
æ
;

294 
d¡
 = 
af
->
	`g‘_d¡
(
asoc
, 
daddr
, 
§ddr
, &
æ
, 
	`sùp_İt2sk
(
İt
));

295 
Œª¥Üt
->
d¡
 = dst;

297 ià(
§ddr
)

298 
	`memıy
(&
Œª¥Üt
->
§ddr
, saddr, (
sùp_addr
));

300 
af
->
	`g‘_§ddr
(
İt
, 
Œª¥Üt
, 
daddr
, &
æ
);

302 ià((
Œª¥Üt
->
·¿m_æags
 & 
SPP_PMTUD_DISABLE
è&&¿n¥Üt->
·thmtu
) {

305 ià(
d¡
) {

306 
Œª¥Üt
->
·thmtu
 = 
	`d¡_mtu
(
d¡
);

311 ià(
asoc
 && (!asoc->
³”
.
´im¬y_·th
 ||

312 (
Œª¥Üt
 =ğ
asoc
->
³”
.
aùive_·th
)))

313 
İt
->
pf
->
af
->
	`to_sk_§ddr
(&
Œª¥Üt
->
§ddr
,

314 
asoc
->
ba£
.
sk
);

316 
Œª¥Üt
->
·thmtu
 = 
SCTP_DEFAULT_MAXSEGMENT
;

317 
	}
}

320 
	$sùp_Œª¥Üt_hŞd
(
sùp_Œª¥Üt
 *
Œª¥Üt
)

322 
	`©omic_šc
(&
Œª¥Üt
->
»fút
);

323 
	}
}

328 
	$sùp_Œª¥Üt_put
(
sùp_Œª¥Üt
 *
Œª¥Üt
)

330 ià(
	`©omic_dec_ªd_‹¡
(&
Œª¥Üt
->
»fút
))

331 
	`sùp_Œª¥Üt_de¡roy
(
Œª¥Üt
);

332 
	}
}

335 
	$sùp_Œª¥Üt_upd©e_¹o
(
sùp_Œª¥Üt
 *

, 
__u32
 
¹t
)

338 
	`SCTP_ASSERT
(

, "NULLransport", );

341 
	`SCTP_ASSERT
(

->
¹o_³ndšg
, "rto_pending‚ot set", );

343 ià(

->
¹tv¬
 ||p->
¤‰
) {

355 

->
¹tv¬
 =p->¹tv¬ - (->¹tv¬ >> 
sùp_¹o_b‘a
)

356 + ((
	`abs
(

->
¤‰
 - 
¹t
)è>> 
sùp_¹o_b‘a
);

357 

->
¤‰
 =p->¤‰ - (->¤‰ >> 
sùp_¹o_®pha
)

358 + (
¹t
 >> 
sùp_¹o_®pha
);

363 

->
¤‰
 = 
¹t
;

364 

->
¹tv¬
 = 
¹t
 >> 1;

370 ià(

->
¹tv¬
 == 0)

371 

->
¹tv¬
 = 
SCTP_CLOCK_GRANULARITY
;

374 

->
¹o
 =p->
¤‰
 + (->
¹tv¬
 << 2);

379 ià(

->
¹o
 <p->
asoc
->
¹o_mš
)

380 

->
¹o
 =p->
asoc
->
¹o_mš
;

385 ià(

->
¹o
 >p->
asoc
->
¹o_max
)

386 

->
¹o
 =p->
asoc
->
¹o_max
;

388 

->
¹t
 =„tt;

393 

->
¹o_³ndšg
 = 0;

395 
	`SCTP_DEBUG_PRINTK
("%s:ransport: %p,„tt: %d, srtt: %d "

396 "¹tv¬: %d,„to: %ld\n", 
__func__
,

397 

, 
¹t
,p->
¤‰
,p->
¹tv¬
,p->
¹o
);

398 
	}
}

403 
	$sùp_Œª¥Üt_¿i£_cwnd
(
sùp_Œª¥Üt
 *
Œª¥Üt
,

404 
__u32
 
§ck_ù¢
, __u32 
by‹s_acked
)

406 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

407 
__u32
 
cwnd
, 
s¡h»sh
, 
æight_size
, 
pba
, 
pmtu
;

409 
cwnd
 = 
Œª¥Üt
->cwnd;

410 
æight_size
 = 
Œª¥Üt
->flight_size;

413 ià(
asoc
->
ç¡_»cov”y
 &&

414 
	`TSN_Ée
(
asoc
->
ç¡_»cov”y_ex™
, 
§ck_ù¢
))

415 
asoc
->
ç¡_»cov”y
 = 0;

421 ià(
	`TSN_Ée
(
§ck_ù¢
, 
Œª¥Üt
->
asoc
->
ù¢_ack_pošt
) ||

422 (
æight_size
 < 
cwnd
))

425 
s¡h»sh
 = 
Œª¥Üt
->ssthresh;

426 
pba
 = 
Œª¥Üt
->
·¹Ÿl_by‹s_acked
;

427 
pmtu
 = 
Œª¥Üt
->
asoc
->
·thmtu
;

429 ià(
cwnd
 <ğ
s¡h»sh
) {

444 ià(
asoc
->
ç¡_»cov”y
)

447 ià(
by‹s_acked
 > 
pmtu
)

448 
cwnd
 +ğ
pmtu
;

450 
cwnd
 +ğ
by‹s_acked
;

451 
	`SCTP_DEBUG_PRINTK
("%s: SLOW START:ransport: %p, "

454 
__func__
,

455 
Œª¥Üt
, 
by‹s_acked
, 
cwnd
,

456 
s¡h»sh
, 
æight_size
, 
pba
);

472 
pba
 +ğ
by‹s_acked
;

473 ià(
pba
 >ğ
cwnd
) {

474 
cwnd
 +ğ
pmtu
;

475 
pba
 = ((
cwnd
 <…ba) ? (pba - cwnd) : 0);

477 
	`SCTP_DEBUG_PRINTK
("%s: CONGESTION AVOIDANCE: "

480 
__func__
,

481 
Œª¥Üt
, 
by‹s_acked
, 
cwnd
,

482 
s¡h»sh
, 
æight_size
, 
pba
);

485 
Œª¥Üt
->
cwnd
 = cwnd;

486 
Œª¥Üt
->
·¹Ÿl_by‹s_acked
 = 
pba
;

487 
	}
}

492 
	$sùp_Œª¥Üt_low”_cwnd
(
sùp_Œª¥Üt
 *
Œª¥Üt
,

493 
sùp_low”_cwnd_t
 
»asÚ
)

495 
sùp_assocŸtiÚ
 *
asoc
 = 
Œª¥Üt
->asoc;

497 
»asÚ
) {

498 
SCTP_LOWER_CWND_T3_RTX
:

506 
Œª¥Üt
->
s¡h»sh
 = 
	`max
Ñ¿n¥Üt->
cwnd
/2,

507 4*
asoc
->
·thmtu
);

508 
Œª¥Üt
->
cwnd
 = 
asoc
->
·thmtu
;

511 
asoc
->
ç¡_»cov”y
 = 0;

514 
SCTP_LOWER_CWND_FAST_RTX
:

527 ià(
asoc
->
ç¡_»cov”y
)

531 
asoc
->
ç¡_»cov”y
 = 1;

532 
asoc
->
ç¡_»cov”y_ex™
 =‡soc->
Ãxt_t¢
 - 1;

534 
Œª¥Üt
->
s¡h»sh
 = 
	`max
Ñ¿n¥Üt->
cwnd
/2,

535 4*
asoc
->
·thmtu
);

536 
Œª¥Üt
->
cwnd
 =¿n¥Üt->
s¡h»sh
;

539 
SCTP_LOWER_CWND_ECNE
:

552 ià(
	`time_aá”
(
jiff›s
, 
Œª¥Üt
->
Ï¡_time_eúe_»duûd
 +

553 
Œª¥Üt
->
¹t
)) {

554 
Œª¥Üt
->
s¡h»sh
 = 
	`max
Ñ¿n¥Üt->
cwnd
/2,

555 4*
asoc
->
·thmtu
);

556 
Œª¥Üt
->
cwnd
 =¿n¥Üt->
s¡h»sh
;

557 
Œª¥Üt
->
Ï¡_time_eúe_»duûd
 = 
jiff›s
;

561 
SCTP_LOWER_CWND_INACTIVE
:

570 
Œª¥Üt
->
cwnd
 = 
	`max
(transport->cwnd/2,

571 4*
asoc
->
·thmtu
);

575 
Œª¥Üt
->
·¹Ÿl_by‹s_acked
 = 0;

576 
	`SCTP_DEBUG_PRINTK
("%s:ransport: %p„eason: %d cwnd: "

577 "%d s¡h»sh: %d\n", 
__func__
,

578 
Œª¥Üt
, 
»asÚ
,

579 
Œª¥Üt
->
cwnd
,¿n¥Üt->
s¡h»sh
);

580 
	}
}

592 
	$sùp_Œª¥Üt_bur¡_lim™ed
(
sùp_Œª¥Üt
 *
t
)

594 
sùp_assocŸtiÚ
 *
asoc
 = 
t
->asoc;

595 
u32
 
Şd_cwnd
 = 
t
->
cwnd
;

596 
u32
 
max_bur¡_by‹s
;

598 ià(
t
->
bur¡_lim™ed
)

601 
max_bur¡_by‹s
 = 
t
->
æight_size
 + (
asoc
->
max_bur¡
 *‡soc->
·thmtu
);

602 ià(
max_bur¡_by‹s
 < 
Şd_cwnd
) {

603 
t
->
cwnd
 = 
max_bur¡_by‹s
;

604 
t
->
bur¡_lim™ed
 = 
Şd_cwnd
;

606 
	}
}

611 
	$sùp_Œª¥Üt_bur¡_»£t
(
sùp_Œª¥Üt
 *
t
)

613 ià(
t
->
bur¡_lim™ed
) {

614 
t
->
cwnd
 =->
bur¡_lim™ed
;

615 
t
->
bur¡_lim™ed
 = 0;

617 
	}
}

620 
	$sùp_Œª¥Üt_timeout
(
sùp_Œª¥Üt
 *
t
)

622 
timeout
;

623 
timeout
 = 
t
->
¹o
 + 
	`sùp_j™‹r
(t->rto);

624 ià((
t
->
¡©e
 !ğ
SCTP_UNCONFIRMED
) &&

625 (
t
->
¡©e
 !ğ
SCTP_PF
))

626 
timeout
 +ğ
t
->
hbš‹rv®
;

627 
timeout
 +ğ
jiff›s
;

628  
timeout
;

629 
	}
}

632 
	$sùp_Œª¥Üt_»£t
(
sùp_Œª¥Üt
 *
t
)

634 
sùp_assocŸtiÚ
 *
asoc
 = 
t
->asoc;

641 
t
->
cwnd
 = 
	`mš
(4*
asoc
->
·thmtu
, 
	`max_t
(
__u32
, 2*asoc->pathmtu, 4380));

642 
t
->
bur¡_lim™ed
 = 0;

643 
t
->
s¡h»sh
 = 
asoc
->
³”
.
i
.
a_rwnd
;

644 
t
->
¹o
 = 
asoc
->
¹o_š™Ÿl
;

645 
t
->
¹t
 = 0;

646 
t
->
¤‰
 = 0;

647 
t
->
¹tv¬
 = 0;

652 
t
->
·¹Ÿl_by‹s_acked
 = 0;

653 
t
->
æight_size
 = 0;

654 
t
->
”rÜ_couÁ
 = 0;

655 
t
->
¹o_³ndšg
 = 0;

656 
t
->
hb_£Á
 = 0;

659 
t
->
ÿcc
.
chªgeov”_aùive
 = 0;

660 
t
->
ÿcc
.
cyşšg_chªgeov”
 = 0;

661 
t
->
ÿcc
.
Ãxt_t¢_©_chªge
 = 0;

662 
t
->
ÿcc
.
ÿcc_§w_Ãwack
 = 0;

663 
	}
}

	@tsnmap.c

45 
	~<lšux/ty³s.h
>

46 
	~<lšux/b™m­.h
>

47 
	~<Ãt/sùp/sùp.h
>

48 
	~<Ãt/sùp/sm.h
>

50 
sùp_t¢m­_upd©e
(
sùp_t¢m­
 *
m­
);

51 
sùp_t¢m­_fšd_g­_ack
(*
m­
, 
__u16
 
off
,

52 
__u16
 
Ën
, __u16 *
¡¬t
, __u16 *
’d
);

53 
sùp_t¢m­_grow
(
sùp_t¢m­
 *
m­
, 
u16
 
g­
);

56 
sùp_t¢m­
 *
	$sùp_t¢m­_š™
(
sùp_t¢m­
 *
m­
, 
__u16
 
Ën
,

57 
__u32
 
š™Ÿl_t¢
, 
gå_t
 
gå
)

59 ià(!
m­
->
t¢_m­
) {

60 
m­
->
t¢_m­
 = 
	`kz®loc
(
Ën
>>3, 
gå
);

61 ià(
m­
->
t¢_m­
 =ğ
NULL
)

62  
NULL
;

64 
m­
->
Ën
 =†en;

66 
	`b™m­_z”o
(
m­
->
t¢_m­
, m­->
Ën
);

70 
m­
->
ba£_t¢
 = 
š™Ÿl_t¢
;

71 
m­
->
cumuÏtive_t¢_ack_pošt
 = 
š™Ÿl_t¢
 - 1;

72 
m­
->
max_t¢_£’
 = m­->
cumuÏtive_t¢_ack_pošt
;

73 
m­
->
num_dup_t¢s
 = 0;

75  
m­
;

76 
	}
}

78 
	$sùp_t¢m­_ä“
(
sùp_t¢m­
 *
m­
)

80 
m­
->
Ën
 = 0;

81 
	`kä“
(
m­
->
t¢_m­
);

82 
	}
}

90 
	$sùp_t¢m­_check
(cÚ¡ 
sùp_t¢m­
 *
m­
, 
__u32
 
t¢
)

92 
u32
 
g­
;

95 ià(
	`TSN_Ée
(
t¢
, 
m­
->
cumuÏtive_t¢_ack_pošt
))

101 ià(!
	`TSN_É
(
t¢
, 
m­
->
ba£_t¢
 + 
SCTP_TSN_MAP_SIZE
))

105 
g­
 = 
t¢
 - 
m­
->
ba£_t¢
;

108 ià(
g­
 < 
m­
->
Ën
 && 
	`‹¡_b™
(g­, m­->
t¢_m­
))

112 
	}
}

116 
	$sùp_t¢m­_m¬k
(
sùp_t¢m­
 *
m­
, 
__u32
 
t¢
,

117 
sùp_Œª¥Üt
 *
Œªs
)

119 
u16
 
g­
;

121 ià(
	`TSN_É
(
t¢
, 
m­
->
ba£_t¢
))

124 
g­
 = 
t¢
 - 
m­
->
ba£_t¢
;

126 ià(
g­
 >ğ
m­
->
Ën
 && !
	`sùp_t¢m­_grow
(map, gap))

127  -
ENOMEM
;

129 ià(!
	`sùp_t¢m­_has_g­
(
m­
è&& 
g­
 == 0) {

134 
m­
->
max_t¢_£’
++;

135 
m­
->
cumuÏtive_t¢_ack_pošt
++;

136 ià(
Œªs
)

137 
Œªs
->
§ck_g’”©iÚ
 =

138 
Œªs
->
asoc
->
³”
.
§ck_g’”©iÚ
;

139 
m­
->
ba£_t¢
++;

146 ià(
	`TSN_É
(
m­
->
max_t¢_£’
, 
t¢
))

147 
m­
->
max_t¢_£’
 = 
t¢
;

150 
	`£t_b™
(
g­
, 
m­
->
t¢_m­
);

155 
	`sùp_t¢m­_upd©e
(
m­
);

159 
	}
}

163 
SCTP_STATIC
 
	$sùp_t¢m­_™”_š™
(cÚ¡ 
sùp_t¢m­
 *
m­
,

164 
sùp_t¢m­_™”
 *
™”
)

167 
™”
->
¡¬t
 = 
m­
->
cumuÏtive_t¢_ack_pošt
 + 1;

168 
	}
}

173 
SCTP_STATIC
 
	$sùp_t¢m­_Ãxt_g­_ack
(cÚ¡ 
sùp_t¢m­
 *
m­
,

174 
sùp_t¢m­_™”
 *
™”
,

175 
__u16
 *
¡¬t
, __u16 *
’d
)

177 
’ded
 = 0;

178 
__u16
 
¡¬t_
 = 0, 
’d_
 = 0, 
off£t
;

181 ià(
	`TSN_Ée
(
m­
->
max_t¢_£’
, 
™”
->
¡¬t
))

184 
off£t
 = 
™”
->
¡¬t
 - 
m­
->
ba£_t¢
;

185 
	`sùp_t¢m­_fšd_g­_ack
(
m­
->
t¢_m­
, 
off£t
, m­->
Ën
,

186 &
¡¬t_
, &
’d_
);

189 ià(
¡¬t_
 && !
’d_
)

190 
’d_
 = 
m­
->
Ën
 - 1;

195 ià(
’d_
) {

199 *
¡¬t
 = 
¡¬t_
 + 1;

200 *
’d
 = 
’d_
 + 1;

203 
™”
->
¡¬t
 = 
m­
->
cumuÏtive_t¢_ack_pošt
 + *
’d
 + 1;

204 
’ded
 = 1;

207  
’ded
;

208 
	}
}

211 
	$sùp_t¢m­_sk
(
sùp_t¢m­
 *
m­
, 
__u32
 
t¢
)

213 
u32
 
g­
;

215 ià(
	`TSN_É
(
t¢
, 
m­
->
ba£_t¢
))

217 ià(!
	`TSN_É
(
t¢
, 
m­
->
ba£_t¢
 + 
SCTP_TSN_MAP_SIZE
))

221 ià(
	`TSN_É
(
m­
->
max_t¢_£’
, 
t¢
))

222 
m­
->
max_t¢_£’
 = 
t¢
;

224 
g­
 = 
t¢
 - 
m­
->
ba£_t¢
 + 1;

226 
m­
->
ba£_t¢
 +ğ
g­
;

227 
m­
->
cumuÏtive_t¢_ack_pošt
 +ğ
g­
;

228 ià(
g­
 >ğ
m­
->
Ën
) {

232 
	`b™m­_z”o
(
m­
->
t¢_m­
, m­->
Ën
);

237 
	`b™m­_shiá_right
(
m­
->
t¢_m­
, m­->t¢_m­, 
g­
, m­->
Ën
);

238 
	`sùp_t¢m­_upd©e
(
m­
);

240 
	}
}

249 
	$sùp_t¢m­_upd©e
(
sùp_t¢m­
 *
m­
)

251 
u16
 
Ën
;

252 
z”o_b™
;

255 
Ën
 = 
m­
->
max_t¢_£’
 - m­->
cumuÏtive_t¢_ack_pošt
;

256 
z”o_b™
 = 
	`fšd_fœ¡_z”o_b™
(
m­
->
t¢_m­
, 
Ën
);

257 ià(!
z”o_b™
)

260 
m­
->
ba£_t¢
 +ğ
z”o_b™
;

261 
m­
->
cumuÏtive_t¢_ack_pošt
 +ğ
z”o_b™
;

263 
	`b™m­_shiá_right
(
m­
->
t¢_m­
, m­->t¢_m­, 
z”o_b™
, m­->
Ën
);

264 
	}
}

268 
__u16
 
	$sùp_t¢m­_³ndšg
(
sùp_t¢m­
 *
m­
)

270 
__u32
 
cum_t¢
 = 
m­
->
cumuÏtive_t¢_ack_pošt
;

271 
__u32
 
max_t¢
 = 
m­
->
max_t¢_£’
;

272 
__u32
 
ba£_t¢
 = 
m­
->base_tsn;

273 
__u16
 
³ndšg_d©a
;

274 
u32
 
g­
, 
i
;

276 
³ndšg_d©a
 = 
max_t¢
 - 
cum_t¢
;

277 
g­
 = 
max_t¢
 - 
ba£_t¢
;

279 ià(
g­
 =ğ0 || g­ >ğ
m­
->
Ën
)

280 
out
;

282 
i
 = 0; i < 
g­
+1; i++) {

283 ià(
	`‹¡_b™
(
i
, 
m­
->
t¢_m­
))

284 
³ndšg_d©a
--;

287 
out
:

288  
³ndšg_d©a
;

289 
	}
}

297 
	$sùp_t¢m­_fšd_g­_ack
(*
m­
, 
__u16
 
off
,

298 
__u16
 
Ën
, __u16 *
¡¬t
, __u16 *
’d
)

300 
i
 = 
off
;

309 
i
 = 
	`fšd_Ãxt_b™
(
m­
, 
Ën
, 
off
);

310 ià(
i
 < 
Ën
)

311 *
¡¬t
 = 
i
;

314 ià(*
¡¬t
) {

318 
i
 = 
	`fšd_Ãxt_z”o_b™
(
m­
, 
Ën
, i);

319 ià(
i
 < 
Ën
)

320 *
’d
 = 
i
 - 1;

322 
	}
}

325 
	$sùp_t¢m­_»Ãge
(
sùp_t¢m­
 *
m­
, 
__u32
 
t¢
)

327 
u32
 
g­
;

329 ià(
	`TSN_É
(
t¢
, 
m­
->
ba£_t¢
))

332 ià(!
	`TSN_É
(
t¢
, 
m­
->
ba£_t¢
 + m­->
Ën
))

335 
g­
 = 
t¢
 - 
m­
->
ba£_t¢
;

338 
	`ş—r_b™
(
g­
, 
m­
->
t¢_m­
);

339 
	}
}

342 
__u16
 
	$sùp_t¢m­_num_gabs
(
sùp_t¢m­
 *
m­
,

343 
sùp_g­_ack_block
 *
gabs
)

345 
sùp_t¢m­_™”
 
™”
;

346 
ng­s
 = 0;

349 ià(
	`sùp_t¢m­_has_g­
(
m­
)) {

350 
__u16
 
¡¬t
 = 0, 
’d
 = 0;

351 
	`sùp_t¢m­_™”_š™
(
m­
, &
™”
);

352 
	`sùp_t¢m­_Ãxt_g­_ack
(
m­
, &
™”
,

353 &
¡¬t
,

354 &
’d
)) {

356 
gabs
[
ng­s
].
¡¬t
 = 
	`htÚs
(start);

357 
gabs
[
ng­s
].
’d
 = 
	`htÚs
(end);

358 
ng­s
++;

359 ià(
ng­s
 >ğ
SCTP_MAX_GABS
)

363  
ng­s
;

364 
	}
}

366 
	$sùp_t¢m­_grow
(
sùp_t¢m­
 *
m­
, 
u16
 
g­
)

368 *
Ãw
;

369 
šc
;

370 
u16
 
Ën
;

372 ià(
g­
 >ğ
SCTP_TSN_MAP_SIZE
)

375 
šc
 = 
	`ALIGN
((
g­
 - 
m­
->
Ën
),
BITS_PER_LONG
è+ 
SCTP_TSN_MAP_INCREMENT
;

376 
Ën
 = 
	`mš_t
(
u16
, 
m­
->ËÀ+ 
šc
, 
SCTP_TSN_MAP_SIZE
);

378 
Ãw
 = 
	`kz®loc
(
Ën
>>3, 
GFP_ATOMIC
);

379 ià(!
Ãw
)

382 
	`b™m­_cİy
(
Ãw
, 
m­
->
t¢_m­
, m­->
max_t¢_£’
 - m­->
ba£_t¢
);

383 
	`kä“
(
m­
->
t¢_m­
);

384 
m­
->
t¢_m­
 = 
Ãw
;

385 
m­
->
Ën
 =†en;

388 
	}
}

	@tsnmap.h

45 
	~<Ãt/sùp/cÚ¡ªts.h
>

47 #iâdeà
__sùp_t¢m­_h__


48 
	#__sùp_t¢m­_h__


	)

58 
	ssùp_t¢m­
 {

63 *
	mt¢_m­
;

66 
__u32
 
	mba£_t¢
;

79 
__u32
 
	mcumuÏtive_t¢_ack_pošt
;

82 
__u32
 
	mmax_t¢_£’
;

88 
__u16
 
	mËn
;

91 
__u16
 
	m³ndšg_d©a
;

97 
__u16
 
	mnum_dup_t¢s
;

98 
__be32
 
	mdup_t¢s
[
SCTP_MAX_DUP_TSNS
];

101 
	ssùp_t¢m­_™”
 {

102 
__u32
 
	m¡¬t
;

106 
sùp_t¢m­
 *
sùp_t¢m­_š™
(sùp_t¢m­ *, 
__u16
 
Ën
,

107 
__u32
 
š™Ÿl_t¢
, 
gå_t
 
gå
);

109 
sùp_t¢m­_ä“
(
sùp_t¢m­
 *
m­
);

117 
sùp_t¢m­_check
(cÚ¡ 
sùp_t¢m­
 *, 
__u32
 
t¢
);

120 
sùp_t¢m­_m¬k
(
sùp_t¢m­
 *, 
__u32
 
t¢
,

121 
sùp_Œª¥Üt
 *
Œªs
);

124 
sùp_t¢m­_sk
(
sùp_t¢m­
 *
m­
, 
__u32
 
t¢
);

127 
šlše
 
__u32
 
	$sùp_t¢m­_g‘_ù¢
(cÚ¡ 
sùp_t¢m­
 *
m­
)

129  
m­
->
cumuÏtive_t¢_ack_pošt
;

130 
	}
}

133 
šlše
 
__u32
 
	$sùp_t¢m­_g‘_max_t¢_£’
(cÚ¡ 
sùp_t¢m­
 *
m­
)

135  
m­
->
max_t¢_£’
;

136 
	}
}

139 
šlše
 
__u16
 
	$sùp_t¢m­_num_dups
(
sùp_t¢m­
 *
m­
)

141  
m­
->
num_dup_t¢s
;

142 
	}
}

145 
šlše
 
__be32
 *
	$sùp_t¢m­_g‘_dups
(
sùp_t¢m­
 *
m­
)

147 
m­
->
num_dup_t¢s
 = 0;

148  
m­
->
dup_t¢s
;

149 
	}
}

152 
__u16
 
sùp_t¢m­_num_gabs
(
sùp_t¢m­
 *
m­
,

153 
sùp_g­_ack_block
 *
gabs
);

156 
__u16
 
sùp_t¢m­_³ndšg
(
sùp_t¢m­
 *
m­
);

159 
šlše
 
	$sùp_t¢m­_has_g­
(cÚ¡ 
sùp_t¢m­
 *
m­
)

161  
m­
->
cumuÏtive_t¢_ack_pošt
 !ğm­->
max_t¢_£’
;

162 
	}
}

167 
šlše
 
	$sùp_t¢m­_m¬k_dup
(
sùp_t¢m­
 *
m­
, 
__u32
 
t¢
)

169 ià(
m­
->
num_dup_t¢s
 < 
SCTP_MAX_DUP_TSNS
)

170 
m­
->
dup_t¢s
[m­->
num_dup_t¢s
++] = 
	`htÚl
(
t¢
);

171 
	}
}

174 
sùp_t¢m­_»Ãge
(
sùp_t¢m­
 *, 
__u32
 
t¢
);

177 
sùp_t¢m­_has_g­
(cÚ¡ 
sùp_t¢m­
 *);

	@ulpevent.c

46 
	~<lšux/ty³s.h
>

47 
	~<lšux/skbuff.h
>

48 
	~<Ãt/sùp/¡ruùs.h
>

49 
	~<Ãt/sùp/sùp.h
>

50 
	~<Ãt/sùp/sm.h
>

52 
sùp_uÍev’t_»ûive_d©a
(
sùp_uÍev’t
 *
ev’t
,

53 
sùp_assocŸtiÚ
 *
asoc
);

54 
sùp_uÍev’t_»Ëa£_d©a
(
sùp_uÍev’t
 *
ev’t
);

55 
sùp_uÍev’t_»Ëa£_äag_d©a
(
sùp_uÍev’t
 *
ev’t
);

59 
SCTP_STATIC
 
	$sùp_uÍev’t_š™
(
sùp_uÍev’t
 *
ev’t
,

60 
msg_æags
,

61 
Ën
)

63 
	`mem£t
(
ev’t
, 0, (
sùp_uÍev’t
));

64 
ev’t
->
msg_æags
 = msg_flags;

65 
ev’t
->
rmem_Ën
 = 
Ën
;

66 
	}
}

69 
SCTP_STATIC
 
sùp_uÍev’t
 *
	$sùp_uÍev’t_Ãw
(
size
, 
msg_æags
,

70 
gå_t
 
gå
)

72 
sùp_uÍev’t
 *
ev’t
;

73 
sk_buff
 *
skb
;

75 
skb
 = 
	`®loc_skb
(
size
, 
gå
);

76 ià(!
skb
)

77 
ç
;

79 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

80 
	`sùp_uÍev’t_š™
(
ev’t
, 
msg_æags
, 
skb
->
Œuesize
);

82  
ev’t
;

84 
ç
:

85  
NULL
;

86 
	}
}

89 
	$sùp_uÍev’t_is_nÙifiÿtiÚ
(cÚ¡ 
sùp_uÍev’t
 *
ev’t
)

91  
MSG_NOTIFICATION
 =ğ(
ev’t
->
msg_æags
 & MSG_NOTIFICATION);

92 
	}
}

97 
šlše
 
	$sùp_uÍev’t_£t_owÃr
(
sùp_uÍev’t
 *
ev’t
,

98 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
)

100 
sk_buff
 *
skb
;

105 
	`sùp_assocŸtiÚ_hŞd
((
sùp_assocŸtiÚ
 *)
asoc
);

106 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

107 
ev’t
->
asoc
 = (
sùp_assocŸtiÚ
 *)asoc;

108 
	`©omic_add
(
ev’t
->
rmem_Ën
, &ev’t->
asoc
->
rmem_®loc
);

109 
	`sùp_skb_£t_owÃr_r
(
skb
, 
asoc
->
ba£
.
sk
);

110 
	}
}

113 
šlše
 
	$sùp_uÍev’t_»Ëa£_owÃr
(
sùp_uÍev’t
 *
ev’t
)

115 
sùp_assocŸtiÚ
 *
asoc
 = 
ev’t
->asoc;

117 
	`©omic_sub
(
ev’t
->
rmem_Ën
, &
asoc
->
rmem_®loc
);

118 
	`sùp_assocŸtiÚ_put
(
asoc
);

119 
	}
}

132 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_assoc_chªge
(

133 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

134 
__u16
 
æags
, __u16 
¡©e
, __u16 
”rÜ
, __u16 
outbound
,

135 
__u16
 
šbound
, 
sùp_chunk
 *
chunk
, 
gå_t
 
gå
)

137 
sùp_uÍev’t
 *
ev’t
;

138 
sùp_assoc_chªge
 *
§c
;

139 
sk_buff
 *
skb
;

144 ià(
chunk
) {

148 
skb
 = 
	`skb_cİy_ex·nd
(
chunk
->skb,

149 (
sùp_assoc_chªge
), 0, 
gå
);

151 ià(!
skb
)

152 
ç
;

155 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

156 
	`sùp_uÍev’t_š™
(
ev’t
, 
MSG_NOTIFICATION
, 
skb
->
Œuesize
);

159 
§c
 = (
sùp_assoc_chªge
 *)

160 
	`skb_push
(
skb
, (
sùp_assoc_chªge
));

163 
	`skb_Œim
(
skb
, (
sùp_assoc_chªge
) +

164 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
) -

165 (
sùp_chunkhdr_t
));

167 
ev’t
 = 
	`sùp_uÍev’t_Ãw
((
sùp_assoc_chªge
),

168 
MSG_NOTIFICATION
, 
gå
);

169 ià(!
ev’t
)

170 
ç
;

172 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

173 
§c
 = (
sùp_assoc_chªge
 *è
	`skb_put
(
skb
,

174 (
sùp_assoc_chªge
));

183 
§c
->
§c_ty³
 = 
SCTP_ASSOC_CHANGE
;

192 
§c
->
§c_¡©e
 = 
¡©e
;

200 
§c
->
§c_æags
 = 0;

209 
§c
->
§c_Ëngth
 = 
skb
->
Ën
;

221 
§c
->
§c_”rÜ
 = 
”rÜ
;

232 
§c
->
§c_outbound_¡»ams
 = 
outbound
;

233 
§c
->
§c_šbound_¡»ams
 = 
šbound
;

244 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

245 
§c
->
§c_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

247  
ev’t
;

249 
ç
:

250  
NULL
;

251 
	}
}

261 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_³”_addr_chªge
(

262 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

263 cÚ¡ 
sockaddr_¡Üage
 *
¯ddr
,

264 
æags
, 
¡©e
, 
”rÜ
, 
gå_t
 
gå
)

266 
sùp_uÍev’t
 *
ev’t
;

267 
sùp_·ddr_chªge
 *
¥c
;

268 
sk_buff
 *
skb
;

270 
ev’t
 = 
	`sùp_uÍev’t_Ãw
((
sùp_·ddr_chªge
),

271 
MSG_NOTIFICATION
, 
gå
);

272 ià(!
ev’t
)

273 
ç
;

275 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

276 
¥c
 = (
sùp_·ddr_chªge
 *)

277 
	`skb_put
(
skb
, (
sùp_·ddr_chªge
));

286 
¥c
->
¥c_ty³
 = 
SCTP_PEER_ADDR_CHANGE
;

296 
¥c
->
¥c_Ëngth
 = (
sùp_·ddr_chªge
);

304 
¥c
->
¥c_æags
 = 0;

314 
¥c
->
¥c_¡©e
 = 
¡©e
;

325 
¥c
->
¥c_”rÜ
 = 
”rÜ
;

336 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

337 
¥c
->
¥c_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

347 
	`memıy
(&
¥c
->
¥c_¯ddr
, 
¯ddr
, (
sockaddr_¡Üage
));

350 
	`sùp_g‘_pf_¥ecific
(
asoc
->
ba£
.
sk
->
sk_çmy
)->
	`addr_v4m­
(

351 
	`sùp_sk
(
asoc
->
ba£
.
sk
),

352 (
sùp_addr
 *)&
¥c
->
¥c_¯ddr
);

354  
ev’t
;

356 
ç
:

357  
NULL
;

358 
	}
}

375 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_»mÙe_”rÜ
(

376 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
sùp_chunk
 *
chunk
,

377 
__u16
 
æags
, 
gå_t
 
gå
)

379 
sùp_uÍev’t
 *
ev’t
;

380 
sùp_»mÙe_”rÜ
 *
¤e
;

381 
sk_buff
 *
skb
;

382 
sùp_”rhdr_t
 *
ch
;

383 
__be16
 
ÿu£
;

384 
–’
;

386 
ch
 = (
sùp_”rhdr_t
 *)(
chunk
->
skb
->
d©a
);

387 
ÿu£
 = 
ch
->cause;

388 
–’
 = 
	`WORD_ROUND
(
	`Áohs
(
ch
->
Ëngth
)è- (
sùp_”rhdr_t
);

391 
	`skb_puÎ
(
chunk
->
skb
, (
sùp_”rhdr_t
));

396 
skb
 = 
	`skb_cİy_ex·nd
(
chunk
->skb, (
sùp_»mÙe_”rÜ
),

397 0, 
gå
);

400 
	`skb_puÎ
(
chunk
->
skb
, 
–’
);

401 ià(!
skb
)

402 
ç
;

405 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

406 
	`sùp_uÍev’t_š™
(
ev’t
, 
MSG_NOTIFICATION
, 
skb
->
Œuesize
);

408 
¤e
 = (
sùp_»mÙe_”rÜ
 *)

409 
	`skb_push
(
skb
, (
sùp_»mÙe_”rÜ
));

412 
	`skb_Œim
(
skb
, (
sùp_»mÙe_”rÜ
è+ 
–’
);

420 
¤e
->
¤e_ty³
 = 
SCTP_REMOTE_ERROR
;

429 
¤e
->
¤e_æags
 = 0;

439 
¤e
->
¤e_Ëngth
 = 
skb
->
Ën
;

448 
¤e
->
¤e_”rÜ
 = 
ÿu£
;

459 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

460 
¤e
->
¤e_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

462  
ev’t
;

464 
ç
:

465  
NULL
;

466 
	}
}

473 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_£nd_çed
(

474 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
sùp_chunk
 *
chunk
,

475 
__u16
 
æags
, 
__u32
 
”rÜ
, 
gå_t
 
gå
)

477 
sùp_uÍev’t
 *
ev’t
;

478 
sùp_£nd_çed
 *
ssf
;

479 
sk_buff
 *
skb
;

482 
Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

485 
skb
 = 
	`skb_cİy_ex·nd
(
chunk
->skb,

486 (
sùp_£nd_çed
),

488 
gå
);

489 ià(!
skb
)

490 
ç
;

493 
	`skb_puÎ
(
skb
, (
sùp_d©a_chunk
));

494 
Ën
 -ğ(
sùp_d©a_chunk
);

497 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

498 
	`sùp_uÍev’t_š™
(
ev’t
, 
MSG_NOTIFICATION
, 
skb
->
Œuesize
);

500 
ssf
 = (
sùp_£nd_çed
 *)

501 
	`skb_push
(
skb
, (
sùp_£nd_çed
));

509 
ssf
->
ssf_ty³
 = 
SCTP_SEND_FAILED
;

524 
ssf
->
ssf_æags
 = 
æags
;

533 
ssf
->
ssf_Ëngth
 = (
sùp_£nd_çed
è+ 
Ën
;

534 
	`skb_Œim
(
skb
, 
ssf
->
ssf_Ëngth
);

544 
ssf
->
ssf_”rÜ
 = 
”rÜ
;

553 
	`memıy
(&
ssf
->
ssf_šfo
, &
chunk
->
sšfo
, (
sùp_¢drcvšfo
));

558 
ssf
->
ssf_šfo
.
sšfo_æags
 = 
chunk
->
chunk_hdr
->
æags
;

569 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

570 
ssf
->
ssf_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

571  
ev’t
;

573 
ç
:

574  
NULL
;

575 
	}
}

582 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_shutdown_ev’t
(

583 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

584 
__u16
 
æags
, 
gå_t
 
gå
)

586 
sùp_uÍev’t
 *
ev’t
;

587 
sùp_shutdown_ev’t
 *
s£
;

588 
sk_buff
 *
skb
;

590 
ev’t
 = 
	`sùp_uÍev’t_Ãw
((
sùp_shutdown_ev’t
),

591 
MSG_NOTIFICATION
, 
gå
);

592 ià(!
ev’t
)

593 
ç
;

595 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

596 
s£
 = (
sùp_shutdown_ev’t
 *)

597 
	`skb_put
(
skb
, (
sùp_shutdown_ev’t
));

605 
s£
->
s£_ty³
 = 
SCTP_SHUTDOWN_EVENT
;

613 
s£
->
s£_æags
 = 0;

622 
s£
->
s£_Ëngth
 = (
sùp_shutdown_ev’t
);

632 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

633 
s£
->
s£_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

635  
ev’t
;

637 
ç
:

638  
NULL
;

639 
	}
}

646 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_ad­tiÚ_šdiÿtiÚ
(

647 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
gå_t
 
gå
)

649 
sùp_uÍev’t
 *
ev’t
;

650 
sùp_ad­tiÚ_ev’t
 *
§i
;

651 
sk_buff
 *
skb
;

653 
ev’t
 = 
	`sùp_uÍev’t_Ãw
((
sùp_ad­tiÚ_ev’t
),

654 
MSG_NOTIFICATION
, 
gå
);

655 ià(!
ev’t
)

656 
ç
;

658 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

659 
§i
 = (
sùp_ad­tiÚ_ev’t
 *)

660 
	`skb_put
(
skb
, (
sùp_ad­tiÚ_ev’t
));

662 
§i
->
§i_ty³
 = 
SCTP_ADAPTATION_INDICATION
;

663 
§i
->
§i_æags
 = 0;

664 
§i
->
§i_Ëngth
 = (
sùp_ad­tiÚ_ev’t
);

665 
§i
->
§i_ad­tiÚ_šd
 = 
asoc
->
³”
.
ad­tiÚ_šd
;

666 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

667 
§i
->
§i_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

669  
ev’t
;

671 
ç
:

672  
NULL
;

673 
	}
}

682 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_rcvmsg
(
sùp_assocŸtiÚ
 *
asoc
,

683 
sùp_chunk
 *
chunk
,

684 
gå_t
 
gå
)

686 
sùp_uÍev’t
 *
ev’t
 = 
NULL
;

687 
sk_buff
 *
skb
;

688 
size_t
 
·ddšg
, 
Ën
;

689 
rx_couÁ
;

696 ià(
asoc
->
•
->
rcvbuf_pŞicy
)

697 
rx_couÁ
 = 
	`©omic_»ad
(&
asoc
->
rmem_®loc
);

699 
rx_couÁ
 = 
	`©omic_»ad
(&
asoc
->
ba£
.
sk
->
sk_rmem_®loc
);

701 ià(
rx_couÁ
 >ğ
asoc
->
ba£
.
sk
->
sk_rcvbuf
) {

703 ià((
asoc
->
ba£
.
sk
->
sk_u£¾ocks
 & 
SOCK_RCVBUF_LOCK
) ||

704 (!
	`sk_rmem_scheduË
(
asoc
->
ba£
.
sk
, 
chunk
->
skb
->
Œuesize
)))

705 
ç
;

709 
skb
 = 
	`skb_şÚe
(
chunk
->skb, 
gå
);

710 ià(!
skb
)

711 
ç
;

716 ià(
	`sùp_t¢m­_m¬k
(&
asoc
->
³”
.
t¢_m­
,

717 
	`Áohl
(
chunk
->
subh
.
d©a_hdr
->
t¢
),

718 
chunk
->
Œª¥Üt
))

719 
ç_m¬k
;

733 
Ën
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

734 
·ddšg
 = 
	`WORD_ROUND
(
Ën
) -†en;

737 
	`skb_Œim
(
skb
, 
chunk
->
chunk_’d
 - 
·ddšg
 - skb->
d©a
);

740 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

746 
	`sùp_uÍev’t_š™
(
ev’t
, 0, 
skb
->
Ën
 + (
sk_buff
));

748 
	`sùp_uÍev’t_»ûive_d©a
(
ev’t
, 
asoc
);

750 
ev’t
->
¡»am
 = 
	`Áohs
(
chunk
->
subh
.
d©a_hdr
->stream);

751 
ev’t
->
s¢
 = 
	`Áohs
(
chunk
->
subh
.
d©a_hdr
->ssn);

752 
ev’t
->
µid
 = 
chunk
->
subh
.
d©a_hdr
->ppid;

753 ià(
chunk
->
chunk_hdr
->
æags
 & 
SCTP_DATA_UNORDERED
) {

754 
ev’t
->
æags
 |ğ
SCTP_UNORDERED
;

755 
ev’t
->
cumt¢
 = 
	`sùp_t¢m­_g‘_ù¢
(&
asoc
->
³”
.
t¢_m­
);

757 
ev’t
->
t¢
 = 
	`Áohl
(
chunk
->
subh
.
d©a_hdr
->tsn);

758 
ev’t
->
msg_æags
 |ğ
chunk
->
chunk_hdr
->
æags
;

759 
ev’t
->
iif
 = 
	`sùp_chunk_iif
(
chunk
);

761  
ev’t
;

763 
ç_m¬k
:

764 
	`kä“_skb
(
skb
);

765 
ç
:

766  
NULL
;

767 
	}
}

777 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_pd­i
(

778 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
__u32
 
šdiÿtiÚ
,

779 
gå_t
 
gå
)

781 
sùp_uÍev’t
 *
ev’t
;

782 
sùp_pd­i_ev’t
 *
pd
;

783 
sk_buff
 *
skb
;

785 
ev’t
 = 
	`sùp_uÍev’t_Ãw
((
sùp_pd­i_ev’t
),

786 
MSG_NOTIFICATION
, 
gå
);

787 ià(!
ev’t
)

788 
ç
;

790 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

791 
pd
 = (
sùp_pd­i_ev’t
 *)

792 
	`skb_put
(
skb
, (
sùp_pd­i_ev’t
));

800 
pd
->
pd­i_ty³
 = 
SCTP_PARTIAL_DELIVERY_EVENT
;

801 
pd
->
pd­i_æags
 = 0;

809 
pd
->
pd­i_Ëngth
 = (
sùp_pd­i_ev’t
);

815 
pd
->
pd­i_šdiÿtiÚ
 = 
šdiÿtiÚ
;

821 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

822 
pd
->
pd­i_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

824  
ev’t
;

825 
ç
:

826  
NULL
;

827 
	}
}

829 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_authkey
(

830 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
__u16
 
key_id
,

831 
__u32
 
šdiÿtiÚ
, 
gå_t
 
gå
)

833 
sùp_uÍev’t
 *
ev’t
;

834 
sùp_authkey_ev’t
 *
ak
;

835 
sk_buff
 *
skb
;

837 
ev’t
 = 
	`sùp_uÍev’t_Ãw
((
sùp_authkey_ev’t
),

838 
MSG_NOTIFICATION
, 
gå
);

839 ià(!
ev’t
)

840 
ç
;

842 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

843 
ak
 = (
sùp_authkey_ev’t
 *)

844 
	`skb_put
(
skb
, (
sùp_authkey_ev’t
));

846 
ak
->
auth_ty³
 = 
SCTP_AUTHENTICATION_INDICATION
;

847 
ak
->
auth_æags
 = 0;

848 
ak
->
auth_Ëngth
 = (
sùp_authkey_ev’t
);

850 
ak
->
auth_keynumb”
 = 
key_id
;

851 
ak
->
auth_®tkeynumb”
 = 0;

852 
ak
->
auth_šdiÿtiÚ
 = 
šdiÿtiÚ
;

857 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

858 
ak
->
auth_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

860  
ev’t
;

861 
ç
:

862  
NULL
;

863 
	}
}

869 
sùp_uÍev’t
 *
	$sùp_uÍev’t_make_£nd”_dry_ev’t
(

870 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
gå_t
 
gå
)

872 
sùp_uÍev’t
 *
ev’t
;

873 
sùp_£nd”_dry_ev’t
 *
sdry
;

874 
sk_buff
 *
skb
;

876 
ev’t
 = 
	`sùp_uÍev’t_Ãw
((
sùp_£nd”_dry_ev’t
),

877 
MSG_NOTIFICATION
, 
gå
);

878 ià(!
ev’t
)

879  
NULL
;

881 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

882 
sdry
 = (
sùp_£nd”_dry_ev’t
 *)

883 
	`skb_put
(
skb
, (
sùp_£nd”_dry_ev’t
));

885 
sdry
->
£nd”_dry_ty³
 = 
SCTP_SENDER_DRY_EVENT
;

886 
sdry
->
£nd”_dry_æags
 = 0;

887 
sdry
->
£nd”_dry_Ëngth
 = (
sùp_£nd”_dry_ev’t
);

888 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

889 
sdry
->
£nd”_dry_assoc_id
 = 
	`sùp_assoc2id
(
asoc
);

891  
ev’t
;

892 
	}
}

897 
__u16
 
	$sùp_uÍev’t_g‘_nÙifiÿtiÚ_ty³
(cÚ¡ 
sùp_uÍev’t
 *
ev’t
)

899 
sùp_nÙifiÿtiÚ
 *
nÙifiÿtiÚ
;

900 
sk_buff
 *
skb
;

902 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

903 
nÙifiÿtiÚ
 = (
sùp_nÙifiÿtiÚ
 *è
skb
->
d©a
;

904  
nÙifiÿtiÚ
->
¢_h—d”
.
¢_ty³
;

905 
	}
}

908 
	$sùp_uÍev’t_»ad_¢drcvšfo
(cÚ¡ 
sùp_uÍev’t
 *
ev’t
,

909 
msghdr
 *msghdr)

911 
sùp_¢drcvšfo
 
sšfo
;

913 ià(
	`sùp_uÍev’t_is_nÙifiÿtiÚ
(
ev’t
))

924 
sšfo
.
sšfo_¡»am
 = 
ev’t
->
¡»am
;

932 
sšfo
.
sšfo_s¢
 = 
ev’t
->
s¢
;

941 
sšfo
.
sšfo_µid
 = 
ev’t
->
µid
;

952 
sšfo
.
sšfo_æags
 = 
ev’t
->
æags
;

958 
sšfo
.
sšfo_t¢
 = 
ev’t
->
t¢
;

966 
sšfo
.
sšfo_cumt¢
 = 
ev’t
->
cumt¢
;

974 
sšfo
.
sšfo_assoc_id
 = 
	`sùp_assoc2id
(
ev’t
->
asoc
);

977 
sšfo
.
sšfo_cÚ‹xt
 = 
ev’t
->
asoc
->
deçuÉ_rcv_cÚ‹xt
;

980 
sšfo
.
sšfo_tim‘Şive
 = 0;

982 
	`put_cmsg
(
msghdr
, 
IPPROTO_SCTP
, 
SCTP_SNDRCV
,

983 (
sùp_¢drcvšfo
), (*)&
sšfo
);

984 
	}
}

989 
	$sùp_uÍev’t_»ûive_d©a
(
sùp_uÍev’t
 *
ev’t
,

990 
sùp_assocŸtiÚ
 *
asoc
)

992 
sk_buff
 *
skb
, *
äag
;

994 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

996 
	`sùp_uÍev’t_£t_owÃr
(
ev’t
, 
asoc
);

997 
	`sùp_assoc_rwnd_deü—£
(
asoc
, 
	`skb_h—dËn
(
skb
));

999 ià(!
skb
->
d©a_Ën
)

1008 
	`skb_w®k_äags
(
skb
, 
äag
)

1009 
	`sùp_uÍev’t_»ûive_d©a
(
	`sùp_skb2ev’t
(
äag
), 
asoc
);

1010 
	}
}

1015 
	$sùp_uÍev’t_»Ëa£_d©a
(
sùp_uÍev’t
 *
ev’t
)

1017 
sk_buff
 *
skb
, *
äag
;

1018 
Ën
;

1027 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

1028 
Ën
 = 
skb
->len;

1030 ià(!
skb
->
d©a_Ën
)

1031 
dÚe
;

1034 
	`skb_w®k_äags
(
skb
, 
äag
) {

1039 
	`sùp_uÍev’t_»Ëa£_äag_d©a
(
	`sùp_skb2ev’t
(
äag
));

1042 
dÚe
:

1043 
	`sùp_assoc_rwnd_šü—£
(
ev’t
->
asoc
, 
Ën
);

1044 
	`sùp_uÍev’t_»Ëa£_owÃr
(
ev’t
);

1045 
	}
}

1047 
	$sùp_uÍev’t_»Ëa£_äag_d©a
(
sùp_uÍev’t
 *
ev’t
)

1049 
sk_buff
 *
skb
, *
äag
;

1051 
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

1053 ià(!
skb
->
d©a_Ën
)

1054 
dÚe
;

1057 
	`skb_w®k_äags
(
skb
, 
äag
) {

1062 
	`sùp_uÍev’t_»Ëa£_äag_d©a
(
	`sùp_skb2ev’t
(
äag
));

1065 
dÚe
:

1066 
	`sùp_uÍev’t_»Ëa£_owÃr
(
ev’t
);

1067 
	}
}

1073 
	$sùp_uÍev’t_ä“
(
sùp_uÍev’t
 *
ev’t
)

1075 ià(
	`sùp_uÍev’t_is_nÙifiÿtiÚ
(
ev’t
))

1076 
	`sùp_uÍev’t_»Ëa£_owÃr
(
ev’t
);

1078 
	`sùp_uÍev’t_»Ëa£_d©a
(
ev’t
);

1080 
	`kä“_skb
(
	`sùp_ev’t2skb
(
ev’t
));

1081 
	}
}

1084 
	$sùp_queue_purge_uÍev’ts
(
sk_buff_h—d
 *
li¡
)

1086 
sk_buff
 *
skb
;

1087 
d©a_uÄ—d
 = 0;

1089 (
skb
 = 
	`skb_dequeue
(
li¡
)è!ğ
NULL
) {

1090 
sùp_uÍev’t
 *
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

1092 ià(!
	`sùp_uÍev’t_is_nÙifiÿtiÚ
(
ev’t
))

1093 
d©a_uÄ—d
 +ğ
skb
->
Ën
;

1095 
	`sùp_uÍev’t_ä“
(
ev’t
);

1098  
d©a_uÄ—d
;

1099 
	}
}

	@ulpevent.h

49 #iâdeà
__sùp_uÍev’t_h__


50 
	#__sùp_uÍev’t_h__


	)

56 
	ssùp_uÍev’t
 {

57 
sùp_assocŸtiÚ
 *
	masoc
;

58 
__u16
 
	m¡»am
;

59 
__u16
 
	ms¢
;

60 
__u16
 
	mæags
;

61 
__u32
 
	mµid
;

62 
__u32
 
	mt¢
;

63 
__u32
 
	mcumt¢
;

64 
	mmsg_æags
;

65 
	miif
;

66 
	mrmem_Ën
;

70 
šlše
 
sk_buff
 *
	$sùp_ev’t2skb
(cÚ¡ 
sùp_uÍev’t
 *
ev
)

72  
	`cÚš”_of
((*)
ev
, 
sk_buff
, 
cb
);

73 
	}
}

76 
šlše
 
sùp_uÍev’t
 *
	$sùp_skb2ev’t
(
sk_buff
 *
skb
)

78  (
sùp_uÍev’t
 *)
skb
->
cb
;

79 
	}
}

81 
sùp_uÍev’t_ä“
(
sùp_uÍev’t
 *);

82 
sùp_uÍev’t_is_nÙifiÿtiÚ
(cÚ¡ 
sùp_uÍev’t
 *);

83 
sùp_queue_purge_uÍev’ts
(
sk_buff_h—d
 *
li¡
);

85 
sùp_uÍev’t
 *
sùp_uÍev’t_make_assoc_chªge
(

86 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

87 
__u16
 
æags
,

88 
__u16
 
¡©e
,

89 
__u16
 
”rÜ
,

90 
__u16
 
outbound
,

91 
__u16
 
šbound
,

92 
sùp_chunk
 *
chunk
,

93 
gå_t
 
gå
);

95 
sùp_uÍev’t
 *
sùp_uÍev’t_make_³”_addr_chªge
(

96 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

97 cÚ¡ 
sockaddr_¡Üage
 *
¯ddr
,

98 
æags
,

99 
¡©e
,

100 
”rÜ
,

101 
gå_t
 
gå
);

103 
sùp_uÍev’t
 *
sùp_uÍev’t_make_»mÙe_”rÜ
(

104 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

105 
sùp_chunk
 *
chunk
,

106 
__u16
 
æags
,

107 
gå_t
 
gå
);

108 
sùp_uÍev’t
 *
sùp_uÍev’t_make_£nd_çed
(

109 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

110 
sùp_chunk
 *
chunk
,

111 
__u16
 
æags
,

112 
__u32
 
”rÜ
,

113 
gå_t
 
gå
);

115 
sùp_uÍev’t
 *
sùp_uÍev’t_make_shutdown_ev’t
(

116 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

117 
__u16
 
æags
,

118 
gå_t
 
gå
);

120 
sùp_uÍev’t
 *
sùp_uÍev’t_make_pd­i
(

121 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
,

122 
__u32
 
šdiÿtiÚ
, 
gå_t
 
gå
);

124 
sùp_uÍev’t
 *
sùp_uÍev’t_make_ad­tiÚ_šdiÿtiÚ
(

125 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
gå_t
 
gå
);

127 
sùp_uÍev’t
 *
sùp_uÍev’t_make_rcvmsg
(
sùp_assocŸtiÚ
 *
asoc
,

128 
sùp_chunk
 *
chunk
,

129 
gå_t
 
gå
);

131 
sùp_uÍev’t
 *
sùp_uÍev’t_make_authkey
(

132 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
__u16
 
key_id
,

133 
__u32
 
šdiÿtiÚ
, 
gå_t
 
gå
);

135 
sùp_uÍev’t
 *
sùp_uÍev’t_make_£nd”_dry_ev’t
(

136 cÚ¡ 
sùp_assocŸtiÚ
 *
asoc
, 
gå_t
 
gå
);

138 
sùp_uÍev’t_»ad_¢drcvšfo
(cÚ¡ 
sùp_uÍev’t
 *
ev’t
,

139 
msghdr
 *);

140 
__u16
 
sùp_uÍev’t_g‘_nÙifiÿtiÚ_ty³
(cÚ¡ 
sùp_uÍev’t
 *
ev’t
);

143 
šlše
 
	$sùp_uÍev’t_ty³_’abËd
(
__u16
 
¢_ty³
,

144 
sùp_ev’t_subsüibe
 *
mask
)

146 *
amask
 = (*è
mask
;

147  
amask
[
¢_ty³
 - 
SCTP_SN_TYPE_BASE
];

148 
	}
}

151 
šlše
 
	$sùp_uÍev’t_is_’abËd
(cÚ¡ 
sùp_uÍev’t
 *
ev’t
,

152 
sùp_ev’t_subsüibe
 *
mask
)

154 
__u16
 
¢_ty³
;

155 
’abËd
 = 1;

157 ià(
	`sùp_uÍev’t_is_nÙifiÿtiÚ
(
ev’t
)) {

158 
¢_ty³
 = 
	`sùp_uÍev’t_g‘_nÙifiÿtiÚ_ty³
(
ev’t
);

159 
’abËd
 = 
	`sùp_uÍev’t_ty³_’abËd
(
¢_ty³
, 
mask
);

161  
’abËd
;

162 
	}
}

	@ulpqueue.c

44 
	~<lšux/ty³s.h
>

45 
	~<lšux/skbuff.h
>

46 
	~<Ãt/sock.h
>

47 
	~<Ãt/sùp/¡ruùs.h
>

48 
	~<Ãt/sùp/sùp.h
>

49 
	~<Ãt/sùp/sm.h
>

52 
sùp_uÍev’t
 * 
sùp_uÍq_»asm
(
sùp_uÍq
 *
uÍq
,

53 
sùp_uÍev’t
 *);

54 
sùp_uÍev’t
 * 
sùp_uÍq_Üd”
(
sùp_uÍq
 *,

55 
sùp_uÍev’t
 *);

56 
sùp_uÍq_»asm_d¿š
(
sùp_uÍq
 *
uÍq
);

61 
sùp_uÍq
 *
	$sùp_uÍq_š™
(
sùp_uÍq
 *
uÍq
,

62 
sùp_assocŸtiÚ
 *
asoc
)

64 
	`mem£t
(
uÍq
, 0, (
sùp_uÍq
));

66 
uÍq
->
asoc
 =‡soc;

67 
	`skb_queue_h—d_š™
(&
uÍq
->
»asm
);

68 
	`skb_queue_h—d_š™
(&
uÍq
->
lobby
);

69 
uÍq
->
pd_mode
 = 0;

70 
uÍq
->
m®loûd
 = 0;

72  
uÍq
;

73 
	}
}

77 
	$sùp_uÍq_æush
(
sùp_uÍq
 *
uÍq
)

79 
sk_buff
 *
skb
;

80 
sùp_uÍev’t
 *
ev’t
;

82 (
skb
 = 
	`__skb_dequeue
(&
uÍq
->
lobby
)è!ğ
NULL
) {

83 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

84 
	`sùp_uÍev’t_ä“
(
ev’t
);

87 (
skb
 = 
	`__skb_dequeue
(&
uÍq
->
»asm
)è!ğ
NULL
) {

88 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

89 
	`sùp_uÍev’t_ä“
(
ev’t
);

92 
	}
}

95 
	$sùp_uÍq_ä“
(
sùp_uÍq
 *
uÍq
)

97 
	`sùp_uÍq_æush
(
uÍq
);

98 ià(
uÍq
->
m®loûd
)

99 
	`kä“
(
uÍq
);

100 
	}
}

103 
	$sùp_uÍq__d©a
(
sùp_uÍq
 *
uÍq
, 
sùp_chunk
 *
chunk
,

104 
gå_t
 
gå
)

106 
sk_buff_h—d
 
‹mp
;

107 
sùp_d©a_chunk_t
 *
hdr
;

108 
sùp_uÍev’t
 *
ev’t
;

110 
hdr
 = (
sùp_d©a_chunk_t
 *è
chunk
->
chunk_hdr
;

113 
ev’t
 = 
	`sùp_uÍev’t_make_rcvmsg
(
chunk
->
asoc
, chunk, 
gå
);

114 ià(!
ev’t
)

115  -
ENOMEM
;

118 
ev’t
 = 
	`sùp_uÍq_»asm
(
uÍq
,ƒvent);

121 ià((
ev’t
è&& (ev’t->
msg_æags
 & 
MSG_EOR
)){

123 
	`skb_queue_h—d_š™
(&
‹mp
);

124 
	`__skb_queue_
(&
‹mp
, 
	`sùp_ev’t2skb
(
ev’t
));

126 
ev’t
 = 
	`sùp_uÍq_Üd”
(
uÍq
,ƒvent);

132 ià(
ev’t
)

133 
	`sùp_uÍq__ev’t
(
uÍq
, 
ev’t
);

136 
	}
}

142 
	$sùp_ş—r_pd
(
sock
 *
sk
, 
sùp_assocŸtiÚ
 *
asoc
)

144 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
sk
);

146 ià(
	`©omic_dec_ªd_‹¡
(&
¥
->
pd_mode
)) {

150 ià(!
	`skb_queue_em±y
(&
¥
->
pd_lobby
)) {

151 
li¡_h—d
 *
li¡
;

152 
	`sùp_skb_li¡_
(&
¥
->
pd_lobby
, &
sk
->
sk_»ûive_queue
);

153 
li¡
 = (
li¡_h—d
 *)&
	`sùp_sk
(
sk
)->
pd_lobby
;

154 
	`INIT_LIST_HEAD
(
li¡
);

163 ià(!
	`skb_queue_em±y
(&
¥
->
pd_lobby
è&& 
asoc
) {

164 
sk_buff
 *
skb
, *
tmp
;

165 
sùp_uÍev’t
 *
ev’t
;

167 
	`sùp_skb_fÜ_—ch
(
skb
, &
¥
->
pd_lobby
, 
tmp
) {

168 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

169 ià(
ev’t
->
asoc
 ==‡soc) {

170 
	`__skb_uÆšk
(
skb
, &
¥
->
pd_lobby
);

171 
	`__skb_queue_
(&
sk
->
sk_»ûive_queue
,

172 
skb
);

179 
	}
}

182 
	$sùp_uÍq_£t_pd
(
sùp_uÍq
 *
uÍq
)

184 
sùp_sock
 *
¥
 = 
	`sùp_sk
(
uÍq
->
asoc
->
ba£
.
sk
);

186 
	`©omic_šc
(&
¥
->
pd_mode
);

187 
uÍq
->
pd_mode
 = 1;

188 
	}
}

191 
	$sùp_uÍq_ş—r_pd
(
sùp_uÍq
 *
uÍq
)

193 
uÍq
->
pd_mode
 = 0;

194 
	`sùp_uÍq_»asm_d¿š
(
uÍq
);

195  
	`sùp_ş—r_pd
(
uÍq
->
asoc
->
ba£
.
sk
, ulpq->asoc);

196 
	}
}

201 
	$sùp_uÍq__ev’t
(
sùp_uÍq
 *
uÍq
, 
sùp_uÍev’t
 *
ev’t
)

203 
sock
 *
sk
 = 
uÍq
->
asoc
->
ba£
.sk;

204 
sk_buff_h—d
 *
queue
, *
skb_li¡
;

205 
sk_buff
 *
skb
 = 
	`sùp_ev’t2skb
(
ev’t
);

206 
ş—r_pd
 = 0;

208 
skb_li¡
 = (
sk_buff_h—d
 *è
skb
->
´ev
;

213 ià(
	`sock_æag
(
sk
, 
SOCK_DEAD
è|| (sk->
sk_shutdown
 & 
RCV_SHUTDOWN
))

214 
out_ä“
;

217 ià(!
	`sùp_uÍev’t_is_’abËd
(
ev’t
, &
	`sùp_sk
(
sk
)->
subsüibe
))

218 
out_ä“
;

225 ià(
	`©omic_»ad
(&
	`sùp_sk
(
sk
)->
pd_mode
) == 0) {

226 
queue
 = &
sk
->
sk_»ûive_queue
;

228 ià(
uÍq
->
pd_mode
) {

234 ià((
ev’t
->
msg_æags
 & 
MSG_NOTIFICATION
) ||

235 (
SCTP_DATA_NOT_FRAG
 ==

236 (
ev’t
->
msg_æags
 & 
SCTP_DATA_FRAG_MASK
)))

237 
queue
 = &
	`sùp_sk
(
sk
)->
pd_lobby
;

239 
ş—r_pd
 = 
ev’t
->
msg_æags
 & 
MSG_EOR
;

240 
queue
 = &
sk
->
sk_»ûive_queue
;

248 ià(
	`sùp_sk
(
sk
)->
äag_š‹¾—ve
)

249 
queue
 = &
sk
->
sk_»ûive_queue
;

251 
queue
 = &
	`sùp_sk
(
sk
)->
pd_lobby
;

258 ià(
skb_li¡
)

259 
	`sùp_skb_li¡_
(
skb_li¡
, 
queue
);

261 
	`__skb_queue_
(
queue
, 
skb
);

267 ià(
ş—r_pd
)

268 
	`sùp_uÍq_ş—r_pd
(
uÍq
);

270 ià(
queue
 =ğ&
sk
->
sk_»ûive_queue
)

271 
sk
->
	`sk_d©a_»ady
(sk, 0);

274 
out_ä“
:

275 ià(
skb_li¡
)

276 
	`sùp_queue_purge_uÍev’ts
(
skb_li¡
);

278 
	`sùp_uÍev’t_ä“
(
ev’t
);

281 
	}
}

286 
	$sùp_uÍq_¡Üe_»asm
(
sùp_uÍq
 *
uÍq
,

287 
sùp_uÍev’t
 *
ev’t
)

289 
sk_buff
 *
pos
;

290 
sùp_uÍev’t
 *
ûv’t
;

291 
__u32
 
t¢
, 
ù¢
;

293 
t¢
 = 
ev’t
->tsn;

296 
pos
 = 
	`skb_³ek_
(&
uÍq
->
»asm
);

297 ià(!
pos
) {

298 
	`__skb_queue_
(&
uÍq
->
»asm
, 
	`sùp_ev’t2skb
(
ev’t
));

303 
ûv’t
 = 
	`sùp_skb2ev’t
(
pos
);

304 
ù¢
 = 
ûv’t
->
t¢
;

305 ià(
	`TSN_É
(
ù¢
, 
t¢
)) {

306 
	`__skb_queue_
(&
uÍq
->
»asm
, 
	`sùp_ev’t2skb
(
ev’t
));

311 
	`skb_queue_w®k
(&
uÍq
->
»asm
, 
pos
) {

312 
ûv’t
 = 
	`sùp_skb2ev’t
(
pos
);

313 
ù¢
 = 
ûv’t
->
t¢
;

315 ià(
	`TSN_É
(
t¢
, 
ù¢
))

320 
	`__skb_queue_befÜe
(&
uÍq
->
»asm
, 
pos
, 
	`sùp_ev’t2skb
(
ev’t
));

322 
	}
}

331 
sùp_uÍev’t
 *
	$sùp_make_»as£mbËd_ev’t
(
sk_buff_h—d
 *
queue
, 
sk_buff
 *
f_äag
, sk_bufà*
l_äag
)

333 
sk_buff
 *
pos
;

334 
sk_buff
 *
Ãw
 = 
NULL
;

335 
sùp_uÍev’t
 *
ev’t
;

336 
sk_buff
 *
²ext
, *
Ï¡
;

337 
sk_buff
 *
li¡
 = 
	`skb_shšfo
(
f_äag
)->
äag_li¡
;

340 ià(
f_äag
 =ğ
l_äag
)

341 
pos
 = 
NULL
;

343 
pos
 = 
f_äag
->
Ãxt
;

346 
Ï¡
 = 
li¡
;†i¡;†a¡ =†i¡,†i¡ =†i¡->
Ãxt
);

351 ià(
Ï¡
)

352 
Ï¡
->
Ãxt
 = 
pos
;

354 ià(
	`skb_şÚed
(
f_äag
)) {

360 
Ãw
 = 
	`skb_cİy
(
f_äag
, 
GFP_ATOMIC
);

361 ià(!
Ãw
)

362  
NULL
;

364 
	`sùp_skb_£t_owÃr_r
(
Ãw
, 
f_äag
->
sk
);

366 
	`skb_shšfo
(
Ãw
)->
äag_li¡
 = 
pos
;

368 
	`skb_shšfo
(
f_äag
)->
äag_li¡
 = 
pos
;

372 
	`__skb_uÆšk
(
f_äag
, 
queue
);

375 ià(
Ãw
) {

376 
	`kä“_skb
(
f_äag
);

377 
f_äag
 = 
Ãw
;

380 
pos
) {

382 
²ext
 = 
pos
->
Ãxt
;

385 
f_äag
->
Ën
 +ğ
pos
->len;

386 
f_äag
->
d©a_Ën
 +ğ
pos
->
Ën
;

389 
	`__skb_uÆšk
(
pos
, 
queue
);

392 ià(
pos
 =ğ
l_äag
)

394 
pos
->
Ãxt
 = 
²ext
;

395 
pos
 = 
²ext
;

398 
ev’t
 = 
	`sùp_skb2ev’t
(
f_äag
);

399 
	`SCTP_INC_STATS
(
SCTP_MIB_REASMUSRMSGS
);

401  
ev’t
;

402 
	}
}

408 
sùp_uÍev’t
 *
	$sùp_uÍq_»Œ›ve_»as£mbËd
(
sùp_uÍq
 *
uÍq
)

410 
sk_buff
 *
pos
;

411 
sùp_uÍev’t
 *
ûv’t
;

412 
sk_buff
 *
fœ¡_äag
 = 
NULL
;

413 
__u32
 
ù¢
, 
Ãxt_t¢
;

414 
sùp_uÍev’t
 *
»tv®
 = 
NULL
;

415 
sk_buff
 *
pd_fœ¡
 = 
NULL
;

416 
sk_buff
 *
pd_Ï¡
 = 
NULL
;

417 
size_t
 
pd_Ën
 = 0;

418 
sùp_assocŸtiÚ
 *
asoc
;

419 
u32
 
pd_pošt
;

425 
Ãxt_t¢
 = 0;

440 
	`skb_queue_w®k
(&
uÍq
->
»asm
, 
pos
) {

441 
ûv’t
 = 
	`sùp_skb2ev’t
(
pos
);

442 
ù¢
 = 
ûv’t
->
t¢
;

444 
ûv’t
->
msg_æags
 & 
SCTP_DATA_FRAG_MASK
) {

445 
SCTP_DATA_FIRST_FRAG
:

450 ià(
pos
 =ğ
uÍq
->
»asm
.
Ãxt
) {

451 
pd_fœ¡
 = 
pos
;

452 
pd_Ï¡
 = 
pos
;

453 
pd_Ën
 = 
pos
->
Ën
;

455 
pd_fœ¡
 = 
NULL
;

456 
pd_Ï¡
 = 
NULL
;

457 
pd_Ën
 = 0;

460 
fœ¡_äag
 = 
pos
;

461 
Ãxt_t¢
 = 
ù¢
 + 1;

464 
SCTP_DATA_MIDDLE_FRAG
:

465 ià((
fœ¡_äag
è&& (
ù¢
 =ğ
Ãxt_t¢
)) {

466 
Ãxt_t¢
++;

467 ià(
pd_fœ¡
) {

468 
pd_Ï¡
 = 
pos
;

469 
pd_Ën
 +ğ
pos
->
Ën
;

472 
fœ¡_äag
 = 
NULL
;

475 
SCTP_DATA_LAST_FRAG
:

476 ià(
fœ¡_äag
 && (
ù¢
 =ğ
Ãxt_t¢
))

477 
found
;

479 
fœ¡_äag
 = 
NULL
;

484 
asoc
 = 
uÍq
->asoc;

485 ià(
pd_fœ¡
) {

491 ià(!
	`sùp_sk
(
asoc
->
ba£
.
sk
)->
äag_š‹¾—ve
 &&

492 
	`©omic_»ad
(&
	`sùp_sk
(
asoc
->
ba£
.
sk
)->
pd_mode
))

493 
dÚe
;

495 
ûv’t
 = 
	`sùp_skb2ev’t
(
pd_fœ¡
);

496 
pd_pošt
 = 
	`sùp_sk
(
asoc
->
ba£
.
sk
)->pd_point;

497 ià(
pd_pošt
 &&…d_pošˆ<ğ
pd_Ën
) {

498 
»tv®
 = 
	`sùp_make_»as£mbËd_ev’t
(&
uÍq
->
»asm
,

499 
pd_fœ¡
,

500 
pd_Ï¡
);

501 ià(
»tv®
)

502 
	`sùp_uÍq_£t_pd
(
uÍq
);

505 
dÚe
:

506  
»tv®
;

507 
found
:

508 
»tv®
 = 
	`sùp_make_»as£mbËd_ev’t
(&
uÍq
->
»asm
, 
fœ¡_äag
, 
pos
);

509 ià(
»tv®
)

510 
»tv®
->
msg_æags
 |ğ
MSG_EOR
;

511 
dÚe
;

512 
	}
}

515 
sùp_uÍev’t
 *
	$sùp_uÍq_»Œ›ve_·¹Ÿl
(
sùp_uÍq
 *
uÍq
)

517 
sk_buff
 *
pos
, *
Ï¡_äag
, *
fœ¡_äag
;

518 
sùp_uÍev’t
 *
ûv’t
;

519 
__u32
 
ù¢
, 
Ãxt_t¢
;

520 
is_Ï¡
;

521 
sùp_uÍev’t
 *
»tv®
;

528 ià(
	`skb_queue_em±y
(&
uÍq
->
»asm
))

529  
NULL
;

531 
Ï¡_äag
 = 
fœ¡_äag
 = 
NULL
;

532 
»tv®
 = 
NULL
;

533 
Ãxt_t¢
 = 0;

534 
is_Ï¡
 = 0;

536 
	`skb_queue_w®k
(&
uÍq
->
»asm
, 
pos
) {

537 
ûv’t
 = 
	`sùp_skb2ev’t
(
pos
);

538 
ù¢
 = 
ûv’t
->
t¢
;

540 
ûv’t
->
msg_æags
 & 
SCTP_DATA_FRAG_MASK
) {

541 
SCTP_DATA_MIDDLE_FRAG
:

542 ià(!
fœ¡_äag
) {

543 
fœ¡_äag
 = 
pos
;

544 
Ãxt_t¢
 = 
ù¢
 + 1;

545 
Ï¡_äag
 = 
pos
;

546 } ià(
Ãxt_t¢
 =ğ
ù¢
)

547 
Ãxt_t¢
++;

549 
dÚe
;

551 
SCTP_DATA_LAST_FRAG
:

552 ià(!
fœ¡_äag
)

553 
fœ¡_äag
 = 
pos
;

554 ià(
ù¢
 !ğ
Ãxt_t¢
)

555 
dÚe
;

556 
Ï¡_äag
 = 
pos
;

557 
is_Ï¡
 = 1;

558 
dÚe
;

560  
NULL
;

567 
dÚe
:

568 
»tv®
 = 
	`sùp_make_»as£mbËd_ev’t
(&
uÍq
->
»asm
, 
fœ¡_äag
, 
Ï¡_äag
);

569 ià(
»tv®
 && 
is_Ï¡
)

570 
»tv®
->
msg_æags
 |ğ
MSG_EOR
;

572  
»tv®
;

573 
	}
}

579 
sùp_uÍev’t
 *
	$sùp_uÍq_»asm
(
sùp_uÍq
 *
uÍq
,

580 
sùp_uÍev’t
 *
ev’t
)

582 
sùp_uÍev’t
 *
»tv®
 = 
NULL
;

585 ià(
SCTP_DATA_NOT_FRAG
 =ğ(
ev’t
->
msg_æags
 & 
SCTP_DATA_FRAG_MASK
)) {

586 
ev’t
->
msg_æags
 |ğ
MSG_EOR
;

587  
ev’t
;

590 
	`sùp_uÍq_¡Üe_»asm
(
uÍq
, 
ev’t
);

591 ià(!
uÍq
->
pd_mode
)

592 
»tv®
 = 
	`sùp_uÍq_»Œ›ve_»as£mbËd
(
uÍq
);

594 
__u32
 
ù¢
, 
ù¢­
;

599 
ù¢
 = 
ev’t
->
t¢
;

600 
ù¢­
 = 
	`sùp_t¢m­_g‘_ù¢
(&
uÍq
->
asoc
->
³”
.
t¢_m­
);

601 ià(
	`TSN_Ée
(
ù¢
, 
ù¢­
))

602 
»tv®
 = 
	`sùp_uÍq_»Œ›ve_·¹Ÿl
(
uÍq
);

605  
»tv®
;

606 
	}
}

609 
sùp_uÍev’t
 *
	$sùp_uÍq_»Œ›ve_fœ¡
(
sùp_uÍq
 *
uÍq
)

611 
sk_buff
 *
pos
, *
Ï¡_äag
, *
fœ¡_äag
;

612 
sùp_uÍev’t
 *
ûv’t
;

613 
__u32
 
ù¢
, 
Ãxt_t¢
;

614 
sùp_uÍev’t
 *
»tv®
;

621 ià(
	`skb_queue_em±y
(&
uÍq
->
»asm
))

622  
NULL
;

624 
Ï¡_äag
 = 
fœ¡_äag
 = 
NULL
;

625 
»tv®
 = 
NULL
;

626 
Ãxt_t¢
 = 0;

628 
	`skb_queue_w®k
(&
uÍq
->
»asm
, 
pos
) {

629 
ûv’t
 = 
	`sùp_skb2ev’t
(
pos
);

630 
ù¢
 = 
ûv’t
->
t¢
;

632 
ûv’t
->
msg_æags
 & 
SCTP_DATA_FRAG_MASK
) {

633 
SCTP_DATA_FIRST_FRAG
:

634 ià(!
fœ¡_äag
) {

635 
fœ¡_äag
 = 
pos
;

636 
Ãxt_t¢
 = 
ù¢
 + 1;

637 
Ï¡_äag
 = 
pos
;

639 
dÚe
;

642 
SCTP_DATA_MIDDLE_FRAG
:

643 ià(!
fœ¡_äag
)

644  
NULL
;

645 ià(
ù¢
 =ğ
Ãxt_t¢
) {

646 
Ãxt_t¢
++;

647 
Ï¡_äag
 = 
pos
;

649 
dÚe
;

652  
NULL
;

659 
dÚe
:

660 
»tv®
 = 
	`sùp_make_»as£mbËd_ev’t
(&
uÍq
->
»asm
, 
fœ¡_äag
, 
Ï¡_äag
);

661  
»tv®
;

662 
	}
}

678 
	$sùp_uÍq_»asm_æusht¢
(
sùp_uÍq
 *
uÍq
, 
__u32
 
fwd_t¢
)

680 
sk_buff
 *
pos
, *
tmp
;

681 
sùp_uÍev’t
 *
ev’t
;

682 
__u32
 
t¢
;

684 ià(
	`skb_queue_em±y
(&
uÍq
->
»asm
))

687 
	`skb_queue_w®k_§ã
(&
uÍq
->
»asm
, 
pos
, 
tmp
) {

688 
ev’t
 = 
	`sùp_skb2ev’t
(
pos
);

689 
t¢
 = 
ev’t
->tsn;

696 ià(
	`TSN_Ée
(
t¢
, 
fwd_t¢
)) {

697 
	`__skb_uÆšk
(
pos
, &
uÍq
->
»asm
);

698 
	`sùp_uÍev’t_ä“
(
ev’t
);

702 
	}
}

709 
	$sùp_uÍq_»asm_d¿š
(
sùp_uÍq
 *
uÍq
)

711 
sùp_uÍev’t
 *
ev’t
 = 
NULL
;

712 
sk_buff_h—d
 
‹mp
;

714 ià(
	`skb_queue_em±y
(&
uÍq
->
»asm
))

717 (
ev’t
 = 
	`sùp_uÍq_»Œ›ve_»as£mbËd
(
uÍq
)è!ğ
NULL
) {

719 ià((
ev’t
è&& (ev’t->
msg_æags
 & 
MSG_EOR
)){

720 
	`skb_queue_h—d_š™
(&
‹mp
);

721 
	`__skb_queue_
(&
‹mp
, 
	`sùp_ev’t2skb
(
ev’t
));

723 
ev’t
 = 
	`sùp_uÍq_Üd”
(
uÍq
,ƒvent);

729 ià(
ev’t
)

730 
	`sùp_uÍq__ev’t
(
uÍq
, 
ev’t
);

732 
	}
}

738 
	$sùp_uÍq_»Œ›ve_Üd”ed
(
sùp_uÍq
 *
uÍq
,

739 
sùp_uÍev’t
 *
ev’t
)

741 
sk_buff_h—d
 *
ev’t_li¡
;

742 
sk_buff
 *
pos
, *
tmp
;

743 
sùp_uÍev’t
 *
ûv’t
;

744 
sùp_¡»am
 *
š
;

745 
__u16
 
sid
, 
csid
;

746 
__u16
 
s¢
, 
cs¢
;

748 
sid
 = 
ev’t
->
¡»am
;

749 
s¢
 = 
ev’t
->ssn;

750 
š
 = &
uÍq
->
asoc
->
s¢m­
->in;

752 
ev’t_li¡
 = (
sk_buff_h—d
 *è
	`sùp_ev’t2skb
(
ev’t
)->
´ev
;

755 
	`sùp_skb_fÜ_—ch
(
pos
, &
uÍq
->
lobby
, 
tmp
) {

756 
ûv’t
 = (
sùp_uÍev’t
 *è
pos
->
cb
;

757 
csid
 = 
ûv’t
->
¡»am
;

758 
cs¢
 = 
ûv’t
->
s¢
;

761 ià(
csid
 > 
sid
)

765 ià(
csid
 < 
sid
)

768 ià(
cs¢
 !ğ
	`sùp_s¢_³ek
(
š
, 
sid
))

772 
	`sùp_s¢_Ãxt
(
š
, 
sid
);

774 
	`__skb_uÆšk
(
pos
, &
uÍq
->
lobby
);

777 
	`__skb_queue_
(
ev’t_li¡
, 
pos
);

779 
	}
}

782 
	$sùp_uÍq_¡Üe_Üd”ed
(
sùp_uÍq
 *
uÍq
,

783 
sùp_uÍev’t
 *
ev’t
)

785 
sk_buff
 *
pos
;

786 
sùp_uÍev’t
 *
ûv’t
;

787 
__u16
 
sid
, 
csid
;

788 
__u16
 
s¢
, 
cs¢
;

790 
pos
 = 
	`skb_³ek_
(&
uÍq
->
lobby
);

791 ià(!
pos
) {

792 
	`__skb_queue_
(&
uÍq
->
lobby
, 
	`sùp_ev’t2skb
(
ev’t
));

796 
sid
 = 
ev’t
->
¡»am
;

797 
s¢
 = 
ev’t
->ssn;

799 
ûv’t
 = (
sùp_uÍev’t
 *è
pos
->
cb
;

800 
csid
 = 
ûv’t
->
¡»am
;

801 
cs¢
 = 
ûv’t
->
s¢
;

802 ià(
sid
 > 
csid
) {

803 
	`__skb_queue_
(&
uÍq
->
lobby
, 
	`sùp_ev’t2skb
(
ev’t
));

807 ià((
sid
 =ğ
csid
è&& 
	`SSN_É
(
cs¢
, 
s¢
)) {

808 
	`__skb_queue_
(&
uÍq
->
lobby
, 
	`sùp_ev’t2skb
(
ev’t
));

815 
	`skb_queue_w®k
(&
uÍq
->
lobby
, 
pos
) {

816 
ûv’t
 = (
sùp_uÍev’t
 *è
pos
->
cb
;

817 
csid
 = 
ûv’t
->
¡»am
;

818 
cs¢
 = 
ûv’t
->
s¢
;

820 ià(
csid
 > 
sid
)

822 ià(
csid
 =ğ
sid
 && 
	`SSN_É
(
s¢
, 
cs¢
))

828 
	`__skb_queue_befÜe
(&
uÍq
->
lobby
, 
pos
, 
	`sùp_ev’t2skb
(
ev’t
));

829 
	}
}

831 
sùp_uÍev’t
 *
	$sùp_uÍq_Üd”
(
sùp_uÍq
 *
uÍq
,

832 
sùp_uÍev’t
 *
ev’t
)

834 
__u16
 
sid
, 
s¢
;

835 
sùp_¡»am
 *
š
;

838 ià(
SCTP_DATA_UNORDERED
 & 
ev’t
->
msg_æags
)

839  
ev’t
;

842 
sid
 = 
ev’t
->
¡»am
;

843 
s¢
 = 
ev’t
->ssn;

844 
š
 = &
uÍq
->
asoc
->
s¢m­
->in;

847 ià(
s¢
 !ğ
	`sùp_s¢_³ek
(
š
, 
sid
)) {

851 
	`sùp_uÍq_¡Üe_Üd”ed
(
uÍq
, 
ev’t
);

852  
NULL
;

856 
	`sùp_s¢_Ãxt
(
š
, 
sid
);

861 
	`sùp_uÍq_»Œ›ve_Üd”ed
(
uÍq
, 
ev’t
);

863  
ev’t
;

864 
	}
}

869 
	$sùp_uÍq_»­_Üd”ed
(
sùp_uÍq
 *
uÍq
, 
__u16
 
sid
)

871 
sk_buff
 *
pos
, *
tmp
;

872 
sùp_uÍev’t
 *
ûv’t
;

873 
sùp_uÍev’t
 *
ev’t
;

874 
sùp_¡»am
 *
š
;

875 
sk_buff_h—d
 
‹mp
;

876 
sk_buff_h—d
 *
lobby
 = &
uÍq
->lobby;

877 
__u16
 
csid
, 
cs¢
;

879 
š
 = &
uÍq
->
asoc
->
s¢m­
->in;

882 
	`skb_queue_h—d_š™
(&
‹mp
);

883 
ev’t
 = 
NULL
;

884 
	`sùp_skb_fÜ_—ch
(
pos
, 
lobby
, 
tmp
) {

885 
ûv’t
 = (
sùp_uÍev’t
 *è
pos
->
cb
;

886 
csid
 = 
ûv’t
->
¡»am
;

887 
cs¢
 = 
ûv’t
->
s¢
;

890 ià(
csid
 > 
sid
)

894 ià(
csid
 < 
sid
)

898 ià(!
	`SSN_É
(
cs¢
, 
	`sùp_s¢_³ek
(
š
, 
csid
)))

901 
	`__skb_uÆšk
(
pos
, 
lobby
);

902 ià(!
ev’t
)

904 
ev’t
 = 
	`sùp_skb2ev’t
(
pos
);

907 
	`__skb_queue_
(&
‹mp
, 
pos
);

913 ià(
ev’t
 =ğ
NULL
 && 
pos
 !ğ(
sk_buff
 *)
lobby
) {

914 
ûv’t
 = (
sùp_uÍev’t
 *è
pos
->
cb
;

915 
csid
 = 
ûv’t
->
¡»am
;

916 
cs¢
 = 
ûv’t
->
s¢
;

918 ià(
csid
 =ğ
sid
 && 
cs¢
 =ğ
	`sùp_s¢_³ek
(
š
, csid)) {

919 
	`sùp_s¢_Ãxt
(
š
, 
csid
);

920 
	`__skb_uÆšk
(
pos
, 
lobby
);

921 
	`__skb_queue_
(&
‹mp
, 
pos
);

922 
ev’t
 = 
	`sùp_skb2ev’t
(
pos
);

929 ià(
ev’t
) {

931 
	`sùp_uÍq_»Œ›ve_Üd”ed
(
uÍq
, 
ev’t
);

932 
	`sùp_uÍq__ev’t
(
uÍq
, 
ev’t
);

934 
	}
}

939 
	$sùp_uÍq_sk
(
sùp_uÍq
 *
uÍq
, 
__u16
 
sid
, __u16 
s¢
)

941 
sùp_¡»am
 *
š
;

944 
š
 = &
uÍq
->
asoc
->
s¢m­
->in;

947 ià(
	`SSN_É
(
s¢
, 
	`sùp_s¢_³ek
(
š
, 
sid
)))

951 
	`sùp_s¢_sk
(
š
, 
sid
, 
s¢
);

956 
	`sùp_uÍq_»­_Üd”ed
(
uÍq
, 
sid
);

958 
	}
}

960 
__u16
 
	$sùp_uÍq_»Ãge_li¡
(
sùp_uÍq
 *
uÍq
,

961 
sk_buff_h—d
 *
li¡
, 
__u16
 
Ãeded
)

963 
__u16
 
ä“d
 = 0;

964 
__u32
 
t¢
;

965 
sk_buff
 *
skb
;

966 
sùp_uÍev’t
 *
ev’t
;

967 
sùp_t¢m­
 *
t¢m­
;

969 
t¢m­
 = &
uÍq
->
asoc
->
³”
.
t¢_m­
;

971 (
skb
 = 
	`__skb_dequeue_
(
li¡
)è!ğ
NULL
) {

972 
ä“d
 +ğ
	`skb_h—dËn
(
skb
);

973 
ev’t
 = 
	`sùp_skb2ev’t
(
skb
);

974 
t¢
 = 
ev’t
->tsn;

976 
	`sùp_uÍev’t_ä“
(
ev’t
);

977 
	`sùp_t¢m­_»Ãge
(
t¢m­
, 
t¢
);

978 ià(
ä“d
 >ğ
Ãeded
)

979  
ä“d
;

982  
ä“d
;

983 
	}
}

986 
__u16
 
	$sùp_uÍq_»Ãge_Üd”
(
sùp_uÍq
 *
uÍq
, 
__u16
 
Ãeded
)

988  
	`sùp_uÍq_»Ãge_li¡
(
uÍq
, &uÍq->
lobby
, 
Ãeded
);

989 
	}
}

992 
__u16
 
	$sùp_uÍq_»Ãge_äags
(
sùp_uÍq
 *
uÍq
, 
__u16
 
Ãeded
)

994  
	`sùp_uÍq_»Ãge_li¡
(
uÍq
, &uÍq->
»asm
, 
Ãeded
);

995 
	}
}

998 
	$sùp_uÍq_·¹Ÿl_d–iv”y
(
sùp_uÍq
 *
uÍq
,

999 
sùp_chunk
 *
chunk
,

1000 
gå_t
 
gå
)

1002 
sùp_uÍev’t
 *
ev’t
;

1003 
sùp_assocŸtiÚ
 *
asoc
;

1004 
sùp_sock
 *
¥
;

1006 
asoc
 = 
uÍq
->asoc;

1007 
¥
 = 
	`sùp_sk
(
asoc
->
ba£
.
sk
);

1012 ià(
uÍq
->
pd_mode
)

1020 ià(
¥
->
äag_š‹¾—ve
 || 
	`©omic_»ad
(&¥->
pd_mode
) == 0) {

1022 
ev’t
 = 
	`sùp_uÍq_»Œ›ve_fœ¡
(
uÍq
);

1024 ià(
ev’t
) {

1025 
	`sùp_uÍq__ev’t
(
uÍq
, 
ev’t
);

1026 
	`sùp_uÍq_£t_pd
(
uÍq
);

1030 
	}
}

1033 
	$sùp_uÍq_»Ãge
(
sùp_uÍq
 *
uÍq
, 
sùp_chunk
 *
chunk
,

1034 
gå_t
 
gå
)

1036 
sùp_assocŸtiÚ
 *
asoc
;

1037 
__u16
 
Ãeded
, 
ä“d
;

1039 
asoc
 = 
uÍq
->asoc;

1041 ià(
chunk
) {

1042 
Ãeded
 = 
	`Áohs
(
chunk
->
chunk_hdr
->
Ëngth
);

1043 
Ãeded
 -ğ(
sùp_d©a_chunk_t
);

1045 
Ãeded
 = 
SCTP_DEFAULT_MAXWINDOW
;

1047 
ä“d
 = 0;

1049 ià(
	`skb_queue_em±y
(&
asoc
->
ba£
.
sk
->
sk_»ûive_queue
)) {

1050 
ä“d
 = 
	`sùp_uÍq_»Ãge_Üd”
(
uÍq
, 
Ãeded
);

1051 ià(
ä“d
 < 
Ãeded
) {

1052 
ä“d
 +ğ
	`sùp_uÍq_»Ãge_äags
(
uÍq
, 
Ãeded
 - freed);

1056 ià(
chunk
 && (
ä“d
 >ğ
Ãeded
)) {

1057 
__u32
 
t¢
;

1058 
t¢
 = 
	`Áohl
(
chunk
->
subh
.
d©a_hdr
->tsn);

1059 
	`sùp_t¢m­_m¬k
(&
asoc
->
³”
.
t¢_m­
, 
t¢
, 
chunk
->
Œª¥Üt
);

1060 
	`sùp_uÍq__d©a
(
uÍq
, 
chunk
, 
gå
);

1062 
	`sùp_uÍq_·¹Ÿl_d–iv”y
(
uÍq
, 
chunk
, 
gå
);

1065 
	`sk_mem_»şaim
(
asoc
->
ba£
.
sk
);

1067 
	}
}

1074 
	$sùp_uÍq_abÜt_pd
(
sùp_uÍq
 *
uÍq
, 
gå_t
 
gå
)

1076 
sùp_uÍev’t
 *
ev
 = 
NULL
;

1077 
sock
 *
sk
;

1079 ià(!
uÍq
->
pd_mode
)

1082 
sk
 = 
uÍq
->
asoc
->
ba£
.sk;

1083 ià(
	`sùp_uÍev’t_ty³_’abËd
(
SCTP_PARTIAL_DELIVERY_EVENT
,

1084 &
	`sùp_sk
(
sk
)->
subsüibe
))

1085 
ev
 = 
	`sùp_uÍev’t_make_pd­i
(
uÍq
->
asoc
,

1086 
SCTP_PARTIAL_DELIVERY_ABORTED
,

1087 
gå
);

1088 ià(
ev
)

1089 
	`__skb_queue_
(&
sk
->
sk_»ûive_queue
, 
	`sùp_ev’t2skb
(
ev
));

1092 ià(
	`sùp_uÍq_ş—r_pd
(
uÍq
è|| 
ev
)

1093 
sk
->
	`sk_d©a_»ady
(sk, 0);

1094 
	}
}

	@ulpqueue.h

47 #iâdeà
__sùp_uÍqueue_h__


48 
	#__sùp_uÍqueue_h__


	)

51 
	ssùp_uÍq
 {

52 
	mm®loûd
;

53 
	mpd_mode
;

54 
sùp_assocŸtiÚ
 *
	masoc
;

55 
sk_buff_h—d
 
	m»asm
;

56 
sk_buff_h—d
 
	mlobby
;

60 
sùp_uÍq
 *
sùp_uÍq_š™
(sctp_ulpq *,

61 
sùp_assocŸtiÚ
 *);

62 
sùp_uÍq_æush
(
sùp_uÍq
 *
uÍq
);

63 
sùp_uÍq_ä“
(
sùp_uÍq
 *);

66 
sùp_uÍq__d©a
(
sùp_uÍq
 *, 
sùp_chunk
 *, 
gå_t
);

69 
sùp_uÍq__ev’t
(
sùp_uÍq
 *, 
sùp_uÍev’t
 *
ev
);

72 
sùp_uÍq_»Ãge
(
sùp_uÍq
 *, 
sùp_chunk
 *, 
gå_t
);

75 
sùp_uÍq_·¹Ÿl_d–iv”y
(
sùp_uÍq
 *, 
gå_t
);

78 
sùp_uÍq_abÜt_pd
(
sùp_uÍq
 *, 
gå_t
);

81 
sùp_ş—r_pd
(
sock
 *
sk
, 
sùp_assocŸtiÚ
 *
asoc
);

84 
sùp_uÍq_sk
(
sùp_uÍq
 *
uÍq
, 
__u16
 
sid
, __u16 
s¢
);

86 
sùp_uÍq_»asm_æusht¢
(
sùp_uÍq
 *, 
__u32
);

	@user.h

52 #iâdeà
__Ãt_sùp_u£r_h__


53 
	#__Ãt_sùp_u£r_h__


	)

55 
	~<lšux/ty³s.h
>

56 
	~<lšux/sock‘.h
>

58 
__s32
 
	tsùp_assoc_t
;

63 
	esùp_İŠame
 {

64 
	mSCTP_RTOINFO
,

65 
	#SCTP_RTOINFO
 
SCTP_RTOINFO


	)

66 
	mSCTP_ASSOCINFO
,

67 
	#SCTP_ASSOCINFO
 
SCTP_ASSOCINFO


	)

68 
	mSCTP_INITMSG
,

69 
	#SCTP_INITMSG
 
SCTP_INITMSG


	)

70 
	mSCTP_NODELAY
,

71 
	#SCTP_NODELAY
 
SCTP_NODELAY


	)

72 
	mSCTP_AUTOCLOSE
,

73 
	#SCTP_AUTOCLOSE
 
SCTP_AUTOCLOSE


	)

74 
	mSCTP_SET_PEER_PRIMARY_ADDR
,

75 
	#SCTP_SET_PEER_PRIMARY_ADDR
 
SCTP_SET_PEER_PRIMARY_ADDR


	)

76 
	mSCTP_PRIMARY_ADDR
,

77 
	#SCTP_PRIMARY_ADDR
 
SCTP_PRIMARY_ADDR


	)

78 
	mSCTP_ADAPTATION_LAYER
,

79 
	#SCTP_ADAPTATION_LAYER
 
SCTP_ADAPTATION_LAYER


	)

80 
	mSCTP_DISABLE_FRAGMENTS
,

81 
	#SCTP_DISABLE_FRAGMENTS
 
SCTP_DISABLE_FRAGMENTS


	)

82 
	mSCTP_PEER_ADDR_PARAMS
,

83 
	#SCTP_PEER_ADDR_PARAMS
 
SCTP_PEER_ADDR_PARAMS


	)

84 
	mSCTP_DEFAULT_SEND_PARAM
,

85 
	#SCTP_DEFAULT_SEND_PARAM
 
SCTP_DEFAULT_SEND_PARAM


	)

86 
	mSCTP_EVENTS
,

87 
	#SCTP_EVENTS
 
SCTP_EVENTS


	)

88 
	mSCTP_I_WANT_MAPPED_V4_ADDR
,

89 
	#SCTP_I_WANT_MAPPED_V4_ADDR
 
SCTP_I_WANT_MAPPED_V4_ADDR


	)

90 
	mSCTP_MAXSEG
,

91 
	#SCTP_MAXSEG
 
SCTP_MAXSEG


	)

92 
	mSCTP_STATUS
,

93 
	#SCTP_STATUS
 
SCTP_STATUS


	)

94 
	mSCTP_GET_PEER_ADDR_INFO
,

95 
	#SCTP_GET_PEER_ADDR_INFO
 
SCTP_GET_PEER_ADDR_INFO


	)

96 
	mSCTP_DELAYED_ACK
,

97 
	#SCTP_DELAYED_ACK_TIME
 
SCTP_DELAYED_ACK


	)

98 
	#SCTP_DELAYED_SACK
 
SCTP_DELAYED_ACK_TIME


	)

99 
	#SCTP_DELAYED_ACK
 
SCTP_DELAYED_ACK


	)

100 
	mSCTP_CONTEXT
,

101 
	#SCTP_CONTEXT
 
SCTP_CONTEXT


	)

102 
	mSCTP_FRAGMENT_INTERLEAVE
,

103 
	#SCTP_FRAGMENT_INTERLEAVE
 
SCTP_FRAGMENT_INTERLEAVE


	)

104 
	mSCTP_PARTIAL_DELIVERY_POINT
,

105 
	#SCTP_PARTIAL_DELIVERY_POINT
 
SCTP_PARTIAL_DELIVERY_POINT


	)

106 
	mSCTP_MAX_BURST
,

107 
	#SCTP_MAX_BURST
 
SCTP_MAX_BURST


	)

108 
	mSCTP_AUTH_CHUNK
,

109 
	#SCTP_AUTH_CHUNK
 
SCTP_AUTH_CHUNK


	)

110 
	mSCTP_HMAC_IDENT
,

111 
	#SCTP_HMAC_IDENT
 
SCTP_HMAC_IDENT


	)

112 
	mSCTP_AUTH_KEY
,

113 
	#SCTP_AUTH_KEY
 
SCTP_AUTH_KEY


	)

114 
	mSCTP_AUTH_ACTIVE_KEY
,

115 
	#SCTP_AUTH_ACTIVE_KEY
 
SCTP_AUTH_ACTIVE_KEY


	)

116 
	mSCTP_AUTH_DELETE_KEY
,

117 
	#SCTP_AUTH_DELETE_KEY
 
SCTP_AUTH_DELETE_KEY


	)

118 
	mSCTP_PEER_AUTH_CHUNKS
,

119 
	#SCTP_PEER_AUTH_CHUNKS
 
SCTP_PEER_AUTH_CHUNKS


	)

120 
	mSCTP_LOCAL_AUTH_CHUNKS
,

121 
	#SCTP_LOCAL_AUTH_CHUNKS
 
SCTP_LOCAL_AUTH_CHUNKS


	)

122 
	mSCTP_GET_ASSOC_NUMBER
,

123 
	#SCTP_GET_ASSOC_NUMBER
 
SCTP_GET_ASSOC_NUMBER


	)

124 
	mSCTP_GET_ASSOC_ID_LIST
,

125 
	#SCTP_GET_ASSOC_ID_LIST
 
SCTP_GET_ASSOC_ID_LIST


	)

126 
	mSCTP_PEER_ADDR_THLDS
 = 31,

127 
	#SCTP_PEER_ADDR_THLDS
 
SCTP_PEER_ADDR_THLDS


	)

132 
	mSCTP_SOCKOPT_BINDX_ADD
 = 100,

133 
	#SCTP_SOCKOPT_BINDX_ADD
 
SCTP_SOCKOPT_BINDX_ADD


	)

134 
	mSCTP_SOCKOPT_BINDX_REM
,

135 
	#SCTP_SOCKOPT_BINDX_REM
 
SCTP_SOCKOPT_BINDX_REM


	)

136 
	mSCTP_SOCKOPT_PEELOFF
,

137 
	#SCTP_SOCKOPT_PEELOFF
 
SCTP_SOCKOPT_PEELOFF


	)

138 
	mSCTP_GET_PEER_ADDRS_NUM_OLD
,

139 
	#SCTP_GET_PEER_ADDRS_NUM_OLD
 
SCTP_GET_PEER_ADDRS_NUM_OLD


	)

140 
	mSCTP_GET_PEER_ADDRS_OLD
,

141 
	#SCTP_GET_PEER_ADDRS_OLD
 
SCTP_GET_PEER_ADDRS_OLD


	)

142 
	mSCTP_GET_LOCAL_ADDRS_NUM_OLD
,

143 
	#SCTP_GET_LOCAL_ADDRS_NUM_OLD
 
SCTP_GET_LOCAL_ADDRS_NUM_OLD


	)

144 
	mSCTP_GET_LOCAL_ADDRS_OLD
,

145 
	#SCTP_GET_LOCAL_ADDRS_OLD
 
SCTP_GET_LOCAL_ADDRS_OLD


	)

146 
	mSCTP_SOCKOPT_CONNECTX_OLD
,

147 
	#SCTP_SOCKOPT_CONNECTX_OLD
 
SCTP_SOCKOPT_CONNECTX_OLD


	)

148 
	mSCTP_GET_PEER_ADDRS
,

149 
	#SCTP_GET_PEER_ADDRS
 
SCTP_GET_PEER_ADDRS


	)

150 
	mSCTP_GET_LOCAL_ADDRS
,

151 
	#SCTP_GET_LOCAL_ADDRS
 
SCTP_GET_LOCAL_ADDRS


	)

152 
	mSCTP_SOCKOPT_CONNECTX
,

153 
	#SCTP_SOCKOPT_CONNECTX
 
SCTP_SOCKOPT_CONNECTX


	)

154 
	mSCTP_SOCKOPT_CONNECTX3
,

155 
	#SCTP_SOCKOPT_CONNECTX3
 
SCTP_SOCKOPT_CONNECTX3


	)

156 
	mSCTP_GET_ASSOC
,

157 
	#SCTP_GET_ASSOC
 
SCTP_GET_ASSOC


	)

158 
	mSCTP_SET_ASSOC
,

159 
	#SCTP_SET_ASSOC
 
SCTP_SET_ASSOC


	)

160 
	mSCTP_UPDATE
,

161 
	#SCTP_UPDATE
 
SCTP_UPDATE


	)

177 
	ssùp_š™msg
 {

178 
__u16
 
	msš™_num_o¡»ams
;

179 
__u16
 
	msš™_max_š¡»ams
;

180 
__u16
 
	msš™_max_©‹m±s
;

181 
__u16
 
	msš™_max_š™_timeo
;

196 
	ssùp_¢drcvšfo
 {

197 
__u16
 
	msšfo_¡»am
;

198 
__u16
 
	msšfo_s¢
;

199 
__u16
 
	msšfo_æags
;

200 
__u32
 
	msšfo_µid
;

201 
__u32
 
	msšfo_cÚ‹xt
;

202 
__u32
 
	msšfo_tim‘Şive
;

203 
__u32
 
	msšfo_t¢
;

204 
__u32
 
	msšfo_cumt¢
;

205 
sùp_assoc_t
 
	msšfo_assoc_id
;

215 
	esùp_sšfo_æags
 {

216 
	mSCTP_UNORDERED
 = 1,

217 
	mSCTP_ADDR_OVER
 = 2,

218 
	mSCTP_ABORT
=4,

219 
	mSCTP_EOF
=
MSG_FIN
,

224 
	esùp_cmsg_ty³
 {

225 
	mSCTP_INIT
,

226 
	mSCTP_SNDRCV
,

227 } 
	tsùp_cmsg_t
;

239 
	ssùp_assoc_chªge
 {

240 
__u16
 
	m§c_ty³
;

241 
__u16
 
	m§c_æags
;

242 
__u32
 
	m§c_Ëngth
;

243 
__u16
 
	m§c_¡©e
;

244 
__u16
 
	m§c_”rÜ
;

245 
__u16
 
	m§c_outbound_¡»ams
;

246 
__u16
 
	m§c_šbound_¡»ams
;

247 
sùp_assoc_t
 
	m§c_assoc_id
;

248 
__u8
 
	m§c_šfo
[0];

260 
	esùp_§c_¡©e
 {

261 
	mSCTP_COMM_UP
,

262 
	mSCTP_COMM_LOST
,

263 
	mSCTP_RESTART
,

264 
	mSCTP_SHUTDOWN_COMP
,

265 
	mSCTP_CANT_STR_ASSOC
,

275 
	ssùp_·ddr_chªge
 {

276 
__u16
 
	m¥c_ty³
;

277 
__u16
 
	m¥c_æags
;

278 
__u32
 
	m¥c_Ëngth
;

279 
sockaddr_¡Üage
 
	m¥c_¯ddr
;

280 
	m¥c_¡©e
;

281 
	m¥c_”rÜ
;

282 
sùp_assoc_t
 
	m¥c_assoc_id
;

283 } 
__©Œibu‹__
((
·cked
, 
®igÃd
(4)));

291 
	esùp_¥c_¡©e
 {

292 
	mSCTP_ADDR_AVAILABLE
,

293 
	mSCTP_ADDR_UNREACHABLE
,

294 
	mSCTP_ADDR_REMOVED
,

295 
	mSCTP_ADDR_ADDED
,

296 
	mSCTP_ADDR_MADE_PRIM
,

297 
	mSCTP_ADDR_CONFIRMED
,

311 
	ssùp_»mÙe_”rÜ
 {

312 
__u16
 
	m¤e_ty³
;

313 
__u16
 
	m¤e_æags
;

314 
__u32
 
	m¤e_Ëngth
;

315 
__u16
 
	m¤e_”rÜ
;

316 
sùp_assoc_t
 
	m¤e_assoc_id
;

317 
__u8
 
	m¤e_d©a
[0];

327 
	ssùp_£nd_çed
 {

328 
__u16
 
	mssf_ty³
;

329 
__u16
 
	mssf_æags
;

330 
__u32
 
	mssf_Ëngth
;

331 
__u32
 
	mssf_”rÜ
;

332 
sùp_¢drcvšfo
 
	mssf_šfo
;

333 
sùp_assoc_t
 
	mssf_assoc_id
;

334 
__u8
 
	mssf_d©a
[0];

349 
	esùp_ssf_æags
 {

350 
	mSCTP_DATA_UNSENT
,

351 
	mSCTP_DATA_SENT
,

360 
	ssùp_shutdown_ev’t
 {

361 
__u16
 
	ms£_ty³
;

362 
__u16
 
	ms£_æags
;

363 
__u32
 
	ms£_Ëngth
;

364 
sùp_assoc_t
 
	ms£_assoc_id
;

374 
	ssùp_ad­tiÚ_ev’t
 {

375 
__u16
 
	m§i_ty³
;

376 
__u16
 
	m§i_æags
;

377 
__u32
 
	m§i_Ëngth
;

378 
__u32
 
	m§i_ad­tiÚ_šd
;

379 
sùp_assoc_t
 
	m§i_assoc_id
;

389 
	ssùp_pd­i_ev’t
 {

390 
__u16
 
	mpd­i_ty³
;

391 
__u16
 
	mpd­i_æags
;

392 
__u32
 
	mpd­i_Ëngth
;

393 
__u32
 
	mpd­i_šdiÿtiÚ
;

394 
sùp_assoc_t
 
	mpd­i_assoc_id
;

397 ’um { 
	mSCTP_PARTIAL_DELIVERY_ABORTED
=0, };

399 
	ssùp_authkey_ev’t
 {

400 
__u16
 
	mauth_ty³
;

401 
__u16
 
	mauth_æags
;

402 
__u32
 
	mauth_Ëngth
;

403 
__u16
 
	mauth_keynumb”
;

404 
__u16
 
	mauth_®tkeynumb”
;

405 
__u32
 
	mauth_šdiÿtiÚ
;

406 
sùp_assoc_t
 
	mauth_assoc_id
;

409 ’um { 
	mSCTP_AUTH_NEWKEY
 = 0, };

419 
	ssùp_£nd”_dry_ev’t
 {

420 
__u16
 
	m£nd”_dry_ty³
;

421 
__u16
 
	m£nd”_dry_æags
;

422 
__u32
 
	m£nd”_dry_Ëngth
;

423 
sùp_assoc_t
 
	m£nd”_dry_assoc_id
;

430 
	ssùp_ev’t_subsüibe
 {

431 
__u8
 
	msùp_d©a_io_ev’t
;

432 
__u8
 
	msùp_assocŸtiÚ_ev’t
;

433 
__u8
 
	msùp_add»ss_ev’t
;

434 
__u8
 
	msùp_£nd_çu»_ev’t
;

435 
__u8
 
	msùp_³”_”rÜ_ev’t
;

436 
__u8
 
	msùp_shutdown_ev’t
;

437 
__u8
 
	msùp_·¹Ÿl_d–iv”y_ev’t
;

438 
__u8
 
	msùp_ad­tiÚ_Ïy”_ev’t
;

439 
__u8
 
	msùp_auth’tiÿtiÚ_ev’t
;

440 
__u8
 
	msùp_£nd”_dry_ev’t
;

450 
	usùp_nÙifiÿtiÚ
 {

452 
__u16
 
	m¢_ty³
;

453 
__u16
 
	m¢_æags
;

454 
__u32
 
	m¢_Ëngth
;

455 } 
	m¢_h—d”
;

456 
sùp_assoc_chªge
 
	m¢_assoc_chªge
;

457 
sùp_·ddr_chªge
 
	m¢_·ddr_chªge
;

458 
sùp_»mÙe_”rÜ
 
	m¢_»mÙe_”rÜ
;

459 
sùp_£nd_çed
 
	m¢_£nd_çed
;

460 
sùp_shutdown_ev’t
 
	m¢_shutdown_ev’t
;

461 
sùp_ad­tiÚ_ev’t
 
	m¢_ad­tiÚ_ev’t
;

462 
sùp_pd­i_ev’t
 
	m¢_pd­i_ev’t
;

463 
sùp_authkey_ev’t
 
	m¢_authkey_ev’t
;

464 
sùp_£nd”_dry_ev’t
 
	m¢_£nd”_dry_ev’t
;

472 
	esùp_¢_ty³
 {

473 
	mSCTP_SN_TYPE_BASE
 = (1<<15),

474 
	mSCTP_ASSOC_CHANGE
,

475 
	mSCTP_PEER_ADDR_CHANGE
,

476 
	mSCTP_SEND_FAILED
,

477 
	mSCTP_REMOTE_ERROR
,

478 
	mSCTP_SHUTDOWN_EVENT
,

479 
	mSCTP_PARTIAL_DELIVERY_EVENT
,

480 
	mSCTP_ADAPTATION_INDICATION
,

481 
	mSCTP_AUTHENTICATION_INDICATION
,

482 
	mSCTP_SENDER_DRY_EVENT
,

492 
	esùp_¢_”rÜ
 {

493 
	mSCTP_FAILED_THRESHOLD
,

494 
	mSCTP_RECEIVED_SACK
,

495 
	mSCTP_HEARTBEAT_SUCCESS
,

496 
	mSCTP_RESPONSE_TO_USER_REQ
,

497 
	mSCTP_INTERNAL_ERROR
,

498 
	mSCTP_SHUTDOWN_GUARD_EXPIRES
,

499 
	mSCTP_PEER_FAULTY
,

500 } 
	tsùp_¢_”rÜ_t
;

509 
	ssùp_¹ošfo
 {

510 
sùp_assoc_t
 
	m¤to_assoc_id
;

511 
__u32
 
	m¤to_š™Ÿl
;

512 
__u32
 
	m¤to_max
;

513 
__u32
 
	m¤to_mš
;

522 
	ssùp_assoı¬ams
 {

523 
sùp_assoc_t
 
	m§soc_assoc_id
;

524 
__u16
 
	m§soc_asocmaxrxt
;

525 
__u16
 
	m§soc_numb”_³”_de¡š©iÚs
;

526 
__u32
 
	m§soc_³”_rwnd
;

527 
__u32
 
	m§soc_loÿl_rwnd
;

528 
__u32
 
	m§soc_cook›_liã
;

539 
	ssùp_£“½rim
 {

540 
sùp_assoc_t
 
	ms¥p_assoc_id
;

541 
sockaddr_¡Üage
 
	ms¥p_addr
;

542 } 
__©Œibu‹__
((
·cked
, 
®igÃd
(4)));

552 
	ssùp_´im
 {

553 
sùp_assoc_t
 
	ms¥_assoc_id
;

554 
sockaddr_¡Üage
 
	ms¥_addr
;

555 } 
__©Œibu‹__
((
·cked
, 
®igÃd
(4)));

563 
	ssùp_£d­tiÚ
 {

564 
__u32
 
	mssb_ad­tiÚ_šd
;

577 
	esùp_¥p_æags
 {

578 
	mSPP_HB_ENABLE
 = 1<<0,

579 
	mSPP_HB_DISABLE
 = 1<<1,

580 
	mSPP_HB
 = 
SPP_HB_ENABLE
 | 
SPP_HB_DISABLE
,

581 
	mSPP_HB_DEMAND
 = 1<<2,

582 
	mSPP_PMTUD_ENABLE
 = 1<<3,

583 
	mSPP_PMTUD_DISABLE
 = 1<<4,

584 
	mSPP_PMTUD
 = 
SPP_PMTUD_ENABLE
 | 
SPP_PMTUD_DISABLE
,

585 
	mSPP_SACKDELAY_ENABLE
 = 1<<5,

586 
	mSPP_SACKDELAY_DISABLE
 = 1<<6,

587 
	mSPP_SACKDELAY
 = 
SPP_SACKDELAY_ENABLE
 | 
SPP_SACKDELAY_DISABLE
,

588 
	mSPP_HB_TIME_IS_ZERO
 = 1<<7,

591 
	ssùp_·dd½¬ams
 {

592 
sùp_assoc_t
 
	m¥p_assoc_id
;

593 
sockaddr_¡Üage
 
	m¥p_add»ss
;

594 
__u32
 
	m¥p_hbš‹rv®
;

595 
__u16
 
	m¥p_·thmaxrxt
;

596 
__u32
 
	m¥p_·thmtu
;

597 
__u32
 
	m¥p_§ckd–ay
;

598 
__u32
 
	m¥p_æags
;

599 } 
__©Œibu‹__
((
·cked
, 
®igÃd
(4)));

608 
	ssùp_authchunk
 {

609 
__u8
 
	m§uth_chunk
;

618 
	ssùp_hmaÿlgo
 {

619 
__u32
 
	mshmac_num_id’ts
;

620 
__u16
 
	mshmac_id’ts
[];

629 
	ssùp_authkey
 {

630 
sùp_assoc_t
 
	msÿ_assoc_id
;

631 
__u16
 
	msÿ_keynumb”
;

632 
__u16
 
	msÿ_keyËngth
;

633 
__u8
 
	msÿ_key
[];

643 
	ssùp_authkeyid
 {

644 
sùp_assoc_t
 
	msÿù_assoc_id
;

645 
__u16
 
	msÿù_keynumb”
;

663 
	ssùp_§ck_šfo
 {

664 
sùp_assoc_t
 
	m§ck_assoc_id
;

665 
ušt32_t
 
	m§ck_d–ay
;

666 
ušt32_t
 
	m§ck_äeq
;

669 
	ssùp_assoc_v®ue
 {

670 
sùp_assoc_t
 
	massoc_id
;

671 
ušt32_t
 
	massoc_v®ue
;

683 
	ssùp_·ddršfo
 {

684 
sùp_assoc_t
 
	m¥šfo_assoc_id
;

685 
sockaddr_¡Üage
 
	m¥šfo_add»ss
;

686 
__s32
 
	m¥šfo_¡©e
;

687 
__u32
 
	m¥šfo_cwnd
;

688 
__u32
 
	m¥šfo_¤‰
;

689 
__u32
 
	m¥šfo_¹o
;

690 
__u32
 
	m¥šfo_mtu
;

691 } 
__©Œibu‹__
((
·cked
, 
®igÃd
(4)));

702 
	esùp_¥šfo_¡©e
 {

703 
	mSCTP_INACTIVE
,

704 
	mSCTP_PF
,

705 
	mSCTP_ACTIVE
,

706 
	mSCTP_UNCONFIRMED
,

707 
	mSCTP_UNKNOWN
 = 0xffff

719 
	ssùp_¡©us
 {

720 
sùp_assoc_t
 
	ms¡©_assoc_id
;

721 
__s32
 
	ms¡©_¡©e
;

722 
__u32
 
	ms¡©_rwnd
;

723 
__u16
 
	ms¡©_uÇckd©a
;

724 
__u16
 
	ms¡©_³ndd©a
;

725 
__u16
 
	ms¡©_š¡rms
;

726 
__u16
 
	ms¡©_out¡rms
;

727 
__u32
 
	ms¡©_äagm’tiÚ_pošt
;

728 
sùp_·ddršfo
 
	ms¡©_´im¬y
;

738 
	ssùp_authchunks
 {

739 
sùp_assoc_t
 
	mgauth_assoc_id
;

740 
__u32
 
	mgauth_numb”_of_chunks
;

741 
ušt8_t
 
	mgauth_chunks
[];

751 
	ssùp_assoc_ids
 {

752 
__u32
 
	mgaids_numb”_of_ids
;

753 
sùp_assoc_t
 
	mgaids_assoc_id
[];

762 
	ssùp_g‘addrs_Şd
 {

763 
sùp_assoc_t
 
	massoc_id
;

764 
	maddr_num
;

765 
sockaddr
 
__u£r
 *
	maddrs
;

767 
	ssùp_g‘addrs
 {

768 
sùp_assoc_t
 
	massoc_id
;

769 
__u32
 
	maddr_num
;

770 
__u8
 
	maddrs
[0];

775 
	esùp_msg_æags
 {

776 
	mMSG_NOTIFICATION
 = 0x8000,

777 
	#MSG_NOTIFICATION
 
MSG_NOTIFICATION


	)

786 
	#SCTP_BINDX_ADD_ADDR
 0x01

	)

787 
	#SCTP_BINDX_REM_ADDR
 0x02

	)

793 
sùp_assoc_t
 
	massocid
;

794 
	msd
;

795 } 
	tsùp_³–off_¬g_t
;

800 
	ssùp_·dd¹hlds
 {

801 
sùp_assoc_t
 
	m¥t_assoc_id
;

802 
sockaddr_¡Üage
 
	m¥t_add»ss
;

803 
__u16
 
	m¥t_·thmaxrxt
;

804 
__u16
 
	m¥t_·thpáhld
;

	@/usr/include/asm/param.h

1 
	~<asm-g’”ic/·¿m.h
>

	@/usr/include/linux/capability.h

13 #iâdeà
_LINUX_CAPABILITY_H


14 
	#_LINUX_CAPABILITY_H


	)

16 
	~<lšux/ty³s.h
>

18 
	gsk_¡ruù
;

31 
	#_LINUX_CAPABILITY_VERSION_1
 0x19980330

	)

32 
	#_LINUX_CAPABILITY_U32S_1
 1

	)

34 
	#_LINUX_CAPABILITY_VERSION_2
 0x20071026

	)

35 
	#_LINUX_CAPABILITY_U32S_2
 2

	)

37 
	#_LINUX_CAPABILITY_VERSION_3
 0x20080522

	)

38 
	#_LINUX_CAPABILITY_U32S_3
 2

	)

40 
	s__u£r_ÿp_h—d”_¡ruù
 {

41 
__u32
 
	mv”siÚ
;

42 
	mpid
;

43 } *
	tÿp_u£r_h—d”_t
;

45 
	s__u£r_ÿp_d©a_¡ruù
 {

46 
__u32
 
	mefãùive
;

47 
__u32
 
	m³rm™‹d
;

48 
__u32
 
	mšh”™abË
;

49 } *
	tÿp_u£r_d©a_t
;

52 
	#XATTR_CAPS_SUFFIX
 "ÿ·b™y"

	)

53 
	#XATTR_NAME_CAPS
 
XATTR_SECURITY_PREFIX
 
XATTR_CAPS_SUFFIX


	)

55 
	#VFS_CAP_REVISION_MASK
 0xFF000000

	)

56 
	#VFS_CAP_REVISION_SHIFT
 24

	)

57 
	#VFS_CAP_FLAGS_MASK
 ~
VFS_CAP_REVISION_MASK


	)

58 
	#VFS_CAP_FLAGS_EFFECTIVE
 0x000001

	)

60 
	#VFS_CAP_REVISION_1
 0x01000000

	)

61 
	#VFS_CAP_U32_1
 1

	)

62 
	#XATTR_CAPS_SZ_1
 ((
__Ë32
)*(1 + 2*
VFS_CAP_U32_1
))

	)

64 
	#VFS_CAP_REVISION_2
 0x02000000

	)

65 
	#VFS_CAP_U32_2
 2

	)

66 
	#XATTR_CAPS_SZ_2
 ((
__Ë32
)*(1 + 2*
VFS_CAP_U32_2
))

	)

68 
	#XATTR_CAPS_SZ
 
XATTR_CAPS_SZ_2


	)

69 
	#VFS_CAP_U32
 
VFS_CAP_U32_2


	)

70 
	#VFS_CAP_REVISION
 
VFS_CAP_REVISION_2


	)

72 
	svfs_ÿp_d©a
 {

73 
__Ë32
 
	mmagic_‘c
;

75 
__Ë32
 
	m³rm™‹d
;

76 
__Ë32
 
	mšh”™abË
;

77 } 
	md©a
[
VFS_CAP_U32
];

86 
	#_LINUX_CAPABILITY_VERSION
 
_LINUX_CAPABILITY_VERSION_1


	)

87 
	#_LINUX_CAPABILITY_U32S
 
_LINUX_CAPABILITY_U32S_1


	)

99 
	#CAP_CHOWN
 0

	)

105 
	#CAP_DAC_OVERRIDE
 1

	)

111 
	#CAP_DAC_READ_SEARCH
 2

	)

117 
	#CAP_FOWNER
 3

	)

126 
	#CAP_FSETID
 4

	)

132 
	#CAP_KILL
 5

	)

138 
	#CAP_SETGID
 6

	)

143 
	#CAP_SETUID
 7

	)

160 
	#CAP_SETPCAP
 8

	)

164 
	#CAP_LINUX_IMMUTABLE
 9

	)

169 
	#CAP_NET_BIND_SERVICE
 10

	)

173 
	#CAP_NET_BROADCAST
 11

	)

189 
	#CAP_NET_ADMIN
 12

	)

194 
	#CAP_NET_RAW
 13

	)

200 
	#CAP_IPC_LOCK
 14

	)

204 
	#CAP_IPC_OWNER
 15

	)

207 
	#CAP_SYS_MODULE
 16

	)

212 
	#CAP_SYS_RAWIO
 17

	)

216 
	#CAP_SYS_CHROOT
 18

	)

220 
	#CAP_SYS_PTRACE
 19

	)

224 
	#CAP_SYS_PACCT
 20

	)

264 
	#CAP_SYS_ADMIN
 21

	)

268 
	#CAP_SYS_BOOT
 22

	)

277 
	#CAP_SYS_NICE
 23

	)

291 
	#CAP_SYS_RESOURCE
 24

	)

297 
	#CAP_SYS_TIME
 25

	)

302 
	#CAP_SYS_TTY_CONFIG
 26

	)

306 
	#CAP_MKNOD
 27

	)

310 
	#CAP_LEASE
 28

	)

312 
	#CAP_AUDIT_WRITE
 29

	)

314 
	#CAP_AUDIT_CONTROL
 30

	)

316 
	#CAP_SETFCAP
 31

	)

324 
	#CAP_MAC_OVERRIDE
 32

	)

333 
	#CAP_MAC_ADMIN
 33

	)

335 
	#CAP_LAST_CAP
 
CAP_MAC_ADMIN


	)

337 
	#ÿp_v®id
(
x
è((xè>ğ0 && (xè<ğ
CAP_LAST_CAP
)

	)

343 
	#CAP_TO_INDEX
(
x
è((xè>> 5è

	)

344 
	#CAP_TO_MASK
(
x
è(1 << ((xè& 31)è

	)

	@/usr/include/linux/errno.h

1 #iâdeà
_LINUX_ERRNO_H


2 
	#_LINUX_ERRNO_H


	)

4 
	~<asm/”ºo.h
>

	@/usr/include/linux/fcntl.h

1 #iâdeà
_LINUX_FCNTL_H


2 
	#_LINUX_FCNTL_H


	)

4 
	~<asm/fú.h
>

6 
	#F_SETLEASE
 (
F_LINUX_SPECIFIC_BASE
 + 0)

	)

7 
	#F_GETLEASE
 (
F_LINUX_SPECIFIC_BASE
 + 1)

	)

13 
	#F_CANCELLK
 (
F_LINUX_SPECIFIC_BASE
 + 5)

	)

16 
	#F_DUPFD_CLOEXEC
 (
F_LINUX_SPECIFIC_BASE
 + 6)

	)

22 
	#F_NOTIFY
 (
F_LINUX_SPECIFIC_BASE
+2)

	)

27 
	#DN_ACCESS
 0x00000001

	)

28 
	#DN_MODIFY
 0x00000002

	)

29 
	#DN_CREATE
 0x00000004

	)

30 
	#DN_DELETE
 0x00000008

	)

31 
	#DN_RENAME
 0x00000010

	)

32 
	#DN_ATTRIB
 0x00000020

	)

33 
	#DN_MULTISHOT
 0x80000000

	)

35 
	#AT_FDCWD
 -100

	)

38 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

39 
	#AT_REMOVEDIR
 0x200

	)

41 
	#AT_SYMLINK_FOLLOW
 0x400

	)

42 
	#AT_NO_AUTOMOUNT
 0x800

	)

	@/usr/include/linux/icmpv6.h

1 #iâdeà
_LINUX_ICMPV6_H


2 
	#_LINUX_ICMPV6_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<asm/by‹Üd”.h
>

7 
	sicmp6hdr
 {

9 
__u8
 
	micmp6_ty³
;

10 
__u8
 
	micmp6_code
;

11 
__sum16
 
	micmp6_cksum
;

15 
__be32
 
	mun_d©a32
[1];

16 
__be16
 
	mun_d©a16
[2];

17 
__u8
 
	mun_d©a8
[4];

19 
	sicmpv6_echo
 {

20 
__be16
 
	mid’tif›r
;

21 
__be16
 
	m£qu’û
;

22 } 
	mu_echo
;

24 
	sicmpv6_nd_advt
 {

25 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

26 
__u32
 
	m»£rved
:5,

27 
	mov”ride
:1,

28 
	msŞic™ed
:1,

29 
	mrou‹r
:1,

30 
	m»£rved2
:24;

31 #–ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

32 
__u32
 
	mrou‹r
:1,

33 
	msŞic™ed
:1,

34 
	mov”ride
:1,

35 
	m»£rved
:29;

39 } 
	mu_nd_advt
;

41 
	sicmpv6_nd_¿
 {

42 
__u8
 
	mhİ_lim™
;

43 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

44 
__u8
 
	m»£rved
:3,

45 
	mrou‹r_´ef
:2,

46 
	mhome_ag’t
:1,

47 
	mÙh”
:1,

48 
	mmªaged
:1;

50 #–ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

51 
__u8
 
	mmªaged
:1,

52 
	mÙh”
:1,

53 
	mhome_ag’t
:1,

54 
	mrou‹r_´ef
:2,

55 
	m»£rved
:3;

59 
__be16
 
	m¹_liãtime
;

60 } 
	mu_nd_¿
;

62 } 
	micmp6_d©aun
;

64 
	#icmp6_id’tif›r
 
icmp6_d©aun
.
u_echo
.
id’tif›r


	)

65 
	#icmp6_£qu’û
 
icmp6_d©aun
.
u_echo
.
£qu’û


	)

66 
	#icmp6_poš‹r
 
icmp6_d©aun
.
un_d©a32
[0]

	)

67 
	#icmp6_mtu
 
icmp6_d©aun
.
un_d©a32
[0]

	)

68 
	#icmp6_unu£d
 
icmp6_d©aun
.
un_d©a32
[0]

	)

69 
	#icmp6_maxd–ay
 
icmp6_d©aun
.
un_d©a16
[0]

	)

70 
	#icmp6_rou‹r
 
icmp6_d©aun
.
u_nd_advt
.
rou‹r


	)

71 
	#icmp6_sŞic™ed
 
icmp6_d©aun
.
u_nd_advt
.
sŞic™ed


	)

72 
	#icmp6_ov”ride
 
icmp6_d©aun
.
u_nd_advt
.
ov”ride


	)

73 
	#icmp6_ndisüe£rved
 
icmp6_d©aun
.
u_nd_advt
.
»£rved


	)

74 
	#icmp6_hİ_lim™
 
icmp6_d©aun
.
u_nd_¿
.
hİ_lim™


	)

75 
	#icmp6_addrcÚf_mªaged
 
icmp6_d©aun
.
u_nd_¿
.
mªaged


	)

76 
	#icmp6_addrcÚf_Ùh”
 
icmp6_d©aun
.
u_nd_¿
.
Ùh”


	)

77 
	#icmp6_¹_liãtime
 
icmp6_d©aun
.
u_nd_¿
.
¹_liãtime


	)

78 
	#icmp6_rou‹r_´ef
 
icmp6_d©aun
.
u_nd_¿
.
rou‹r_´ef


	)

82 
	#ICMPV6_ROUTER_PREF_LOW
 0x3

	)

83 
	#ICMPV6_ROUTER_PREF_MEDIUM
 0x0

	)

84 
	#ICMPV6_ROUTER_PREF_HIGH
 0x1

	)

85 
	#ICMPV6_ROUTER_PREF_INVALID
 0x2

	)

87 
	#ICMPV6_DEST_UNREACH
 1

	)

88 
	#ICMPV6_PKT_TOOBIG
 2

	)

89 
	#ICMPV6_TIME_EXCEED
 3

	)

90 
	#ICMPV6_PARAMPROB
 4

	)

92 
	#ICMPV6_INFOMSG_MASK
 0x80

	)

94 
	#ICMPV6_ECHO_REQUEST
 128

	)

95 
	#ICMPV6_ECHO_REPLY
 129

	)

96 
	#ICMPV6_MGM_QUERY
 130

	)

97 
	#ICMPV6_MGM_REPORT
 131

	)

98 
	#ICMPV6_MGM_REDUCTION
 132

	)

100 
	#ICMPV6_NI_QUERY
 139

	)

101 
	#ICMPV6_NI_REPLY
 140

	)

103 
	#ICMPV6_MLD2_REPORT
 143

	)

105 
	#ICMPV6_DHAAD_REQUEST
 144

	)

106 
	#ICMPV6_DHAAD_REPLY
 145

	)

107 
	#ICMPV6_MOBILE_PREFIX_SOL
 146

	)

108 
	#ICMPV6_MOBILE_PREFIX_ADV
 147

	)

113 
	#ICMPV6_NOROUTE
 0

	)

114 
	#ICMPV6_ADM_PROHIBITED
 1

	)

115 
	#ICMPV6_NOT_NEIGHBOUR
 2

	)

116 
	#ICMPV6_ADDR_UNREACH
 3

	)

117 
	#ICMPV6_PORT_UNREACH
 4

	)

122 
	#ICMPV6_EXC_HOPLIMIT
 0

	)

123 
	#ICMPV6_EXC_FRAGTIME
 1

	)

128 
	#ICMPV6_HDR_FIELD
 0

	)

129 
	#ICMPV6_UNK_NEXTHDR
 1

	)

130 
	#ICMPV6_UNK_OPTION
 2

	)

136 
	#ICMPV6_FILTER
 1

	)

142 
	#ICMPV6_FILTER_BLOCK
 1

	)

143 
	#ICMPV6_FILTER_PASS
 2

	)

144 
	#ICMPV6_FILTER_BLOCKOTHERS
 3

	)

145 
	#ICMPV6_FILTER_PASSONLY
 4

	)

147 
	sicmp6_f‹r
 {

148 
__u32
 
	md©a
[8];

154 
	#MLD2_MODE_IS_INCLUDE
 1

	)

155 
	#MLD2_MODE_IS_EXCLUDE
 2

	)

156 
	#MLD2_CHANGE_TO_INCLUDE
 3

	)

157 
	#MLD2_CHANGE_TO_EXCLUDE
 4

	)

158 
	#MLD2_ALLOW_NEW_SOURCES
 5

	)

159 
	#MLD2_BLOCK_OLD_SOURCES
 6

	)

161 
	#MLD2_ALL_MCR_INIT
 { { { 0xff,0x02,0,0,0,0,0,0,0,0,0,0,0,0,0,0x16 } } }

	)

	@/usr/include/linux/in.h

18 #iâdeà
_LINUX_IN_H


19 
	#_LINUX_IN_H


	)

21 
	~<lšux/ty³s.h
>

22 
	~<lšux/sock‘.h
>

26 
	mIPPROTO_IP
 = 0,

27 
	#IPPROTO_IP
 
IPPROTO_IP


	)

28 
	mIPPROTO_ICMP
 = 1,

29 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

30 
	mIPPROTO_IGMP
 = 2,

31 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

32 
	mIPPROTO_IPIP
 = 4,

33 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

34 
	mIPPROTO_TCP
 = 6,

35 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

36 
	mIPPROTO_EGP
 = 8,

37 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

38 
	mIPPROTO_PUP
 = 12,

39 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

40 
	mIPPROTO_UDP
 = 17,

41 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

42 
	mIPPROTO_IDP
 = 22,

43 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

44 
	mIPPROTO_TP
 = 29,

45 
	#IPPROTO_TP
 
IPPROTO_TP


	)

46 
	mIPPROTO_DCCP
 = 33,

47 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

48 
	mIPPROTO_IPV6
 = 41,

49 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

50 
	mIPPROTO_RSVP
 = 46,

51 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

52 
	mIPPROTO_GRE
 = 47,

53 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

54 
	mIPPROTO_ESP
 = 50,

55 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

56 
	mIPPROTO_AH
 = 51,

57 
	#IPPROTO_AH
 
IPPROTO_AH


	)

58 
	mIPPROTO_MTP
 = 92,

59 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

60 
	mIPPROTO_BEETPH
 = 94,

61 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

62 
	mIPPROTO_ENCAP
 = 98,

63 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

64 
	mIPPROTO_PIM
 = 103,

65 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

66 
	mIPPROTO_COMP
 = 108,

67 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

68 
	mIPPROTO_SCTP
 = 132,

69 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

70 
	mIPPROTO_UDPLITE
 = 136,

71 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

72 
	mIPPROTO_RAW
 = 255,

73 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

74 
	mIPPROTO_MAX


79 
	sš_addr
 {

80 
__be32
 
	ms_addr
;

83 
	#IP_TOS
 1

	)

84 
	#IP_TTL
 2

	)

85 
	#IP_HDRINCL
 3

	)

86 
	#IP_OPTIONS
 4

	)

87 
	#IP_ROUTER_ALERT
 5

	)

88 
	#IP_RECVOPTS
 6

	)

89 
	#IP_RETOPTS
 7

	)

90 
	#IP_PKTINFO
 8

	)

91 
	#IP_PKTOPTIONS
 9

	)

92 
	#IP_MTU_DISCOVER
 10

	)

93 
	#IP_RECVERR
 11

	)

94 
	#IP_RECVTTL
 12

	)

95 
	#IP_RECVTOS
 13

	)

96 
	#IP_MTU
 14

	)

97 
	#IP_FREEBIND
 15

	)

98 
	#IP_IPSEC_POLICY
 16

	)

99 
	#IP_XFRM_POLICY
 17

	)

100 
	#IP_PASSSEC
 18

	)

101 
	#IP_TRANSPARENT
 19

	)

104 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

107 
	#IP_ORIGDSTADDR
 20

	)

108 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

110 
	#IP_MINTTL
 21

	)

113 
	#IP_PMTUDISC_DONT
 0

	)

114 
	#IP_PMTUDISC_WANT
 1

	)

115 
	#IP_PMTUDISC_DO
 2

	)

116 
	#IP_PMTUDISC_PROBE
 3

	)

121 
	#IP_PMTUDISC_INTERFACE
 4

	)

125 
	#IP_PMTUDISC_OMIT
 5

	)

127 
	#IP_MULTICAST_IF
 32

	)

128 
	#IP_MULTICAST_TTL
 33

	)

129 
	#IP_MULTICAST_LOOP
 34

	)

130 
	#IP_ADD_MEMBERSHIP
 35

	)

131 
	#IP_DROP_MEMBERSHIP
 36

	)

132 
	#IP_UNBLOCK_SOURCE
 37

	)

133 
	#IP_BLOCK_SOURCE
 38

	)

134 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

135 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

136 
	#IP_MSFILTER
 41

	)

137 
	#MCAST_JOIN_GROUP
 42

	)

138 
	#MCAST_BLOCK_SOURCE
 43

	)

139 
	#MCAST_UNBLOCK_SOURCE
 44

	)

140 
	#MCAST_LEAVE_GROUP
 45

	)

141 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

142 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

143 
	#MCAST_MSFILTER
 48

	)

144 
	#IP_MULTICAST_ALL
 49

	)

146 
	#MCAST_EXCLUDE
 0

	)

147 
	#MCAST_INCLUDE
 1

	)

150 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

151 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

155 
	s_m»q


157 
š_addr
 
	mimr_muÉŸddr
;

158 
š_addr
 
	mimr_š‹rçû
;

161 
	s_m»qn


163 
š_addr
 
	mimr_muÉŸddr
;

164 
š_addr
 
	mimr_add»ss
;

165 
	mimr_ifšdex
;

168 
	s_m»q_sourû
 {

169 
__be32
 
	mimr_muÉŸddr
;

170 
__be32
 
	mimr_š‹rçû
;

171 
__be32
 
	mimr_sourûaddr
;

174 
	s_msf‹r
 {

175 
__be32
 
	mimsf_muÉŸddr
;

176 
__be32
 
	mimsf_š‹rçû
;

177 
__u32
 
	mimsf_fmode
;

178 
__u32
 
	mimsf_num¤c
;

179 
__be32
 
	mimsf_¦i¡
[1];

182 
	#IP_MSFILTER_SIZE
(
num¤c
) \

183 ((
_msf‹r
è- (
__u32
) \

184 + (
num¤c
è* (
__u32
))

	)

186 
	sgroup_»q


188 
__u32
 
	mgr_š‹rçû
;

189 
__k”Ãl_sockaddr_¡Üage
 
	mgr_group
;

192 
	sgroup_sourû_»q


194 
__u32
 
	mg¤_š‹rçû
;

195 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_group
;

196 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_sourû
;

199 
	sgroup_f‹r


201 
__u32
 
	mgf_š‹rçû
;

202 
__k”Ãl_sockaddr_¡Üage
 
	mgf_group
;

203 
__u32
 
	mgf_fmode
;

204 
__u32
 
	mgf_num¤c
;

205 
__k”Ãl_sockaddr_¡Üage
 
	mgf_¦i¡
[1];

208 
	#GROUP_FILTER_SIZE
(
num¤c
) \

209 ((
group_f‹r
è- (
__k”Ãl_sockaddr_¡Üage
) \

210 + (
num¤c
è* (
__k”Ãl_sockaddr_¡Üage
))

	)

212 
	sš_pktšfo


214 
	mi_ifšdex
;

215 
š_addr
 
	mi_¥ec_d¡
;

216 
š_addr
 
	mi_addr
;

220 
	#__SOCK_SIZE__
 16

	)

221 
	ssockaddr_š
 {

222 
§_çmy_t
 
	msš_çmy
;

223 
__be16
 
	msš_pÜt
;

224 
š_addr
 
	msš_addr
;

227 
	m__·d
[
__SOCK_SIZE__
 - () -

228 (è- (
š_addr
)];

230 
	#sš_z”o
 
__·d


	)

238 
	#IN_CLASSA
(
a
è((((è×)è& 0x80000000è=ğ0)

	)

239 
	#IN_CLASSA_NET
 0xff000000

	)

240 
	#IN_CLASSA_NSHIFT
 24

	)

241 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

242 
	#IN_CLASSA_MAX
 128

	)

244 
	#IN_CLASSB
(
a
è((((è×)è& 0xc0000000è=ğ0x80000000)

	)

245 
	#IN_CLASSB_NET
 0xffff0000

	)

246 
	#IN_CLASSB_NSHIFT
 16

	)

247 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

248 
	#IN_CLASSB_MAX
 65536

	)

250 
	#IN_CLASSC
(
a
è((((è×)è& 0xe0000000è=ğ0xc0000000)

	)

251 
	#IN_CLASSC_NET
 0xffffff00

	)

252 
	#IN_CLASSC_NSHIFT
 8

	)

253 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

255 
	#IN_CLASSD
(
a
è((((è×)è& 0xf0000000è=ğ0xe0000000)

	)

256 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

257 
	#IN_MULTICAST_NET
 0xF0000000

	)

259 
	#IN_EXPERIMENTAL
(
a
è((((è×)è& 0xf0000000è=ğ0xf0000000)

	)

260 
	#IN_BADCLASS
(
a
è
	`IN_EXPERIMENTAL
(×))

	)

263 
	#INADDR_ANY
 ((è0x00000000)

	)

266 
	#INADDR_BROADCAST
 ((è0xffffffff)

	)

269 
	#INADDR_NONE
 ((è0xffffffff)

	)

272 
	#IN_LOOPBACKNET
 127

	)

275 
	#INADDR_LOOPBACK
 0x7f000001

	)

276 
	#IN_LOOPBACK
(
a
è((((è×)è& 0xff000000è=ğ0x7f000000)

	)

279 
	#INADDR_UNSPEC_GROUP
 0xe0000000U

	)

280 
	#INADDR_ALLHOSTS_GROUP
 0xe0000001U

	)

281 
	#INADDR_ALLRTRS_GROUP
 0xe0000002U

	)

282 
	#INADDR_MAX_LOCAL_GROUP
 0xe00000ffU

	)

286 
	~<asm/by‹Üd”.h
>

	@/usr/include/linux/in6.h

21 #iâdeà
_LINUX_IN6_H


22 
	#_LINUX_IN6_H


	)

23 
	#_UAPI_LINUX_IN6_H


	)

25 
	~<lšux/ty³s.h
>

26 
	~<lšux/libc-com·t.h
>

32 #ià
__UAPI_DEF_IN6_ADDR


33 
	sš6_addr
 {

35 
__u8
 
	mu6_addr8
[16];

36 #ià
__UAPI_DEF_IN6_ADDR_ALT


37 
__be16
 
	mu6_addr16
[8];

38 
__be32
 
	mu6_addr32
[4];

40 } 
	mš6_u
;

41 
	#s6_addr
 
š6_u
.
u6_addr8


	)

42 #ià
__UAPI_DEF_IN6_ADDR_ALT


43 
	#s6_addr16
 
š6_u
.
u6_addr16


	)

44 
	#s6_addr32
 
š6_u
.
u6_addr32


	)

54 #ià
__UAPI_DEF_SOCKADDR_IN6


55 
	ssockaddr_š6
 {

56 
	msš6_çmy
;

57 
__be16
 
	msš6_pÜt
;

58 
__be32
 
	msš6_æowšfo
;

59 
š6_addr
 
	msš6_addr
;

60 
__u32
 
	msš6_scİe_id
;

64 #ià
__UAPI_DEF_IPV6_MREQ


65 
	sv6_m»q
 {

67 
š6_addr
 
	mv6mr_muÉŸddr
;

70 
	mv6mr_ifšdex
;

74 
	#v6mr_aÿddr
 
v6mr_muÉŸddr


	)

76 
	sš6_æowÏb–_»q


78 
š6_addr
 
	mær_d¡
;

79 
__be32
 
	mær_Ïb–
;

80 
__u8
 
	mær_aùiÚ
;

81 
__u8
 
	mær_sh¬e
;

82 
__u16
 
	mær_æags
;

83 
__u16
 
	mær_expœes
;

84 
__u16
 
	mær_lšg”
;

85 
__u32
 
	m__ær_·d
;

89 
	#IPV6_FL_A_GET
 0

	)

90 
	#IPV6_FL_A_PUT
 1

	)

91 
	#IPV6_FL_A_RENEW
 2

	)

93 
	#IPV6_FL_F_CREATE
 1

	)

94 
	#IPV6_FL_F_EXCL
 2

	)

96 
	#IPV6_FL_S_NONE
 0

	)

97 
	#IPV6_FL_S_EXCL
 1

	)

98 
	#IPV6_FL_S_PROCESS
 2

	)

99 
	#IPV6_FL_S_USER
 3

	)

100 
	#IPV6_FL_S_ANY
 255

	)

111 
	#IPV6_FLOWINFO_FLOWLABEL
 0x000fffff

	)

112 
	#IPV6_FLOWINFO_PRIORITY
 0x0ff00000

	)

115 
	#IPV6_PRIORITY_UNCHARACTERIZED
 0x0000

	)

116 
	#IPV6_PRIORITY_FILLER
 0x0100

	)

117 
	#IPV6_PRIORITY_UNATTENDED
 0x0200

	)

118 
	#IPV6_PRIORITY_RESERVED1
 0x0300

	)

119 
	#IPV6_PRIORITY_BULK
 0x0400

	)

120 
	#IPV6_PRIORITY_RESERVED2
 0x0500

	)

121 
	#IPV6_PRIORITY_INTERACTIVE
 0x0600

	)

122 
	#IPV6_PRIORITY_CONTROL
 0x0700

	)

123 
	#IPV6_PRIORITY_8
 0x0800

	)

124 
	#IPV6_PRIORITY_9
 0x0900

	)

125 
	#IPV6_PRIORITY_10
 0x0a00

	)

126 
	#IPV6_PRIORITY_11
 0x0b00

	)

127 
	#IPV6_PRIORITY_12
 0x0c00

	)

128 
	#IPV6_PRIORITY_13
 0x0d00

	)

129 
	#IPV6_PRIORITY_14
 0x0e00

	)

130 
	#IPV6_PRIORITY_15
 0x0f00

	)

135 #ià
__UAPI_DEF_IPPROTO_V6


136 
	#IPPROTO_HOPOPTS
 0

	)

137 
	#IPPROTO_ROUTING
 43

	)

138 
	#IPPROTO_FRAGMENT
 44

	)

139 
	#IPPROTO_ICMPV6
 58

	)

140 
	#IPPROTO_NONE
 59

	)

141 
	#IPPROTO_DSTOPTS
 60

	)

142 
	#IPPROTO_MH
 135

	)

148 
	#IPV6_TLV_PAD0
 0

	)

149 
	#IPV6_TLV_PADN
 1

	)

150 
	#IPV6_TLV_ROUTERALERT
 5

	)

151 
	#IPV6_TLV_JUMBO
 194

	)

152 
	#IPV6_TLV_HAO
 201

	)

158 
	#IPV6_ADDRFORM
 1

	)

159 
	#IPV6_2292PKTINFO
 2

	)

160 
	#IPV6_2292HOPOPTS
 3

	)

161 
	#IPV6_2292DSTOPTS
 4

	)

162 
	#IPV6_2292RTHDR
 5

	)

163 
	#IPV6_2292PKTOPTIONS
 6

	)

164 
	#IPV6_CHECKSUM
 7

	)

165 
	#IPV6_2292HOPLIMIT
 8

	)

166 
	#IPV6_NEXTHOP
 9

	)

167 
	#IPV6_AUTHHDR
 10

	)

168 
	#IPV6_FLOWINFO
 11

	)

170 
	#IPV6_UNICAST_HOPS
 16

	)

171 
	#IPV6_MULTICAST_IF
 17

	)

172 
	#IPV6_MULTICAST_HOPS
 18

	)

173 
	#IPV6_MULTICAST_LOOP
 19

	)

174 
	#IPV6_ADD_MEMBERSHIP
 20

	)

175 
	#IPV6_DROP_MEMBERSHIP
 21

	)

176 
	#IPV6_ROUTER_ALERT
 22

	)

177 
	#IPV6_MTU_DISCOVER
 23

	)

178 
	#IPV6_MTU
 24

	)

179 
	#IPV6_RECVERR
 25

	)

180 
	#IPV6_V6ONLY
 26

	)

181 
	#IPV6_JOIN_ANYCAST
 27

	)

182 
	#IPV6_LEAVE_ANYCAST
 28

	)

185 
	#IPV6_PMTUDISC_DONT
 0

	)

186 
	#IPV6_PMTUDISC_WANT
 1

	)

187 
	#IPV6_PMTUDISC_DO
 2

	)

188 
	#IPV6_PMTUDISC_PROBE
 3

	)

192 
	#IPV6_PMTUDISC_INTERFACE
 4

	)

196 
	#IPV6_PMTUDISC_OMIT
 5

	)

199 
	#IPV6_FLOWLABEL_MGR
 32

	)

200 
	#IPV6_FLOWINFO_SEND
 33

	)

202 
	#IPV6_IPSEC_POLICY
 34

	)

203 
	#IPV6_XFRM_POLICY
 35

	)

224 
	#IPV6_RECVPKTINFO
 49

	)

225 
	#IPV6_PKTINFO
 50

	)

226 
	#IPV6_RECVHOPLIMIT
 51

	)

227 
	#IPV6_HOPLIMIT
 52

	)

228 
	#IPV6_RECVHOPOPTS
 53

	)

229 
	#IPV6_HOPOPTS
 54

	)

230 
	#IPV6_RTHDRDSTOPTS
 55

	)

231 
	#IPV6_RECVRTHDR
 56

	)

232 
	#IPV6_RTHDR
 57

	)

233 
	#IPV6_RECVDSTOPTS
 58

	)

234 
	#IPV6_DSTOPTS
 59

	)

236 
	#IPV6_RECVPATHMTU
 60

	)

237 
	#IPV6_PATHMTU
 61

	)

238 
	#IPV6_DONTFRAG
 62

	)

239 
	#IPV6_USE_MIN_MTU
 63

	)

255 
	#IPV6_RECVTCLASS
 66

	)

256 
	#IPV6_TCLASS
 67

	)

269 
	#IPV6_ADDR_PREFERENCES
 72

	)

271 
	#IPV6_PREFER_SRC_TMP
 0x0001

	)

272 
	#IPV6_PREFER_SRC_PUBLIC
 0x0002

	)

273 
	#IPV6_PREFER_SRC_PUBTMP_DEFAULT
 0x0100

	)

274 
	#IPV6_PREFER_SRC_COA
 0x0004

	)

275 
	#IPV6_PREFER_SRC_HOME
 0x0400

	)

276 
	#IPV6_PREFER_SRC_CGA
 0x0008

	)

277 
	#IPV6_PREFER_SRC_NONCGA
 0x0800

	)

279 
	#IPV6_ORIGDSTADDR
 74

	)

280 
	#IPV6_RECVORIGDSTADDR
 
IPV6_ORIGDSTADDR


	)

281 
	#IPV6_TRANSPARENT
 75

	)

284 
	#IPV6_MINHOPCOUNT
 73

	)

	@/usr/include/linux/ip.h

17 #iâdeà
_LINUX_IP_H


18 
	#_LINUX_IP_H


	)

19 
	~<lšux/ty³s.h
>

20 
	~<asm/by‹Üd”.h
>

22 
	#IPTOS_TOS_MASK
 0x1E

	)

23 
	#IPTOS_TOS
(
tos
è(Ños)&
IPTOS_TOS_MASK
)

	)

24 
	#IPTOS_LOWDELAY
 0x10

	)

25 
	#IPTOS_THROUGHPUT
 0x08

	)

26 
	#IPTOS_RELIABILITY
 0x04

	)

27 
	#IPTOS_MINCOST
 0x02

	)

29 
	#IPTOS_PREC_MASK
 0xE0

	)

30 
	#IPTOS_PREC
(
tos
è(Ños)&
IPTOS_PREC_MASK
)

	)

31 
	#IPTOS_PREC_NETCONTROL
 0xe0

	)

32 
	#IPTOS_PREC_INTERNETCONTROL
 0xc0

	)

33 
	#IPTOS_PREC_CRITIC_ECP
 0xa0

	)

34 
	#IPTOS_PREC_FLASHOVERRIDE
 0x80

	)

35 
	#IPTOS_PREC_FLASH
 0x60

	)

36 
	#IPTOS_PREC_IMMEDIATE
 0x40

	)

37 
	#IPTOS_PREC_PRIORITY
 0x20

	)

38 
	#IPTOS_PREC_ROUTINE
 0x00

	)

42 
	#IPOPT_COPY
 0x80

	)

43 
	#IPOPT_CLASS_MASK
 0x60

	)

44 
	#IPOPT_NUMBER_MASK
 0x1f

	)

46 
	#IPOPT_COPIED
(
o
è((o)&
IPOPT_COPY
)

	)

47 
	#IPOPT_CLASS
(
o
è((o)&
IPOPT_CLASS_MASK
)

	)

48 
	#IPOPT_NUMBER
(
o
è((o)&
IPOPT_NUMBER_MASK
)

	)

50 
	#IPOPT_CONTROL
 0x00

	)

51 
	#IPOPT_RESERVED1
 0x20

	)

52 
	#IPOPT_MEASUREMENT
 0x40

	)

53 
	#IPOPT_RESERVED2
 0x60

	)

55 
	#IPOPT_END
 (0 |
IPOPT_CONTROL
)

	)

56 
	#IPOPT_NOOP
 (1 |
IPOPT_CONTROL
)

	)

57 
	#IPOPT_SEC
 (2 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

58 
	#IPOPT_LSRR
 (3 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

59 
	#IPOPT_TIMESTAMP
 (4 |
IPOPT_MEASUREMENT
)

	)

60 
	#IPOPT_CIPSO
 (6 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

61 
	#IPOPT_RR
 (7 |
IPOPT_CONTROL
)

	)

62 
	#IPOPT_SID
 (8 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

63 
	#IPOPT_SSRR
 (9 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

64 
	#IPOPT_RA
 (20|
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

66 
	#IPVERSION
 4

	)

67 
	#MAXTTL
 255

	)

68 
	#IPDEFTTL
 64

	)

70 
	#IPOPT_OPTVAL
 0

	)

71 
	#IPOPT_OLEN
 1

	)

72 
	#IPOPT_OFFSET
 2

	)

73 
	#IPOPT_MINOFF
 4

	)

74 
	#MAX_IPOPTLEN
 40

	)

75 
	#IPOPT_NOP
 
IPOPT_NOOP


	)

76 
	#IPOPT_EOL
 
IPOPT_END


	)

77 
	#IPOPT_TS
 
IPOPT_TIMESTAMP


	)

79 
	#IPOPT_TS_TSONLY
 0

	)

80 
	#IPOPT_TS_TSANDADDR
 1

	)

81 
	#IPOPT_TS_PRESPEC
 3

	)

83 
	#IPV4_BEET_PHMAXLEN
 8

	)

85 
	shdr
 {

86 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

87 
__u8
 
	mihl
:4,

88 
	mv”siÚ
:4;

89 #–ià
defšed
 (
__BIG_ENDIAN_BITFIELD
)

90 
__u8
 
	mv”siÚ
:4,

91 
	mihl
:4;

95 
__u8
 
	mtos
;

96 
__be16
 
	mtÙ_Ën
;

97 
__be16
 
	mid
;

98 
__be16
 
	mäag_off
;

99 
__u8
 
	m‰l
;

100 
__u8
 
	m´ÙocŞ
;

101 
__sum16
 
	mcheck
;

102 
__be32
 
	m§ddr
;

103 
__be32
 
	mdaddr
;

108 
	s_auth_hdr
 {

109 
__u8
 
	mÃxthdr
;

110 
__u8
 
	mhd¾’
;

111 
__be16
 
	m»£rved
;

112 
__be32
 
	m¥i
;

113 
__be32
 
	m£q_no
;

114 
__u8
 
	mauth_d©a
[0];

117 
	s_e¥_hdr
 {

118 
__be32
 
	m¥i
;

119 
__be32
 
	m£q_no
;

120 
__u8
 
	m’c_d©a
[0];

123 
	s_comp_hdr
 {

124 
__u8
 
	mÃxthdr
;

125 
__u8
 
	mæags
;

126 
__be16
 
	mıi
;

129 
	s_b“t_phdr
 {

130 
__u8
 
	mÃxthdr
;

131 
__u8
 
	mhd¾’
;

132 
__u8
 
	m·dËn
;

133 
__u8
 
	m»£rved
;

	@/usr/include/linux/ipsec.h

1 #iâdeà
_LINUX_IPSEC_H


2 
	#_LINUX_IPSEC_H


	)

6 
	~<lšux/pfkeyv2.h
>

8 
	#IPSEC_PORT_ANY
 0

	)

9 
	#IPSEC_ULPROTO_ANY
 255

	)

10 
	#IPSEC_PROTO_ANY
 255

	)

13 
	mIPSEC_MODE_ANY
 = 0,

14 
	mIPSEC_MODE_TRANSPORT
 = 1,

15 
	mIPSEC_MODE_TUNNEL
 = 2,

16 
	mIPSEC_MODE_BEET
 = 3

20 
	mIPSEC_DIR_ANY
 = 0,

21 
	mIPSEC_DIR_INBOUND
 = 1,

22 
	mIPSEC_DIR_OUTBOUND
 = 2,

23 
	mIPSEC_DIR_FWD
 = 3,

24 
	mIPSEC_DIR_MAX
 = 4,

25 
	mIPSEC_DIR_INVALID
 = 5

29 
	mIPSEC_POLICY_DISCARD
 = 0,

30 
	mIPSEC_POLICY_NONE
 = 1,

31 
	mIPSEC_POLICY_IPSEC
 = 2,

32 
	mIPSEC_POLICY_ENTRUST
 = 3,

33 
	mIPSEC_POLICY_BYPASS
 = 4

37 
	mIPSEC_LEVEL_DEFAULT
 = 0,

38 
	mIPSEC_LEVEL_USE
 = 1,

39 
	mIPSEC_LEVEL_REQUIRE
 = 2,

40 
	mIPSEC_LEVEL_UNIQUE
 = 3

43 
	#IPSEC_MANUAL_REQID_MAX
 0x3fff

	)

45 
	#IPSEC_REPLAYWSIZE
 32

	)

	@/usr/include/linux/ipv6.h

1 #iâdeà
_IPV6_H


2 
	#_IPV6_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/š6.h
>

6 
	~<asm/by‹Üd”.h
>

10 
	#IPV6_MIN_MTU
 1280

	)

19 
	sš6_pktšfo
 {

20 
š6_addr
 
	mi6_addr
;

21 
	mi6_ifšdex
;

25 
	sš6_iäeq
 {

26 
š6_addr
 
	miä6_addr
;

27 
__u32
 
	miä6_´efixËn
;

28 
	miä6_ifšdex
;

31 
	#IPV6_SRCRT_STRICT
 0x01

	)

32 
	#IPV6_SRCRT_TYPE_0
 0

	)

33 
	#IPV6_SRCRT_TYPE_2
 2

	)

38 
	sv6_¹_hdr
 {

39 
__u8
 
	mÃxthdr
;

40 
__u8
 
	mhd¾’
;

41 
__u8
 
	mty³
;

42 
__u8
 
	m£gm’ts_Ëá
;

51 
	sv6_İt_hdr
 {

52 
__u8
 
	mÃxthdr
;

53 
__u8
 
	mhd¾’
;

57 } 
__©Œibu‹__
 ((
·cked
));

59 
	#v6_de¡İt_hdr
 
v6_İt_hdr


	)

60 
	#v6_hİİt_hdr
 
v6_İt_hdr


	)

67 
	s¹0_hdr
 {

68 
v6_¹_hdr
 
	m¹_hdr
;

69 
__u32
 
	m»£rved
;

70 
š6_addr
 
	maddr
[0];

72 
	#¹0_ty³
 
¹_hdr
.
ty³


	)

79 
	s¹2_hdr
 {

80 
v6_¹_hdr
 
	m¹_hdr
;

81 
__u32
 
	m»£rved
;

82 
š6_addr
 
	maddr
;

84 
	#¹2_ty³
 
¹_hdr
.
ty³


	)

91 
	sv6_de¡İt_hao
 {

92 
__u8
 
	mty³
;

93 
__u8
 
	mËngth
;

94 
š6_addr
 
	maddr
;

95 } 
__©Œibu‹__
 ((
__·cked__
));

104 
	sv6hdr
 {

105 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

106 
__u8
 
	m´iÜ™y
:4,

107 
	mv”siÚ
:4;

108 #–ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

109 
__u8
 
	mv”siÚ
:4,

110 
	m´iÜ™y
:4;

114 
__u8
 
	mæow_lbl
[3];

116 
__be16
 
	m·ylßd_Ën
;

117 
__u8
 
	mÃxthdr
;

118 
__u8
 
	mhİ_lim™
;

120 
š6_addr
 
	m§ddr
;

121 
š6_addr
 
	mdaddr
;

127 
	mDEVCONF_FORWARDING
 = 0,

128 
	mDEVCONF_HOPLIMIT
,

129 
	mDEVCONF_MTU6
,

130 
	mDEVCONF_ACCEPT_RA
,

131 
	mDEVCONF_ACCEPT_REDIRECTS
,

132 
	mDEVCONF_AUTOCONF
,

133 
	mDEVCONF_DAD_TRANSMITS
,

134 
	mDEVCONF_RTR_SOLICITS
,

135 
	mDEVCONF_RTR_SOLICIT_INTERVAL
,

136 
	mDEVCONF_RTR_SOLICIT_DELAY
,

137 
	mDEVCONF_USE_TEMPADDR
,

138 
	mDEVCONF_TEMP_VALID_LFT
,

139 
	mDEVCONF_TEMP_PREFERED_LFT
,

140 
	mDEVCONF_REGEN_MAX_RETRY
,

141 
	mDEVCONF_MAX_DESYNC_FACTOR
,

142 
	mDEVCONF_MAX_ADDRESSES
,

143 
	mDEVCONF_FORCE_MLD_VERSION
,

144 
	mDEVCONF_ACCEPT_RA_DEFRTR
,

145 
	mDEVCONF_ACCEPT_RA_PINFO
,

146 
	mDEVCONF_ACCEPT_RA_RTR_PREF
,

147 
	mDEVCONF_RTR_PROBE_INTERVAL
,

148 
	mDEVCONF_ACCEPT_RA_RT_INFO_MAX_PLEN
,

149 
	mDEVCONF_PROXY_NDP
,

150 
	mDEVCONF_OPTIMISTIC_DAD
,

151 
	mDEVCONF_ACCEPT_SOURCE_ROUTE
,

152 
	mDEVCONF_MC_FORWARDING
,

153 
	mDEVCONF_DISABLE_IPV6
,

154 
	mDEVCONF_ACCEPT_DAD
,

155 
	mDEVCONF_MAX


	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

10 
	#SI_LOAD_SHIFT
 16

	)

11 
	ssysšfo
 {

12 
	mu±ime
;

13 
	mlßds
[3];

14 
	mtÙ®¿m
;

15 
	mä“¿m
;

16 
	msh¬ed¿m
;

17 
	mbufã¼am
;

18 
	mtÙ®sw­
;

19 
	mä“sw­
;

20 
	m´ocs
;

21 
	m·d
;

22 
	mtÙ®high
;

23 
	mä“high
;

24 
	mmem_un™
;

25 
	m_f
[20-2*()-()];

29 
	#BUILD_BUG_ON
(
cÚd™iÚ
è(()
	`BUILD_BUG_ON_ZERO
(cÚd™iÚ))

	)

32 
	#MAYBE_BUILD_BUG_ON
(
cÚd
è(()([1 - 2 * !!(cÚd)]))

	)

35 
	#BUILD_BUG_ON_NOT_POWER_OF_2
(
n
) \

36 
	`BUILD_BUG_ON
((
n
è=ğ0 || ((Òè& (Òè- 1)è!ğ0))

	)

42 
	#BUILD_BUG_ON_ZERO
(
e
è((¡ruù { :-!!Ó); }))

	)

43 
	#BUILD_BUG_ON_NULL
(
e
è((*)(¡ruù { :-!!Ó); }))

	)

46 
	#__FUNCTION__
 (
__func__
)

	)

49 #ifdeà
CONFIG_NUMA


50 
	#NUMA_BUILD
 1

	)

52 
	#NUMA_BUILD
 0

	)

56 #ifdeà
CONFIG_COMPACTION


57 
	#COMPACTION_BUILD
 1

	)

59 
	#COMPACTION_BUILD
 0

	)

63 #ifdeà
CONFIG_FTRACE_MCOUNT_RECORD


64 
	#REBUILD_DUE_TO_FTRACE_MCOUNT_RECORD


	)

67 
	gmoduË
;

69 
m¬k_h¬dw¬e_unsuµÜ‹d
(cÚ¡ *
msg
);

70 
m¬k_‹ch_´ev›w
(cÚ¡ *
msg
, 
moduË
 *
mod
);

72 #iâdeà
´_fmt


73 
	#´_fmt
(
fmt
è
	)
fmt

	@/usr/include/linux/net.h

18 #iâdeà
_LINUX_NET_H


19 
	#_LINUX_NET_H


	)

21 
	~<lšux/sock‘.h
>

22 
	~<asm/sock‘.h
>

24 
	#NPROTO
 
AF_MAX


	)

26 
	#SYS_SOCKET
 1

	)

27 
	#SYS_BIND
 2

	)

28 
	#SYS_CONNECT
 3

	)

29 
	#SYS_LISTEN
 4

	)

30 
	#SYS_ACCEPT
 5

	)

31 
	#SYS_GETSOCKNAME
 6

	)

32 
	#SYS_GETPEERNAME
 7

	)

33 
	#SYS_SOCKETPAIR
 8

	)

34 
	#SYS_SEND
 9

	)

35 
	#SYS_RECV
 10

	)

36 
	#SYS_SENDTO
 11

	)

37 
	#SYS_RECVFROM
 12

	)

38 
	#SYS_SHUTDOWN
 13

	)

39 
	#SYS_SETSOCKOPT
 14

	)

40 
	#SYS_GETSOCKOPT
 15

	)

41 
	#SYS_SENDMSG
 16

	)

42 
	#SYS_RECVMSG
 17

	)

43 
	#SYS_ACCEPT4
 18

	)

44 
	#SYS_RECVMMSG
 19

	)

45 
	#SYS_SENDMMSG
 20

	)

48 
	mSS_FREE
 = 0,

49 
	mSS_UNCONNECTED
,

50 
	mSS_CONNECTING
,

51 
	mSS_CONNECTED
,

52 
	mSS_DISCONNECTING


53 } 
	tsock‘_¡©e
;

55 
	#__SO_ACCEPTCON
 (1 << 16è

	)

	@/usr/include/linux/netdevice.h

25 #iâdeà
_LINUX_NETDEVICE_H


26 
	#_LINUX_NETDEVICE_H


	)

28 
	~<lšux/if.h
>

29 
	~<lšux/if_‘h”.h
>

30 
	~<lšux/if_·ck‘.h
>

31 
	~<lšux/if_lšk.h
>

34 
	#MAX_ADDR_LEN
 32

	)

40 
	mIF_PORT_UNKNOWN
 = 0,

41 
	mIF_PORT_10BASE2
,

42 
	mIF_PORT_10BASET
,

43 
	mIF_PORT_AUI
,

44 
	mIF_PORT_100BASET
,

45 
	mIF_PORT_100BASETX
,

46 
	mIF_PORT_100BASEFX


	@/usr/include/linux/poll.h

1 #iâdeà
_LINUX_POLL_H


2 
	#_LINUX_POLL_H


	)

4 
	~<asm/pŞl.h
>

	@/usr/include/linux/random.h

7 #iâdeà
_LINUX_RANDOM_H


8 
	#_LINUX_RANDOM_H


	)

10 
	~<lšux/ty³s.h
>

11 
	~<lšux/ioùl.h
>

12 
	~<lšux/œqÄ.h
>

17 
	#RNDGETENTCNT
 
	`_IOR
Ğ'R', 0x00, )

	)

20 
	#RNDADDTOENTCNT
 
	`_IOW
Ğ'R', 0x01, )

	)

23 
	#RNDGETPOOL
 
	`_IOR
Ğ'R', 0x02, [2] )

	)

29 
	#RNDADDENTROPY
 
	`_IOW
Ğ'R', 0x03, [2] )

	)

32 
	#RNDZAPENTCNT
 
	`_IO
Ğ'R', 0x04 )

	)

35 
	#RNDCLEARPOOL
 
	`_IO
Ğ'R', 0x06 )

	)

37 
	s¿nd_poŞ_šfo
 {

38 
	m’Œİy_couÁ
;

39 
	mbuf_size
;

40 
__u32
 
	mbuf
[0];

43 
	sºd_¡©e
 {

44 
__u32
 
	ms1
, 
	ms2
, 
	ms3
;

	@/usr/include/linux/sched.h

1 #iâdeà
_LINUX_SCHED_H


2 
	#_LINUX_SCHED_H


	)

7 
	#CSIGNAL
 0x000000fà

	)

8 
	#CLONE_VM
 0x00000100

	)

9 
	#CLONE_FS
 0x00000200

	)

10 
	#CLONE_FILES
 0x00000400

	)

11 
	#CLONE_SIGHAND
 0x00000800

	)

12 
	#CLONE_PTRACE
 0x00002000

	)

13 
	#CLONE_VFORK
 0x00004000

	)

14 
	#CLONE_PARENT
 0x00008000

	)

15 
	#CLONE_THREAD
 0x00010000

	)

16 
	#CLONE_NEWNS
 0x00020000

	)

17 
	#CLONE_SYSVSEM
 0x00040000

	)

18 
	#CLONE_SETTLS
 0x00080000

	)

19 
	#CLONE_PARENT_SETTID
 0x00100000

	)

20 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

21 
	#CLONE_DETACHED
 0x00400000

	)

22 
	#CLONE_UNTRACED
 0x00800000

	)

23 
	#CLONE_CHILD_SETTID
 0x01000000

	)

24 
	#CLONE_STOPPED
 0x02000000

	)

25 
	#CLONE_NEWUTS
 0x04000000

	)

26 
	#CLONE_NEWIPC
 0x08000000

	)

27 
	#CLONE_NEWUSER
 0x10000000

	)

28 
	#CLONE_NEWPID
 0x20000000

	)

29 
	#CLONE_NEWNET
 0x40000000

	)

30 
	#CLONE_IO
 0x80000000

	)

35 
	#SCHED_NORMAL
 0

	)

36 
	#SCHED_FIFO
 1

	)

37 
	#SCHED_RR
 2

	)

38 
	#SCHED_BATCH
 3

	)

40 
	#SCHED_IDLE
 5

	)

42 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

	@/usr/include/linux/socket.h

1 #iâdeà
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

11 
	s__k”Ãl_sockaddr_¡Üage
 {

12 
	mss_çmy
;

14 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

17 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/sockios.h

18 #iâdeà
_LINUX_SOCKIOS_H


19 
	#_LINUX_SOCKIOS_H


	)

21 
	~<asm/sockios.h
>

24 
	#SIOCINQ
 
FIONREAD


	)

25 
	#SIOCOUTQ
 
TIOCOUTQ


	)

28 
	#SIOCADDRT
 0x890B

	)

29 
	#SIOCDELRT
 0x890C

	)

30 
	#SIOCRTMSG
 0x890D

	)

33 
	#SIOCGIFNAME
 0x8910

	)

34 
	#SIOCSIFLINK
 0x8911

	)

35 
	#SIOCGIFCONF
 0x8912

	)

36 
	#SIOCGIFFLAGS
 0x8913

	)

37 
	#SIOCSIFFLAGS
 0x8914

	)

38 
	#SIOCGIFADDR
 0x8915

	)

39 
	#SIOCSIFADDR
 0x8916

	)

40 
	#SIOCGIFDSTADDR
 0x8917

	)

41 
	#SIOCSIFDSTADDR
 0x8918

	)

42 
	#SIOCGIFBRDADDR
 0x8919

	)

43 
	#SIOCSIFBRDADDR
 0x891¨

	)

44 
	#SIOCGIFNETMASK
 0x891b

	)

45 
	#SIOCSIFNETMASK
 0x891ø

	)

46 
	#SIOCGIFMETRIC
 0x891d

	)

47 
	#SIOCSIFMETRIC
 0x891

	)

48 
	#SIOCGIFMEM
 0x891à

	)

49 
	#SIOCSIFMEM
 0x8920

	)

50 
	#SIOCGIFMTU
 0x8921

	)

51 
	#SIOCSIFMTU
 0x8922

	)

52 
	#SIOCSIFNAME
 0x8923

	)

53 
	#SIOCSIFHWADDR
 0x8924

	)

54 
	#SIOCGIFENCAP
 0x8925

	)

55 
	#SIOCSIFENCAP
 0x8926

	)

56 
	#SIOCGIFHWADDR
 0x8927

	)

57 
	#SIOCGIFSLAVE
 0x8929

	)

58 
	#SIOCSIFSLAVE
 0x8930

	)

59 
	#SIOCADDMULTI
 0x8931

	)

60 
	#SIOCDELMULTI
 0x8932

	)

61 
	#SIOCGIFINDEX
 0x8933

	)

62 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

63 
	#SIOCSIFPFLAGS
 0x8934

	)

64 
	#SIOCGIFPFLAGS
 0x8935

	)

65 
	#SIOCDIFADDR
 0x8936

	)

66 
	#SIOCSIFHWBROADCAST
 0x8937

	)

67 
	#SIOCGIFCOUNT
 0x8938

	)

69 
	#SIOCGIFBR
 0x8940

	)

70 
	#SIOCSIFBR
 0x8941

	)

72 
	#SIOCGIFTXQLEN
 0x8942

	)

73 
	#SIOCSIFTXQLEN
 0x8943

	)

78 
	#SIOCETHTOOL
 0x8946

	)

80 
	#SIOCGMIIPHY
 0x8947

	)

81 
	#SIOCGMIIREG
 0x8948

	)

82 
	#SIOCSMIIREG
 0x8949

	)

84 
	#SIOCWANDEV
 0x894A

	)

86 
	#SIOCOUTQNSD
 0x894B

	)

90 
	#SIOCDARP
 0x8953

	)

91 
	#SIOCGARP
 0x8954

	)

92 
	#SIOCSARP
 0x8955

	)

95 
	#SIOCDRARP
 0x8960

	)

96 
	#SIOCGRARP
 0x8961

	)

97 
	#SIOCSRARP
 0x8962

	)

101 
	#SIOCGIFMAP
 0x8970

	)

102 
	#SIOCSIFMAP
 0x8971

	)

106 
	#SIOCADDDLCI
 0x8980

	)

107 
	#SIOCDELDLCI
 0x8981

	)

109 
	#SIOCGIFVLAN
 0x8982

	)

110 
	#SIOCSIFVLAN
 0x8983

	)

114 
	#SIOCBONDENSLAVE
 0x8990

	)

115 
	#SIOCBONDRELEASE
 0x8991

	)

116 
	#SIOCBONDSETHWADDR
 0x8992

	)

117 
	#SIOCBONDSLAVEINFOQUERY
 0x8993

	)

118 
	#SIOCBONDINFOQUERY
 0x8994

	)

119 
	#SIOCBONDCHANGEACTIVE
 0x8995

	)

122 
	#SIOCBRADDBR
 0x89a0

	)

123 
	#SIOCBRDELBR
 0x89a1

	)

124 
	#SIOCBRADDIF
 0x89a2

	)

125 
	#SIOCBRDELIF
 0x89a3

	)

128 
	#SIOCSHWTSTAMP
 0x89b0

	)

129 
	#SIOCGHWTSTAMP
 0x89b1

	)

142 
	#SIOCDEVPRIVATE
 0x89F0

	)

148 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/linux/sysctl.h

25 #iâdeà
_LINUX_SYSCTL_H


26 
	#_LINUX_SYSCTL_H


	)

28 
	~<lšux/k”Ãl.h
>

29 
	~<lšux/ty³s.h
>

32 
	gcom¶‘iÚ
;

34 
	#CTL_MAXNAME
 10

	)

39 
	s__sysùl_¬gs
 {

40 *
	mÇme
;

41 
	mÆ’
;

42 *
	mŞdv®
;

43 
size_t
 *
	mŞdËÅ
;

44 *
	mÃwv®
;

45 
size_t
 
	mÃwËn
;

46 
	m__unu£d
[4];

57 
	mCTL_KERN
=1,

58 
	mCTL_VM
=2,

59 
	mCTL_NET
=3,

60 
	mCTL_PROC
=4,

61 
	mCTL_FS
=5,

62 
	mCTL_DEBUG
=6,

63 
	mCTL_DEV
=7,

64 
	mCTL_BUS
=8,

65 
	mCTL_ABI
=9,

66 
	mCTL_CPU
=10,

67 
	mCTL_ARLAN
=254,

68 
	mCTL_S390DBF
=5677,

69 
	mCTL_SUNRPC
=7249,

70 
	mCTL_PM
=9899,

71 
	mCTL_FRV
=9898,

77 
	mCTL_BUS_ISA
=1

83 
	mINOTIFY_MAX_USER_INSTANCES
=1,

84 
	mINOTIFY_MAX_USER_WATCHES
=2,

85 
	mINOTIFY_MAX_QUEUED_EVENTS
=3

91 
	mKERN_OSTYPE
=1,

92 
	mKERN_OSRELEASE
=2,

93 
	mKERN_OSREV
=3,

94 
	mKERN_VERSION
=4,

95 
	mKERN_SECUREMASK
=5,

96 
	mKERN_PROF
=6,

97 
	mKERN_NODENAME
=7,

98 
	mKERN_DOMAINNAME
=8,

100 
	mKERN_PANIC
=15,

101 
	mKERN_REALROOTDEV
=16,

103 
	mKERN_SPARC_REBOOT
=21,

104 
	mKERN_CTLALTDEL
=22,

105 
	mKERN_PRINTK
=23,

106 
	mKERN_NAMETRANS
=24,

107 
	mKERN_PPC_HTABRECLAIM
=25,

108 
	mKERN_PPC_ZEROPAGED
=26,

109 
	mKERN_PPC_POWERSAVE_NAP
=27,

110 
	mKERN_MODPROBE
=28,

111 
	mKERN_SG_BIG_BUFF
=29,

112 
	mKERN_ACCT
=30,

113 
	mKERN_PPC_L2CR
=31,

115 
	mKERN_RTSIGNR
=32,

116 
	mKERN_RTSIGMAX
=33,

118 
	mKERN_SHMMAX
=34,

119 
	mKERN_MSGMAX
=35,

120 
	mKERN_MSGMNB
=36,

121 
	mKERN_MSGPOOL
=37,

122 
	mKERN_SYSRQ
=38,

123 
	mKERN_MAX_THREADS
=39,

124 
	mKERN_RANDOM
=40,

125 
	mKERN_SHMALL
=41,

126 
	mKERN_MSGMNI
=42,

127 
	mKERN_SEM
=43,

128 
	mKERN_SPARC_STOP_A
=44,

129 
	mKERN_SHMMNI
=45,

130 
	mKERN_OVERFLOWUID
=46,

131 
	mKERN_OVERFLOWGID
=47,

132 
	mKERN_SHMPATH
=48,

133 
	mKERN_HOTPLUG
=49,

134 
	mKERN_IEEE_EMULATION_WARNINGS
=50,

135 
	mKERN_S390_USER_DEBUG_LOGGING
=51,

136 
	mKERN_CORE_USES_PID
=52,

137 
	mKERN_TAINTED
=53,

138 
	mKERN_CADPID
=54,

139 
	mKERN_PIDMAX
=55,

140 
	mKERN_CORE_PATTERN
=56,

141 
	mKERN_PANIC_ON_OOPS
=57,

142 
	mKERN_HPPA_PWRSW
=58,

143 
	mKERN_HPPA_UNALIGNED
=59,

144 
	mKERN_PRINTK_RATELIMIT
=60,

145 
	mKERN_PRINTK_RATELIMIT_BURST
=61,

146 
	mKERN_PTY
=62,

147 
	mKERN_NGROUPS_MAX
=63,

148 
	mKERN_SPARC_SCONS_PWROFF
=64,

149 
	mKERN_HZ_TIMER
=65,

150 
	mKERN_UNKNOWN_NMI_PANIC
=66,

151 
	mKERN_BOOTLOADER_TYPE
=67,

152 
	mKERN_RANDOMIZE
=68,

153 
	mKERN_SETUID_DUMPABLE
=69,

154 
	mKERN_SPIN_RETRY
=70,

155 
	mKERN_ACPI_VIDEO_FLAGS
=71,

156 
	mKERN_IA64_UNALIGNED
=72,

157 
	mKERN_COMPAT_LOG
=73,

158 
	mKERN_MAX_LOCK_DEPTH
=74,

159 
	mKERN_NMI_WATCHDOG
=75,

160 
	mKERN_PANIC_ON_NMI
=76,

161 
	mKERN_PANIC_ON_WARN
=77,

169 
	mVM_UNUSED1
=1,

170 
	mVM_UNUSED2
=2,

171 
	mVM_UNUSED3
=3,

172 
	mVM_UNUSED4
=4,

173 
	mVM_OVERCOMMIT_MEMORY
=5,

174 
	mVM_UNUSED5
=6,

175 
	mVM_UNUSED7
=7,

176 
	mVM_UNUSED8
=8,

177 
	mVM_UNUSED9
=9,

178 
	mVM_PAGE_CLUSTER
=10,

179 
	mVM_DIRTY_BACKGROUND
=11,

180 
	mVM_DIRTY_RATIO
=12,

181 
	mVM_DIRTY_WB_CS
=13,

182 
	mVM_DIRTY_EXPIRE_CS
=14,

183 
	mVM_NR_PDFLUSH_THREADS
=15,

184 
	mVM_OVERCOMMIT_RATIO
=16,

185 
	mVM_PAGEBUF
=17,

186 
	mVM_HUGETLB_PAGES
=18,

187 
	mVM_SWAPPINESS
=19,

188 
	mVM_LOWMEM_RESERVE_RATIO
=20,

189 
	mVM_MIN_FREE_KBYTES
=21,

190 
	mVM_MAX_MAP_COUNT
=22,

191 
	mVM_LAPTOP_MODE
=23,

192 
	mVM_BLOCK_DUMP
=24,

193 
	mVM_HUGETLB_GROUP
=25,

194 
	mVM_VFS_CACHE_PRESSURE
=26,

195 
	mVM_LEGACY_VA_LAYOUT
=27,

196 
	mVM_SWAP_TOKEN_TIMEOUT
=28,

197 
	mVM_DROP_PAGECACHE
=29,

198 
	mVM_PERCPU_PAGELIST_FRACTION
=30,

199 
	mVM_ZONE_RECLAIM_MODE
=31,

200 
	mVM_MIN_UNMAPPED
=32,

201 
	mVM_PANIC_ON_OOM
=33,

202 
	mVM_VDSO_ENABLED
=34,

203 
	mVM_MIN_SLAB
=35,

210 
	mNET_CORE
=1,

211 
	mNET_ETHER
=2,

212 
	mNET_802
=3,

213 
	mNET_UNIX
=4,

214 
	mNET_IPV4
=5,

215 
	mNET_IPX
=6,

216 
	mNET_ATALK
=7,

217 
	mNET_NETROM
=8,

218 
	mNET_AX25
=9,

219 
	mNET_BRIDGE
=10,

220 
	mNET_ROSE
=11,

221 
	mNET_IPV6
=12,

222 
	mNET_X25
=13,

223 
	mNET_TR
=14,

224 
	mNET_DECNET
=15,

225 
	mNET_ECONET
=16,

226 
	mNET_SCTP
=17,

227 
	mNET_LLC
=18,

228 
	mNET_NETFILTER
=19,

229 
	mNET_DCCP
=20,

230 
	mNET_IRDA
=412,

236 
	mRANDOM_POOLSIZE
=1,

237 
	mRANDOM_ENTROPY_COUNT
=2,

238 
	mRANDOM_READ_THRESH
=3,

239 
	mRANDOM_WRITE_THRESH
=4,

240 
	mRANDOM_BOOT_ID
=5,

241 
	mRANDOM_UUID
=6

247 
	mPTY_MAX
=1,

248 
	mPTY_NR
=2

254 
	mBUS_ISA_MEM_BASE
=1,

255 
	mBUS_ISA_PORT_BASE
=2,

256 
	mBUS_ISA_PORT_SHIFT
=3

262 
	mNET_CORE_WMEM_MAX
=1,

263 
	mNET_CORE_RMEM_MAX
=2,

264 
	mNET_CORE_WMEM_DEFAULT
=3,

265 
	mNET_CORE_RMEM_DEFAULT
=4,

267 
	mNET_CORE_MAX_BACKLOG
=6,

268 
	mNET_CORE_FASTROUTE
=7,

269 
	mNET_CORE_MSG_COST
=8,

270 
	mNET_CORE_MSG_BURST
=9,

271 
	mNET_CORE_OPTMEM_MAX
=10,

272 
	mNET_CORE_HOT_LIST_LENGTH
=11,

273 
	mNET_CORE_DIVERT_VERSION
=12,

274 
	mNET_CORE_NO_CONG_THRESH
=13,

275 
	mNET_CORE_NO_CONG
=14,

276 
	mNET_CORE_LO_CONG
=15,

277 
	mNET_CORE_MOD_CONG
=16,

278 
	mNET_CORE_DEV_WEIGHT
=17,

279 
	mNET_CORE_SOMAXCONN
=18,

280 
	mNET_CORE_BUDGET
=19,

281 
	mNET_CORE_AEVENT_ETIME
=20,

282 
	mNET_CORE_AEVENT_RSEQTH
=21,

283 
	mNET_CORE_WARNINGS
=22,

294 
	mNET_UNIX_DESTROY_DELAY
=1,

295 
	mNET_UNIX_DELETE_DELAY
=2,

296 
	mNET_UNIX_MAX_DGRAM_QLEN
=3,

302 
	mNET_NF_CONNTRACK_MAX
=1,

303 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

304 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

305 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

306 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

307 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

308 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

309 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

310 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

311 
	mNET_NF_CONNTRACK_UDP_TIMEOUT
=10,

312 
	mNET_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

313 
	mNET_NF_CONNTRACK_ICMP_TIMEOUT
=12,

314 
	mNET_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

315 
	mNET_NF_CONNTRACK_BUCKETS
=14,

316 
	mNET_NF_CONNTRACK_LOG_INVALID
=15,

317 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

318 
	mNET_NF_CONNTRACK_TCP_LOOSE
=17,

319 
	mNET_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

320 
	mNET_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

321 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

322 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

323 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

324 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

325 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

326 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

327 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

328 
	mNET_NF_CONNTRACK_COUNT
=27,

329 
	mNET_NF_CONNTRACK_ICMPV6_TIMEOUT
=28,

330 
	mNET_NF_CONNTRACK_FRAG6_TIMEOUT
=29,

331 
	mNET_NF_CONNTRACK_FRAG6_LOW_THRESH
=30,

332 
	mNET_NF_CONNTRACK_FRAG6_HIGH_THRESH
=31,

333 
	mNET_NF_CONNTRACK_CHECKSUM
=32,

340 
	mNET_IPV4_FORWARD
=8,

341 
	mNET_IPV4_DYNADDR
=9,

343 
	mNET_IPV4_CONF
=16,

344 
	mNET_IPV4_NEIGH
=17,

345 
	mNET_IPV4_ROUTE
=18,

346 
	mNET_IPV4_FIB_HASH
=19,

347 
	mNET_IPV4_NETFILTER
=20,

349 
	mNET_IPV4_TCP_TIMESTAMPS
=33,

350 
	mNET_IPV4_TCP_WINDOW_SCALING
=34,

351 
	mNET_IPV4_TCP_SACK
=35,

352 
	mNET_IPV4_TCP_RETRANS_COLLAPSE
=36,

353 
	mNET_IPV4_DEFAULT_TTL
=37,

354 
	mNET_IPV4_AUTOCONFIG
=38,

355 
	mNET_IPV4_NO_PMTU_DISC
=39,

356 
	mNET_IPV4_TCP_SYN_RETRIES
=40,

357 
	mNET_IPV4_IPFRAG_HIGH_THRESH
=41,

358 
	mNET_IPV4_IPFRAG_LOW_THRESH
=42,

359 
	mNET_IPV4_IPFRAG_TIME
=43,

360 
	mNET_IPV4_TCP_MAX_KA_PROBES
=44,

361 
	mNET_IPV4_TCP_KEEPALIVE_TIME
=45,

362 
	mNET_IPV4_TCP_KEEPALIVE_PROBES
=46,

363 
	mNET_IPV4_TCP_RETRIES1
=47,

364 
	mNET_IPV4_TCP_RETRIES2
=48,

365 
	mNET_IPV4_TCP_FIN_TIMEOUT
=49,

366 
	mNET_IPV4_IP_MASQ_DEBUG
=50,

367 
	mNET_TCP_SYNCOOKIES
=51,

368 
	mNET_TCP_STDURG
=52,

369 
	mNET_TCP_RFC1337
=53,

370 
	mNET_TCP_SYN_TAILDROP
=54,

371 
	mNET_TCP_MAX_SYN_BACKLOG
=55,

372 
	mNET_IPV4_LOCAL_PORT_RANGE
=56,

373 
	mNET_IPV4_ICMP_ECHO_IGNORE_ALL
=57,

374 
	mNET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS
=58,

375 
	mNET_IPV4_ICMP_SOURCEQUENCH_RATE
=59,

376 
	mNET_IPV4_ICMP_DESTUNREACH_RATE
=60,

377 
	mNET_IPV4_ICMP_TIMEEXCEED_RATE
=61,

378 
	mNET_IPV4_ICMP_PARAMPROB_RATE
=62,

379 
	mNET_IPV4_ICMP_ECHOREPLY_RATE
=63,

380 
	mNET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES
=64,

381 
	mNET_IPV4_IGMP_MAX_MEMBERSHIPS
=65,

382 
	mNET_TCP_TW_RECYCLE
=66,

383 
	mNET_IPV4_ALWAYS_DEFRAG
=67,

384 
	mNET_IPV4_TCP_KEEPALIVE_INTVL
=68,

385 
	mNET_IPV4_INET_PEER_THRESHOLD
=69,

386 
	mNET_IPV4_INET_PEER_MINTTL
=70,

387 
	mNET_IPV4_INET_PEER_MAXTTL
=71,

388 
	mNET_IPV4_INET_PEER_GC_MINTIME
=72,

389 
	mNET_IPV4_INET_PEER_GC_MAXTIME
=73,

390 
	mNET_TCP_ORPHAN_RETRIES
=74,

391 
	mNET_TCP_ABORT_ON_OVERFLOW
=75,

392 
	mNET_TCP_SYNACK_RETRIES
=76,

393 
	mNET_TCP_MAX_ORPHANS
=77,

394 
	mNET_TCP_MAX_TW_BUCKETS
=78,

395 
	mNET_TCP_FACK
=79,

396 
	mNET_TCP_REORDERING
=80,

397 
	mNET_TCP_ECN
=81,

398 
	mNET_TCP_DSACK
=82,

399 
	mNET_TCP_MEM
=83,

400 
	mNET_TCP_WMEM
=84,

401 
	mNET_TCP_RMEM
=85,

402 
	mNET_TCP_APP_WIN
=86,

403 
	mNET_TCP_ADV_WIN_SCALE
=87,

404 
	mNET_IPV4_NONLOCAL_BIND
=88,

405 
	mNET_IPV4_ICMP_RATELIMIT
=89,

406 
	mNET_IPV4_ICMP_RATEMASK
=90,

407 
	mNET_TCP_TW_REUSE
=91,

408 
	mNET_TCP_FRTO
=92,

409 
	mNET_TCP_LOW_LATENCY
=93,

410 
	mNET_IPV4_IPFRAG_SECRET_INTERVAL
=94,

411 
	mNET_IPV4_IGMP_MAX_MSF
=96,

412 
	mNET_TCP_NO_METRICS_SAVE
=97,

413 
	mNET_TCP_DEFAULT_WIN_SCALE
=105,

414 
	mNET_TCP_MODERATE_RCVBUF
=106,

415 
	mNET_TCP_TSO_WIN_DIVISOR
=107,

416 
	mNET_TCP_BIC_BETA
=108,

417 
	mNET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR
=109,

418 
	mNET_TCP_CONG_CONTROL
=110,

419 
	mNET_TCP_ABC
=111,

420 
	mNET_IPV4_IPFRAG_MAX_DIST
=112,

421 
	mNET_TCP_MTU_PROBING
=113,

422 
	mNET_TCP_BASE_MSS
=114,

423 
	mNET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS
=115,

424 
	mNET_TCP_DMA_COPYBREAK
=116,

425 
	mNET_TCP_SLOW_START_AFTER_IDLE
=117,

426 
	mNET_CIPSOV4_CACHE_ENABLE
=118,

427 
	mNET_CIPSOV4_CACHE_BUCKET_SIZE
=119,

428 
	mNET_CIPSOV4_RBM_OPTFMT
=120,

429 
	mNET_CIPSOV4_RBM_STRICTVALID
=121,

430 
	mNET_TCP_AVAIL_CONG_CONTROL
=122,

431 
	mNET_TCP_ALLOWED_CONG_CONTROL
=123,

432 
	mNET_TCP_MAX_SSTHRESH
=124,

433 
	mNET_TCP_FRTO_RESPONSE
=125,

437 
	mNET_IPV4_ROUTE_FLUSH
=1,

438 
	mNET_IPV4_ROUTE_MIN_DELAY
=2,

439 
	mNET_IPV4_ROUTE_MAX_DELAY
=3,

440 
	mNET_IPV4_ROUTE_GC_THRESH
=4,

441 
	mNET_IPV4_ROUTE_MAX_SIZE
=5,

442 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL
=6,

443 
	mNET_IPV4_ROUTE_GC_TIMEOUT
=7,

444 
	mNET_IPV4_ROUTE_GC_INTERVAL
=8,

445 
	mNET_IPV4_ROUTE_REDIRECT_LOAD
=9,

446 
	mNET_IPV4_ROUTE_REDIRECT_NUMBER
=10,

447 
	mNET_IPV4_ROUTE_REDIRECT_SILENCE
=11,

448 
	mNET_IPV4_ROUTE_ERROR_COST
=12,

449 
	mNET_IPV4_ROUTE_ERROR_BURST
=13,

450 
	mNET_IPV4_ROUTE_GC_ELASTICITY
=14,

451 
	mNET_IPV4_ROUTE_MTU_EXPIRES
=15,

452 
	mNET_IPV4_ROUTE_MIN_PMTU
=16,

453 
	mNET_IPV4_ROUTE_MIN_ADVMSS
=17,

454 
	mNET_IPV4_ROUTE_SECRET_INTERVAL
=18,

455 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL_MS
=19,

460 
	mNET_PROTO_CONF_ALL
=-2,

461 
	mNET_PROTO_CONF_DEFAULT
=-3

468 
	mNET_IPV4_CONF_FORWARDING
=1,

469 
	mNET_IPV4_CONF_MC_FORWARDING
=2,

470 
	mNET_IPV4_CONF_PROXY_ARP
=3,

471 
	mNET_IPV4_CONF_ACCEPT_REDIRECTS
=4,

472 
	mNET_IPV4_CONF_SECURE_REDIRECTS
=5,

473 
	mNET_IPV4_CONF_SEND_REDIRECTS
=6,

474 
	mNET_IPV4_CONF_SHARED_MEDIA
=7,

475 
	mNET_IPV4_CONF_RP_FILTER
=8,

476 
	mNET_IPV4_CONF_ACCEPT_SOURCE_ROUTE
=9,

477 
	mNET_IPV4_CONF_BOOTP_RELAY
=10,

478 
	mNET_IPV4_CONF_LOG_MARTIANS
=11,

479 
	mNET_IPV4_CONF_TAG
=12,

480 
	mNET_IPV4_CONF_ARPFILTER
=13,

481 
	mNET_IPV4_CONF_MEDIUM_ID
=14,

482 
	mNET_IPV4_CONF_NOXFRM
=15,

483 
	mNET_IPV4_CONF_NOPOLICY
=16,

484 
	mNET_IPV4_CONF_FORCE_IGMP_VERSION
=17,

485 
	mNET_IPV4_CONF_ARP_ANNOUNCE
=18,

486 
	mNET_IPV4_CONF_ARP_IGNORE
=19,

487 
	mNET_IPV4_CONF_PROMOTE_SECONDARIES
=20,

488 
	mNET_IPV4_CONF_ARP_ACCEPT
=21,

489 
	mNET_IPV4_CONF_ARP_NOTIFY
=22,

490 
	mNET_IPV4_CONF_ACCEPT_LOCAL
=23,

491 
	mNET_IPV4_CONF_SRC_VMARK
=24,

492 
	mNET_IPV4_CONF_PROXY_ARP_PVLAN
=25,

501 
	mNET_IPV4_CONF_ROUTE_LOCALNET
=26,

502 
	m__NET_IPV4_CONF_MAX


508 
	mNET_IPV4_NF_CONNTRACK_MAX
=1,

509 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

510 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

511 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

512 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

513 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

514 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

515 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

516 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

517 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT
=10,

518 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

519 
	mNET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT
=12,

520 
	mNET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

521 
	mNET_IPV4_NF_CONNTRACK_BUCKETS
=14,

522 
	mNET_IPV4_NF_CONNTRACK_LOG_INVALID
=15,

523 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

524 
	mNET_IPV4_NF_CONNTRACK_TCP_LOOSE
=17,

525 
	mNET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

526 
	mNET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

527 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

528 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

529 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

530 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

531 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

532 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

533 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

534 
	mNET_IPV4_NF_CONNTRACK_COUNT
=27,

535 
	mNET_IPV4_NF_CONNTRACK_CHECKSUM
=28,

540 
	mNET_IPV6_CONF
=16,

541 
	mNET_IPV6_NEIGH
=17,

542 
	mNET_IPV6_ROUTE
=18,

543 
	mNET_IPV6_ICMP
=19,

544 
	mNET_IPV6_BINDV6ONLY
=20,

545 
	mNET_IPV6_IP6FRAG_HIGH_THRESH
=21,

546 
	mNET_IPV6_IP6FRAG_LOW_THRESH
=22,

547 
	mNET_IPV6_IP6FRAG_TIME
=23,

548 
	mNET_IPV6_IP6FRAG_SECRET_INTERVAL
=24,

549 
	mNET_IPV6_MLD_MAX_MSF
=25,

553 
	mNET_IPV6_ROUTE_FLUSH
=1,

554 
	mNET_IPV6_ROUTE_GC_THRESH
=2,

555 
	mNET_IPV6_ROUTE_MAX_SIZE
=3,

556 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL
=4,

557 
	mNET_IPV6_ROUTE_GC_TIMEOUT
=5,

558 
	mNET_IPV6_ROUTE_GC_INTERVAL
=6,

559 
	mNET_IPV6_ROUTE_GC_ELASTICITY
=7,

560 
	mNET_IPV6_ROUTE_MTU_EXPIRES
=8,

561 
	mNET_IPV6_ROUTE_MIN_ADVMSS
=9,

562 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL_MS
=10

566 
	mNET_IPV6_FORWARDING
=1,

567 
	mNET_IPV6_HOP_LIMIT
=2,

568 
	mNET_IPV6_MTU
=3,

569 
	mNET_IPV6_ACCEPT_RA
=4,

570 
	mNET_IPV6_ACCEPT_REDIRECTS
=5,

571 
	mNET_IPV6_AUTOCONF
=6,

572 
	mNET_IPV6_DAD_TRANSMITS
=7,

573 
	mNET_IPV6_RTR_SOLICITS
=8,

574 
	mNET_IPV6_RTR_SOLICIT_INTERVAL
=9,

575 
	mNET_IPV6_RTR_SOLICIT_DELAY
=10,

576 
	mNET_IPV6_USE_TEMPADDR
=11,

577 
	mNET_IPV6_TEMP_VALID_LFT
=12,

578 
	mNET_IPV6_TEMP_PREFERED_LFT
=13,

579 
	mNET_IPV6_REGEN_MAX_RETRY
=14,

580 
	mNET_IPV6_MAX_DESYNC_FACTOR
=15,

581 
	mNET_IPV6_MAX_ADDRESSES
=16,

582 
	mNET_IPV6_FORCE_MLD_VERSION
=17,

583 
	mNET_IPV6_ACCEPT_RA_DEFRTR
=18,

584 
	mNET_IPV6_ACCEPT_RA_PINFO
=19,

585 
	mNET_IPV6_ACCEPT_RA_RTR_PREF
=20,

586 
	mNET_IPV6_RTR_PROBE_INTERVAL
=21,

587 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN
=22,

588 
	mNET_IPV6_PROXY_NDP
=23,

589 
	mNET_IPV6_ACCEPT_SOURCE_ROUTE
=25,

590 
	m__NET_IPV6_MAX


595 
	mNET_IPV6_ICMP_RATELIMIT
=1

600 
	mNET_NEIGH_MCAST_SOLICIT
=1,

601 
	mNET_NEIGH_UCAST_SOLICIT
=2,

602 
	mNET_NEIGH_APP_SOLICIT
=3,

603 
	mNET_NEIGH_RETRANS_TIME
=4,

604 
	mNET_NEIGH_REACHABLE_TIME
=5,

605 
	mNET_NEIGH_DELAY_PROBE_TIME
=6,

606 
	mNET_NEIGH_GC_STALE_TIME
=7,

607 
	mNET_NEIGH_UNRES_QLEN
=8,

608 
	mNET_NEIGH_PROXY_QLEN
=9,

609 
	mNET_NEIGH_ANYCAST_DELAY
=10,

610 
	mNET_NEIGH_PROXY_DELAY
=11,

611 
	mNET_NEIGH_LOCKTIME
=12,

612 
	mNET_NEIGH_GC_INTERVAL
=13,

613 
	mNET_NEIGH_GC_THRESH1
=14,

614 
	mNET_NEIGH_GC_THRESH2
=15,

615 
	mNET_NEIGH_GC_THRESH3
=16,

616 
	mNET_NEIGH_RETRANS_TIME_MS
=17,

617 
	mNET_NEIGH_REACHABLE_TIME_MS
=18,

618 
	m__NET_NEIGH_MAX


623 
	mNET_DCCP_DEFAULT
=1,

628 
	mNET_IPX_PPROP_BROADCASTING
=1,

629 
	mNET_IPX_FORWARDING
=2

634 
	mNET_LLC2
=1,

635 
	mNET_LLC_STATION
=2,

640 
	mNET_LLC2_TIMEOUT
=1,

645 
	mNET_LLC_STATION_ACK_TIMEOUT
=1,

650 
	mNET_LLC2_ACK_TIMEOUT
=1,

651 
	mNET_LLC2_P_TIMEOUT
=2,

652 
	mNET_LLC2_REJ_TIMEOUT
=3,

653 
	mNET_LLC2_BUSY_TIMEOUT
=4,

658 
	mNET_ATALK_AARP_EXPIRY_TIME
=1,

659 
	mNET_ATALK_AARP_TICK_TIME
=2,

660 
	mNET_ATALK_AARP_RETRANSMIT_LIMIT
=3,

661 
	mNET_ATALK_AARP_RESOLVE_TIME
=4

667 
	mNET_NETROM_DEFAULT_PATH_QUALITY
=1,

668 
	mNET_NETROM_OBSOLESCENCE_COUNT_INITIALISER
=2,

669 
	mNET_NETROM_NETWORK_TTL_INITIALISER
=3,

670 
	mNET_NETROM_TRANSPORT_TIMEOUT
=4,

671 
	mNET_NETROM_TRANSPORT_MAXIMUM_TRIES
=5,

672 
	mNET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY
=6,

673 
	mNET_NETROM_TRANSPORT_BUSY_DELAY
=7,

674 
	mNET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE
=8,

675 
	mNET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT
=9,

676 
	mNET_NETROM_ROUTING_CONTROL
=10,

677 
	mNET_NETROM_LINK_FAILS_COUNT
=11,

678 
	mNET_NETROM_RESET
=12

683 
	mNET_AX25_IP_DEFAULT_MODE
=1,

684 
	mNET_AX25_DEFAULT_MODE
=2,

685 
	mNET_AX25_BACKOFF_TYPE
=3,

686 
	mNET_AX25_CONNECT_MODE
=4,

687 
	mNET_AX25_STANDARD_WINDOW
=5,

688 
	mNET_AX25_EXTENDED_WINDOW
=6,

689 
	mNET_AX25_T1_TIMEOUT
=7,

690 
	mNET_AX25_T2_TIMEOUT
=8,

691 
	mNET_AX25_T3_TIMEOUT
=9,

692 
	mNET_AX25_IDLE_TIMEOUT
=10,

693 
	mNET_AX25_N2
=11,

694 
	mNET_AX25_PACLEN
=12,

695 
	mNET_AX25_PROTOCOL
=13,

696 
	mNET_AX25_DAMA_SLAVE_TIMEOUT
=14

701 
	mNET_ROSE_RESTART_REQUEST_TIMEOUT
=1,

702 
	mNET_ROSE_CALL_REQUEST_TIMEOUT
=2,

703 
	mNET_ROSE_RESET_REQUEST_TIMEOUT
=3,

704 
	mNET_ROSE_CLEAR_REQUEST_TIMEOUT
=4,

705 
	mNET_ROSE_ACK_HOLD_BACK_TIMEOUT
=5,

706 
	mNET_ROSE_ROUTING_CONTROL
=6,

707 
	mNET_ROSE_LINK_FAIL_TIMEOUT
=7,

708 
	mNET_ROSE_MAX_VCS
=8,

709 
	mNET_ROSE_WINDOW_SIZE
=9,

710 
	mNET_ROSE_NO_ACTIVITY_TIMEOUT
=10

715 
	mNET_X25_RESTART_REQUEST_TIMEOUT
=1,

716 
	mNET_X25_CALL_REQUEST_TIMEOUT
=2,

717 
	mNET_X25_RESET_REQUEST_TIMEOUT
=3,

718 
	mNET_X25_CLEAR_REQUEST_TIMEOUT
=4,

719 
	mNET_X25_ACK_HOLD_BACK_TIMEOUT
=5,

720 
	mNET_X25_FORWARD
=6

726 
	mNET_TR_RIF_TIMEOUT
=1

731 
	mNET_DECNET_NODE_TYPE
 = 1,

732 
	mNET_DECNET_NODE_ADDRESS
 = 2,

733 
	mNET_DECNET_NODE_NAME
 = 3,

734 
	mNET_DECNET_DEFAULT_DEVICE
 = 4,

735 
	mNET_DECNET_TIME_WAIT
 = 5,

736 
	mNET_DECNET_DN_COUNT
 = 6,

737 
	mNET_DECNET_DI_COUNT
 = 7,

738 
	mNET_DECNET_DR_COUNT
 = 8,

739 
	mNET_DECNET_DST_GC_INTERVAL
 = 9,

740 
	mNET_DECNET_CONF
 = 10,

741 
	mNET_DECNET_NO_FC_MAX_CWND
 = 11,

742 
	mNET_DECNET_MEM
 = 12,

743 
	mNET_DECNET_RMEM
 = 13,

744 
	mNET_DECNET_WMEM
 = 14,

745 
	mNET_DECNET_DEBUG_LEVEL
 = 255

750 
	mNET_DECNET_CONF_LOOPBACK
 = -2,

751 
	mNET_DECNET_CONF_DDCMP
 = -3,

752 
	mNET_DECNET_CONF_PPP
 = -4,

753 
	mNET_DECNET_CONF_X25
 = -5,

754 
	mNET_DECNET_CONF_GRE
 = -6,

755 
	mNET_DECNET_CONF_ETHER
 = -7

762 
	mNET_DECNET_CONF_DEV_PRIORITY
 = 1,

763 
	mNET_DECNET_CONF_DEV_T1
 = 2,

764 
	mNET_DECNET_CONF_DEV_T2
 = 3,

765 
	mNET_DECNET_CONF_DEV_T3
 = 4,

766 
	mNET_DECNET_CONF_DEV_FORWARDING
 = 5,

767 
	mNET_DECNET_CONF_DEV_BLKSIZE
 = 6,

768 
	mNET_DECNET_CONF_DEV_STATE
 = 7

773 
	mNET_SCTP_RTO_INITIAL
 = 1,

774 
	mNET_SCTP_RTO_MIN
 = 2,

775 
	mNET_SCTP_RTO_MAX
 = 3,

776 
	mNET_SCTP_RTO_ALPHA
 = 4,

777 
	mNET_SCTP_RTO_BETA
 = 5,

778 
	mNET_SCTP_VALID_COOKIE_LIFE
 = 6,

779 
	mNET_SCTP_ASSOCIATION_MAX_RETRANS
 = 7,

780 
	mNET_SCTP_PATH_MAX_RETRANS
 = 8,

781 
	mNET_SCTP_MAX_INIT_RETRANSMITS
 = 9,

782 
	mNET_SCTP_HB_INTERVAL
 = 10,

783 
	mNET_SCTP_PRESERVE_ENABLE
 = 11,

784 
	mNET_SCTP_MAX_BURST
 = 12,

785 
	mNET_SCTP_ADDIP_ENABLE
 = 13,

786 
	mNET_SCTP_PRSCTP_ENABLE
 = 14,

787 
	mNET_SCTP_SNDBUF_POLICY
 = 15,

788 
	mNET_SCTP_SACK_TIMEOUT
 = 16,

789 
	mNET_SCTP_RCVBUF_POLICY
 = 17,

794 
	mNET_BRIDGE_NF_CALL_ARPTABLES
 = 1,

795 
	mNET_BRIDGE_NF_CALL_IPTABLES
 = 2,

796 
	mNET_BRIDGE_NF_CALL_IP6TABLES
 = 3,

797 
	mNET_BRIDGE_NF_FILTER_VLAN_TAGGED
 = 4,

798 
	mNET_BRIDGE_NF_FILTER_PPPOE_TAGGED
 = 5,

803 
	mNET_IRDA_DISCOVERY
=1,

804 
	mNET_IRDA_DEVNAME
=2,

805 
	mNET_IRDA_DEBUG
=3,

806 
	mNET_IRDA_FAST_POLL
=4,

807 
	mNET_IRDA_DISCOVERY_SLOTS
=5,

808 
	mNET_IRDA_DISCOVERY_TIMEOUT
=6,

809 
	mNET_IRDA_SLOT_TIMEOUT
=7,

810 
	mNET_IRDA_MAX_BAUD_RATE
=8,

811 
	mNET_IRDA_MIN_TX_TURN_TIME
=9,

812 
	mNET_IRDA_MAX_TX_DATA_SIZE
=10,

813 
	mNET_IRDA_MAX_TX_WINDOW
=11,

814 
	mNET_IRDA_MAX_NOREPLY_TIME
=12,

815 
	mNET_IRDA_WARN_NOREPLY_TIME
=13,

816 
	mNET_IRDA_LAP_KEEPALIVE_TIME
=14,

823 
	mFS_NRINODE
=1,

824 
	mFS_STATINODE
=2,

825 
	mFS_MAXINODE
=3,

826 
	mFS_NRDQUOT
=4,

827 
	mFS_MAXDQUOT
=5,

828 
	mFS_NRFILE
=6,

829 
	mFS_MAXFILE
=7,

830 
	mFS_DENTRY
=8,

831 
	mFS_NRSUPER
=9,

832 
	mFS_MAXSUPER
=10,

833 
	mFS_OVERFLOWUID
=11,

834 
	mFS_OVERFLOWGID
=12,

835 
	mFS_LEASES
=13,

836 
	mFS_DIR_NOTIFY
=14,

837 
	mFS_LEASE_TIME
=15,

838 
	mFS_DQSTATS
=16,

839 
	mFS_XFS
=17,

840 
	mFS_AIO_NR
=18,

841 
	mFS_AIO_MAX_NR
=19,

842 
	mFS_INOTIFY
=20,

843 
	mFS_OCFS2
=988,

848 
	mFS_DQ_LOOKUPS
 = 1,

849 
	mFS_DQ_DROPS
 = 2,

850 
	mFS_DQ_READS
 = 3,

851 
	mFS_DQ_WRITES
 = 4,

852 
	mFS_DQ_CACHE_HITS
 = 5,

853 
	mFS_DQ_ALLOCATED
 = 6,

854 
	mFS_DQ_FREE
 = 7,

855 
	mFS_DQ_SYNCS
 = 8,

856 
	mFS_DQ_WARNINGS
 = 9,

863 
	mDEV_CDROM
=1,

864 
	mDEV_HWMON
=2,

865 
	mDEV_PARPORT
=3,

866 
	mDEV_RAID
=4,

867 
	mDEV_MAC_HID
=5,

868 
	mDEV_SCSI
=6,

869 
	mDEV_IPMI
=7,

874 
	mDEV_CDROM_INFO
=1,

875 
	mDEV_CDROM_AUTOCLOSE
=2,

876 
	mDEV_CDROM_AUTOEJECT
=3,

877 
	mDEV_CDROM_DEBUG
=4,

878 
	mDEV_CDROM_LOCK
=5,

879 
	mDEV_CDROM_CHECK_MEDIA
=6

884 
	mDEV_PARPORT_DEFAULT
=-3

889 
	mDEV_RAID_SPEED_LIMIT_MIN
=1,

890 
	mDEV_RAID_SPEED_LIMIT_MAX
=2

895 
	mDEV_PARPORT_DEFAULT_TIMESLICE
=1,

896 
	mDEV_PARPORT_DEFAULT_SPINTIME
=2

901 
	mDEV_PARPORT_SPINTIME
=1,

902 
	mDEV_PARPORT_BASE_ADDR
=2,

903 
	mDEV_PARPORT_IRQ
=3,

904 
	mDEV_PARPORT_DMA
=4,

905 
	mDEV_PARPORT_MODES
=5,

906 
	mDEV_PARPORT_DEVICES
=6,

907 
	mDEV_PARPORT_AUTOPROBE
=16

912 
	mDEV_PARPORT_DEVICES_ACTIVE
=-3,

917 
	mDEV_PARPORT_DEVICE_TIMESLICE
=1,

922 
	mDEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES
=1,

923 
	mDEV_MAC_HID_KEYBOARD_LOCK_KEYCODES
=2,

924 
	mDEV_MAC_HID_MOUSE_BUTTON_EMULATION
=3,

925 
	mDEV_MAC_HID_MOUSE_BUTTON2_KEYCODE
=4,

926 
	mDEV_MAC_HID_MOUSE_BUTTON3_KEYCODE
=5,

927 
	mDEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES
=6

932 
	mDEV_SCSI_LOGGING_LEVEL
=1,

937 
	mDEV_IPMI_POWEROFF_POWERCYCLE
=1,

943 
	mABI_DEFHANDLER_COFF
=1,

944 
	mABI_DEFHANDLER_ELF
=2,

945 
	mABI_DEFHANDLER_LCALL7
=3,

946 
	mABI_DEFHANDLER_LIBCSO
=4,

947 
	mABI_TRACE
=5,

948 
	mABI_FAKE_UTSNAME
=6,

	@/usr/include/linux/time.h

1 #iâdeà
_LINUX_TIME_H


2 
	#_LINUX_TIME_H


	)

4 
	~<lšux/ty³s.h
>

7 #iâdeà
_STRUCT_TIMESPEC


8 
	#_STRUCT_TIMESPEC


	)

9 
	stime¥ec
 {

10 
__k”Ãl_time_t
 
	mtv_£c
;

11 
	mtv_n£c
;

15 
	stimev®
 {

16 
__k”Ãl_time_t
 
	mtv_£c
;

17 
__k”Ãl_su£cÚds_t
 
	mtv_u£c
;

20 
	stimezÚe
 {

21 
	mtz_mšu‹swe¡
;

22 
	mtz_d¡time
;

26 
	#NFDBITS
 
__NFDBITS


	)

28 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

29 
	#FD_SET
(
fd
,
fd£
è
	`__FD_SET
(fd,fd£)

	)

30 
	#FD_CLR
(
fd
,
fd£
è
	`__FD_CLR
(fd,fd£)

	)

31 
	#FD_ISSET
(
fd
,
fd£
è
	`__FD_ISSET
(fd,fd£)

	)

32 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
(fd£)

	)

38 
	#ITIMER_REAL
 0

	)

39 
	#ITIMER_VIRTUAL
 1

	)

40 
	#ITIMER_PROF
 2

	)

42 
	s™im”¥ec
 {

43 
time¥ec
 
	m™_š‹rv®
;

44 
time¥ec
 
	m™_v®ue
;

47 
	s™im”v®
 {

48 
timev®
 
	m™_š‹rv®
;

49 
timev®
 
	m™_v®ue
;

55 
	#CLOCK_REALTIME
 0

	)

56 
	#CLOCK_MONOTONIC
 1

	)

57 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

58 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

59 
	#CLOCK_MONOTONIC_RAW
 4

	)

60 
	#CLOCK_REALTIME_COARSE
 5

	)

61 
	#CLOCK_MONOTONIC_COARSE
 6

	)

66 
	#CLOCK_SGI_CYCLE
 10

	)

67 
	#MAX_CLOCKS
 16

	)

68 
	#CLOCKS_MASK
 (
CLOCK_REALTIME
 | 
CLOCK_MONOTONIC
)

	)

69 
	#CLOCKS_MONO
 
CLOCK_MONOTONIC


	)

74 
	#TIMER_ABSTIME
 0x01

	)

	@/usr/include/linux/tty.h

1 #iâdeà
_LINUX_TTY_H


2 
	#_LINUX_TTY_H


	)

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

38 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

39 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

40 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/linux/wait.h

1 #iâdeà
_LINUX_WAIT_H


2 
	#_LINUX_WAIT_H


	)

4 
	#WNOHANG
 0x00000001

	)

5 
	#WUNTRACED
 0x00000002

	)

6 
	#WSTOPPED
 
WUNTRACED


	)

7 
	#WEXITED
 0x00000004

	)

8 
	#WCONTINUED
 0x00000008

	)

9 
	#WNOWAIT
 0x01000000

	)

11 
	#__WNOTHREAD
 0x20000000

	)

12 
	#__WALL
 0x40000000

	)

13 
	#__WCLONE
 0x80000000

	)

16 
	#P_ALL
 0

	)

17 
	#P_PID
 1

	)

18 
	#P_PGID
 2

	)

	@/usr/include/net/route.h

21 #iâdeà
_NET_ROUTE_H


22 
	#_NET_ROUTE_H
 1

	)

24 
	~<ã©u»s.h
>

25 
	~<sys/sock‘.h
>

26 
	~<sys/ty³s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<b™s/wÜdsize.h
>

32 
	s¹’Œy


34 
	m¹_·d1
;

35 
sockaddr
 
	m¹_d¡
;

36 
sockaddr
 
	m¹_g©eway
;

37 
sockaddr
 
	m¹_g’mask
;

38 
	m¹_æags
;

39 
	m¹_·d2
;

40 
	m¹_·d3
;

41 
	m¹_tos
;

42 
	m¹_şass
;

43 #ià
__WORDSIZE
 == 64

44 
	m¹_·d4
[3];

46 
	m¹_·d4
;

48 
	m¹_m‘ric
;

49 *
	m¹_dev
;

50 
	m¹_mtu
;

51 
	m¹_wšdow
;

52 
	m¹_œ‰
;

55 
	#¹_mss
 
¹_mtu


	)

58 
	sš6_¹msg


60 
š6_addr
 
	m¹msg_d¡
;

61 
š6_addr
 
	m¹msg_¤c
;

62 
š6_addr
 
	m¹msg_g©eway
;

63 
u_št32_t
 
	m¹msg_ty³
;

64 
u_št16_t
 
	m¹msg_d¡_Ën
;

65 
u_št16_t
 
	m¹msg_¤c_Ën
;

66 
u_št32_t
 
	m¹msg_m‘ric
;

67 
	m¹msg_šfo
;

68 
u_št32_t
 
	m¹msg_æags
;

69 
	m¹msg_ifšdex
;

73 
	#RTF_UP
 0x0001

	)

74 
	#RTF_GATEWAY
 0x0002

	)

76 
	#RTF_HOST
 0x0004

	)

77 
	#RTF_REINSTATE
 0x0008

	)

78 
	#RTF_DYNAMIC
 0x0010

	)

79 
	#RTF_MODIFIED
 0x0020

	)

80 
	#RTF_MTU
 0x0040

	)

81 
	#RTF_MSS
 
RTF_MTU


	)

82 
	#RTF_WINDOW
 0x0080

	)

83 
	#RTF_IRTT
 0x0100

	)

84 
	#RTF_REJECT
 0x0200

	)

85 
	#RTF_STATIC
 0x0400

	)

86 
	#RTF_XRESOLVE
 0x0800

	)

87 
	#RTF_NOFORWARD
 0x1000

	)

88 
	#RTF_THROW
 0x2000

	)

89 
	#RTF_NOPMTUDISC
 0x4000

	)

92 
	#RTF_DEFAULT
 0x00010000

	)

93 
	#RTF_ALLONLINK
 0x00020000

	)

94 
	#RTF_ADDRCONF
 0x00040000

	)

96 
	#RTF_LINKRT
 0x00100000

	)

97 
	#RTF_NONEXTHOP
 0x00200000

	)

99 
	#RTF_CACHE
 0x01000000

	)

100 
	#RTF_FLOW
 0x02000000

	)

101 
	#RTF_POLICY
 0x04000000

	)

103 
	#RTCF_VALVE
 0x00200000

	)

104 
	#RTCF_MASQ
 0x00400000

	)

105 
	#RTCF_NAT
 0x00800000

	)

106 
	#RTCF_DOREDIRECT
 0x01000000

	)

107 
	#RTCF_LOG
 0x02000000

	)

108 
	#RTCF_DIRECTSRC
 0x04000000

	)

110 
	#RTF_LOCAL
 0x80000000

	)

111 
	#RTF_INTERFACE
 0x40000000

	)

112 
	#RTF_MULTICAST
 0x20000000

	)

113 
	#RTF_BROADCAST
 0x10000000

	)

114 
	#RTF_NAT
 0x08000000

	)

116 
	#RTF_ADDRCLASSMASK
 0xF8000000

	)

117 
	#RT_ADDRCLASS
(
æags
è((
__u_št32_t
èæag >> 23)

	)

119 
	#RT_TOS
(
tos
è(Ñosè& 
IPTOS_TOS_MASK
)

	)

121 
	#RT_LOCALADDR
(
æags
è((æag & 
RTF_ADDRCLASSMASK
) \

122 =ğ(
RTF_LOCAL
|
RTF_INTERFACE
))

	)

124 
	#RT_CLASS_UNSPEC
 0

	)

125 
	#RT_CLASS_DEFAULT
 253

	)

127 
	#RT_CLASS_MAIN
 254

	)

128 
	#RT_CLASS_LOCAL
 255

	)

129 
	#RT_CLASS_MAX
 255

	)

132 
	#RTMSG_ACK
 
NLMSG_ACK


	)

133 
	#RTMSG_OVERRUN
 
NLMSG_OVERRUN


	)

135 
	#RTMSG_NEWDEVICE
 0x11

	)

136 
	#RTMSG_DELDEVICE
 0x12

	)

137 
	#RTMSG_NEWROUTE
 0x21

	)

138 
	#RTMSG_DELROUTE
 0x22

	)

139 
	#RTMSG_NEWRULE
 0x31

	)

140 
	#RTMSG_DELRULE
 0x32

	)

141 
	#RTMSG_CONTROL
 0x40

	)

143 
	#RTMSG_AR_FAILED
 0x51

	)

	@/usr/include/asm-generic/param.h

1 #iâdeà
__ASM_GENERIC_PARAM_H


2 
	#__ASM_GENERIC_PARAM_H


	)

5 #iâdeà
HZ


6 
	#HZ
 100

	)

9 #iâdeà
EXEC_PAGESIZE


10 
	#EXEC_PAGESIZE
 4096

	)

13 #iâdeà
NOGROUP


14 
	#NOGROUP
 (-1)

	)

17 
	#MAXHOSTNAMELEN
 64

	)

	@/usr/include/asm/byteorder.h

1 #iâdeà
_ASM_X86_BYTEORDER_H


2 
	#_ASM_X86_BYTEORDER_H


	)

4 
	~<lšux/by‹Üd”/l™e_’dŸn.h
>

	@/usr/include/asm/errno.h

1 
	~<asm-g’”ic/”ºo.h
>

	@/usr/include/asm/fcntl.h

1 
	~<asm-g’”ic/fú.h
>

	@/usr/include/asm/poll.h

1 
	~<asm-g’”ic/pŞl.h
>

	@/usr/include/asm/socket.h

1 
	~<asm-g’”ic/sock‘.h
>

	@/usr/include/asm/sockios.h

1 
	~<asm-g’”ic/sockios.h
>

	@/usr/include/asm/types.h

1 #iâdeà
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-g’”ic/ty³s.h
>

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__


4 
	#__WORDSIZE
 64

	)

5 
	#__WORDSIZE_COMPAT32
 1

	)

7 
	#__WORDSIZE
 32

	)

	@/usr/include/features.h

19 #iâdef 
_FEATURES_H


20 
	#_FEATURES_H
 1

	)

96 #undeà
__USE_ISOC99


97 #undeà
__USE_ISOC95


98 #undeà
__USE_POSIX


99 #undeà
__USE_POSIX2


100 #undeà
__USE_POSIX199309


101 #undeà
__USE_POSIX199506


102 #undeà
__USE_XOPEN


103 #undeà
__USE_XOPEN_EXTENDED


104 #undeà
__USE_UNIX98


105 #undeà
__USE_XOPEN2K


106 #undeà
__USE_XOPEN2KXSI


107 #undeà
__USE_XOPEN2K8


108 #undeà
__USE_XOPEN2K8XSI


109 #undeà
__USE_LARGEFILE


110 #undeà
__USE_LARGEFILE64


111 #undeà
__USE_FILE_OFFSET64


112 #undeà
__USE_BSD


113 #undeà
__USE_SVID


114 #undeà
__USE_MISC


115 #undeà
__USE_ATFILE


116 #undeà
__USE_GNU


117 #undeà
__USE_REENTRANT


118 #undeà
__USE_FORTIFY_LEVEL


119 #undeà
__FAVOR_BSD


120 #undeà
__KERNEL_STRICT_NAMES


124 #iâdeà
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

129 
	#__USE_ANSI
 1

	)

138 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


139 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

140 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

142 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

147 #ià
defšed
 
_BSD_SOURCE
 && \

148 !(
defšed
 
	g_POSIX_SOURCE
 || defšed 
	g_POSIX_C_SOURCE
 || \

149 
defšed
 
	g_XOPEN_SOURCE
 || defšed 
	g_GNU_SOURCE
 || defšed 
	g_SVID_SOURCE
)

150 
	#__FAVOR_BSD
 1

	)

154 #ifdeà
_GNU_SOURCE


155 #undeà
_ISOC95_SOURCE


156 
	#_ISOC95_SOURCE
 1

	)

157 #undeà
_ISOC99_SOURCE


158 
	#_ISOC99_SOURCE
 1

	)

159 #undeà
_POSIX_SOURCE


160 
	#_POSIX_SOURCE
 1

	)

161 #undeà
_POSIX_C_SOURCE


162 
	#_POSIX_C_SOURCE
 200809L

	)

163 #undeà
_XOPEN_SOURCE


164 
	#_XOPEN_SOURCE
 700

	)

165 #undeà
_XOPEN_SOURCE_EXTENDED


166 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

167 #undeà
_LARGEFILE64_SOURCE


168 
	#_LARGEFILE64_SOURCE
 1

	)

169 #undeà
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #undeà
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #undeà
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #ià(!
defšed
 
__STRICT_ANSI__
 && !defšed 
_ISOC99_SOURCE
 && \

180 !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 && \

181 !
defšed
 
	g_XOPEN_SOURCE
 && !defšed 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
)

182 
	#_BSD_SOURCE
 1

	)

183 
	#_SVID_SOURCE
 1

	)

190 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

191 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

192 
	#__USE_ISOC99
 1

	)

196 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC9X_SOURCE
 \

197 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

198 
	#__USE_ISOC95
 1

	)

203 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

204 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

205 
	#_POSIX_SOURCE
 1

	)

206 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

207 
	#_POSIX_C_SOURCE
 2

	)

208 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

209 
	#_POSIX_C_SOURCE
 199506L

	)

210 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

211 
	#_POSIX_C_SOURCE
 200112L

	)

213 
	#_POSIX_C_SOURCE
 200809L

	)

215 
	#__USE_POSIX_IMPLICITLY
 1

	)

218 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


219 
	#__USE_POSIX
 1

	)

222 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


223 
	#__USE_POSIX2
 1

	)

226 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

227 
	#__USE_POSIX199309
 1

	)

230 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

231 
	#__USE_POSIX199506
 1

	)

234 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

235 
	#__USE_XOPEN2K
 1

	)

236 #undeà
__USE_ISOC95


237 
	#__USE_ISOC95
 1

	)

238 #undeà
__USE_ISOC99


239 
	#__USE_ISOC99
 1

	)

242 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

243 
	#__USE_XOPEN2K8
 1

	)

244 #undeà
_ATFILE_SOURCE


245 
	#_ATFILE_SOURCE
 1

	)

248 #ifdef 
_XOPEN_SOURCE


249 
	#__USE_XOPEN
 1

	)

250 #ià(
_XOPEN_SOURCE
 - 0) >= 500

251 
	#__USE_XOPEN_EXTENDED
 1

	)

252 
	#__USE_UNIX98
 1

	)

253 #undeà
_LARGEFILE_SOURCE


254 
	#_LARGEFILE_SOURCE
 1

	)

255 #ià(
_XOPEN_SOURCE
 - 0) >= 600

256 #ià(
_XOPEN_SOURCE
 - 0) >= 700

257 
	#__USE_XOPEN2K8
 1

	)

258 
	#__USE_XOPEN2K8XSI
 1

	)

260 
	#__USE_XOPEN2K
 1

	)

261 
	#__USE_XOPEN2KXSI
 1

	)

262 #undeà
__USE_ISOC95


263 
	#__USE_ISOC95
 1

	)

264 #undeà
__USE_ISOC99


265 
	#__USE_ISOC99
 1

	)

268 #ifdeà
_XOPEN_SOURCE_EXTENDED


269 
	#__USE_XOPEN_EXTENDED
 1

	)

274 #ifdeà
_LARGEFILE_SOURCE


275 
	#__USE_LARGEFILE
 1

	)

278 #ifdeà
_LARGEFILE64_SOURCE


279 
	#__USE_LARGEFILE64
 1

	)

282 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

283 
	#__USE_FILE_OFFSET64
 1

	)

286 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


287 
	#__USE_MISC
 1

	)

290 #ifdef 
_BSD_SOURCE


291 
	#__USE_BSD
 1

	)

294 #ifdef 
_SVID_SOURCE


295 
	#__USE_SVID
 1

	)

298 #ifdef 
_ATFILE_SOURCE


299 
	#__USE_ATFILE
 1

	)

302 #ifdef 
_GNU_SOURCE


303 
	#__USE_GNU
 1

	)

306 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


307 
	#__USE_REENTRANT
 1

	)

310 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

311 && 
defšed
 
__OPTIMIZE__
 && __OPTIMIZE__ > 0

312 #ià!
__GNUC_PREREQ
 (4, 1)

313 #ifdeà
__GNUC_RH_RELEASE__


314 #w¬nšg 
_FORTIFY_SOURCE
 
suµÜ‹d
 
Úly
 
w™h
 
GCC
 4.1 
ªd
 
Ï‹r


316 
	#__USE_FORTIFY_LEVEL
 0

	)

317 #–ià
_FORTIFY_SOURCE
 > 1

318 
	#__USE_FORTIFY_LEVEL
 2

	)

320 
	#__USE_FORTIFY_LEVEL
 1

	)

323 
	#__USE_FORTIFY_LEVEL
 0

	)

327 
	#__STDC_IEC_559__
 1

	)

328 
	#__STDC_IEC_559_COMPLEX__
 1

	)

331 
	#__STDC_ISO_10646__
 200009L

	)

339 #undeà
__GNU_LIBRARY__


340 
	#__GNU_LIBRARY__
 6

	)

344 
	#__GLIBC__
 2

	)

345 
	#__GLIBC_MINOR__
 12

	)

347 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

348 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

351 #ià
defšed
 
__GNUC__
 \

352 || (
defšed
 
	g__PGI
 && defšed 
	g__i386__
 ) \

353 || (
defšed
 
	g__INTEL_COMPILER
 && (defšed 
	g__i386__
 || defšed 
	g__Ÿ64__
)) \

354 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

355 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

359 #iâdeà
__ASSEMBLER__


360 #iâdeà
_SYS_CDEFS_H


361 
	~<sys/cdefs.h
>

366 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


367 
	#__USE_LARGEFILE
 1

	)

368 
	#__USE_LARGEFILE64
 1

	)

374 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

375 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

376 && 
defšed
 
	g__ex‹º_šlše


377 
	#__USE_EXTERN_INLINES
 1

	)

385 
	~<gnu/¡ubs.h
>

	@/usr/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<lšux/ty³s.h
>

23 
	~<lšux/sock‘.h
>

26 
	#IFNAMSIZ
 16

	)

27 
	#IFALIASZ
 256

	)

28 
	~<lšux/hdlc/ioùl.h
>

31 
	#IFF_UP
 0x1

	)

32 
	#IFF_BROADCAST
 0x2

	)

33 
	#IFF_DEBUG
 0x4

	)

34 
	#IFF_LOOPBACK
 0x8

	)

35 
	#IFF_POINTOPOINT
 0x10

	)

36 
	#IFF_NOTRAILERS
 0x20

	)

37 
	#IFF_RUNNING
 0x40

	)

38 
	#IFF_NOARP
 0x80

	)

39 
	#IFF_PROMISC
 0x100

	)

40 
	#IFF_ALLMULTI
 0x200

	)

42 
	#IFF_MASTER
 0x400

	)

43 
	#IFF_SLAVE
 0x800

	)

45 
	#IFF_MULTICAST
 0x1000

	)

47 
	#IFF_PORTSEL
 0x2000

	)

48 
	#IFF_AUTOMEDIA
 0x4000

	)

49 
	#IFF_DYNAMIC
 0x8000

	)

51 
	#IFF_LOWER_UP
 0x10000

	)

52 
	#IFF_DORMANT
 0x20000

	)

54 
	#IFF_ECHO
 0x40000

	)

56 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

57 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

60 
	#IFF_802_1Q_VLAN
 0x1

	)

61 
	#IFF_EBRIDGE
 0x2

	)

62 
	#IFF_SLAVE_INACTIVE
 0x4

	)

63 
	#IFF_MASTER_8023AD
 0x8

	)

64 
	#IFF_MASTER_ALB
 0x10

	)

65 
	#IFF_BONDING
 0x20

	)

66 
	#IFF_SLAVE_NEEDARP
 0x40

	)

67 
	#IFF_ISATAP
 0x80

	)

68 
	#IFF_MASTER_ARPMON
 0x100

	)

69 
	#IFF_WAN_HDLC
 0x200

	)

70 
	#IFF_XMIT_DST_RELEASE
 0x400

	)

73 
	#IFF_IN_NETPOLL
 0x800

	)

74 
	#IFF_DISABLE_NETPOLL
 0x1000

	)

75 
	#IFF_BRIDGE_PORT
 0x2000

	)

76 
	#IFF_MACVLAN_PORT
 0x4000

	)

77 
	#IFF_OVS_DATAPATH
 0x8000

	)

81 
	#IFF_TX_SKB_SHARING
 0x10000

	)

83 
	#IFF_DONT_BRIDGE
 0x20000

	)

84 
	#IFF_NO_UNICAST_FLT
 0x40000

	)

86 
	#IFF_LIVE_ADDR_CHANGE
 0x100000

	)

89 
	#IF_GET_IFACE
 0x0001

	)

90 
	#IF_GET_PROTO
 0x0002

	)

93 
	#IF_IFACE_V35
 0x1000

	)

94 
	#IF_IFACE_V24
 0x1001

	)

95 
	#IF_IFACE_X21
 0x1002

	)

96 
	#IF_IFACE_T1
 0x1003

	)

97 
	#IF_IFACE_E1
 0x1004

	)

98 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

99 
	#IF_IFACE_X21D
 0x1006

	)

102 
	#IF_PROTO_HDLC
 0x2000

	)

103 
	#IF_PROTO_PPP
 0x2001

	)

104 
	#IF_PROTO_CISCO
 0x2002

	)

105 
	#IF_PROTO_FR
 0x2003

	)

106 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

107 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

108 
	#IF_PROTO_X25
 0x2006

	)

109 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

110 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

111 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

112 
	#IF_PROTO_FR_PVC
 0x200A

	)

113 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

114 
	#IF_PROTO_RAW
 0x200C

	)

118 
	mIF_OPER_UNKNOWN
,

119 
	mIF_OPER_NOTPRESENT
,

120 
	mIF_OPER_DOWN
,

121 
	mIF_OPER_LOWERLAYERDOWN
,

122 
	mIF_OPER_TESTING
,

123 
	mIF_OPER_DORMANT
,

124 
	mIF_OPER_UP
,

129 
	mIF_LINK_MODE_DEFAULT
,

130 
	mIF_LINK_MODE_DORMANT
,

143 
	sifm­


145 
	mmem_¡¬t
;

146 
	mmem_’d
;

147 
	mba£_addr
;

148 
	mœq
;

149 
	mdma
;

150 
	mpÜt
;

154 
	sif_£‰šgs


156 
	mty³
;

157 
	msize
;

160 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

161 
cisco_´Ùo
 *
	mcisco
;

162 
ä_´Ùo
 *
	mä
;

163 
ä_´Ùo_pvc
 *
	mä_pvc
;

164 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

167 
sync_£rŸl_£‰šgs
 *
	msync
;

168 
‹1_£‰šgs
 *
	m‹1
;

169 } 
	mifs_ifsu
;

179 
	siäeq


181 
	#IFHWADDRLEN
 6

	)

184 
	miän_Çme
[
IFNAMSIZ
];

185 } 
	miä_iän
;

188 
sockaddr
 
	miäu_addr
;

189 
sockaddr
 
	miäu_d¡addr
;

190 
sockaddr
 
	miäu_brßdaddr
;

191 
sockaddr
 
	miäu_Ãtmask
;

192 
sockaddr
 
	miäu_hwaddr
;

193 
	miäu_æags
;

194 
	miäu_iv®ue
;

195 
	miäu_mtu
;

196 
ifm­
 
	miäu_m­
;

197 
	miäu_¦ave
[
IFNAMSIZ
];

198 
	miäu_ÃwÇme
[
IFNAMSIZ
];

199 * 
	miäu_d©a
;

200 
if_£‰šgs
 
	miäu_£‰šgs
;

201 } 
	miä_iäu
;

204 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

205 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

206 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

207 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

208 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

209 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

210 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

211 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

212 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

213 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

214 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

215 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

216 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

217 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

218 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

219 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

220 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

229 
	sifcÚf


231 
	mifc_Ën
;

234 *
	mifcu_buf
;

235 
iäeq
 *
	mifcu_»q
;

236 } 
	mifc_ifcu
;

238 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

239 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_DEC
 0x6000

	)

52 
	#ETH_P_DNA_DL
 0x6001

	)

53 
	#ETH_P_DNA_RC
 0x6002

	)

54 
	#ETH_P_DNA_RT
 0x6003

	)

55 
	#ETH_P_LAT
 0x6004

	)

56 
	#ETH_P_DIAG
 0x6005

	)

57 
	#ETH_P_CUST
 0x6006

	)

58 
	#ETH_P_SCA
 0x6007

	)

59 
	#ETH_P_TEB
 0x6558

	)

60 
	#ETH_P_RARP
 0x8035

	)

61 
	#ETH_P_ATALK
 0x809B

	)

62 
	#ETH_P_AARP
 0x80F3

	)

63 
	#ETH_P_8021Q
 0x8100

	)

64 
	#ETH_P_IPX
 0x8137

	)

65 
	#ETH_P_IPV6
 0x86DD

	)

66 
	#ETH_P_PAUSE
 0x8808

	)

67 
	#ETH_P_SLOW
 0x8809

	)

68 
	#ETH_P_WCCP
 0x883E

	)

70 
	#ETH_P_PPP_DISC
 0x8863

	)

71 
	#ETH_P_PPP_SES
 0x8864

	)

72 
	#ETH_P_MPLS_UC
 0x8847

	)

73 
	#ETH_P_MPLS_MC
 0x8848

	)

74 
	#ETH_P_ATMMPOA
 0x884ø

	)

75 
	#ETH_P_ATMFATE
 0x8884

	)

78 
	#ETH_P_PAE
 0x888E

	)

79 
	#ETH_P_AOE
 0x88A2

	)

80 
	#ETH_P_8021AD
 0x88A8

	)

81 
	#ETH_P_TIPC
 0x88CA

	)

82 
	#ETH_P_8021AH
 0x88E7

	)

83 
	#ETH_P_1588
 0x88F7

	)

84 
	#ETH_P_FCOE
 0x8906

	)

85 
	#ETH_P_TDLS
 0x890D

	)

86 
	#ETH_P_FIP
 0x8914

	)

87 
	#ETH_P_80221
 0x8917

	)

88 
	#ETH_P_LOOPBACK
 0x9000

	)

89 
	#ETH_P_QINQ1
 0x9100

	)

90 
	#ETH_P_QINQ2
 0x9200

	)

91 
	#ETH_P_QINQ3
 0x9300

	)

92 
	#ETH_P_EDSA
 0xDADA

	)

93 
	#ETH_P_AF_IUCV
 0xFBFB

	)

95 
	#ETH_P_802_3_MIN
 0x0600

	)

102 
	#ETH_P_802_3
 0x0001

	)

103 
	#ETH_P_AX25
 0x0002

	)

104 
	#ETH_P_ALL
 0x0003

	)

105 
	#ETH_P_802_2
 0x0004

	)

106 
	#ETH_P_SNAP
 0x0005

	)

107 
	#ETH_P_DDCMP
 0x0006

	)

108 
	#ETH_P_WAN_PPP
 0x0007

	)

109 
	#ETH_P_PPP_MP
 0x0008

	)

110 
	#ETH_P_LOCALTALK
 0x0009

	)

111 
	#ETH_P_CAN
 0x000C

	)

112 
	#ETH_P_PPPTALK
 0x0010

	)

113 
	#ETH_P_TR_802_2
 0x0011

	)

114 
	#ETH_P_MOBITEX
 0x0015

	)

115 
	#ETH_P_CONTROL
 0x0016

	)

116 
	#ETH_P_IRDA
 0x0017

	)

117 
	#ETH_P_ECONET
 0x0018

	)

118 
	#ETH_P_HDLC
 0x0019

	)

119 
	#ETH_P_ARCNET
 0x001A

	)

120 
	#ETH_P_DSA
 0x001B

	)

121 
	#ETH_P_TRAILER
 0x001C

	)

122 
	#ETH_P_PHONET
 0x00F5

	)

123 
	#ETH_P_IEEE802154
 0x00F6

	)

129 
	s‘hhdr
 {

130 
	mh_de¡
[
ETH_ALEN
];

131 
	mh_sourû
[
ETH_ALEN
];

132 
__be16
 
	mh_´Ùo
;

133 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/if_link.h

1 #iâdeà
_LINUX_IF_LINK_H


2 
	#_LINUX_IF_LINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

8 
	s¹Æ_lšk_¡©s
 {

9 
__u32
 
	mrx_·ck‘s
;

10 
__u32
 
	mtx_·ck‘s
;

11 
__u32
 
	mrx_by‹s
;

12 
__u32
 
	mtx_by‹s
;

13 
__u32
 
	mrx_”rÜs
;

14 
__u32
 
	mtx_”rÜs
;

15 
__u32
 
	mrx_drİ³d
;

16 
__u32
 
	mtx_drİ³d
;

17 
__u32
 
	mmuÉiÿ¡
;

18 
__u32
 
	mcŞlisiÚs
;

21 
__u32
 
	mrx_Ëngth_”rÜs
;

22 
__u32
 
	mrx_ov”_”rÜs
;

23 
__u32
 
	mrx_üc_”rÜs
;

24 
__u32
 
	mrx_äame_”rÜs
;

25 
__u32
 
	mrx_fifo_”rÜs
;

26 
__u32
 
	mrx_mis£d_”rÜs
;

29 
__u32
 
	mtx_abÜ‹d_”rÜs
;

30 
__u32
 
	mtx_ÿ¼›r_”rÜs
;

31 
__u32
 
	mtx_fifo_”rÜs
;

32 
__u32
 
	mtx_h—¹b—t_”rÜs
;

33 
__u32
 
	mtx_wšdow_”rÜs
;

36 
__u32
 
	mrx_com´es£d
;

37 
__u32
 
	mtx_com´es£d
;

41 
	s¹Æ_lšk_¡©s64
 {

42 
__u64
 
	mrx_·ck‘s
;

43 
__u64
 
	mtx_·ck‘s
;

44 
__u64
 
	mrx_by‹s
;

45 
__u64
 
	mtx_by‹s
;

46 
__u64
 
	mrx_”rÜs
;

47 
__u64
 
	mtx_”rÜs
;

48 
__u64
 
	mrx_drİ³d
;

49 
__u64
 
	mtx_drİ³d
;

50 
__u64
 
	mmuÉiÿ¡
;

51 
__u64
 
	mcŞlisiÚs
;

54 
__u64
 
	mrx_Ëngth_”rÜs
;

55 
__u64
 
	mrx_ov”_”rÜs
;

56 
__u64
 
	mrx_üc_”rÜs
;

57 
__u64
 
	mrx_äame_”rÜs
;

58 
__u64
 
	mrx_fifo_”rÜs
;

59 
__u64
 
	mrx_mis£d_”rÜs
;

62 
__u64
 
	mtx_abÜ‹d_”rÜs
;

63 
__u64
 
	mtx_ÿ¼›r_”rÜs
;

64 
__u64
 
	mtx_fifo_”rÜs
;

65 
__u64
 
	mtx_h—¹b—t_”rÜs
;

66 
__u64
 
	mtx_wšdow_”rÜs
;

69 
__u64
 
	mrx_com´es£d
;

70 
__u64
 
	mtx_com´es£d
;

74 
	s¹Æ_lšk_ifm­


76 
__u64
 
	mmem_¡¬t
;

77 
__u64
 
	mmem_’d
;

78 
__u64
 
	mba£_addr
;

79 
__u16
 
	mœq
;

80 
__u8
 
	mdma
;

81 
__u8
 
	mpÜt
;

103 
	mIFLA_UNSPEC
,

104 
	mIFLA_ADDRESS
,

105 
	mIFLA_BROADCAST
,

106 
	mIFLA_IFNAME
,

107 
	mIFLA_MTU
,

108 
	mIFLA_LINK
,

109 
	mIFLA_QDISC
,

110 
	mIFLA_STATS
,

111 
	mIFLA_COST
,

112 
	#IFLA_COST
 
IFLA_COST


	)

113 
	mIFLA_PRIORITY
,

114 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

115 
	mIFLA_MASTER
,

116 
	#IFLA_MASTER
 
IFLA_MASTER


	)

117 
	mIFLA_WIRELESS
,

118 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

119 
	mIFLA_PROTINFO
,

120 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

121 
	mIFLA_TXQLEN
,

122 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

123 
	mIFLA_MAP
,

124 
	#IFLA_MAP
 
IFLA_MAP


	)

125 
	mIFLA_WEIGHT
,

126 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

127 
	mIFLA_OPERSTATE
,

128 
	mIFLA_LINKMODE
,

129 
	mIFLA_LINKINFO
,

130 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

131 
	mIFLA_NET_NS_PID
,

132 
	mIFLA_IFALIAS
,

133 
	mIFLA_NUM_VF
,

134 
	mIFLA_VFINFO_LIST
,

135 
	mIFLA_STATS64
,

136 
	mIFLA_VF_PORTS
,

137 
	mIFLA_PORT_SELF
,

138 
	mIFLA_AF_SPEC
,

139 
	mIFLA_GROUP
,

140 
	mIFLA_NET_NS_FD
,

141 
	mIFLA_EXT_MASK
,

142 
	mIFLA_PROMISCUITY
,

143 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

144 
	mIFLA_NUM_TX_QUEUES
,

145 
	mIFLA_NUM_RX_QUEUES
,

146 
	mIFLA_CARRIER
,

147 
	mIFLA_PHYS_PORT_ID
,

148 
	m__IFLA_MAX


152 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

155 
	#IFLA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
ifšfomsg
))))

	)

156 
	#IFLA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
ifšfomsg
))

	)

159 
	mIFLA_INET_UNSPEC
,

160 
	mIFLA_INET_CONF
,

161 
	m__IFLA_INET_MAX
,

164 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

198 
	mIFLA_INET6_UNSPEC
,

199 
	mIFLA_INET6_FLAGS
,

200 
	mIFLA_INET6_CONF
,

201 
	mIFLA_INET6_STATS
,

202 
	mIFLA_INET6_MCAST
,

203 
	mIFLA_INET6_CACHEINFO
,

204 
	mIFLA_INET6_ICMP6STATS
,

205 
	mIFLA_INET6_TOKEN
,

206 
	m__IFLA_INET6_MAX


209 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

211 
	siæa_ÿchešfo


213 
__u32
 
	mmax_»asm_Ën
;

214 
__u32
 
	mt¡amp
;

215 
__u32
 
	m»achabË_time
;

216 
__u32
 
	m»Œªs_time
;

221 
	mIFLA_INFO_UNSPEC
,

222 
	mIFLA_INFO_KIND
,

223 
	mIFLA_INFO_DATA
,

224 
	mIFLA_INFO_XSTATS
,

225 
	m__IFLA_INFO_MAX
,

228 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

234 
	mIFLA_VLAN_UNSPEC
,

235 
	mIFLA_VLAN_ID
,

236 
	mIFLA_VLAN_FLAGS
,

237 
	mIFLA_VLAN_EGRESS_QOS
,

238 
	mIFLA_VLAN_INGRESS_QOS
,

239 
	m__IFLA_VLAN_MAX
,

242 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

244 
	siæa_vÏn_æags
 {

245 
__u32
 
	mæags
;

246 
__u32
 
	mmask
;

251 
	mIFLA_VLAN_QOS_UNSPEC
,

252 
	mIFLA_VLAN_QOS_MAPPING
,

253 
	m__IFLA_VLAN_QOS_MAX


256 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

258 
	siæa_vÏn_qos_m­pšg


260 
__u32
 
	mäom
;

261 
__u32
 
	mto
;

266 
	mIFLA_MACVLAN_UNSPEC
,

267 
	mIFLA_MACVLAN_MODE
,

268 
	m__IFLA_MACVLAN_MAX
,

271 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

273 
	emacvÏn_mode
 {

274 
	mMACVLAN_MODE_PRIVATE
 = 1,

275 
	mMACVLAN_MODE_VEPA
 = 2,

276 
	mMACVLAN_MODE_BRIDGE
 = 4,

277 
	mMACVLAN_MODE_PASSTHRU
 = 8,

282 
	mIFLA_VXLAN_UNSPEC
,

283 
	mIFLA_VXLAN_ID
,

284 
	mIFLA_VXLAN_GROUP
,

285 
	mIFLA_VXLAN_LINK
,

286 
	mIFLA_VXLAN_LOCAL
,

287 
	mIFLA_VXLAN_TTL
,

288 
	mIFLA_VXLAN_TOS
,

289 
	mIFLA_VXLAN_LEARNING
,

290 
	mIFLA_VXLAN_AGEING
,

291 
	mIFLA_VXLAN_LIMIT
,

292 
	mIFLA_VXLAN_PORT_RANGE
,

293 
	mIFLA_VXLAN_PROXY
,

294 
	mIFLA_VXLAN_RSC
,

295 
	mIFLA_VXLAN_L2MISS
,

296 
	mIFLA_VXLAN_L3MISS
,

297 
	mIFLA_VXLAN_PORT
,

298 
	m__IFLA_VXLAN_MAX


300 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

302 
	siæa_vxÏn_pÜt_¿nge
 {

303 
__be16
 
	mlow
;

304 
__be16
 
	mhigh
;

310 
	mIFLA_BOND_UNSPEC
,

311 
	mIFLA_BOND_MODE
,

312 
	mIFLA_BOND_ACTIVE_SLAVE
,

313 
	mIFLA_BOND_MIIMON
,

314 
	mIFLA_BOND_UPDELAY
,

315 
	mIFLA_BOND_DOWNDELAY
,

316 
	mIFLA_BOND_USE_CARRIER
,

317 
	mIFLA_BOND_ARP_INTERVAL
,

318 
	mIFLA_BOND_ARP_IP_TARGET
,

319 
	mIFLA_BOND_ARP_VALIDATE
,

320 
	mIFLA_BOND_ARP_ALL_TARGETS
,

321 
	mIFLA_BOND_PRIMARY
,

322 
	mIFLA_BOND_PRIMARY_RESELECT
,

323 
	mIFLA_BOND_FAIL_OVER_MAC
,

324 
	mIFLA_BOND_XMIT_HASH_POLICY
,

325 
	mIFLA_BOND_RESEND_IGMP
,

326 
	mIFLA_BOND_NUM_PEER_NOTIF
,

327 
	mIFLA_BOND_ALL_SLAVES_ACTIVE
,

328 
	mIFLA_BOND_MIN_LINKS
,

329 
	mIFLA_BOND_LP_INTERVAL
,

330 
	mIFLA_BOND_PACKETS_PER_SLAVE
,

331 
	mIFLA_BOND_AD_LACP_RATE
,

332 
	mIFLA_BOND_AD_SELECT
,

333 
	mIFLA_BOND_AD_INFO
,

334 
	m__IFLA_BOND_MAX
,

337 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

340 
	mIFLA_BOND_AD_INFO_AGGREGATOR
,

341 
	mIFLA_BOND_AD_INFO_NUM_PORTS
,

342 
	mIFLA_BOND_AD_INFO_ACTOR_KEY
,

343 
	mIFLA_BOND_AD_INFO_PARTNER_KEY
,

344 
	mIFLA_BOND_AD_INFO_PARTNER_MAC
,

345 
	m__IFLA_BOND_AD_INFO_MAX
,

348 
	#IFLA_BOND_AD_INFO_MAX
 (
__IFLA_BOND_AD_INFO_MAX
 - 1)

	)

353 
	mIFLA_VF_INFO_UNSPEC
,

354 
	mIFLA_VF_INFO
,

355 
	m__IFLA_VF_INFO_MAX
,

358 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

361 
	mIFLA_VF_UNSPEC
,

362 
	mIFLA_VF_MAC
,

363 
	mIFLA_VF_VLAN
,

364 
	mIFLA_VF_TX_RATE
,

365 
	mIFLA_VF_SPOOFCHK
,

366 
	mIFLA_VF_LINK_STATE
,

367 
	m__IFLA_VF_MAX
,

370 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

372 
	siæa_vf_mac
 {

373 
__u32
 
	mvf
;

374 
__u8
 
	mmac
[32];

377 
	siæa_vf_vÏn
 {

378 
__u32
 
	mvf
;

379 
__u32
 
	mvÏn
;

380 
__u32
 
	mqos
;

383 
	siæa_vf_tx_¿‹
 {

384 
__u32
 
	mvf
;

385 
__u32
 
	m¿‹
;

388 
	siæa_vf_¥oofchk
 {

389 
__u32
 
	mvf
;

390 
__u32
 
	m£‰šg
;

394 
	mIFLA_VF_LINK_STATE_AUTO
,

395 
	mIFLA_VF_LINK_STATE_ENABLE
,

396 
	mIFLA_VF_LINK_STATE_DISABLE
,

397 
	m__IFLA_VF_LINK_STATE_MAX
,

400 
	siæa_vf_lšk_¡©e
 {

401 
__u32
 
	mvf
;

402 
__u32
 
	mlšk_¡©e
;

422 
	mIFLA_VF_PORT_UNSPEC
,

423 
	mIFLA_VF_PORT
,

424 
	m__IFLA_VF_PORT_MAX
,

427 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

430 
	mIFLA_PORT_UNSPEC
,

431 
	mIFLA_PORT_VF
,

432 
	mIFLA_PORT_PROFILE
,

433 
	mIFLA_PORT_VSI_TYPE
,

434 
	mIFLA_PORT_INSTANCE_UUID
,

435 
	mIFLA_PORT_HOST_UUID
,

436 
	mIFLA_PORT_REQUEST
,

437 
	mIFLA_PORT_RESPONSE
,

438 
	m__IFLA_PORT_MAX
,

441 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

443 
	#PORT_PROFILE_MAX
 40

	)

444 
	#PORT_UUID_MAX
 16

	)

445 
	#PORT_SELF_VF
 -1

	)

448 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

449 
	mPORT_REQUEST_PREASSOCIATE_RR
,

450 
	mPORT_REQUEST_ASSOCIATE
,

451 
	mPORT_REQUEST_DISASSOCIATE
,

455 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

456 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

457 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

458 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

459 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

460 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

461 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

463 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

464 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

465 
	mPORT_PROFILE_RESPONSE_INVALID
,

466 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

467 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

468 
	mPORT_PROFILE_RESPONSE_ERROR
,

471 
	siæa_pÜt_vsi
 {

472 
__u8
 
	mvsi_mgr_id
;

473 
__u8
 
	mvsi_ty³_id
[3];

474 
__u8
 
	mvsi_ty³_v”siÚ
;

475 
__u8
 
	m·d
[3];

482 
	mIFLA_IPOIB_UNSPEC
,

483 
	mIFLA_IPOIB_PKEY
,

484 
	mIFLA_IPOIB_MODE
,

485 
	mIFLA_IPOIB_UMCAST
,

486 
	m__IFLA_IPOIB_MAX


490 
	mIPOIB_MODE_DATAGRAM
 = 0,

491 
	mIPOIB_MODE_CONNECTED
 = 1,

494 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

	@/usr/include/linux/if_packet.h

1 #iâdeà
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<lšux/ty³s.h
>

6 
	ssockaddr_pkt


8 
	m¥kt_çmy
;

9 
	m¥kt_deviû
[14];

10 
__be16
 
	m¥kt_´ÙocŞ
;

13 
	ssockaddr_Î


15 
	m¦l_çmy
;

16 
__be16
 
	m¦l_´ÙocŞ
;

17 
	m¦l_ifšdex
;

18 
	m¦l_h©y³
;

19 
	m¦l_pk‰y³
;

20 
	m¦l_h®’
;

21 
	m¦l_addr
[8];

26 
	#PACKET_HOST
 0

	)

27 
	#PACKET_BROADCAST
 1

	)

28 
	#PACKET_MULTICAST
 2

	)

29 
	#PACKET_OTHERHOST
 3

	)

30 
	#PACKET_OUTGOING
 4

	)

32 
	#PACKET_LOOPBACK
 5

	)

33 
	#PACKET_FASTROUTE
 6

	)

37 
	#PACKET_ADD_MEMBERSHIP
 1

	)

38 
	#PACKET_DROP_MEMBERSHIP
 2

	)

39 
	#PACKET_RECV_OUTPUT
 3

	)

41 
	#PACKET_RX_RING
 5

	)

42 
	#PACKET_STATISTICS
 6

	)

43 
	#PACKET_COPY_THRESH
 7

	)

44 
	#PACKET_AUXDATA
 8

	)

45 
	#PACKET_ORIGDEV
 9

	)

46 
	#PACKET_VERSION
 10

	)

47 
	#PACKET_HDRLEN
 11

	)

48 
	#PACKET_RESERVE
 12

	)

49 
	#PACKET_TX_RING
 13

	)

50 
	#PACKET_LOSS
 14

	)

51 
	#PACKET_TX_TIMESTAMP
 16

	)

52 
	#PACKET_TIMESTAMP
 17

	)

54 
	sack‘_¡©s


56 
	m_·ck‘s
;

57 
	m_drİs
;

60 
	sack‘_auxd©a


62 
__u32
 
	m_¡©us
;

63 
__u32
 
	m_Ën
;

64 
__u32
 
	m_¢­Ën
;

65 
__u16
 
	m_mac
;

66 
__u16
 
	m_Ãt
;

67 
__u16
 
	m_vÏn_tci
;

68 
__u16
 
	m_·ddšg
;

72 
	#TP_STATUS_KERNEL
 0x0

	)

73 
	#TP_STATUS_USER
 0x1

	)

74 
	#TP_STATUS_COPY
 0x2

	)

75 
	#TP_STATUS_LOSING
 0x4

	)

76 
	#TP_STATUS_CSUMNOTREADY
 0x8

	)

79 
	#TP_STATUS_AVAILABLE
 0x0

	)

80 
	#TP_STATUS_SEND_REQUEST
 0x1

	)

81 
	#TP_STATUS_SENDING
 0x2

	)

82 
	#TP_STATUS_WRONG_FORMAT
 0x4

	)

84 
	sack‘_hdr


86 
	m_¡©us
;

87 
	m_Ën
;

88 
	m_¢­Ën
;

89 
	m_mac
;

90 
	m_Ãt
;

91 
	m_£c
;

92 
	m_u£c
;

95 
	#TPACKET_ALIGNMENT
 16

	)

96 
	#TPACKET_ALIGN
(
x
è(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

97 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘_hdr
)è+ (
sockaddr_Î
))

	)

99 
	sack‘2_hdr


101 
__u32
 
	m_¡©us
;

102 
__u32
 
	m_Ën
;

103 
__u32
 
	m_¢­Ën
;

104 
__u16
 
	m_mac
;

105 
__u16
 
	m_Ãt
;

106 
__u32
 
	m_£c
;

107 
__u32
 
	m_n£c
;

108 
__u16
 
	m_vÏn_tci
;

109 
__u16
 
	m_·ddšg
;

112 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘2_hdr
)è+ (
sockaddr_Î
))

	)

114 
	eack‘_v”siÚs


116 
	mTPACKET_V1
,

117 
	mTPACKET_V2
,

133 
	sack‘_»q


135 
	m_block_size
;

136 
	m_block_Ä
;

137 
	m_äame_size
;

138 
	m_äame_Ä
;

141 
	s·ck‘_m»q


143 
	mmr_ifšdex
;

144 
	mmr_ty³
;

145 
	mmr_®’
;

146 
	mmr_add»ss
[8];

149 
	#PACKET_MR_MULTICAST
 0

	)

150 
	#PACKET_MR_PROMISC
 1

	)

151 
	#PACKET_MR_ALLMULTI
 2

	)

152 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/ioctl.h

1 #iâdeà
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/ioùl.h
>

	@/usr/include/linux/irqnr.h

1 #iâdeà
_LINUX_IRQNR_H


2 
	#_LINUX_IRQNR_H


	)

	@/usr/include/linux/libc-compat.h

48 #iâdeà
_UAPI_LIBC_COMPAT_H


49 
	#_UAPI_LIBC_COMPAT_H


	)

52 #ià
defšed
(
__GLIBC__
)

55 #ià
defšed
(
_NETINET_IN_H
)

59 
	#__UAPI_DEF_IN6_ADDR
 0

	)

64 #ià
defšed
(
__USE_MISC
è|| defšed (
__USE_GNU
)

65 
	#__UAPI_DEF_IN6_ADDR_ALT
 0

	)

67 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

69 
	#__UAPI_DEF_SOCKADDR_IN6
 0

	)

70 
	#__UAPI_DEF_IPV6_MREQ
 0

	)

71 
	#__UAPI_DEF_IPPROTO_V6
 0

	)

78 
	#__UAPI_DEF_IN6_ADDR
 1

	)

81 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

82 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

83 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

84 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

95 
	#__UAPI_DEF_IN6_ADDR
 1

	)

96 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

97 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

98 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

99 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

	@/usr/include/linux/pfkeyv2.h

6 #iâdeà
_LINUX_PFKEY2_H


7 
	#_LINUX_PFKEY2_H


	)

9 
	~<lšux/ty³s.h
>

11 
	#PF_KEY_V2
 2

	)

12 
	#PFKEYV2_REVISION
 199806L

	)

14 
	s§db_msg
 {

15 
__u8
 
	m§db_msg_v”siÚ
;

16 
__u8
 
	m§db_msg_ty³
;

17 
__u8
 
	m§db_msg_”ºo
;

18 
__u8
 
	m§db_msg_§ty³
;

19 
__u16
 
	m§db_msg_Ën
;

20 
__u16
 
	m§db_msg_»£rved
;

21 
__u32
 
	m§db_msg_£q
;

22 
__u32
 
	m§db_msg_pid
;

23 } 
__©Œibu‹__
((
·cked
));

26 
	s§db_ext
 {

27 
__u16
 
	m§db_ext_Ën
;

28 
__u16
 
	m§db_ext_ty³
;

29 } 
__©Œibu‹__
((
·cked
));

32 
	s§db_§
 {

33 
__u16
 
	m§db_§_Ën
;

34 
__u16
 
	m§db_§_ex‰y³
;

35 
__be32
 
	m§db_§_¥i
;

36 
__u8
 
	m§db_§_»¶ay
;

37 
__u8
 
	m§db_§_¡©e
;

38 
__u8
 
	m§db_§_auth
;

39 
__u8
 
	m§db_§_’üy±
;

40 
__u32
 
	m§db_§_æags
;

41 } 
__©Œibu‹__
((
·cked
));

44 
	s§db_liãtime
 {

45 
__u16
 
	m§db_liãtime_Ën
;

46 
__u16
 
	m§db_liãtime_ex‰y³
;

47 
__u32
 
	m§db_liãtime_®loÿtiÚs
;

48 
__u64
 
	m§db_liãtime_by‹s
;

49 
__u64
 
	m§db_liãtime_addtime
;

50 
__u64
 
	m§db_liãtime_u£time
;

51 } 
__©Œibu‹__
((
·cked
));

54 
	s§db_add»ss
 {

55 
__u16
 
	m§db_add»ss_Ën
;

56 
__u16
 
	m§db_add»ss_ex‰y³
;

57 
__u8
 
	m§db_add»ss_´Ùo
;

58 
__u8
 
	m§db_add»ss_´efixËn
;

59 
__u16
 
	m§db_add»ss_»£rved
;

60 } 
__©Œibu‹__
((
·cked
));

63 
	s§db_key
 {

64 
__u16
 
	m§db_key_Ën
;

65 
__u16
 
	m§db_key_ex‰y³
;

66 
__u16
 
	m§db_key_b™s
;

67 
__u16
 
	m§db_key_»£rved
;

68 } 
__©Œibu‹__
((
·cked
));

71 
	s§db_id’t
 {

72 
__u16
 
	m§db_id’t_Ën
;

73 
__u16
 
	m§db_id’t_ex‰y³
;

74 
__u16
 
	m§db_id’t_ty³
;

75 
__u16
 
	m§db_id’t_»£rved
;

76 
__u64
 
	m§db_id’t_id
;

77 } 
__©Œibu‹__
((
·cked
));

80 
	s§db_£ns
 {

81 
__u16
 
	m§db_£ns_Ën
;

82 
__u16
 
	m§db_£ns_ex‰y³
;

83 
__u32
 
	m§db_£ns_dpd
;

84 
__u8
 
	m§db_£ns_£ns_Ëv–
;

85 
__u8
 
	m§db_£ns_£ns_Ën
;

86 
__u8
 
	m§db_£ns_š‹g_Ëv–
;

87 
__u8
 
	m§db_£ns_š‹g_Ën
;

88 
__u32
 
	m§db_£ns_»£rved
;

89 } 
__©Œibu‹__
((
·cked
));

96 
	s§db_´İ
 {

97 
__u16
 
	m§db_´İ_Ën
;

98 
__u16
 
	m§db_´İ_ex‰y³
;

99 
__u8
 
	m§db_´İ_»¶ay
;

100 
__u8
 
	m§db_´İ_»£rved
[3];

101 } 
__©Œibu‹__
((
·cked
));

109 
	s§db_comb
 {

110 
__u8
 
	m§db_comb_auth
;

111 
__u8
 
	m§db_comb_’üy±
;

112 
__u16
 
	m§db_comb_æags
;

113 
__u16
 
	m§db_comb_auth_mšb™s
;

114 
__u16
 
	m§db_comb_auth_maxb™s
;

115 
__u16
 
	m§db_comb_’üy±_mšb™s
;

116 
__u16
 
	m§db_comb_’üy±_maxb™s
;

117 
__u32
 
	m§db_comb_»£rved
;

118 
__u32
 
	m§db_comb_soá_®loÿtiÚs
;

119 
__u32
 
	m§db_comb_h¬d_®loÿtiÚs
;

120 
__u64
 
	m§db_comb_soá_by‹s
;

121 
__u64
 
	m§db_comb_h¬d_by‹s
;

122 
__u64
 
	m§db_comb_soá_addtime
;

123 
__u64
 
	m§db_comb_h¬d_addtime
;

124 
__u64
 
	m§db_comb_soá_u£time
;

125 
__u64
 
	m§db_comb_h¬d_u£time
;

126 } 
__©Œibu‹__
((
·cked
));

129 
	s§db_suµÜ‹d
 {

130 
__u16
 
	m§db_suµÜ‹d_Ën
;

131 
__u16
 
	m§db_suµÜ‹d_ex‰y³
;

132 
__u32
 
	m§db_suµÜ‹d_»£rved
;

133 } 
__©Œibu‹__
((
·cked
));

141 
	s§db_®g
 {

142 
__u8
 
	m§db_®g_id
;

143 
__u8
 
	m§db_®g_ivËn
;

144 
__u16
 
	m§db_®g_mšb™s
;

145 
__u16
 
	m§db_®g_maxb™s
;

146 
__u16
 
	m§db_®g_»£rved
;

147 } 
__©Œibu‹__
((
·cked
));

150 
	s§db_¥œªge
 {

151 
__u16
 
	m§db_¥œªge_Ën
;

152 
__u16
 
	m§db_¥œªge_ex‰y³
;

153 
__u32
 
	m§db_¥œªge_mš
;

154 
__u32
 
	m§db_¥œªge_max
;

155 
__u32
 
	m§db_¥œªge_»£rved
;

156 } 
__©Œibu‹__
((
·cked
));

159 
	s§db_x_km´iv©e
 {

160 
__u16
 
	m§db_x_km´iv©e_Ën
;

161 
__u16
 
	m§db_x_km´iv©e_ex‰y³
;

162 
__u32
 
	m§db_x_km´iv©e_»£rved
;

163 } 
__©Œibu‹__
((
·cked
));

166 
	s§db_x_§2
 {

167 
__u16
 
	m§db_x_§2_Ën
;

168 
__u16
 
	m§db_x_§2_ex‰y³
;

169 
__u8
 
	m§db_x_§2_mode
;

170 
__u8
 
	m§db_x_§2_»£rved1
;

171 
__u16
 
	m§db_x_§2_»£rved2
;

172 
__u32
 
	m§db_x_§2_£qu’û
;

173 
__u32
 
	m§db_x_§2_»qid
;

174 } 
__©Œibu‹__
((
·cked
));

177 
	s§db_x_pŞicy
 {

178 
__u16
 
	m§db_x_pŞicy_Ën
;

179 
__u16
 
	m§db_x_pŞicy_ex‰y³
;

180 
__u16
 
	m§db_x_pŞicy_ty³
;

181 
__u8
 
	m§db_x_pŞicy_dœ
;

182 
__u8
 
	m§db_x_pŞicy_»£rved
;

183 
__u32
 
	m§db_x_pŞicy_id
;

184 
__u32
 
	m§db_x_pŞicy_´iÜ™y
;

185 } 
__©Œibu‹__
((
·cked
));

188 
	s§db_x_£üeque¡
 {

189 
__u16
 
	m§db_x_£üeque¡_Ën
;

190 
__u16
 
	m§db_x_£üeque¡_´Ùo
;

191 
__u8
 
	m§db_x_£üeque¡_mode
;

192 
__u8
 
	m§db_x_£üeque¡_Ëv–
;

193 
__u16
 
	m§db_x_£üeque¡_»£rved1
;

194 
__u32
 
	m§db_x_£üeque¡_»qid
;

195 
__u32
 
	m§db_x_£üeque¡_»£rved2
;

196 } 
__©Œibu‹__
((
·cked
));

202 
	s§db_x_Çt_t_ty³
 {

203 
__u16
 
	m§db_x_Çt_t_ty³_Ën
;

204 
__u16
 
	m§db_x_Çt_t_ty³_ex‰y³
;

205 
__u8
 
	m§db_x_Çt_t_ty³_ty³
;

206 
__u8
 
	m§db_x_Çt_t_ty³_»£rved
[3];

207 } 
__©Œibu‹__
((
·cked
));

211 
	s§db_x_Çt_t_pÜt
 {

212 
__u16
 
	m§db_x_Çt_t_pÜt_Ën
;

213 
__u16
 
	m§db_x_Çt_t_pÜt_ex‰y³
;

214 
__be16
 
	m§db_x_Çt_t_pÜt_pÜt
;

215 
__u16
 
	m§db_x_Çt_t_pÜt_»£rved
;

216 } 
__©Œibu‹__
((
·cked
));

220 
	s§db_x_£c_ùx
 {

221 
__u16
 
	m§db_x_£c_Ën
;

222 
__u16
 
	m§db_x_£c_ex‰y³
;

223 
__u8
 
	m§db_x_ùx_®g
;

224 
__u8
 
	m§db_x_ùx_doi
;

225 
__u16
 
	m§db_x_ùx_Ën
;

226 } 
__©Œibu‹__
((
·cked
));

231 
	s§db_x_kmadd»ss
 {

232 
__u16
 
	m§db_x_kmadd»ss_Ën
;

233 
__u16
 
	m§db_x_kmadd»ss_ex‰y³
;

234 
__u32
 
	m§db_x_kmadd»ss_»£rved
;

235 } 
__©Œibu‹__
((
·cked
));

239 
	#SADB_RESERVED
 0

	)

240 
	#SADB_GETSPI
 1

	)

241 
	#SADB_UPDATE
 2

	)

242 
	#SADB_ADD
 3

	)

243 
	#SADB_DELETE
 4

	)

244 
	#SADB_GET
 5

	)

245 
	#SADB_ACQUIRE
 6

	)

246 
	#SADB_REGISTER
 7

	)

247 
	#SADB_EXPIRE
 8

	)

248 
	#SADB_FLUSH
 9

	)

249 
	#SADB_DUMP
 10

	)

250 
	#SADB_X_PROMISC
 11

	)

251 
	#SADB_X_PCHANGE
 12

	)

252 
	#SADB_X_SPDUPDATE
 13

	)

253 
	#SADB_X_SPDADD
 14

	)

254 
	#SADB_X_SPDDELETE
 15

	)

255 
	#SADB_X_SPDGET
 16

	)

256 
	#SADB_X_SPDACQUIRE
 17

	)

257 
	#SADB_X_SPDDUMP
 18

	)

258 
	#SADB_X_SPDFLUSH
 19

	)

259 
	#SADB_X_SPDSETIDX
 20

	)

260 
	#SADB_X_SPDEXPIRE
 21

	)

261 
	#SADB_X_SPDDELETE2
 22

	)

262 
	#SADB_X_NAT_T_NEW_MAPPING
 23

	)

263 
	#SADB_X_MIGRATE
 24

	)

264 
	#SADB_MAX
 24

	)

267 
	#SADB_SAFLAGS_PFS
 1

	)

268 
	#SADB_SAFLAGS_NOPMTUDISC
 0x20000000

	)

269 
	#SADB_SAFLAGS_DECAP_DSCP
 0x40000000

	)

270 
	#SADB_SAFLAGS_NOECN
 0x80000000

	)

273 
	#SADB_SASTATE_LARVAL
 0

	)

274 
	#SADB_SASTATE_MATURE
 1

	)

275 
	#SADB_SASTATE_DYING
 2

	)

276 
	#SADB_SASTATE_DEAD
 3

	)

277 
	#SADB_SASTATE_MAX
 3

	)

280 
	#SADB_SATYPE_UNSPEC
 0

	)

281 
	#SADB_SATYPE_AH
 2

	)

282 
	#SADB_SATYPE_ESP
 3

	)

283 
	#SADB_SATYPE_RSVP
 5

	)

284 
	#SADB_SATYPE_OSPFV2
 6

	)

285 
	#SADB_SATYPE_RIPV2
 7

	)

286 
	#SADB_SATYPE_MIP
 8

	)

287 
	#SADB_X_SATYPE_IPCOMP
 9

	)

288 
	#SADB_SATYPE_MAX
 9

	)

291 
	#SADB_AALG_NONE
 0

	)

292 
	#SADB_AALG_MD5HMAC
 2

	)

293 
	#SADB_AALG_SHA1HMAC
 3

	)

294 
	#SADB_X_AALG_SHA2_256HMAC
 5

	)

295 
	#SADB_X_AALG_SHA2_384HMAC
 6

	)

296 
	#SADB_X_AALG_SHA2_512HMAC
 7

	)

297 
	#SADB_X_AALG_RIPEMD160HMAC
 8

	)

298 
	#SADB_X_AALG_AES_XCBC_MAC
 9

	)

299 
	#SADB_X_AALG_NULL
 251

	)

300 
	#SADB_AALG_MAX
 251

	)

303 
	#SADB_EALG_NONE
 0

	)

304 
	#SADB_EALG_DESCBC
 2

	)

305 
	#SADB_EALG_3DESCBC
 3

	)

306 
	#SADB_X_EALG_CASTCBC
 6

	)

307 
	#SADB_X_EALG_BLOWFISHCBC
 7

	)

308 
	#SADB_EALG_NULL
 11

	)

309 
	#SADB_X_EALG_AESCBC
 12

	)

310 
	#SADB_X_EALG_AESCTR
 13

	)

311 
	#SADB_X_EALG_AES_CCM_ICV8
 14

	)

312 
	#SADB_X_EALG_AES_CCM_ICV12
 15

	)

313 
	#SADB_X_EALG_AES_CCM_ICV16
 16

	)

314 
	#SADB_X_EALG_AES_GCM_ICV8
 18

	)

315 
	#SADB_X_EALG_AES_GCM_ICV12
 19

	)

316 
	#SADB_X_EALG_AES_GCM_ICV16
 20

	)

317 
	#SADB_X_EALG_CAMELLIACBC
 22

	)

318 
	#SADB_X_EALG_NULL_AES_GMAC
 23

	)

319 
	#SADB_EALG_MAX
 253

	)

321 
	#SADB_X_EALG_SERPENTCBC
 252

	)

322 
	#SADB_X_EALG_TWOFISHCBC
 253

	)

325 
	#SADB_X_CALG_NONE
 0

	)

326 
	#SADB_X_CALG_OUI
 1

	)

327 
	#SADB_X_CALG_DEFLATE
 2

	)

328 
	#SADB_X_CALG_LZS
 3

	)

329 
	#SADB_X_CALG_LZJH
 4

	)

330 
	#SADB_X_CALG_MAX
 4

	)

333 
	#SADB_EXT_RESERVED
 0

	)

334 
	#SADB_EXT_SA
 1

	)

335 
	#SADB_EXT_LIFETIME_CURRENT
 2

	)

336 
	#SADB_EXT_LIFETIME_HARD
 3

	)

337 
	#SADB_EXT_LIFETIME_SOFT
 4

	)

338 
	#SADB_EXT_ADDRESS_SRC
 5

	)

339 
	#SADB_EXT_ADDRESS_DST
 6

	)

340 
	#SADB_EXT_ADDRESS_PROXY
 7

	)

341 
	#SADB_EXT_KEY_AUTH
 8

	)

342 
	#SADB_EXT_KEY_ENCRYPT
 9

	)

343 
	#SADB_EXT_IDENTITY_SRC
 10

	)

344 
	#SADB_EXT_IDENTITY_DST
 11

	)

345 
	#SADB_EXT_SENSITIVITY
 12

	)

346 
	#SADB_EXT_PROPOSAL
 13

	)

347 
	#SADB_EXT_SUPPORTED_AUTH
 14

	)

348 
	#SADB_EXT_SUPPORTED_ENCRYPT
 15

	)

349 
	#SADB_EXT_SPIRANGE
 16

	)

350 
	#SADB_X_EXT_KMPRIVATE
 17

	)

351 
	#SADB_X_EXT_POLICY
 18

	)

352 
	#SADB_X_EXT_SA2
 19

	)

354 
	#SADB_X_EXT_NAT_T_TYPE
 20

	)

355 
	#SADB_X_EXT_NAT_T_SPORT
 21

	)

356 
	#SADB_X_EXT_NAT_T_DPORT
 22

	)

357 
	#SADB_X_EXT_NAT_T_OA
 23

	)

358 
	#SADB_X_EXT_SEC_CTX
 24

	)

360 
	#SADB_X_EXT_KMADDRESS
 25

	)

361 
	#SADB_EXT_MAX
 25

	)

364 
	#SADB_IDENTTYPE_RESERVED
 0

	)

365 
	#SADB_IDENTTYPE_PREFIX
 1

	)

366 
	#SADB_IDENTTYPE_FQDN
 2

	)

367 
	#SADB_IDENTTYPE_USERFQDN
 3

	)

368 
	#SADB_IDENTTYPE_MAX
 3

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__NFDBITS


22 
	#__NFDBITS
 (8 * ())

	)

24 #undeà
__FD_SETSIZE


25 
	#__FD_SETSIZE
 1024

	)

27 #undeà
__FDSET_LONGS


28 
	#__FDSET_LONGS
 (
__FD_SETSIZE
/
__NFDBITS
)

	)

30 #undeà
__FDELT


31 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

33 #undeà
__FDMASK


34 
	#__FDMASK
(
d
è(1UL << ((dè% 
__NFDBITS
))

	)

37 
	mfds_b™s
 [
__FDSET_LONGS
];

38 } 
	t__k”Ãl_fd_£t
;

41 (*
	t__k”Ãl_sighªdËr_t
)();

44 
	t__k”Ãl_key_t
;

45 
	t__k”Ãl_mqd_t
;

47 
	~<asm/posix_ty³s.h
>

	@/usr/include/netinet/in.h

20 #iâdef 
_NETINET_IN_H


21 
	#_NETINET_IN_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<¡dšt.h
>

25 
	~<sys/sock‘.h
>

26 
	~<b™s/ty³s.h
>

29 
__BEGIN_DECLS


32 
ušt32_t
 
	tš_addr_t
;

33 
	sš_addr


35 
š_addr_t
 
	ms_addr
;

39 
	~<b™s/š.h
>

44 
	mIPPROTO_IP
 = 0,

45 
	#IPPROTO_IP
 
IPPROTO_IP


	)

46 
	mIPPROTO_ICMP
 = 1,

47 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

48 
	mIPPROTO_IGMP
 = 2,

49 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

50 
	mIPPROTO_IPIP
 = 4,

51 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

52 
	mIPPROTO_TCP
 = 6,

53 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

54 
	mIPPROTO_EGP
 = 8,

55 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

56 
	mIPPROTO_PUP
 = 12,

57 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

58 
	mIPPROTO_UDP
 = 17,

59 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

60 
	mIPPROTO_IDP
 = 22,

61 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

62 
	mIPPROTO_TP
 = 29,

63 
	#IPPROTO_TP
 
IPPROTO_TP


	)

64 
	mIPPROTO_DCCP
 = 33,

65 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

66 
	mIPPROTO_IPV6
 = 41,

67 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

68 
	mIPPROTO_RSVP
 = 46,

69 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

70 
	mIPPROTO_GRE
 = 47,

71 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

72 
	mIPPROTO_ESP
 = 50,

73 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

74 
	mIPPROTO_AH
 = 51,

75 
	#IPPROTO_AH
 
IPPROTO_AH


	)

76 
	mIPPROTO_MTP
 = 92,

77 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

78 
	mIPPROTO_BEETPH
 = 94,

79 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

80 
	mIPPROTO_ENCAP
 = 98,

81 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

82 
	mIPPROTO_PIM
 = 103,

83 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

84 
	mIPPROTO_COMP
 = 108,

85 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

86 
	mIPPROTO_SCTP
 = 132,

87 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

88 
	mIPPROTO_UDPLITE
 = 136,

89 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


98 #iâdeà
__USE_KERNEL_IPV6_DEFS


101 
	mIPPROTO_HOPOPTS
 = 0,

102 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

103 
	mIPPROTO_ROUTING
 = 43,

104 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

105 
	mIPPROTO_FRAGMENT
 = 44,

106 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

107 
	mIPPROTO_ICMPV6
 = 58,

108 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

109 
	mIPPROTO_NONE
 = 59,

110 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

111 
	mIPPROTO_DSTOPTS
 = 60,

112 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

113 
	mIPPROTO_MH
 = 135,

114 
	#IPPROTO_MH
 
IPPROTO_MH


	)

119 
ušt16_t
 
	tš_pÜt_t
;

124 
	mIPPORT_ECHO
 = 7,

125 
	mIPPORT_DISCARD
 = 9,

126 
	mIPPORT_SYSTAT
 = 11,

127 
	mIPPORT_DAYTIME
 = 13,

128 
	mIPPORT_NETSTAT
 = 15,

129 
	mIPPORT_FTP
 = 21,

130 
	mIPPORT_TELNET
 = 23,

131 
	mIPPORT_SMTP
 = 25,

132 
	mIPPORT_TIMESERVER
 = 37,

133 
	mIPPORT_NAMESERVER
 = 42,

134 
	mIPPORT_WHOIS
 = 43,

135 
	mIPPORT_MTP
 = 57,

137 
	mIPPORT_TFTP
 = 69,

138 
	mIPPORT_RJE
 = 77,

139 
	mIPPORT_FINGER
 = 79,

140 
	mIPPORT_TTYLINK
 = 87,

141 
	mIPPORT_SUPDUP
 = 95,

144 
	mIPPORT_EXECSERVER
 = 512,

145 
	mIPPORT_LOGINSERVER
 = 513,

146 
	mIPPORT_CMDSERVER
 = 514,

147 
	mIPPORT_EFSSERVER
 = 520,

150 
	mIPPORT_BIFFUDP
 = 512,

151 
	mIPPORT_WHOSERVER
 = 513,

152 
	mIPPORT_ROUTESERVER
 = 520,

155 
	mIPPORT_RESERVED
 = 1024,

158 
	mIPPORT_USERRESERVED
 = 5000

166 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

167 
	#IN_CLASSA_NET
 0xff000000

	)

168 
	#IN_CLASSA_NSHIFT
 24

	)

169 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

170 
	#IN_CLASSA_MAX
 128

	)

172 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

173 
	#IN_CLASSB_NET
 0xffff0000

	)

174 
	#IN_CLASSB_NSHIFT
 16

	)

175 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

176 
	#IN_CLASSB_MAX
 65536

	)

178 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

179 
	#IN_CLASSC_NET
 0xffffff00

	)

180 
	#IN_CLASSC_NSHIFT
 8

	)

181 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

183 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

184 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

186 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

187 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

190 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

192 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

194 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

197 
	#IN_LOOPBACKNET
 127

	)

199 #iâdeà
INADDR_LOOPBACK


200 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

204 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

205 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

206 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

207 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

209 #iâdeà
__USE_KERNEL_IPV6_DEFS


211 
	sš6_addr


215 
ušt8_t
 
	m__u6_addr8
[16];

216 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


217 
ušt16_t
 
	m__u6_addr16
[8];

218 
ušt32_t
 
	m__u6_addr32
[4];

220 } 
	m__š6_u
;

221 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

222 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


223 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

224 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

229 cÚ¡ 
š6_addr
 
š6addr_ªy
;

230 cÚ¡ 
š6_addr
 
š6addr_loİback
;

231 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

232 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

234 
	#INET_ADDRSTRLEN
 16

	)

235 
	#INET6_ADDRSTRLEN
 46

	)

239 
	ssockaddr_š


241 
__SOCKADDR_COMMON
 (
sš_
);

242 
š_pÜt_t
 
	msš_pÜt
;

243 
š_addr
 
	msš_addr
;

246 
	msš_z”o
[ (
sockaddr
) -

247 
__SOCKADDR_COMMON_SIZE
 -

248  (
š_pÜt_t
) -

249  (
š_addr
)];

252 #iâdeà
__USE_KERNEL_IPV6_DEFS


254 
	ssockaddr_š6


256 
__SOCKADDR_COMMON
 (
sš6_
);

257 
š_pÜt_t
 
	msš6_pÜt
;

258 
ušt32_t
 
	msš6_æowšfo
;

259 
š6_addr
 
	msš6_addr
;

260 
ušt32_t
 
	msš6_scİe_id
;

264 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


266 
	s_m»q


269 
š_addr
 
	mimr_muÉŸddr
;

272 
š_addr
 
	mimr_š‹rçû
;

275 
	s_m»q_sourû


278 
š_addr
 
	mimr_muÉŸddr
;

281 
š_addr
 
	mimr_š‹rçû
;

284 
š_addr
 
	mimr_sourûaddr
;

288 #iâdeà
__USE_KERNEL_IPV6_DEFS


290 
	sv6_m»q


293 
š6_addr
 
	mv6mr_muÉŸddr
;

296 
	mv6mr_š‹rçû
;

300 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


302 
	sgroup_»q


305 
ušt32_t
 
	mgr_š‹rçû
;

308 
sockaddr_¡Üage
 
	mgr_group
;

311 
	sgroup_sourû_»q


314 
ušt32_t
 
	mg¤_š‹rçû
;

317 
sockaddr_¡Üage
 
	mg¤_group
;

320 
sockaddr_¡Üage
 
	mg¤_sourû
;

325 
	s_msf‹r


328 
š_addr
 
	mimsf_muÉŸddr
;

331 
š_addr
 
	mimsf_š‹rçû
;

334 
ušt32_t
 
	mimsf_fmode
;

337 
ušt32_t
 
	mimsf_num¤c
;

339 
š_addr
 
	mimsf_¦i¡
[1];

342 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

343 -  (
š_addr
) \

344 + (
num¤c
è*  (
š_addr
))

	)

346 
	sgroup_f‹r


349 
ušt32_t
 
	mgf_š‹rçû
;

352 
sockaddr_¡Üage
 
	mgf_group
;

355 
ušt32_t
 
	mgf_fmode
;

358 
ušt32_t
 
	mgf_num¤c
;

360 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

363 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

364 -  (
sockaddr_¡Üage
) \

365 + ((
num¤c
) \

366 *  (
sockaddr_¡Üage
)))

	)

376 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

381 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

382 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

384 
	~<’dŸn.h
>

387 
	~<b™s/by‹sw­.h
>

389 #ifdeà
__OPTIMIZE__


393 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


396 
	#Áohl
(
x
è(x)

	)

397 
	#Áohs
(
x
è(x)

	)

398 
	#htÚl
(
x
è(x)

	)

399 
	#htÚs
(
x
è(x)

	)

401 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


402 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

403 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

404 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

405 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

410 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

411 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0 \

412 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0 \

413 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0 \

414 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

416 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

417 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0 \

418 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0 \

419 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0 \

420 && ((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

422 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((
__cÚ¡
 
ušt8_t
 *è×))[0] =ğ0xff)

	)

424 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

425 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

426 =ğ
	`htÚl
 (0xã800000))

	)

428 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

429 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

430 =ğ
	`htÚl
 (0xãc00000))

	)

432 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

433 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0) \

434 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0) \

435 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

437 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

438 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] == 0) \

439 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] == 0) \

440 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] == 0) \

441 && (
	`Áohl
 (((
__cÚ¡
 
ušt32_t
 *è(
a
))[3]è> 1))

	)

443 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

444 ((((
__cÚ¡
 
ušt32_t
 *è(
a
))[0] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[0]) \

445 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[1] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[1]) \

446 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[2] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[2]) \

447 && (((
__cÚ¡
 
ušt32_t
 *è(
a
))[3] =ğ((__cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

449 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


451 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

454 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

455 
__THROW
;

459 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

460 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

461 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

463 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

464 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

465 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

467 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

468 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

469 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

471 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

472 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

473 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

475 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

476 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

477 && ((((
__cÚ¡
 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

480 #ifdeà
__USE_GNU


482 
	sš6_pktšfo


484 
š6_addr
 
i6_addr
;

485 
i6_ifšdex
;

489 
	s6_mtušfo


491 
sockaddr_š6
 
6m_addr
;

492 
ušt32_t
 
6m_mtu
;

497 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

498 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

499 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

500 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

501 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

502 
__cÚ¡
 
ušt8_t
 *
__ty³p
, 
__muÉx
,

503 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

504 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

505 
__muÉx
, 
__¶usy
)

506 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

507 
	$š‘6_İtiÚ_Ãxt
 (
__cÚ¡
 
cmsghdr
 *
__cmsg
,

508 
ušt8_t
 **
__Œp
)

509 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

510 
	$š‘6_İtiÚ_fšd
 (
__cÚ¡
 
cmsghdr
 *
__cmsg
,

511 
ušt8_t
 **
__Œp
, 
__ty³
)

512 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

516 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

517 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

518 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

519 **
__d©abuå
è
__THROW
;

520 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

521 
__THROW
;

522 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

523 
sockËn_t
 
__v®Ën
è
__THROW
;

524 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

525 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

526 **
__d©abuå
è
__THROW
;

527 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

528 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

529 **
__d©abuå
è
__THROW
;

530 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

531 
sockËn_t
 
__v®Ën
è
__THROW
;

535 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

536 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

537 
__£gm’ts
è
__THROW
;

538 
	$š‘6_¹h_add
 (*
__bp
, 
__cÚ¡
 
š6_addr
 *
__addr
è
__THROW
;

539 
	$š‘6_¹h_»v”£
 (
__cÚ¡
 *
__š
, *
__out
è
__THROW
;

540 
	$š‘6_¹h_£gm’ts
 (
__cÚ¡
 *
__bp
è
__THROW
;

541 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (
__cÚ¡
 *
__bp
, 
__šdex
)

542 
__THROW
;

548 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

549 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

550 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

551 
__THROW
;

554 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

555 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

556 
ušt32_t
 
__num¤c
,

557 
__cÚ¡
 
š_addr
 *
__¦i¡
)

558 
__THROW
;

562 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

563 
__cÚ¡
 
sockaddr
 *
__group
,

564 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

565 
ušt32_t
 *
__num¤c
,

566 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

569 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

570 
__cÚ¡
 
sockaddr
 *
__group
,

571 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

572 
ušt32_t
 
__num¤c
,

573 
__cÚ¡
 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

576 
__END_DECLS


	@/usr/include/sys/socket.h

21 #iâdef 
_SYS_SOCKET_H


22 
	#_SYS_SOCKET_H
 1

	)

24 
	~<ã©u»s.h
>

26 
	g__BEGIN_DECLS


28 
	~<sys/uio.h
>

29 
	#__Ãed_size_t


	)

30 
	~<¡ddef.h
>

31 #ifdeà
__USE_GNU


33 
	~<b™s/sig£t.h
>

40 
	~<b™s/sock‘.h
>

42 #ifdeà
__USE_BSD


45 
	sosockaddr


47 
	m§_çmy
;

48 
	m§_d©a
[14];

56 
	mSHUT_RD
 = 0,

57 
	#SHUT_RD
 
SHUT_RD


	)

58 
	mSHUT_WR
,

59 
	#SHUT_WR
 
SHUT_WR


	)

60 
	mSHUT_RDWR


61 
	#SHUT_RDWR
 
SHUT_RDWR


	)

70 #ià
defšed
 
__ılu¥lus
 || !
__GNUC_PREREQ
 (2, 7è|| !defšed 
__USE_GNU


71 
	#__SOCKADDR_ARG
 
sockaddr
 *
__»¡riù


	)

72 
	#__CONST_SOCKADDR_ARG
 
__cÚ¡
 
sockaddr
 *

	)

76 
	#__SOCKADDR_ALLTYPES
 \

77 
	`__SOCKADDR_ONETYPE
 (
sockaddr
) \

78 
	`__SOCKADDR_ONETYPE
 (
sockaddr_©
) \

79 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ax25
) \

80 
	`__SOCKADDR_ONETYPE
 (
sockaddr_dl
) \

81 
	`__SOCKADDR_ONETYPE
 (
sockaddr_eÚ
) \

82 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š
) \

83 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š6
) \

84 
	`__SOCKADDR_ONETYPE
 (
sockaddr_š¬p
) \

85 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x
) \

86 
	`__SOCKADDR_ONETYPE
 (
sockaddr_iso
) \

87 
	`__SOCKADDR_ONETYPE
 (
sockaddr_ns
) \

88 
	`__SOCKADDR_ONETYPE
 (
sockaddr_un
) \

89 
	`__SOCKADDR_ONETYPE
 (
sockaddr_x25
)

	)

91 
	#__SOCKADDR_ONETYPE
(
ty³
èty³ *
__»¡riù
 
__
##ty³##__;

	)

92 uniÚ { 
	m__SOCKADDR_ALLTYPES


93 } 
	t__SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

94 #undeà
__SOCKADDR_ONETYPE


95 
	#__SOCKADDR_ONETYPE
(
ty³
è
__cÚ¡
 ty³ *
__»¡riù
 
__
##ty³##__;

	)

96 uniÚ { 
	m__SOCKADDR_ALLTYPES


97 } 
	t__CONST_SOCKADDR_ARG
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

98 #undeà
__SOCKADDR_ONETYPE


105 
	$sock‘
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
è
__THROW
;

111 
	$sock‘·œ
 (
__domaš
, 
__ty³
, 
__´ÙocŞ
,

112 
__fds
[2]è
__THROW
;

115 
	$bšd
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
)

116 
__THROW
;

119 
	$g‘sockÇme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

120 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

129 
	`cÚÃù
 (
__fd
, 
__CONST_SOCKADDR_ARG
 
__addr
, 
sockËn_t
 
__Ën
);

133 
	$g‘³”Çme
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

134 
sockËn_t
 *
__»¡riù
 
__Ën
è
__THROW
;

141 
ssize_t
 
	`£nd
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
, 
__æags
);

148 
ssize_t
 
	`»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
);

155 
ssize_t
 
	`£ndto
 (
__fd
, 
__cÚ¡
 *
__buf
, 
size_t
 
__n
,

156 
__æags
, 
__CONST_SOCKADDR_ARG
 
__addr
,

157 
sockËn_t
 
__addr_Ën
);

166 
ssize_t
 
	`»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

167 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

168 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

176 
ssize_t
 
	`£ndmsg
 (
__fd
, 
__cÚ¡
 
msghdr
 *
__mes§ge
,

177 
__æags
);

184 
ssize_t
 
	`»cvmsg
 (
__fd
, 
msghdr
 *
__mes§ge
, 
__æags
);

190 
	$g‘sockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

191 *
__»¡riù
 
__İtv®
,

192 
sockËn_t
 *
__»¡riù
 
__İ’
è
__THROW
;

197 
	$£tsockİt
 (
__fd
, 
__Ëv–
, 
__İŠame
,

198 
__cÚ¡
 *
__İtv®
, 
sockËn_t
 
__İ’
è
__THROW
;

204 
	$li¡’
 (
__fd
, 
__n
è
__THROW
;

214 
	`acû±
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

215 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

217 #ifdeà
__USE_GNU


222 
	`acû±4
 (
__fd
, 
__SOCKADDR_ARG
 
__addr
,

223 
sockËn_t
 *
__»¡riù
 
__addr_Ën
, 
__æags
);

232 
	$shutdown
 (
__fd
, 
__how
è
__THROW
;

235 #ifdeà
__USE_XOPEN2K


237 
	$sock©m¬k
 (
__fd
è
__THROW
;

241 #ifdeà
__USE_MISC


245 
	$isfdty³
 (
__fd
, 
__fdty³
è
__THROW
;

250 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


251 
	~<b™s/sock‘2.h
>

254 
__END_DECLS


	@/usr/include/sys/types.h

23 #iâdef 
_SYS_TYPES_H


24 
	#_SYS_TYPES_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


30 
	~<b™s/ty³s.h
>

32 #ifdef 
__USE_BSD


33 #iâdeà
__u_ch¬_defšed


34 
__u_ch¬
 
	tu_ch¬
;

35 
__u_shÜt
 
	tu_shÜt
;

36 
__u_št
 
	tu_št
;

37 
__u_lÚg
 
	tu_lÚg
;

38 
__quad_t
 
	tquad_t
;

39 
__u_quad_t
 
	tu_quad_t
;

40 
__fsid_t
 
	tfsid_t
;

41 
	#__u_ch¬_defšed


	)

45 
__loff_t
 
	tloff_t
;

47 #iâdeà
__šo_t_defšed


48 #iâdeà
__USE_FILE_OFFSET64


49 
__šo_t
 
	tšo_t
;

51 
__šo64_t
 
	tšo_t
;

53 
	#__šo_t_defšed


	)

55 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


56 
__šo64_t
 
	tšo64_t
;

57 
	#__šo64_t_defšed


	)

60 #iâdeà
__dev_t_defšed


61 
__dev_t
 
	tdev_t
;

62 
	#__dev_t_defšed


	)

65 #iâdeà
__gid_t_defšed


66 
__gid_t
 
	tgid_t
;

67 
	#__gid_t_defšed


	)

70 #iâdeà
__mode_t_defšed


71 
__mode_t
 
	tmode_t
;

72 
	#__mode_t_defšed


	)

75 #iâdeà
__Æšk_t_defšed


76 
__Æšk_t
 
	tÆšk_t
;

77 
	#__Æšk_t_defšed


	)

80 #iâdeà
__uid_t_defšed


81 
__uid_t
 
	tuid_t
;

82 
	#__uid_t_defšed


	)

85 #iâdeà
__off_t_defšed


86 #iâdeà
__USE_FILE_OFFSET64


87 
__off_t
 
	toff_t
;

89 
__off64_t
 
	toff_t
;

91 
	#__off_t_defšed


	)

93 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


94 
__off64_t
 
	toff64_t
;

95 
	#__off64_t_defšed


	)

98 #iâdeà
__pid_t_defšed


99 
__pid_t
 
	tpid_t
;

100 
	#__pid_t_defšed


	)

103 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
) \

104 && !
defšed
 
__id_t_defšed


105 
__id_t
 
	tid_t
;

106 
	#__id_t_defšed


	)

109 #iâdeà
__ssize_t_defšed


110 
__ssize_t
 
	tssize_t
;

111 
	#__ssize_t_defšed


	)

114 #ifdef 
__USE_BSD


115 #iâdeà
__daddr_t_defšed


116 
__daddr_t
 
	tdaddr_t
;

117 
__ÿddr_t
 
	tÿddr_t
;

118 
	#__daddr_t_defšed


	)

122 #ià(
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN
è&& !defšed 
__key_t_defšed


123 
__key_t
 
	tkey_t
;

124 
	#__key_t_defšed


	)

127 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


128 
	#__Ãed_şock_t


	)

130 
	#__Ãed_time_t


	)

131 
	#__Ãed_tim”_t


	)

132 
	#__Ãed_şockid_t


	)

133 
	~<time.h
>

135 #ifdeà
__USE_XOPEN


136 #iâdeà
__u£cÚds_t_defšed


137 
__u£cÚds_t
 
	tu£cÚds_t
;

138 
	#__u£cÚds_t_defšed


	)

140 #iâdeà
__su£cÚds_t_defšed


141 
__su£cÚds_t
 
	tsu£cÚds_t
;

142 
	#__su£cÚds_t_defšed


	)

146 
	#__Ãed_size_t


	)

147 
	~<¡ddef.h
>

149 #ifdeà
__USE_MISC


151 
	tulÚg
;

152 
	tushÜt
;

153 
	tušt
;

158 #ià!
__GNUC_PREREQ
 (2, 7)

161 #iâdeà
__št8_t_defšed


162 
	#__št8_t_defšed


	)

163 
	tšt8_t
;

164 
	tšt16_t
;

165 
	tšt32_t
;

166 #ià
__WORDSIZE
 == 64

167 
	tšt64_t
;

168 #–ià
__GLIBC_HAVE_LONG_LONG


169 
__ex‹nsiÚ__
 
	tšt64_t
;

174 
	tu_št8_t
;

175 
	tu_št16_t
;

176 
	tu_št32_t
;

177 #ià
__WORDSIZE
 == 64

178 
	tu_št64_t
;

179 #–ià
__GLIBC_HAVE_LONG_LONG


180 
__ex‹nsiÚ__
 
	tu_št64_t
;

183 
	t»gi¡”_t
;

188 
	#__štN_t
(
N
, 
MODE
) \

189 ##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

190 
	t__u_štN_t
(
	tN
, 
	tMODE
) \

191 
	tu_št
##
	tN
##
	t_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	tMODE
)))

	)

193 #iâdeà
	t__št8_t_defšed


194 
	t__št8_t_defšed


	)

195 
	t__štN_t
 (8, 
	t__QI__
);

196 
__štN_t
 (16, 
__HI__
);

197 
__štN_t
 (32, 
__SI__
);

198 
__štN_t
 (64, 
__DI__
);

201 
__u_štN_t
 (8, 
__QI__
);

202 
__u_štN_t
 (16, 
__HI__
);

203 
__u_štN_t
 (32, 
__SI__
);

204 
__u_štN_t
 (64, 
__DI__
);

206 
	t»gi¡”_t
 
	t__©Œibu‹__
 ((
	t__mode__
 (
	t__wÜd__
)));

212 
	#__BIT_TYPES_DEFINED__
 1

	)

215 #ifdef 
__USE_BSD


217 
	~<’dŸn.h
>

220 
	~<sys/£Ëù.h
>

223 
	~<sys/sysmaüos.h
>

227 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
) \

228 && !
defšed
 
__blksize_t_defšed


229 
__blksize_t
 
	tblksize_t
;

230 
	#__blksize_t_defšed


	)

234 #iâdeà
__USE_FILE_OFFSET64


235 #iâdeà
__blkút_t_defšed


236 
__blkút_t
 
	tblkút_t
;

237 
	#__blkút_t_defšed


	)

239 #iâdeà
__fsblkút_t_defšed


240 
__fsblkút_t
 
	tfsblkút_t
;

241 
	#__fsblkút_t_defšed


	)

243 #iâdeà
__fsfút_t_defšed


244 
__fsfút_t
 
	tfsfút_t
;

245 
	#__fsfút_t_defšed


	)

248 #iâdeà
__blkút_t_defšed


249 
__blkút64_t
 
	tblkút_t
;

250 
	#__blkút_t_defšed


	)

252 #iâdeà
__fsblkút_t_defšed


253 
__fsblkút64_t
 
	tfsblkút_t
;

254 
	#__fsblkút_t_defšed


	)

256 #iâdeà
__fsfút_t_defšed


257 
__fsfút64_t
 
	tfsfút_t
;

258 
	#__fsfút_t_defšed


	)

262 #ifdeà
__USE_LARGEFILE64


263 
__blkút64_t
 
	tblkút64_t
;

264 
__fsblkút64_t
 
	tfsblkút64_t
;

265 
__fsfút64_t
 
	tfsfút64_t
;

270 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


271 
	~<b™s/±h»adty³s.h
>

274 
	g__END_DECLS


	@/usr/include/asm-generic/errno.h

1 #iâdeà
_ASM_GENERIC_ERRNO_H


2 
	#_ASM_GENERIC_ERRNO_H


	)

4 
	~<asm-g’”ic/”ºo-ba£.h
>

6 
	#EDEADLK
 35

	)

7 
	#ENAMETOOLONG
 36

	)

8 
	#ENOLCK
 37

	)

9 
	#ENOSYS
 38

	)

10 
	#ENOTEMPTY
 39

	)

11 
	#ELOOP
 40

	)

12 
	#EWOULDBLOCK
 
EAGAIN


	)

13 
	#ENOMSG
 42

	)

14 
	#EIDRM
 43

	)

15 
	#ECHRNG
 44

	)

16 
	#EL2NSYNC
 45

	)

17 
	#EL3HLT
 46

	)

18 
	#EL3RST
 47

	)

19 
	#ELNRNG
 48

	)

20 
	#EUNATCH
 49

	)

21 
	#ENOCSI
 50

	)

22 
	#EL2HLT
 51

	)

23 
	#EBADE
 52

	)

24 
	#EBADR
 53

	)

25 
	#EXFULL
 54

	)

26 
	#ENOANO
 55

	)

27 
	#EBADRQC
 56

	)

28 
	#EBADSLT
 57

	)

30 
	#EDEADLOCK
 
EDEADLK


	)

32 
	#EBFONT
 59

	)

33 
	#ENOSTR
 60

	)

34 
	#ENODATA
 61

	)

35 
	#ETIME
 62

	)

36 
	#ENOSR
 63

	)

37 
	#ENONET
 64

	)

38 
	#ENOPKG
 65

	)

39 
	#EREMOTE
 66

	)

40 
	#ENOLINK
 67

	)

41 
	#EADV
 68

	)

42 
	#ESRMNT
 69

	)

43 
	#ECOMM
 70

	)

44 
	#EPROTO
 71

	)

45 
	#EMULTIHOP
 72

	)

46 
	#EDOTDOT
 73

	)

47 
	#EBADMSG
 74

	)

48 
	#EOVERFLOW
 75

	)

49 
	#ENOTUNIQ
 76

	)

50 
	#EBADFD
 77

	)

51 
	#EREMCHG
 78

	)

52 
	#ELIBACC
 79

	)

53 
	#ELIBBAD
 80

	)

54 
	#ELIBSCN
 81

	)

55 
	#ELIBMAX
 82

	)

56 
	#ELIBEXEC
 83

	)

57 
	#EILSEQ
 84

	)

58 
	#ERESTART
 85

	)

59 
	#ESTRPIPE
 86

	)

60 
	#EUSERS
 87

	)

61 
	#ENOTSOCK
 88

	)

62 
	#EDESTADDRREQ
 89

	)

63 
	#EMSGSIZE
 90

	)

64 
	#EPROTOTYPE
 91

	)

65 
	#ENOPROTOOPT
 92

	)

66 
	#EPROTONOSUPPORT
 93

	)

67 
	#ESOCKTNOSUPPORT
 94

	)

68 
	#EOPNOTSUPP
 95

	)

69 
	#EPFNOSUPPORT
 96

	)

70 
	#EAFNOSUPPORT
 97

	)

71 
	#EADDRINUSE
 98

	)

72 
	#EADDRNOTAVAIL
 99

	)

73 
	#ENETDOWN
 100

	)

74 
	#ENETUNREACH
 101

	)

75 
	#ENETRESET
 102

	)

76 
	#ECONNABORTED
 103

	)

77 
	#ECONNRESET
 104

	)

78 
	#ENOBUFS
 105

	)

79 
	#EISCONN
 106

	)

80 
	#ENOTCONN
 107

	)

81 
	#ESHUTDOWN
 108

	)

82 
	#ETOOMANYREFS
 109

	)

83 
	#ETIMEDOUT
 110

	)

84 
	#ECONNREFUSED
 111

	)

85 
	#EHOSTDOWN
 112

	)

86 
	#EHOSTUNREACH
 113

	)

87 
	#EALREADY
 114

	)

88 
	#EINPROGRESS
 115

	)

89 
	#ESTALE
 116

	)

90 
	#EUCLEAN
 117

	)

91 
	#ENOTNAM
 118

	)

92 
	#ENAVAIL
 119

	)

93 
	#EISNAM
 120

	)

94 
	#EREMOTEIO
 121

	)

95 
	#EDQUOT
 122

	)

97 
	#ENOMEDIUM
 123

	)

98 
	#EMEDIUMTYPE
 124

	)

99 
	#ECANCELED
 125

	)

100 
	#ENOKEY
 126

	)

101 
	#EKEYEXPIRED
 127

	)

102 
	#EKEYREVOKED
 128

	)

103 
	#EKEYREJECTED
 129

	)

106 
	#EOWNERDEAD
 130

	)

107 
	#ENOTRECOVERABLE
 131

	)

109 
	#ERFKILL
 132

	)

111 
	#EHWPOISON
 133

	)

	@/usr/include/asm-generic/fcntl.h

1 #iâdeà
_ASM_GENERIC_FCNTL_H


2 
	#_ASM_GENERIC_FCNTL_H


	)

4 
	~<lšux/ty³s.h
>

8 
	#O_ACCMODE
 00000003

	)

9 
	#O_RDONLY
 00000000

	)

10 
	#O_WRONLY
 00000001

	)

11 
	#O_RDWR
 00000002

	)

12 #iâdeà
O_CREAT


13 
	#O_CREAT
 00000100

	)

15 #iâdeà
O_EXCL


16 
	#O_EXCL
 00000200

	)

18 #iâdeà
O_NOCTTY


19 
	#O_NOCTTY
 00000400

	)

21 #iâdeà
O_TRUNC


22 
	#O_TRUNC
 00001000

	)

24 #iâdeà
O_APPEND


25 
	#O_APPEND
 00002000

	)

27 #iâdeà
O_NONBLOCK


28 
	#O_NONBLOCK
 00004000

	)

30 #iâdeà
O_SYNC


31 
	#O_SYNC
 00010000

	)

33 #iâdeà
FASYNC


34 
	#FASYNC
 00020000

	)

36 #iâdeà
O_DIRECT


37 
	#O_DIRECT
 00040000

	)

39 #iâdeà
O_LARGEFILE


40 
	#O_LARGEFILE
 00100000

	)

42 #iâdeà
O_DIRECTORY


43 
	#O_DIRECTORY
 00200000

	)

45 #iâdeà
O_NOFOLLOW


46 
	#O_NOFOLLOW
 00400000

	)

48 #iâdeà
O_NOATIME


49 
	#O_NOATIME
 01000000

	)

51 #iâdeà
O_CLOEXEC


52 
	#O_CLOEXEC
 02000000

	)

54 #iâdeà
O_NDELAY


55 
	#O_NDELAY
 
O_NONBLOCK


	)

58 
	#F_DUPFD
 0

	)

59 
	#F_GETFD
 1

	)

60 
	#F_SETFD
 2

	)

61 
	#F_GETFL
 3

	)

62 
	#F_SETFL
 4

	)

63 #iâdeà
F_GETLK


64 
	#F_GETLK
 5

	)

65 
	#F_SETLK
 6

	)

66 
	#F_SETLKW
 7

	)

68 #iâdeà
F_SETOWN


69 
	#F_SETOWN
 8

	)

70 
	#F_GETOWN
 9

	)

72 #iâdeà
F_SETSIG


73 
	#F_SETSIG
 10

	)

74 
	#F_GETSIG
 11

	)

77 #iâdeà
CONFIG_64BIT


78 #iâdeà
F_GETLK64


79 
	#F_GETLK64
 12

	)

80 
	#F_SETLK64
 13

	)

81 
	#F_SETLKW64
 14

	)

85 #iâdeà
F_SETOWN_EX


86 
	#F_SETOWN_EX
 15

	)

87 
	#F_GETOWN_EX
 16

	)

90 
	#F_OWNER_TID
 0

	)

91 
	#F_OWNER_PID
 1

	)

92 
	#F_OWNER_PGRP
 2

	)

94 
	sf_owÃr_ex
 {

95 
	mty³
;

96 
pid_t
 
	mpid
;

100 
	#FD_CLOEXEC
 1

	)

103 #iâdeà
F_RDLCK


104 
	#F_RDLCK
 0

	)

105 
	#F_WRLCK
 1

	)

106 
	#F_UNLCK
 2

	)

110 #iâdeà
F_EXLCK


111 
	#F_EXLCK
 4

	)

112 
	#F_SHLCK
 8

	)

116 #iâdeà
F_INPROGRESS


117 
	#F_INPROGRESS
 16

	)

121 
	#LOCK_SH
 1

	)

122 
	#LOCK_EX
 2

	)

123 
	#LOCK_NB
 4

	)

125 
	#LOCK_UN
 8

	)

127 
	#LOCK_MAND
 32

	)

128 
	#LOCK_READ
 64

	)

129 
	#LOCK_WRITE
 128

	)

130 
	#LOCK_RW
 192

	)

132 
	#F_LINUX_SPECIFIC_BASE
 1024

	)

134 #iâdeà
HAVE_ARCH_STRUCT_FLOCK


135 #iâdeà
__ARCH_FLOCK_PAD


136 
	#__ARCH_FLOCK_PAD


	)

139 
	sæock
 {

140 
	ml_ty³
;

141 
	ml_wh’û
;

142 
__k”Ãl_off_t
 
	ml_¡¬t
;

143 
__k”Ãl_off_t
 
	ml_Ën
;

144 
__k”Ãl_pid_t
 
	ml_pid
;

145 
	m__ARCH_FLOCK_PAD


149 #iâdeà
CONFIG_64BIT


151 #iâdeà
HAVE_ARCH_STRUCT_FLOCK64


152 #iâdeà
__ARCH_FLOCK64_PAD


153 
	#__ARCH_FLOCK64_PAD


	)

156 
	sæock64
 {

157 
	ml_ty³
;

158 
	ml_wh’û
;

159 
__k”Ãl_loff_t
 
	ml_¡¬t
;

160 
__k”Ãl_loff_t
 
	ml_Ën
;

161 
__k”Ãl_pid_t
 
	ml_pid
;

162 
	m__ARCH_FLOCK64_PAD


	@/usr/include/asm-generic/poll.h

1 #iâdeà
__ASM_GENERIC_POLL_H


2 
	#__ASM_GENERIC_POLL_H


	)

5 
	#POLLIN
 0x0001

	)

6 
	#POLLPRI
 0x0002

	)

7 
	#POLLOUT
 0x0004

	)

8 
	#POLLERR
 0x0008

	)

9 
	#POLLHUP
 0x0010

	)

10 
	#POLLNVAL
 0x0020

	)

13 
	#POLLRDNORM
 0x0040

	)

14 
	#POLLRDBAND
 0x0080

	)

15 #iâdeà
POLLWRNORM


16 
	#POLLWRNORM
 0x0100

	)

18 #iâdeà
POLLWRBAND


19 
	#POLLWRBAND
 0x0200

	)

21 #iâdeà
POLLMSG


22 
	#POLLMSG
 0x0400

	)

24 #iâdeà
POLLREMOVE


25 
	#POLLREMOVE
 0x1000

	)

27 #iâdeà
POLLRDHUP


28 
	#POLLRDHUP
 0x2000

	)

31 
	#POLL_BUSY_LOOP
 0x8000

	)

33 
	spŞlfd
 {

34 
	mfd
;

35 
	mev’ts
;

36 
	m»v’ts
;

	@/usr/include/asm-generic/socket.h

1 #iâdeà
__ASM_GENERIC_SOCKET_H


2 
	#__ASM_GENERIC_SOCKET_H


	)

4 
	~<asm/sockios.h
>

7 
	#SOL_SOCKET
 1

	)

9 
	#SO_DEBUG
 1

	)

10 
	#SO_REUSEADDR
 2

	)

11 
	#SO_TYPE
 3

	)

12 
	#SO_ERROR
 4

	)

13 
	#SO_DONTROUTE
 5

	)

14 
	#SO_BROADCAST
 6

	)

15 
	#SO_SNDBUF
 7

	)

16 
	#SO_RCVBUF
 8

	)

17 
	#SO_SNDBUFFORCE
 32

	)

18 
	#SO_RCVBUFFORCE
 33

	)

19 
	#SO_KEEPALIVE
 9

	)

20 
	#SO_OOBINLINE
 10

	)

21 
	#SO_NO_CHECK
 11

	)

22 
	#SO_PRIORITY
 12

	)

23 
	#SO_LINGER
 13

	)

24 
	#SO_BSDCOMPAT
 14

	)

25 
	#SO_REUSEPORT
 15

	)

27 #iâdeà
SO_PASSCRED


28 
	#SO_PASSCRED
 16

	)

29 
	#SO_PEERCRED
 17

	)

30 
	#SO_RCVLOWAT
 18

	)

31 
	#SO_SNDLOWAT
 19

	)

32 
	#SO_RCVTIMEO
 20

	)

33 
	#SO_SNDTIMEO
 21

	)

37 
	#SO_SECURITY_AUTHENTICATION
 22

	)

38 
	#SO_SECURITY_ENCRYPTION_TRANSPORT
 23

	)

39 
	#SO_SECURITY_ENCRYPTION_NETWORK
 24

	)

41 
	#SO_BINDTODEVICE
 25

	)

44 
	#SO_ATTACH_FILTER
 26

	)

45 
	#SO_DETACH_FILTER
 27

	)

47 
	#SO_PEERNAME
 28

	)

48 
	#SO_TIMESTAMP
 29

	)

49 
	#SCM_TIMESTAMP
 
SO_TIMESTAMP


	)

51 
	#SO_ACCEPTCONN
 30

	)

53 
	#SO_PEERSEC
 31

	)

54 
	#SO_PASSSEC
 34

	)

55 
	#SO_TIMESTAMPNS
 35

	)

56 
	#SCM_TIMESTAMPNS
 
SO_TIMESTAMPNS


	)

58 
	#SO_MARK
 36

	)

60 
	#SO_TIMESTAMPING
 37

	)

61 
	#SCM_TIMESTAMPING
 
SO_TIMESTAMPING


	)

63 
	#SO_PROTOCOL
 38

	)

64 
	#SO_DOMAIN
 39

	)

66 
	#SO_RXQ_OVFL
 40

	)

68 
	#SO_BUSY_POLL
 46

	)

69 
	#SO_BPF_EXTENSIONS
 48

	)

	@/usr/include/asm-generic/sockios.h

1 #iâdeà
__ASM_GENERIC_SOCKIOS_H


2 
	#__ASM_GENERIC_SOCKIOS_H


	)

5 
	#FIOSETOWN
 0x8901

	)

6 
	#SIOCSPGRP
 0x8902

	)

7 
	#FIOGETOWN
 0x8903

	)

8 
	#SIOCGPGRP
 0x8904

	)

9 
	#SIOCATMARK
 0x8905

	)

10 
	#SIOCGSTAMP
 0x8906

	)

11 
	#SIOCGSTAMPNS
 0x8907

	)

	@/usr/include/asm-generic/types.h

1 #iâdeà
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

7 
	~<asm-g’”ic/št-Î64.h
>

9 #iâdeà
__ASSEMBLY__


11 
	tumode_t
;

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/asm/posix_types.h

1 #ifdeà
__i386__


2 
	~"posix_ty³s_32.h
"

4 
	~"posix_ty³s_64.h
"

	@/usr/include/bits/byteswap.h

21 #ià!
defšed
 
_BYTESWAP_H
 && !defšed 
_NETINET_IN_H
 && !defšed 
_ENDIAN_H


25 #iâdeà
_BITS_BYTESWAP_H


26 
	#_BITS_BYTESWAP_H
 1

	)

28 
	~<b™s/wÜdsize.h
>

31 
	#__bsw­_cÚ¡ªt_16
(
x
) \

32 ((è((((
x
è>> 8è& 0xffè| (((xè& 0xffè<< 8)))

	)

34 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

35 
	#__bsw­_16
(
x
) \

36 (
__ex‹nsiÚ__
 \

37 ({ 
__v
, 
__x
 = (è(
x
); \

38 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

39 
__v
 = 
	`__bsw­_cÚ¡ªt_16
 (
__x
); \

41 
	`__asm__
 ("rorw $8, %w0" \

42 : "ô" (
__v
) \

43 : "0" (
__x
) \

45 
__v
; }))

	)

48 
	#__bsw­_16
(
x
) \

49 (
__ex‹nsiÚ__
 \

50 ({ 
__x
 = (è(
x
); \

51 
	`__bsw­_cÚ¡ªt_16
 (
__x
); }))

	)

56 
	#__bsw­_cÚ¡ªt_32
(
x
) \

57 ((((
x
) & 0xff000000) >> 24) | (((x) & 0x00ff0000) >> 8) | \

58 (((
x
è& 0x0000ff00è<< 8è| (((xè& 0x000000ffè<< 24))

	)

60 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

61 #ià
__WORDSIZE
 =ğ64 || (
defšed
 
__i486__
 || defšed 
__³Áium__
 \

62 || 
defšed
 
	g__³Áium´o__
 || defšed 
	g__³Áium4__
 \

63 || 
defšed
 
	g__k8__
 || defšed 
	g__©hlÚ__
 \

64 || 
defšed
 
	g__k6__
 || defšed 
	g__nocÚa__
 \

65 || 
defšed
 
	g__cÜe2__
 || defšed 
	g__geode__
 \

66 || 
defšed
 
	g__amdçm10__
)

69 
	#__bsw­_32
(
x
) \

70 (
__ex‹nsiÚ__
 \

71 ({ 
__v
, 
__x
 = (
x
); \

72 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

73 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

75 
	`__asm__
 ("bsw­ %0" : "ô" (
__v
è: "0" (
__x
)); \

76 
__v
; }))

	)

78 
	#__bsw­_32
(
x
) \

79 (
__ex‹nsiÚ__
 \

80 ({ 
__v
, 
__x
 = (
x
); \

81 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

82 
__v
 = 
	`__bsw­_cÚ¡ªt_32
 (
__x
); \

84 
	`__asm__
 ("rorw $8, %w0;" \

87 : "ô" (
__v
) \

88 : "0" (
__x
) \

90 
__v
; }))

	)

93 
	#__bsw­_32
(
x
) \

94 (
__ex‹nsiÚ__
 \

95 ({ 
__x
 = (
x
); 
	`__bsw­_cÚ¡ªt_32
 (__x); }))

	)

99 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

101 
	#__bsw­_cÚ¡ªt_64
(
x
) \

102 ((((
x
) & 0xff00000000000000ull) >> 56) \

103 | (((
x
) & 0x00ff000000000000ull) >> 40) \

104 | (((
x
) & 0x0000ff0000000000ull) >> 24) \

105 | (((
x
) & 0x000000ff00000000ull) >> 8) \

106 | (((
x
) & 0x00000000ff000000ull) << 8) \

107 | (((
x
) & 0x0000000000ff0000ull) << 24) \

108 | (((
x
) & 0x000000000000ff00ull) << 40) \

109 | (((
x
è& 0x00000000000000ffuÎè<< 56))

	)

111 #ià
__WORDSIZE
 == 64

112 
	#__bsw­_64
(
x
) \

113 (
__ex‹nsiÚ__
 \

114 ({ 
__v
, 
__x
 = (
x
); \

115 ià(
	`__butš_cÚ¡ªt_p
 (
__x
)) \

116 
__v
 = 
	`__bsw­_cÚ¡ªt_64
 (
__x
); \

118 
	`__asm__
 ("bsw­ %q0" : "ô" (
__v
è: "0" (
__x
)); \

119 
__v
; }))

	)

121 
	#__bsw­_64
(
x
) \

122 (
__ex‹nsiÚ__
 \

123 ({ uniÚ { 
__ex‹nsiÚ__
 
__Î
; \

124 
__l
[2]; } 
__w
, 
__r
; \

125 ià(
	`__butš_cÚ¡ªt_p
 (
x
)) \

126 
__r
.
__Î
 = 
	`__bsw­_cÚ¡ªt_64
 (
x
); \

129 
__w
.
__Î
 = (
x
); \

130 
__r
.
__l
[0] = 
	`__bsw­_32
 (
__w
.__l[1]); \

131 
__r
.
__l
[1] = 
	`__bsw­_32
 (
__w
.__l[0]); \

133 
__r
.
__Î
; }))

	)

	@/usr/include/bits/in.h

21 #iâdeà
_NETINET_IN_H


30 #ifdeà
_UAPI_LINUX_IN6_H


34 
	#__USE_KERNEL_IPV6_DEFS


	)

40 
	#IP_OPTIONS
 4

	)

41 
	#IP_HDRINCL
 3

	)

42 
	#IP_TOS
 1

	)

43 
	#IP_TTL
 2

	)

44 
	#IP_RECVOPTS
 6

	)

46 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

47 
	#IP_RETOPTS
 7

	)

48 
	#IP_MULTICAST_IF
 32

	)

49 
	#IP_MULTICAST_TTL
 33

	)

50 
	#IP_MULTICAST_LOOP
 34

	)

51 
	#IP_ADD_MEMBERSHIP
 35

	)

52 
	#IP_DROP_MEMBERSHIP
 36

	)

53 
	#IP_UNBLOCK_SOURCE
 37

	)

54 
	#IP_BLOCK_SOURCE
 38

	)

55 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

56 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

57 
	#IP_MSFILTER
 41

	)

58 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


59 
	#MCAST_JOIN_GROUP
 42

	)

60 
	#MCAST_BLOCK_SOURCE
 43

	)

61 
	#MCAST_UNBLOCK_SOURCE
 44

	)

62 
	#MCAST_LEAVE_GROUP
 45

	)

63 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

64 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

65 
	#MCAST_MSFILTER
 48

	)

67 
	#MCAST_EXCLUDE
 0

	)

68 
	#MCAST_INCLUDE
 1

	)

71 
	#IP_ROUTER_ALERT
 5

	)

72 
	#IP_PKTINFO
 8

	)

73 
	#IP_PKTOPTIONS
 9

	)

74 
	#IP_PMTUDISC
 10

	)

75 
	#IP_MTU_DISCOVER
 10

	)

76 
	#IP_RECVERR
 11

	)

77 
	#IP_RECVTTL
 12

	)

78 
	#IP_RECVTOS
 13

	)

79 
	#IP_MTU
 14

	)

80 
	#IP_FREEBIND
 15

	)

81 
	#IP_IPSEC_POLICY
 16

	)

82 
	#IP_XFRM_POLICY
 17

	)

83 
	#IP_PASSSEC
 18

	)

84 
	#IP_TRANSPARENT
 19

	)

85 
	#IP_MULTICAST_ALL
 49

	)

88 
	#IP_ORIGDSTADDR
 20

	)

89 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

91 
	#IP_MINTTL
 21

	)

95 
	#IP_PMTUDISC_DONT
 0

	)

96 
	#IP_PMTUDISC_WANT
 1

	)

97 
	#IP_PMTUDISC_DO
 2

	)

98 
	#IP_PMTUDISC_PROBE
 3

	)

101 
	#SOL_IP
 0

	)

103 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

104 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

105 
	#IP_MAX_MEMBERSHIPS
 20

	)

107 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


111 
	s_İts


113 
š_addr
 
	m_d¡
;

114 
	m_İts
[40];

118 
	s_m»qn


120 
š_addr
 
	mimr_muÉŸddr
;

121 
š_addr
 
	mimr_add»ss
;

122 
	mimr_ifšdex
;

126 
	sš_pktšfo


128 
	mi_ifšdex
;

129 
š_addr
 
	mi_¥ec_d¡
;

130 
š_addr
 
	mi_addr
;

137 
	#IPV6_ADDRFORM
 1

	)

138 
	#IPV6_2292PKTINFO
 2

	)

139 
	#IPV6_2292HOPOPTS
 3

	)

140 
	#IPV6_2292DSTOPTS
 4

	)

141 
	#IPV6_2292RTHDR
 5

	)

142 
	#IPV6_2292PKTOPTIONS
 6

	)

143 
	#IPV6_CHECKSUM
 7

	)

144 
	#IPV6_2292HOPLIMIT
 8

	)

146 
	#SCM_SRCRT
 
IPV6_RXSRCRT


	)

148 
	#IPV6_NEXTHOP
 9

	)

149 
	#IPV6_AUTHHDR
 10

	)

150 
	#IPV6_UNICAST_HOPS
 16

	)

151 
	#IPV6_MULTICAST_IF
 17

	)

152 
	#IPV6_MULTICAST_HOPS
 18

	)

153 
	#IPV6_MULTICAST_LOOP
 19

	)

154 
	#IPV6_JOIN_GROUP
 20

	)

155 
	#IPV6_LEAVE_GROUP
 21

	)

156 
	#IPV6_ROUTER_ALERT
 22

	)

157 
	#IPV6_MTU_DISCOVER
 23

	)

158 
	#IPV6_MTU
 24

	)

159 
	#IPV6_RECVERR
 25

	)

160 
	#IPV6_V6ONLY
 26

	)

161 
	#IPV6_JOIN_ANYCAST
 27

	)

162 
	#IPV6_LEAVE_ANYCAST
 28

	)

163 
	#IPV6_IPSEC_POLICY
 34

	)

164 
	#IPV6_XFRM_POLICY
 35

	)

166 
	#IPV6_RECVPKTINFO
 49

	)

167 
	#IPV6_PKTINFO
 50

	)

168 
	#IPV6_RECVHOPLIMIT
 51

	)

169 
	#IPV6_HOPLIMIT
 52

	)

170 
	#IPV6_RECVHOPOPTS
 53

	)

171 
	#IPV6_HOPOPTS
 54

	)

172 
	#IPV6_RTHDRDSTOPTS
 55

	)

173 
	#IPV6_RECVRTHDR
 56

	)

174 
	#IPV6_RTHDR
 57

	)

175 
	#IPV6_RECVDSTOPTS
 58

	)

176 
	#IPV6_DSTOPTS
 59

	)

178 
	#IPV6_RECVTCLASS
 66

	)

179 
	#IPV6_TCLASS
 67

	)

182 
	#IPV6_ADD_MEMBERSHIP
 
IPV6_JOIN_GROUP


	)

183 
	#IPV6_DROP_MEMBERSHIP
 
IPV6_LEAVE_GROUP


	)

184 
	#IPV6_RXHOPOPTS
 
IPV6_HOPOPTS


	)

185 
	#IPV6_RXDSTOPTS
 
IPV6_DSTOPTS


	)

188 
	#IPV6_PMTUDISC_DONT
 0

	)

189 
	#IPV6_PMTUDISC_WANT
 1

	)

190 
	#IPV6_PMTUDISC_DO
 2

	)

191 
	#IPV6_PMTUDISC_PROBE
 3

	)

194 
	#SOL_IPV6
 41

	)

195 
	#SOL_ICMPV6
 58

	)

198 
	#IPV6_RTHDR_LOOSE
 0

	)

199 
	#IPV6_RTHDR_STRICT
 1

	)

201 
	#IPV6_RTHDR_TYPE_0
 0

	)

	@/usr/include/bits/pthreadtypes.h

20 #iâdeà
_BITS_PTHREADTYPES_H


21 
	#_BITS_PTHREADTYPES_H
 1

	)

23 
	~<b™s/wÜdsize.h
>

25 #ià
__WORDSIZE
 == 64

26 
	#__SIZEOF_PTHREAD_ATTR_T
 56

	)

27 
	#__SIZEOF_PTHREAD_MUTEX_T
 40

	)

28 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

29 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

30 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

31 
	#__SIZEOF_PTHREAD_RWLOCK_T
 56

	)

32 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

33 
	#__SIZEOF_PTHREAD_BARRIER_T
 32

	)

34 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

36 
	#__SIZEOF_PTHREAD_ATTR_T
 36

	)

37 
	#__SIZEOF_PTHREAD_MUTEX_T
 24

	)

38 
	#__SIZEOF_PTHREAD_MUTEXATTR_T
 4

	)

39 
	#__SIZEOF_PTHREAD_COND_T
 48

	)

40 
	#__SIZEOF_PTHREAD_CONDATTR_T
 4

	)

41 
	#__SIZEOF_PTHREAD_RWLOCK_T
 32

	)

42 
	#__SIZEOF_PTHREAD_RWLOCKATTR_T
 8

	)

43 
	#__SIZEOF_PTHREAD_BARRIER_T
 20

	)

44 
	#__SIZEOF_PTHREAD_BARRIERATTR_T
 4

	)

50 
	t±h»ad_t
;

55 
	m__size
[
__SIZEOF_PTHREAD_ATTR_T
];

56 
	m__®ign
;

57 } 
	t±h»ad_©Œ_t
;

60 #ià
__WORDSIZE
 == 64

61 
	s__±h»ad_š‹º®_li¡


63 
__±h»ad_š‹º®_li¡
 *
	m__´ev
;

64 
__±h»ad_š‹º®_li¡
 *
	m__Ãxt
;

65 } 
	t__±h»ad_li¡_t
;

67 
	s__±h»ad_š‹º®_¦i¡


69 
__±h»ad_š‹º®_¦i¡
 *
	m__Ãxt
;

70 } 
	t__±h»ad_¦i¡_t
;

78 
	s__±h»ad_mu‹x_s


80 
	m__lock
;

81 
	m__couÁ
;

82 
	m__owÃr
;

83 #ià
__WORDSIZE
 == 64

84 
	m__nu£rs
;

88 
	m__kšd
;

89 #ià
__WORDSIZE
 == 64

90 
	m__¥šs
;

91 
__±h»ad_li¡_t
 
	m__li¡
;

92 
	#__PTHREAD_MUTEX_HAVE_PREV
 1

	)

94 
	m__nu£rs
;

95 
__ex‹nsiÚ__
 union

97 
	m__¥šs
;

98 
__±h»ad_¦i¡_t
 
	m__li¡
;

101 } 
	m__d©a
;

102 
	m__size
[
__SIZEOF_PTHREAD_MUTEX_T
];

103 
	m__®ign
;

104 } 
	t±h»ad_mu‹x_t
;

108 
	m__size
[
__SIZEOF_PTHREAD_MUTEXATTR_T
];

109 
	m__®ign
;

110 } 
	t±h»ad_mu‹x©Œ_t
;

119 
	m__lock
;

120 
	m__fu‹x
;

121 
__ex‹nsiÚ__
 
	m__tÙ®_£q
;

122 
__ex‹nsiÚ__
 
	m__wakeup_£q
;

123 
__ex‹nsiÚ__
 
	m__wok’_£q
;

124 *
	m__mu‹x
;

125 
	m__nwa™”s
;

126 
	m__brßdÿ¡_£q
;

127 } 
	m__d©a
;

128 
	m__size
[
__SIZEOF_PTHREAD_COND_T
];

129 
__ex‹nsiÚ__
 
	m__®ign
;

130 } 
	t±h»ad_cÚd_t
;

134 
	m__size
[
__SIZEOF_PTHREAD_CONDATTR_T
];

135 
	m__®ign
;

136 } 
	t±h»ad_cÚd©Œ_t
;

140 
	t±h»ad_key_t
;

144 
	t±h»ad_Úû_t
;

147 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


152 #ià
__WORDSIZE
 == 64

155 
	m__lock
;

156 
	m__Ä_»ad”s
;

157 
	m__»ad”s_wakeup
;

158 
	m__wr™”_wakeup
;

159 
	m__Ä_»ad”s_queued
;

160 
	m__Ä_wr™”s_queued
;

161 
	m__wr™”
;

162 
	m__sh¬ed
;

163 
	m__·d1
;

164 
	m__·d2
;

167 
	m__æags
;

168 } 
	m__d©a
;

172 
	m__lock
;

173 
	m__Ä_»ad”s
;

174 
	m__»ad”s_wakeup
;

175 
	m__wr™”_wakeup
;

176 
	m__Ä_»ad”s_queued
;

177 
	m__Ä_wr™”s_queued
;

180 
	m__æags
;

181 
	m__sh¬ed
;

182 
	m__·d1
;

183 
	m__·d2
;

184 
	m__wr™”
;

185 } 
	m__d©a
;

187 
	m__size
[
__SIZEOF_PTHREAD_RWLOCK_T
];

188 
	m__®ign
;

189 } 
	t±h»ad_rwlock_t
;

193 
	m__size
[
__SIZEOF_PTHREAD_RWLOCKATTR_T
];

194 
	m__®ign
;

195 } 
	t±h»ad_rwlock©Œ_t
;

199 #ifdeà
__USE_XOPEN2K


201 vŞ©
	t±h»ad_¥šlock_t
;

208 
	m__size
[
__SIZEOF_PTHREAD_BARRIER_T
];

209 
	m__®ign
;

210 } 
	t±h»ad_b¬r›r_t
;

214 
	m__size
[
__SIZEOF_PTHREAD_BARRIERATTR_T
];

215 
	m__®ign
;

216 } 
	t±h»ad_b¬r›¿‰r_t
;

220 #ià
__WORDSIZE
 == 32

222 
	#__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
	`__»g·rm__
 (1)))

	)

	@/usr/include/bits/sigset.h

21 #iâdef 
_SIGSET_H_ty³s


22 
	#_SIGSET_H_ty³s
 1

	)

24 
	t__sig_©omic_t
;

28 
	#_SIGSET_NWORDS
 (1024 / (8 *  ()))

	)

31 
	m__v®
[
_SIGSET_NWORDS
];

32 } 
	t__sig£t_t
;

43 #ià!
defšed
 
_SIGSET_H_âs
 && defšed 
_SIGNAL_H


44 
	#_SIGSET_H_âs
 1

	)

46 #iâdeà
_EXTERN_INLINE


47 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

51 
	#__sigmask
(
sig
) \

52 (((è1è<< (((
sig
è- 1è% (8 *  ())))

	)

55 
	#__sigwÜd
(
sig
è(((sigè- 1è/ (8 *  ()))

	)

57 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

58 
	#__sigem±y£t
(
£t
) \

59 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

60 
sig£t_t
 *
__£t
 = (
£t
); \

61 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = 0; \

62 0; }))

	)

63 
	#__sigfl£t
(
£t
) \

64 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

65 
sig£t_t
 *
__£t
 = (
£t
); \

66 --
__út
 >ğ0è
__£t
->
__v®
[__cnt] = ~0UL; \

67 0; }))

	)

69 #ifdeà
__USE_GNU


73 
	#__sigi£m±y£t
(
£t
) \

74 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

75 cÚ¡ 
sig£t_t
 *
__£t
 = (
£t
); \

76 
__»t
 = 
__£t
->
__v®
[--
__út
]; \

77 !
__»t
 && --
__út
 >= 0) \

78 
__»t
 = 
__£t
->
__v®
[
__út
]; \

79 
__»t
 =ğ0; }))

	)

80 
	#__sigªd£t
(
de¡
, 
Ëá
, 
right
) \

81 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

82 
sig£t_t
 *
__de¡
 = (
de¡
); \

83 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

84 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

85 --
__út
 >= 0) \

86 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

87 & 
__right
->
__v®
[
__út
]); \

88 0; }))

	)

89 
	#__sigÜ£t
(
de¡
, 
Ëá
, 
right
) \

90 (
	`__ex‹nsiÚ__
 ({ 
__út
 = 
_SIGSET_NWORDS
; \

91 
sig£t_t
 *
__de¡
 = (
de¡
); \

92 cÚ¡ 
sig£t_t
 *
__Ëá
 = (
Ëá
); \

93 cÚ¡ 
sig£t_t
 *
__right
 = (
right
); \

94 --
__út
 >= 0) \

95 
__de¡
->
__v®
[
__út
] = (
__Ëá
->__val[__cnt] \

96 | 
__right
->
__v®
[
__út
]); \

97 0; }))

	)

104 
__sigismemb”
 (
__cÚ¡
 
__sig£t_t
 *, );

105 
__sigadd£t
 (
__sig£t_t
 *, );

106 
__sigd–£t
 (
__sig£t_t
 *, );

108 #ifdeà
__USE_EXTERN_INLINES


109 
	#__SIGSETFN
(
NAME
, 
BODY
, 
CONST
) \

110 
_EXTERN_INLINE
 \

111 
	`NAME
 (
CONST
 
__sig£t_t
 *
__£t
, 
__sig
) \

113 
__mask
 = 
	`__sigmask
 (
__sig
); \

114 
__wÜd
 = 
	`__sigwÜd
 (
__sig
); \

115  
BODY
; \

116 }

	)

118 
__SIGSETFN
 (
__sigismemb”
, (
__£t
->
__v®
[
__wÜd
] & 
__mask
è? 1 : 0, 
__cÚ¡
)

119 
__SIGSETFN
 (
__sigadd£t
, ((
__£t
->
__v®
[
__wÜd
] |ğ
__mask
), 0), )

120 
__SIGSETFN
 (
__sigd–£t
, ((
__£t
->
__v®
[
__wÜd
] &ğ~
__mask
), 0), )

122 #undeà
__SIGSETFN


	@/usr/include/bits/socket.h

21 #iâdeà
__BITS_SOCKET_H


22 
	#__BITS_SOCKET_H


	)

24 #iâdeà
_SYS_SOCKET_H


28 
	#__Ãed_size_t


	)

29 
	~<¡ddef.h
>

31 
	~<sys/ty³s.h
>

34 #iâdeà
__sockËn_t_defšed


35 
__sockËn_t
 
	tsockËn_t
;

36 
	#__sockËn_t_defšed


	)

40 
	e__sock‘_ty³


42 
	mSOCK_STREAM
 = 1,

44 
	#SOCK_STREAM
 
SOCK_STREAM


	)

45 
	mSOCK_DGRAM
 = 2,

47 
	#SOCK_DGRAM
 
SOCK_DGRAM


	)

48 
	mSOCK_RAW
 = 3,

49 
	#SOCK_RAW
 
SOCK_RAW


	)

50 
	mSOCK_RDM
 = 4,

51 
	#SOCK_RDM
 
SOCK_RDM


	)

52 
	mSOCK_SEQPACKET
 = 5,

54 
	#SOCK_SEQPACKET
 
SOCK_SEQPACKET


	)

55 
	mSOCK_DCCP
 = 6,

56 
	#SOCK_DCCP
 
SOCK_DCCP


	)

57 
	mSOCK_PACKET
 = 10,

60 
	#SOCK_PACKET
 
SOCK_PACKET


	)

65 
	mSOCK_CLOEXEC
 = 02000000,

67 
	#SOCK_CLOEXEC
 
SOCK_CLOEXEC


	)

68 
	mSOCK_NONBLOCK
 = 04000

70 
	#SOCK_NONBLOCK
 
SOCK_NONBLOCK


	)

74 
	#PF_UNSPEC
 0

	)

75 
	#PF_LOCAL
 1

	)

76 
	#PF_UNIX
 
PF_LOCAL


	)

77 
	#PF_FILE
 
PF_LOCAL


	)

78 
	#PF_INET
 2

	)

79 
	#PF_AX25
 3

	)

80 
	#PF_IPX
 4

	)

81 
	#PF_APPLETALK
 5

	)

82 
	#PF_NETROM
 6

	)

83 
	#PF_BRIDGE
 7

	)

84 
	#PF_ATMPVC
 8

	)

85 
	#PF_X25
 9

	)

86 
	#PF_INET6
 10

	)

87 
	#PF_ROSE
 11

	)

88 
	#PF_DECÃt
 12

	)

89 
	#PF_NETBEUI
 13

	)

90 
	#PF_SECURITY
 14

	)

91 
	#PF_KEY
 15

	)

92 
	#PF_NETLINK
 16

	)

93 
	#PF_ROUTE
 
PF_NETLINK


	)

94 
	#PF_PACKET
 17

	)

95 
	#PF_ASH
 18

	)

96 
	#PF_ECONET
 19

	)

97 
	#PF_ATMSVC
 20

	)

98 
	#PF_RDS
 21

	)

99 
	#PF_SNA
 22

	)

100 
	#PF_IRDA
 23

	)

101 
	#PF_PPPOX
 24

	)

102 
	#PF_WANPIPE
 25

	)

103 
	#PF_LLC
 26

	)

104 
	#PF_CAN
 29

	)

105 
	#PF_TIPC
 30

	)

106 
	#PF_BLUETOOTH
 31

	)

107 
	#PF_IUCV
 32

	)

108 
	#PF_RXRPC
 33

	)

109 
	#PF_ISDN
 34

	)

110 
	#PF_PHONET
 35

	)

111 
	#PF_IEEE802154
 36

	)

112 
	#PF_MAX
 37

	)

115 
	#AF_UNSPEC
 
PF_UNSPEC


	)

116 
	#AF_LOCAL
 
PF_LOCAL


	)

117 
	#AF_UNIX
 
PF_UNIX


	)

118 
	#AF_FILE
 
PF_FILE


	)

119 
	#AF_INET
 
PF_INET


	)

120 
	#AF_AX25
 
PF_AX25


	)

121 
	#AF_IPX
 
PF_IPX


	)

122 
	#AF_APPLETALK
 
PF_APPLETALK


	)

123 
	#AF_NETROM
 
PF_NETROM


	)

124 
	#AF_BRIDGE
 
PF_BRIDGE


	)

125 
	#AF_ATMPVC
 
PF_ATMPVC


	)

126 
	#AF_X25
 
PF_X25


	)

127 
	#AF_INET6
 
PF_INET6


	)

128 
	#AF_ROSE
 
PF_ROSE


	)

129 
	#AF_DECÃt
 
PF_DECÃt


	)

130 
	#AF_NETBEUI
 
PF_NETBEUI


	)

131 
	#AF_SECURITY
 
PF_SECURITY


	)

132 
	#AF_KEY
 
PF_KEY


	)

133 
	#AF_NETLINK
 
PF_NETLINK


	)

134 
	#AF_ROUTE
 
PF_ROUTE


	)

135 
	#AF_PACKET
 
PF_PACKET


	)

136 
	#AF_ASH
 
PF_ASH


	)

137 
	#AF_ECONET
 
PF_ECONET


	)

138 
	#AF_ATMSVC
 
PF_ATMSVC


	)

139 
	#AF_RDS
 
PF_RDS


	)

140 
	#AF_SNA
 
PF_SNA


	)

141 
	#AF_IRDA
 
PF_IRDA


	)

142 
	#AF_PPPOX
 
PF_PPPOX


	)

143 
	#AF_WANPIPE
 
PF_WANPIPE


	)

144 
	#AF_LLC
 
PF_LLC


	)

145 
	#AF_CAN
 
PF_CAN


	)

146 
	#AF_TIPC
 
PF_TIPC


	)

147 
	#AF_BLUETOOTH
 
PF_BLUETOOTH


	)

148 
	#AF_IUCV
 
PF_IUCV


	)

149 
	#AF_RXRPC
 
PF_RXRPC


	)

150 
	#AF_ISDN
 
PF_ISDN


	)

151 
	#AF_PHONET
 
PF_PHONET


	)

152 
	#AF_IEEE802154
 
PF_IEEE802154


	)

153 
	#AF_MAX
 
PF_MAX


	)

159 
	#SOL_RAW
 255

	)

160 
	#SOL_DECNET
 261

	)

161 
	#SOL_X25
 262

	)

162 
	#SOL_PACKET
 263

	)

163 
	#SOL_ATM
 264

	)

164 
	#SOL_AAL
 265

	)

165 
	#SOL_IRDA
 266

	)

168 
	#SOMAXCONN
 128

	)

171 
	~<b™s/sockaddr.h
>

174 
	ssockaddr


176 
__SOCKADDR_COMMON
 (
§_
);

177 
	m§_d©a
[14];

183 
	#__ss_®igÁy³
 

	)

184 
	#_SS_SIZE
 128

	)

185 
	#_SS_PADSIZE
 (
_SS_SIZE
 - (2 *  (
__ss_®igÁy³
)))

	)

187 
	ssockaddr_¡Üage


189 
__SOCKADDR_COMMON
 (
ss_
);

190 
__ss_®igÁy³
 
	m__ss_®ign
;

191 
	m__ss_·ddšg
[
_SS_PADSIZE
];

198 
	mMSG_OOB
 = 0x01,

199 
	#MSG_OOB
 
MSG_OOB


	)

200 
	mMSG_PEEK
 = 0x02,

201 
	#MSG_PEEK
 
MSG_PEEK


	)

202 
	mMSG_DONTROUTE
 = 0x04,

203 
	#MSG_DONTROUTE
 
MSG_DONTROUTE


	)

204 #ifdeà
__USE_GNU


206 
	mMSG_TRYHARD
 = 
MSG_DONTROUTE
,

207 
	#MSG_TRYHARD
 
MSG_DONTROUTE


	)

209 
	mMSG_CTRUNC
 = 0x08,

210 
	#MSG_CTRUNC
 
MSG_CTRUNC


	)

211 
	mMSG_PROXY
 = 0x10,

212 
	#MSG_PROXY
 
MSG_PROXY


	)

213 
	mMSG_TRUNC
 = 0x20,

214 
	#MSG_TRUNC
 
MSG_TRUNC


	)

215 
	mMSG_DONTWAIT
 = 0x40,

216 
	#MSG_DONTWAIT
 
MSG_DONTWAIT


	)

217 
	mMSG_EOR
 = 0x80,

218 
	#MSG_EOR
 
MSG_EOR


	)

219 
	mMSG_WAITALL
 = 0x100,

220 
	#MSG_WAITALL
 
MSG_WAITALL


	)

221 
	mMSG_FIN
 = 0x200,

222 
	#MSG_FIN
 
MSG_FIN


	)

223 
	mMSG_SYN
 = 0x400,

224 
	#MSG_SYN
 
MSG_SYN


	)

225 
	mMSG_CONFIRM
 = 0x800,

226 
	#MSG_CONFIRM
 
MSG_CONFIRM


	)

227 
	mMSG_RST
 = 0x1000,

228 
	#MSG_RST
 
MSG_RST


	)

229 
	mMSG_ERRQUEUE
 = 0x2000,

230 
	#MSG_ERRQUEUE
 
MSG_ERRQUEUE


	)

231 
	mMSG_NOSIGNAL
 = 0x4000,

232 
	#MSG_NOSIGNAL
 
MSG_NOSIGNAL


	)

233 
	mMSG_MORE
 = 0x8000,

234 
	#MSG_MORE
 
MSG_MORE


	)

235 
	mMSG_WAITFORONE
 = 0x10000,

236 
	#MSG_WAITFORONE
 
MSG_WAITFORONE


	)

238 
	mMSG_CMSG_CLOEXEC
 = 0x40000000

241 
	#MSG_CMSG_CLOEXEC
 
MSG_CMSG_CLOEXEC


	)

247 
	smsghdr


249 *
	mmsg_Çme
;

250 
sockËn_t
 
	mmsg_Çm–’
;

252 
iovec
 *
	mmsg_iov
;

253 
size_t
 
	mmsg_iovËn
;

255 *
	mmsg_cÚŒŞ
;

256 
size_t
 
	mmsg_cÚŒŞËn
;

261 
	mmsg_æags
;

264 #ifdeà
__USE_GNU


266 
	smmsghdr


268 
msghdr
 
	mmsg_hdr
;

269 
	mmsg_Ën
;

274 
	scmsghdr


276 
size_t
 
	mcmsg_Ën
;

281 
	mcmsg_Ëv–
;

282 
	mcmsg_ty³
;

283 #ià(!
defšed
 
__STRICT_ANSI__
 && 
__GNUC__
 >ğ2è|| 
__STDC_VERSION__
 >= 199901L

284 
__ex‹nsiÚ__
 
__cmsg_d©a
 
	m__æex¬r
;

289 #ià(!
defšed
 
__STRICT_ANSI__
 && 
__GNUC__
 >ğ2è|| 
__STDC_VERSION__
 >= 199901L

290 
	#CMSG_DATA
(
cmsg
è((cmsg)->
__cmsg_d©a
)

	)

292 
	#CMSG_DATA
(
cmsg
è((*è((
cmsghdr
 *è(cmsgè+ 1))

	)

294 
	#CMSG_NXTHDR
(
mhdr
, 
cmsg
è
	`__cmsg_nxthdr
 (mhdr, cmsg)

	)

295 
	#CMSG_FIRSTHDR
(
mhdr
) \

296 ((
size_t
è(
mhdr
)->
msg_cÚŒŞËn
 >ğ (
cmsghdr
) \

297 ? (
cmsghdr
 *è(
mhdr
)->
msg_cÚŒŞ
 : (cmsghd¸*è0)

	)

298 
	#CMSG_ALIGN
(
Ën
è((Ö’è+  (
size_t
) - 1) \

299 & (
size_t
è~( (size_tè- 1))

	)

300 
	#CMSG_SPACE
(
Ën
è(
	`CMSG_ALIGN
 (len) \

301 + 
	`CMSG_ALIGN
 ( (
cmsghdr
)))

	)

302 
	#CMSG_LEN
(
Ën
è(
	`CMSG_ALIGN
 ( (
cmsghdr
)è+ (Ën))

	)

304 
cmsghdr
 *
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
,

305 
cmsghdr
 *
__cmsg
è
__THROW
;

306 #ifdeà
__USE_EXTERN_INLINES


307 #iâdeà
_EXTERN_INLINE


308 
	#_EXTERN_INLINE
 
__ex‹º_šlše


	)

310 
_EXTERN_INLINE
 
cmsghdr
 *

311 
	`__NTH
 (
	$__cmsg_nxthdr
 (
msghdr
 *
__mhdr
, 
cmsghdr
 *
__cmsg
))

313 ià((
size_t
è
__cmsg
->
cmsg_Ën
 <  (
cmsghdr
))

317 
__cmsg
 = (
cmsghdr
 *) ((*) __cmsg

318 + 
	`CMSG_ALIGN
 (
__cmsg
->
cmsg_Ën
));

319 ià((*è(
__cmsg
 + 1è> ((*è
__mhdr
->
msg_cÚŒŞ


320 + 
__mhdr
->
msg_cÚŒŞËn
)

321 || ((*è
__cmsg
 + 
	`CMSG_ALIGN
 (__cmsg->
cmsg_Ën
)

322 > ((*è
__mhdr
->
msg_cÚŒŞ
 + __mhdr->
msg_cÚŒŞËn
)))

325  
__cmsg
;

326 
	}
}

333 
	mSCM_RIGHTS
 = 0x01

334 
	#SCM_RIGHTS
 
SCM_RIGHTS


	)

335 #ifdeà
__USE_GNU


336 , 
	mSCM_CREDENTIALS
 = 0x02

337 
	#SCM_CREDENTIALS
 
SCM_CREDENTIALS


	)

341 #ifdeà
__USE_GNU


343 
	suüed


345 
pid_t
 
	mpid
;

346 
uid_t
 
	muid
;

347 
gid_t
 
	mgid
;

352 #ià!
defšed
 
__USE_MISC
 && !defšed 
__USE_GNU


353 #iâdeà
FIOGETOWN


354 
	#__SYS_SOCKET_H_undef_FIOGETOWN


	)

356 #iâdeà
FIOSETOWN


357 
	#__SYS_SOCKET_H_undef_FIOSETOWN


	)

359 #iâdeà
SIOCATMARK


360 
	#__SYS_SOCKET_H_undef_SIOCATMARK


	)

362 #iâdeà
SIOCGPGRP


363 
	#__SYS_SOCKET_H_undef_SIOCGPGRP


	)

365 #iâdeà
SIOCGSTAMP


366 
	#__SYS_SOCKET_H_undef_SIOCGSTAMP


	)

368 #iâdeà
SIOCGSTAMPNS


369 
	#__SYS_SOCKET_H_undef_SIOCGSTAMPNS


	)

371 #iâdeà
SIOCSPGRP


372 
	#__SYS_SOCKET_H_undef_SIOCSPGRP


	)

377 
	~<asm/sock‘.h
>

379 #ià!
defšed
 
__USE_MISC
 && !defšed 
__USE_GNU


380 #ifdeà
__SYS_SOCKET_H_undef_FIOGETOWN


381 #undeà
__SYS_SOCKET_H_undef_FIOGETOWN


382 #undeà
FIOGETOWN


384 #ifdeà
__SYS_SOCKET_H_undef_FIOSETOWN


385 #undeà
__SYS_SOCKET_H_undef_FIOSETOWN


386 #undeà
FIOSETOWN


388 #ifdeà
__SYS_SOCKET_H_undef_SIOCATMARK


389 #undeà
__SYS_SOCKET_H_undef_SIOCATMARK


390 #undeà
SIOCATMARK


392 #ifdeà
__SYS_SOCKET_H_undef_SIOCGPGRP


393 #undeà
__SYS_SOCKET_H_undef_SIOCGPGRP


394 #undeà
SIOCGPGRP


396 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


397 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMP


398 #undeà
SIOCGSTAMP


400 #ifdeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


401 #undeà
__SYS_SOCKET_H_undef_SIOCGSTAMPNS


402 #undeà
SIOCGSTAMPNS


404 #ifdeà
__SYS_SOCKET_H_undef_SIOCSPGRP


405 #undeà
__SYS_SOCKET_H_undef_SIOCSPGRP


406 #undeà
SIOCSPGRP


411 
	slšg”


413 
	ml_Úoff
;

414 
	ml_lšg”
;

418 
__BEGIN_DECLS


425 
»cvmmsg
 (
__fd
, 
mmsghdr
 *
__vmes§ges
,

426 
__vËn
, 
__æags
,

427 
__cÚ¡
 
time¥ec
 *
__tmo
);

429 
	g__END_DECLS


	@/usr/include/bits/socket2.h

20 #iâdeà
_SYS_SOCKET_H


24 
ssize_t
 
__»cv_chk
 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

25 
__æags
);

26 
ssize_t
 
__REDIRECT
 (
__»cv_®Ÿs
, (
__fd
, *
__buf
, 
size_t
 
__n
,

27 
__æags
), 
»cv
);

28 
ssize_t
 
__REDIRECT
 (
__»cv_chk_w¬n
,

29 (
__fd
, *
__buf
, 
size_t
 
__n
, size_ˆ
__buæ’
,

30 
__æags
), 
__»cv_chk
)

31 
__w¬Ç‰r
 ("recv called with bigger†engthhan size of destination "

34 
__ex‹º_®ways_šlše
 
ssize_t


35 
	$»cv
 (
__fd
, *
__buf
, 
size_t
 
__n
, 
__æags
)

37 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

39 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

40  
	`__»cv_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

42 ià(
__n
 > 
	`__bos0
 (
__buf
))

43  
	`__»cv_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
);

45  
	`__»cv_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
);

46 
	}
}

48 
ssize_t
 
__»cväom_chk
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

49 
size_t
 
__buæ’
, 
__æags
,

50 
__SOCKADDR_ARG
 
__addr
,

51 
sockËn_t
 *
__»¡riù
 
__addr_Ën
);

52 
ssize_t
 
__REDIRECT
 (
__»cväom_®Ÿs
,

53 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

54 
__æags
, 
__SOCKADDR_ARG
 
__addr
,

55 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
»cväom
);

56 
ssize_t
 
__REDIRECT
 (
__»cväom_chk_w¬n
,

57 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
,

58 
size_t
 
__buæ’
, 
__æags
,

59 
__SOCKADDR_ARG
 
__addr
,

60 
sockËn_t
 *
__»¡riù
 
__addr_Ën
), 
__»cväom_chk
)

61 
__w¬Ç‰r
 ("recvfrom called with bigger†engthhan size of "

64 
__ex‹º_®ways_šlše
 
ssize_t


65 
	$»cväom
 (
__fd
, *
__»¡riù
 
__buf
, 
size_t
 
__n
, 
__æags
,

66 
__SOCKADDR_ARG
 
__addr
, 
sockËn_t
 *
__»¡riù
 
__addr_Ën
)

68 ià(
	`__bos0
 (
__buf
è!ğ(
size_t
) -1)

70 ià(!
	`__butš_cÚ¡ªt_p
 (
__n
))

71  
	`__»cväom_chk
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

72 
__addr
, 
__addr_Ën
);

73 ià(
__n
 > 
	`__bos0
 (
__buf
))

74  
	`__»cväom_chk_w¬n
 (
__fd
, 
__buf
, 
__n
, 
	`__bos0
 (__buf), 
__æags
,

75 
__addr
, 
__addr_Ën
);

77  
	`__»cväom_®Ÿs
 (
__fd
, 
__buf
, 
__n
, 
__æags
, 
__addr
, 
__addr_Ën
);

78 
	}
}

	@/usr/include/bits/types.h

24 #iâdef 
_BITS_TYPES_H


25 
	#_BITS_TYPES_H
 1

	)

27 
	~<ã©u»s.h
>

28 
	~<b™s/wÜdsize.h
>

31 
	t__u_ch¬
;

32 
	t__u_shÜt
;

33 
	t__u_št
;

34 
	t__u_lÚg
;

37 sigÃd 
	t__št8_t
;

38 
	t__ušt8_t
;

39 sigÃd 
	t__št16_t
;

40 
	t__ušt16_t
;

41 sigÃd 
	t__št32_t
;

42 
	t__ušt32_t
;

43 #ià
__WORDSIZE
 == 64

44 sigÃd 
	t__št64_t
;

45 
	t__ušt64_t
;

46 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


47 
__ex‹nsiÚ__
 sigÃd 
	t__št64_t
;

48 
__ex‹nsiÚ__
 
	t__ušt64_t
;

52 #ià
__WORDSIZE
 == 64

53 
	t__quad_t
;

54 
	t__u_quad_t
;

55 #–ià
defšed
 
__GLIBC_HAVE_LONG_LONG


56 
__ex‹nsiÚ__
 
	t__quad_t
;

57 
__ex‹nsiÚ__
 
	t__u_quad_t
;

61 
	m__v®
[2];

62 } 
	t__quad_t
;

65 
__u_lÚg
 
	m__v®
[2];

66 } 
	t__u_quad_t
;

99 
	#__S16_TYPE
 

	)

100 
	#__U16_TYPE
 

	)

101 
	#__S32_TYPE
 

	)

102 
	#__U32_TYPE
 

	)

103 
	#__SLONGWORD_TYPE
 

	)

104 
	#__ULONGWORD_TYPE
 

	)

105 #ià
__WORDSIZE
 == 32

106 
	#__SQUAD_TYPE
 
__quad_t


	)

107 
	#__UQUAD_TYPE
 
__u_quad_t


	)

108 
	#__SWORD_TYPE
 

	)

109 
	#__UWORD_TYPE
 

	)

110 
	#__SLONG32_TYPE
 

	)

111 
	#__ULONG32_TYPE
 

	)

112 
	#__S64_TYPE
 
__quad_t


	)

113 
	#__U64_TYPE
 
__u_quad_t


	)

116 
	#__STD_TYPE
 
__ex‹nsiÚ__
 

	)

117 #–ià
__WORDSIZE
 == 64

118 
	t__SQUAD_TYPE
 

	)

119 
	t__UQUAD_TYPE
 

	)

120 
	t__SWORD_TYPE
 

	)

121 
	t__UWORD_TYPE
 

	)

122 
	t__SLONG32_TYPE
 

	)

123 
	t__ULONG32_TYPE
 

	)

124 
	t__S64_TYPE
 

	)

125 
	t__U64_TYPE
 

	)

127 
	t__STD_TYPE
 

	)

131 
	~<b™s/ty³sizes.h
>

134 
__STD_TYPE
 
	t__DEV_T_TYPE
 
	t__dev_t
;

135 
__STD_TYPE
 
__UID_T_TYPE
 
	g__uid_t
;

136 
__STD_TYPE
 
__GID_T_TYPE
 
	g__gid_t
;

137 
__STD_TYPE
 
__INO_T_TYPE
 
	g__šo_t
;

138 
__STD_TYPE
 
__INO64_T_TYPE
 
	g__šo64_t
;

139 
__STD_TYPE
 
__MODE_T_TYPE
 
	g__mode_t
;

140 
__STD_TYPE
 
__NLINK_T_TYPE
 
	g__Æšk_t
;

141 
__STD_TYPE
 
__OFF_T_TYPE
 
	g__off_t
;

142 
__STD_TYPE
 
__OFF64_T_TYPE
 
	g__off64_t
;

143 
__STD_TYPE
 
__PID_T_TYPE
 
	g__pid_t
;

144 
__STD_TYPE
 
__FSID_T_TYPE
 
	g__fsid_t
;

145 
__STD_TYPE
 
__CLOCK_T_TYPE
 
	g__şock_t
;

146 
__STD_TYPE
 
__RLIM_T_TYPE
 
	g__¾im_t
;

147 
__STD_TYPE
 
__RLIM64_T_TYPE
 
	g__¾im64_t
;

148 
__STD_TYPE
 
__ID_T_TYPE
 
	g__id_t
;

149 
__STD_TYPE
 
__TIME_T_TYPE
 
	g__time_t
;

150 
__STD_TYPE
 
__USECONDS_T_TYPE
 
	g__u£cÚds_t
;

151 
__STD_TYPE
 
__SUSECONDS_T_TYPE
 
	g__su£cÚds_t
;

153 
__STD_TYPE
 
__DADDR_T_TYPE
 
	g__daddr_t
;

154 
__STD_TYPE
 
__SWBLK_T_TYPE
 
	g__swblk_t
;

155 
__STD_TYPE
 
__KEY_T_TYPE
 
	g__key_t
;

158 
__STD_TYPE
 
__CLOCKID_T_TYPE
 
	g__şockid_t
;

161 
__STD_TYPE
 
__TIMER_T_TYPE
 
	g__tim”_t
;

164 
__STD_TYPE
 
__BLKSIZE_T_TYPE
 
	g__blksize_t
;

169 
__STD_TYPE
 
__BLKCNT_T_TYPE
 
	g__blkút_t
;

170 
__STD_TYPE
 
__BLKCNT64_T_TYPE
 
	g__blkút64_t
;

173 
__STD_TYPE
 
__FSBLKCNT_T_TYPE
 
	g__fsblkút_t
;

174 
__STD_TYPE
 
__FSBLKCNT64_T_TYPE
 
	g__fsblkút64_t
;

177 
__STD_TYPE
 
__FSFILCNT_T_TYPE
 
	g__fsfút_t
;

178 
__STD_TYPE
 
__FSFILCNT64_T_TYPE
 
	g__fsfút64_t
;

180 
__STD_TYPE
 
__SSIZE_T_TYPE
 
	g__ssize_t
;

184 
__off64_t
 
	t__loff_t
;

185 
__quad_t
 *
	t__qaddr_t
;

186 *
	t__ÿddr_t
;

189 
__STD_TYPE
 
__SWORD_TYPE
 
	g__šŒ_t
;

192 
__STD_TYPE
 
__U32_TYPE
 
	g__sockËn_t
;

195 #undeà
__STD_TYPE


	@/usr/include/endian.h

19 #iâdef 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<ã©u»s.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<b™s/’dŸn.h
>

41 #iâdeà
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

54 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

59 #ifdeà
__USE_BSD


61 
	~<b™s/by‹sw­.h
>

63 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


64 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

65 
	#htŞe16
(
x
è(x)

	)

66 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

67 
	#Ë16toh
(
x
è(x)

	)

69 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

70 
	#htŞe32
(
x
è(x)

	)

71 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

72 
	#Ë32toh
(
x
è(x)

	)

74 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

75 
	#htŞe64
(
x
è(x)

	)

76 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

77 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/gnu/stubs.h

4 
	~<b™s/wÜdsize.h
>

6 #ià
__WORDSIZE
 == 32

7 
	~<gnu/¡ubs-32.h
>

8 #–ià
__WORDSIZE
 == 64

9 
	~<gnu/¡ubs-64.h
>

	@/usr/include/linux/byteorder/little_endian.h

1 #iâdeà
_LINUX_BYTEORDER_LITTLE_ENDIAN_H


2 
	#_LINUX_BYTEORDER_LITTLE_ENDIAN_H


	)

4 #iâdeà
__LITTLE_ENDIAN


5 
	#__LITTLE_ENDIAN
 1234

	)

7 #iâdeà
__LITTLE_ENDIAN_BITFIELD


8 
	#__LITTLE_ENDIAN_BITFIELD


	)

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/swab.h
>

14 
	#__cÚ¡ªt_htÚl
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

15 
	#__cÚ¡ªt_Áohl
(
x
è
	`___cÚ¡ªt_swab32
((
__be32
)(x))

	)

16 
	#__cÚ¡ªt_htÚs
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

17 
	#__cÚ¡ªt_Áohs
(
x
è
	`___cÚ¡ªt_swab16
((
__be16
)(x))

	)

18 
	#__cÚ¡ªt_ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

19 
	#__cÚ¡ªt_Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

20 
	#__cÚ¡ªt_ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

21 
	#__cÚ¡ªt_Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

22 
	#__cÚ¡ªt_ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

23 
	#__cÚ¡ªt_Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

24 
	#__cÚ¡ªt_ıu_to_be64
(
x
è((
__be64
)
	`___cÚ¡ªt_swab64
((x)))

	)

25 
	#__cÚ¡ªt_be64_to_ıu
(
x
è
	`___cÚ¡ªt_swab64
((
__u64
)(
__be64
)(x))

	)

26 
	#__cÚ¡ªt_ıu_to_be32
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

27 
	#__cÚ¡ªt_be32_to_ıu
(
x
è
	`___cÚ¡ªt_swab32
((
__u32
)(
__be32
)(x))

	)

28 
	#__cÚ¡ªt_ıu_to_be16
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

29 
	#__cÚ¡ªt_be16_to_ıu
(
x
è
	`___cÚ¡ªt_swab16
((
__u16
)(
__be16
)(x))

	)

30 
	#__ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

31 
	#__Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

32 
	#__ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

33 
	#__Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

34 
	#__ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

35 
	#__Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

36 
	#__ıu_to_be64
(
x
è((
__be64
)
	`__swab64
((x)))

	)

37 
	#__be64_to_ıu
(
x
è
	`__swab64
((
__u64
)(
__be64
)(x))

	)

38 
	#__ıu_to_be32
(
x
è((
__be32
)
	`__swab32
((x)))

	)

39 
	#__be32_to_ıu
(
x
è
	`__swab32
((
__u32
)(
__be32
)(x))

	)

40 
	#__ıu_to_be16
(
x
è((
__be16
)
	`__swab16
((x)))

	)

41 
	#__be16_to_ıu
(
x
è
	`__swab16
((
__u16
)(
__be16
)(x))

	)

43 
__šlše__
 
__Ë64
 
	$__ıu_to_Ë64p
(cÚ¡ 
__u64
 *
p
)

45  (
__Ë64
)*
p
;

46 
	}
}

47 
__šlše__
 
__u64
 
	$__Ë64_to_ıup
(cÚ¡ 
__Ë64
 *
p
)

49  (
__u64
)*
p
;

50 
	}
}

51 
__šlše__
 
__Ë32
 
	$__ıu_to_Ë32p
(cÚ¡ 
__u32
 *
p
)

53  (
__Ë32
)*
p
;

54 
	}
}

55 
__šlše__
 
__u32
 
	$__Ë32_to_ıup
(cÚ¡ 
__Ë32
 *
p
)

57  (
__u32
)*
p
;

58 
	}
}

59 
__šlše__
 
__Ë16
 
	$__ıu_to_Ë16p
(cÚ¡ 
__u16
 *
p
)

61  (
__Ë16
)*
p
;

62 
	}
}

63 
__šlše__
 
__u16
 
	$__Ë16_to_ıup
(cÚ¡ 
__Ë16
 *
p
)

65  (
__u16
)*
p
;

66 
	}
}

67 
__šlše__
 
__be64
 
	$__ıu_to_be64p
(cÚ¡ 
__u64
 *
p
)

69  (
__be64
)
	`__swab64p
(
p
);

70 
	}
}

71 
__šlše__
 
__u64
 
	$__be64_to_ıup
(cÚ¡ 
__be64
 *
p
)

73  
	`__swab64p
((
__u64
 *)
p
);

74 
	}
}

75 
__šlše__
 
__be32
 
	$__ıu_to_be32p
(cÚ¡ 
__u32
 *
p
)

77  (
__be32
)
	`__swab32p
(
p
);

78 
	}
}

79 
__šlše__
 
__u32
 
	$__be32_to_ıup
(cÚ¡ 
__be32
 *
p
)

81  
	`__swab32p
((
__u32
 *)
p
);

82 
	}
}

83 
__šlše__
 
__be16
 
	$__ıu_to_be16p
(cÚ¡ 
__u16
 *
p
)

85  (
__be16
)
	`__swab16p
(
p
);

86 
	}
}

87 
__šlše__
 
__u16
 
	$__be16_to_ıup
(cÚ¡ 
__be16
 *
p
)

89  
	`__swab16p
((
__u16
 *)
p
);

90 
	}
}

91 
	#__ıu_to_Ë64s
(
x
èdØ{ ()(x); } 0)

	)

92 
	#__Ë64_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

93 
	#__ıu_to_Ë32s
(
x
èdØ{ ()(x); } 0)

	)

94 
	#__Ë32_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

95 
	#__ıu_to_Ë16s
(
x
èdØ{ ()(x); } 0)

	)

96 
	#__Ë16_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

97 
	#__ıu_to_be64s
(
x
è
	`__swab64s
((x))

	)

98 
	#__be64_to_ıus
(
x
è
	`__swab64s
((x))

	)

99 
	#__ıu_to_be32s
(
x
è
	`__swab32s
((x))

	)

100 
	#__be32_to_ıus
(
x
è
	`__swab32s
((x))

	)

101 
	#__ıu_to_be16s
(
x
è
	`__swab16s
((x))

	)

102 
	#__be16_to_ıus
(
x
è
	`__swab16s
((x))

	)

	@/usr/include/linux/hdlc/ioctl.h

1 #iâdeà
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

38 
	mşock_¿‹
;

39 
	mşock_ty³
;

40 
	mloİback
;

41 } 
	tsync_£rŸl_£‰šgs
;

44 
	mşock_¿‹
;

45 
	mşock_ty³
;

46 
	mloİback
;

47 
	m¦Ù_m­
;

48 } 
	t‹1_£‰šgs
;

51 
	m’codšg
;

52 
	m·r™y
;

53 } 
	t¿w_hdlc_´Ùo
;

56 
	mt391
;

57 
	mt392
;

58 
	mn391
;

59 
	mn392
;

60 
	mn393
;

61 
	mlmi
;

62 
	mdû
;

63 } 
	tä_´Ùo
;

66 
	mdlci
;

67 } 
	tä_´Ùo_pvc
;

70 
	mdlci
;

71 
	mma¡”
[
IFNAMSIZ
];

72 }
	tä_´Ùo_pvc_šfo
;

75 
	mš‹rv®
;

76 
	mtimeout
;

77 } 
	tcisco_´Ùo
;

	@/usr/include/linux/netlink.h

1 #iâdeà
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<lšux/sock‘.h
>

5 
	~<lšux/ty³s.h
>

7 
	#NETLINK_ROUTE
 0

	)

8 
	#NETLINK_UNUSED
 1

	)

9 
	#NETLINK_USERSOCK
 2

	)

10 
	#NETLINK_FIREWALL
 3

	)

11 
	#NETLINK_INET_DIAG
 4

	)

12 
	#NETLINK_NFLOG
 5

	)

13 
	#NETLINK_XFRM
 6

	)

14 
	#NETLINK_SELINUX
 7

	)

15 
	#NETLINK_ISCSI
 8

	)

16 
	#NETLINK_AUDIT
 9

	)

17 
	#NETLINK_FIB_LOOKUP
 10

	)

18 
	#NETLINK_CONNECTOR
 11

	)

19 
	#NETLINK_NETFILTER
 12

	)

20 
	#NETLINK_IP6_FW
 13

	)

21 
	#NETLINK_DNRTMSG
 14

	)

22 
	#NETLINK_KOBJECT_UEVENT
 15

	)

23 
	#NETLINK_GENERIC
 16

	)

25 
	#NETLINK_SCSITRANSPORT
 18

	)

26 
	#NETLINK_ECRYPTFS
 19

	)

27 
	#NETLINK_RDMA
 20

	)

29 
	#MAX_LINKS
 32

	)

31 
	gÃt
;

33 
	ssockaddr_Æ


35 
§_çmy_t
 
	mÆ_çmy
;

36 
	mÆ_·d
;

37 
__u32
 
	mÆ_pid
;

38 
__u32
 
	mÆ_groups
;

41 
	sÆmsghdr


43 
__u32
 
	mÆmsg_Ën
;

44 
__u16
 
	mÆmsg_ty³
;

45 
__u16
 
	mÆmsg_æags
;

46 
__u32
 
	mÆmsg_£q
;

47 
__u32
 
	mÆmsg_pid
;

52 
	#NLM_F_REQUEST
 1

	)

53 
	#NLM_F_MULTI
 2

	)

54 
	#NLM_F_ACK
 4

	)

55 
	#NLM_F_ECHO
 8

	)

56 
	#NLM_F_DUMP_INTR
 16

	)

59 
	#NLM_F_ROOT
 0x100

	)

60 
	#NLM_F_MATCH
 0x200

	)

61 
	#NLM_F_ATOMIC
 0x400

	)

62 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

65 
	#NLM_F_REPLACE
 0x100

	)

66 
	#NLM_F_EXCL
 0x200

	)

67 
	#NLM_F_CREATE
 0x400

	)

68 
	#NLM_F_APPEND
 0x800

	)

79 
	#NLMSG_ALIGNTO
 4

	)

80 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

81 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

82 
	#NLMSG_LENGTH
(
Ën
è(Ö’)+
	`NLMSG_ALIGN
(
NLMSG_HDRLEN
))

	)

83 
	#NLMSG_SPACE
(
Ën
è
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
Ö’))

	)

84 
	#NLMSG_DATA
(
Æh
è((*)(((*êlhè+ 
	`NLMSG_LENGTH
(0)))

	)

85 
	#NLMSG_NEXT
(
Æh
,
Ën
è(Ö’è-ğ
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
), \

86 (
Æmsghdr
*)(((*)(
Æh
)è+ 
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
)))

	)

87 
	#NLMSG_OK
(
Æh
,
Ën
è(Ö’è>ğ()(
Æmsghdr
) && \

88 (
Æh
)->
Æmsg_Ën
 >ğ(
Æmsghdr
) && \

89 (
Æh
)->
Æmsg_Ën
 <ğ(
Ën
))

	)

90 
	#NLMSG_PAYLOAD
(
Æh
,
Ën
è(Òlh)->
Æmsg_Ën
 - 
	`NLMSG_SPACE
(Ö’)))

	)

92 
	#NLMSG_NOOP
 0x1

	)

93 
	#NLMSG_ERROR
 0x2

	)

94 
	#NLMSG_DONE
 0x3

	)

95 
	#NLMSG_OVERRUN
 0x4

	)

97 
	#NLMSG_MIN_TYPE
 0x10

	)

99 
	sÆmsg”r


101 
	m”rÜ
;

102 
Æmsghdr
 
	mmsg
;

105 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

106 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

107 
	#NETLINK_PKTINFO
 3

	)

108 
	#NETLINK_BROADCAST_ERROR
 4

	)

109 
	#NETLINK_NO_ENOBUFS
 5

	)

111 
	sÆ_pktšfo


113 
__u32
 
	mgroup
;

116 
	#NET_MAJOR
 36

	)

119 
	mNETLINK_UNCONNECTED
 = 0,

120 
	mNETLINK_CONNECTED
,

132 
	sÆ©Œ


134 
__u16
 
	mÆa_Ën
;

135 
__u16
 
	mÆa_ty³
;

148 
	#NLA_F_NESTED
 (1 << 15)

	)

149 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

150 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

152 
	#NLA_ALIGNTO
 4

	)

153 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

154 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

	@/usr/include/linux/stddef.h

1 #iâdeà
_LINUX_STDDEF_H


2 
	#_LINUX_STDDEF_H


	)

6 #undeà
NULL


7 #ià
defšed
(
__ılu¥lus
)

8 
	#NULL
 0

	)

10 
	#NULL
 ((*)0)

	)

	@/usr/include/stdint.h

23 #iâdeà
_STDINT_H


24 
	#_STDINT_H
 1

	)

26 
	~<ã©u»s.h
>

27 
	~<b™s/wch¬.h
>

28 
	~<b™s/wÜdsize.h
>

35 #iâdeà
__št8_t_defšed


36 
	#__št8_t_defšed


	)

37 sigÃd 
	tšt8_t
;

38 
	tšt16_t
;

39 
	tšt32_t
;

40 #ià
__WORDSIZE
 == 64

41 
	tšt64_t
;

43 
__ex‹nsiÚ__


44 
	tšt64_t
;

49 
	tušt8_t
;

50 
	tušt16_t
;

51 #iâdeà
__ušt32_t_defšed


52 
	tušt32_t
;

53 
	#__ušt32_t_defšed


	)

55 #ià
__WORDSIZE
 == 64

56 
	tušt64_t
;

58 
__ex‹nsiÚ__


59 
	tušt64_t
;

66 sigÃd 
	tšt_Ëa¡8_t
;

67 
	tšt_Ëa¡16_t
;

68 
	tšt_Ëa¡32_t
;

69 #ià
__WORDSIZE
 == 64

70 
	tšt_Ëa¡64_t
;

72 
__ex‹nsiÚ__


73 
	tšt_Ëa¡64_t
;

77 
	tušt_Ëa¡8_t
;

78 
	tušt_Ëa¡16_t
;

79 
	tušt_Ëa¡32_t
;

80 #ià
__WORDSIZE
 == 64

81 
	tušt_Ëa¡64_t
;

83 
__ex‹nsiÚ__


84 
	tušt_Ëa¡64_t
;

91 sigÃd 
	tšt_ç¡8_t
;

92 #ià
__WORDSIZE
 == 64

93 
	tšt_ç¡16_t
;

94 
	tšt_ç¡32_t
;

95 
	tšt_ç¡64_t
;

97 
	tšt_ç¡16_t
;

98 
	tšt_ç¡32_t
;

99 
__ex‹nsiÚ__


100 
	tšt_ç¡64_t
;

104 
	tušt_ç¡8_t
;

105 #ià
__WORDSIZE
 == 64

106 
	tušt_ç¡16_t
;

107 
	tušt_ç¡32_t
;

108 
	tušt_ç¡64_t
;

110 
	tušt_ç¡16_t
;

111 
	tušt_ç¡32_t
;

112 
__ex‹nsiÚ__


113 
	tušt_ç¡64_t
;

118 #ià
__WORDSIZE
 == 64

119 #iâdeà
__šŒ_t_defšed


120 
	tšŒ_t
;

121 
	#__šŒ_t_defšed


	)

123 
	tušŒ_t
;

125 #iâdeà
__šŒ_t_defšed


126 
	tšŒ_t
;

127 
	#__šŒ_t_defšed


	)

129 
	tušŒ_t
;

134 #ià
__WORDSIZE
 == 64

135 
	tštmax_t
;

136 
	tuštmax_t
;

138 
__ex‹nsiÚ__


139 
	tštmax_t
;

140 
__ex‹nsiÚ__


141 
	tuštmax_t
;

147 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_LIMIT_MACROS


149 #ià
__WORDSIZE
 == 64

150 
	#__INT64_C
(
c
èø## 
L


	)

151 
	#__UINT64_C
(
c
èø## 
UL


	)

153 
	#__INT64_C
(
c
èø## 
LL


	)

154 
	#__UINT64_C
(
c
èø## 
ULL


	)

160 
	#INT8_MIN
 (-128)

	)

161 
	#INT16_MIN
 (-32767-1)

	)

162 
	#INT32_MIN
 (-2147483647-1)

	)

163 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

165 
	#INT8_MAX
 (127)

	)

166 
	#INT16_MAX
 (32767)

	)

167 
	#INT32_MAX
 (2147483647)

	)

168 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

171 
	#UINT8_MAX
 (255)

	)

172 
	#UINT16_MAX
 (65535)

	)

173 
	#UINT32_MAX
 (4294967295U)

	)

174 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

178 
	#INT_LEAST8_MIN
 (-128)

	)

179 
	#INT_LEAST16_MIN
 (-32767-1)

	)

180 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

181 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

183 
	#INT_LEAST8_MAX
 (127)

	)

184 
	#INT_LEAST16_MAX
 (32767)

	)

185 
	#INT_LEAST32_MAX
 (2147483647)

	)

186 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

189 
	#UINT_LEAST8_MAX
 (255)

	)

190 
	#UINT_LEAST16_MAX
 (65535)

	)

191 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

192 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

196 
	#INT_FAST8_MIN
 (-128)

	)

197 #ià
__WORDSIZE
 == 64

198 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

199 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

201 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

202 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

204 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

206 
	#INT_FAST8_MAX
 (127)

	)

207 #ià
__WORDSIZE
 == 64

208 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

209 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

211 
	#INT_FAST16_MAX
 (2147483647)

	)

212 
	#INT_FAST32_MAX
 (2147483647)

	)

214 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

217 
	#UINT_FAST8_MAX
 (255)

	)

218 #ià
__WORDSIZE
 == 64

219 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

220 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

222 
	#UINT_FAST16_MAX
 (4294967295U)

	)

223 
	#UINT_FAST32_MAX
 (4294967295U)

	)

225 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

229 #ià
__WORDSIZE
 == 64

230 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

231 
	#INTPTR_MAX
 (9223372036854775807L)

	)

232 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

234 
	#INTPTR_MIN
 (-2147483647-1)

	)

235 
	#INTPTR_MAX
 (2147483647)

	)

236 
	#UINTPTR_MAX
 (4294967295U)

	)

241 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

243 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

246 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

252 #ià
__WORDSIZE
 == 64

253 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

254 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

256 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

257 
	#PTRDIFF_MAX
 (2147483647)

	)

261 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

262 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

265 #ià
__WORDSIZE
 == 64

266 
	#SIZE_MAX
 (18446744073709551615UL)

	)

268 
	#SIZE_MAX
 (4294967295U)

	)

272 #iâdeà
WCHAR_MIN


274 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

275 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

279 
	#WINT_MIN
 (0u)

	)

280 
	#WINT_MAX
 (4294967295u)

	)

287 #ià!
defšed
 
__ılu¥lus
 || defšed 
__STDC_CONSTANT_MACROS


290 
	#INT8_C
(
c
è
	)
c

291 
	#INT16_C
(
c
è
	)
c

292 
	#INT32_C
(
c
è
	)
c

293 #ià
__WORDSIZE
 == 64

294 
	#INT64_C
(
c
èø## 
L


	)

296 
	#INT64_C
(
c
èø## 
LL


	)

300 
	#UINT8_C
(
c
è
	)
c

301 
	#UINT16_C
(
c
è
	)
c

302 
	#UINT32_C
(
c
èø## 
U


	)

303 #ià
__WORDSIZE
 == 64

304 
	#UINT64_C
(
c
èø## 
UL


	)

306 
	#UINT64_C
(
c
èø## 
ULL


	)

310 #ià
__WORDSIZE
 == 64

311 
	#INTMAX_C
(
c
èø## 
L


	)

312 
	#UINTMAX_C
(
c
èø## 
UL


	)

314 
	#INTMAX_C
(
c
èø## 
LL


	)

315 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/sys/cdefs.h

20 #iâdef 
_SYS_CDEFS_H


21 
	#_SYS_CDEFS_H
 1

	)

24 #iâdeà
_FEATURES_H


25 
	~<ã©u»s.h
>

31 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


36 #undeà
__P


37 #undeà
__PMT


39 #ifdeà
__GNUC__


46 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

47 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

48 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
)è
	)
fct

50 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

51 
	#__THROW
 
	`throw
 ()

	)

52 
	#__NTH
(
fù
èfù 
	`throw
 ()

	)

54 
	#__THROW


	)

55 
	#__NTH
(
fù
è
	)
fct

61 
	#__šlše


	)

63 
	#__THROW


	)

64 
	#__NTH
(
fù
è
	)
fct

66 
	#__cÚ¡
 cÚ¡

	)

67 
	#__sigÃd
 sigÃd

	)

68 
	#__vŞ©e
 vŞ©e

	)

74 
	#__P
(
¬gs
è
	)
args

75 
	#__PMT
(
¬gs
è
	)
args

80 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

81 
	#__STRING
(
x
è#x

	)

84 
	#__±r_t
 *

	)

85 
	#__lÚg_doubË_t
 

	)

89 #ifdef 
__ılu¥lus


90 
	#__BEGIN_DECLS
 "C" {

	)

91 
	#__END_DECLS
 }

	)

93 
	#__BEGIN_DECLS


	)

94 
	#__END_DECLS


	)

103 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


104 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

105 
	#__END_NAMESPACE_STD
 }

	)

106 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

107 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

108 
	#__END_NAMESPACE_C99
 }

	)

109 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

114 
	#__BEGIN_NAMESPACE_STD


	)

115 
	#__END_NAMESPACE_STD


	)

116 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

117 
	#__BEGIN_NAMESPACE_C99


	)

118 
	#__END_NAMESPACE_C99


	)

119 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

124 #iâdeà
__BOUNDED_POINTERS__


125 
	#__bounded


	)

126 
	#__unbounded


	)

127 
	#__±rv®ue


	)

132 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

135 #ià
__GNUC_PREREQ
 (4,3) \

136 || (
defšed
 
	g__GNUC_RH_RELEASE__
 && 
	g__GNUC__
 == 4 \

137 && 
__GNUC_MINOR__
 =ğ1 && 
__GNUC_PATCHLEVEL__
 == 2 \

138 && 
__GNUC_RH_RELEASE__
 >= 31)

139 
	#__w¬ndeş
(
Çme
, 
msg
) \

140 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

141 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

142 
	#__”rÜdeş
(
Çme
, 
msg
) \

143 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

145 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

146 
	#__w¬Ç‰r
(
msg
)

	)

147 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

151 #ià
__GNUC_PREREQ
 (2,97)

153 
	#__æex¬r
 []

	)

155 #ifdeà
__GNUC__


156 
	#__æex¬r
 [0]

	)

158 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

159 
	#__æex¬r
 []

	)

162 
	#__æex¬r
 [1]

	)

178 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

180 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

181 #ifdeà
__ılu¥lus


182 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

183 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

185 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

186 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

188 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

189 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

202 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

203 
	#__©Œibu‹__
(
xyz
è

	)

209 #ià
__GNUC_PREREQ
 (2,96)

210 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

212 
	#__©Œibu‹_m®loc__


	)

218 #ià
__GNUC_PREREQ
 (2,96)

219 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

221 
	#__©Œibu‹_pu»__


	)

227 #ià
__GNUC_PREREQ
 (3,1)

228 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

229 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

231 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

232 
	#__©Œibu‹_nošlše__


	)

236 #ià
__GNUC_PREREQ
 (3,2)

237 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

239 
	#__©Œibu‹_d•»ÿ‹d__


	)

248 #ià
__GNUC_PREREQ
 (2,8)

249 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

251 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

258 #ià
__GNUC_PREREQ
 (2,97)

259 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

260 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

262 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

267 #ià
__GNUC_PREREQ
 (3,3)

268 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

270 
	#__nÚnuÎ
(
·¿ms
)

	)

275 #ià
__GNUC_PREREQ
 (3,4)

276 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

277 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

278 #ià
__USE_FORTIFY_LEVEL
 > 0

279 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

282 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

284 #iâdeà
__wur


285 
	#__wur


	)

289 #ià
__GNUC_PREREQ
 (3,2)

290 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

292 
	#__®ways_šlše
 
__šlše


	)

297 #ià!
defšed
 
__ılu¥lus
 || 
__GNUC_PREREQ
 (4,3) \

298 || (
defšed
 
__GNUC_RH_RELEASE__
 && 
__GNUC__
 == 4 \

299 && 
__GNUC_MINOR__
 =ğ1 && 
__GNUC_PATCHLEVEL__
 == 2 \

300 && 
__GNUC_RH_RELEASE__
 >= 31)

301 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


302 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

303 #ià
__GNUC_PREREQ
 (4,3) \

304 || (
defšed
 
__GNUC_RH_RELEASE__
 && 
__GNUC__
 == 4 \

305 && 
__GNUC_MINOR__
 =ğ1 && 
__GNUC_PATCHLEVEL__
 == 2 \

306 && 
__GNUC_RH_RELEASE__
 >= 31)

307 
	#__ex‹º_®ways_šlše
 \

308 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
, 
__¬tificŸl__
))

	)

310 
	#__ex‹º_®ways_šlše
 \

311 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

314 
	#__ex‹º_šlše
 
__šlše


	)

315 #ià
__GNUC_PREREQ
 (4,3)

316 
	#__ex‹º_®ways_šlše
 \

317 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

319 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

326 #ià
__GNUC_PREREQ
 (4,3) \

327 || (
defšed
 
__GNUC_RH_RELEASE__
 && 
__GNUC__
 == 4 \

328 && 
__GNUC_MINOR__
 =ğ1 && 
__GNUC_PATCHLEVEL__
 == 2 \

329 && 
__GNUC_RH_RELEASE__
 >= 31)

330 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

331 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

338 #ià!
__GNUC_PREREQ
 (2,8)

339 
	#__ex‹nsiÚ__


	)

343 #ià!
__GNUC_PREREQ
 (2,92)

344 
	#__»¡riù


	)

350 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


351 
	#__»¡riù_¬r
 
__»¡riù


	)

353 #ifdeà
__GNUC__


354 
	#__»¡riù_¬r


	)

356 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

357 
	#__»¡riù_¬r
 
»¡riù


	)

360 
	#__»¡riù_¬r


	)

365 #ià
__GNUC__
 >= 3

366 
	#__glibc_uÆik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 0)

	)

367 
	#__glibc_lik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 1)

	)

369 
	#__glibc_uÆik–y
(
cÚd
è(cÚd)

	)

370 
	#__glibc_lik–y
(
cÚd
è(cÚd)

	)

373 
	~<b™s/wÜdsize.h
>

375 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


376 
	#__LDBL_COMPAT
 1

	)

377 #ifdeà
__REDIRECT


378 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

379 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

380 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

381 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

382 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

383 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

384 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

385 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

386 
	#__LDBL_REDIR_DECL
(
Çme
) \

387 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

388 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

389 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

390 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

391 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

394 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


395 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

396 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

397 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

398 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

399 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

400 #ifdeà
__REDIRECT


401 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

402 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

403 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

	@/usr/include/sys/select.h

22 #iâdeà
_SYS_SELECT_H


23 
	#_SYS_SELECT_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	~<b™s/ty³s.h
>

31 
	~<b™s/£Ëù.h
>

34 
	~<b™s/sig£t.h
>

36 #iâdeà
__sig£t_t_defšed


37 
	#__sig£t_t_defšed


	)

38 
__sig£t_t
 
	tsig£t_t
;

42 
	#__Ãed_time_t


	)

43 
	#__Ãed_time¥ec


	)

44 
	~<time.h
>

45 
	#__Ãed_timev®


	)

46 
	~<b™s/time.h
>

48 #iâdeà
__su£cÚds_t_defšed


49 
__su£cÚds_t
 
	tsu£cÚds_t
;

50 
	#__su£cÚds_t_defšed


	)

55 
	t__fd_mask
;

58 #undeà
__NFDBITS


59 #undeà
__FDELT


60 #undeà
__FDMASK


62 
	#__NFDBITS
 (8 * (è (
__fd_mask
))

	)

63 
	#__FDELT
(
d
è((dè/ 
__NFDBITS
)

	)

64 
	#__FDMASK
(
d
è((
__fd_mask
è1 << ((dè% 
__NFDBITS
))

	)

71 #ifdeà
__USE_XOPEN


72 
__fd_mask
 
	mfds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

73 
	#__FDS_BITS
(
£t
è((£t)->
fds_b™s
)

	)

75 
__fd_mask
 
	m__fds_b™s
[
__FD_SETSIZE
 / 
__NFDBITS
];

76 
	#__FDS_BITS
(
£t
è((£t)->
__fds_b™s
)

	)

78 } 
	tfd_£t
;

81 
	#FD_SETSIZE
 
__FD_SETSIZE


	)

83 #ifdeà
__USE_MISC


85 
__fd_mask
 
	tfd_mask
;

88 
	#NFDBITS
 
__NFDBITS


	)

93 
	#FD_SET
(
fd
, 
fd£
è
	`__FD_SET
 (fd, fd£)

	)

94 
	#FD_CLR
(
fd
, 
fd£
è
	`__FD_CLR
 (fd, fd£)

	)

95 
	#FD_ISSET
(
fd
, 
fd£
è
	`__FD_ISSET
 (fd, fd£)

	)

96 
	#FD_ZERO
(
fd£
è
	`__FD_ZERO
 (fd£)

	)

99 
__BEGIN_DECLS


109 
£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

110 
fd_£t
 *
__»¡riù
 
__wr™efds
,

111 
fd_£t
 *
__»¡riù
 
__exû±fds
,

112 
timev®
 *
__»¡riù
 
__timeout
);

114 #ifdeà
__USE_XOPEN2K


121 
p£Ëù
 (
__nfds
, 
fd_£t
 *
__»¡riù
 
__»adfds
,

122 
fd_£t
 *
__»¡riù
 
__wr™efds
,

123 
fd_£t
 *
__»¡riù
 
__exû±fds
,

124 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
,

125 cÚ¡ 
__sig£t_t
 *
__»¡riù
 
__sigmask
);

128 
	g__END_DECLS


	@/usr/include/sys/sysmacros.h

21 #iâdeà
_SYS_SYSMACROS_H


22 
	#_SYS_SYSMACROS_H
 1

	)

24 
	~<ã©u»s.h
>

29 #ifdeà
__GLIBC_HAVE_LONG_LONG


30 
__ex‹nsiÚ__


31 
	$gnu_dev_majÜ
 (
__dev
)

32 
__THROW
;

33 
__ex‹nsiÚ__


34 
	$gnu_dev_mšÜ
 (
__dev
)

35 
__THROW
;

36 
__ex‹nsiÚ__


37 
	$gnu_dev_makedev
 (
__majÜ
,

38 
__mšÜ
)

39 
__THROW
;

41 #ià
defšed
 
__GNUC__
 && __GNUC__ >ğ2 && defšed 
__USE_EXTERN_INLINES


42 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

43 
	`__NTH
 (
	$gnu_dev_majÜ
 (
__dev
))

45  ((
__dev
 >> 8) & 0xfff) | (() (__dev >> 32) & ~0xfff);

46 
	}
}

48 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

49 
__NTH
 (
	$gnu_dev_mšÜ
 (
__dev
))

51  (
__dev
 & 0xff) | (() (__dev >> 12) & ~0xff);

52 
	}
}

54 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

55 
__NTH
 (
	$gnu_dev_makedev
 (
__majÜ
, 
__mšÜ
))

57  ((
__mšÜ
 & 0xffè| ((
__majÜ
 & 0xfff) << 8)

58 | (((è(
__mšÜ
 & ~0xff)) << 12)

59 | (((è(
__majÜ
 & ~0xfff)) << 32));

60 
	}
}

65 
	#majÜ
(
dev
è
	`gnu_dev_majÜ
 (dev)

	)

66 
	#mšÜ
(
dev
è
	`gnu_dev_mšÜ
 (dev)

	)

67 
	#makedev
(
maj
, 
mš
è
	`gnu_dev_makedev
 (maj, mš)

	)

	@/usr/include/sys/uio.h

19 #iâdeà
_SYS_UIO_H


20 
	#_SYS_UIO_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	~<sys/ty³s.h
>

26 
	g__BEGIN_DECLS


29 
	~<b™s/uio.h
>

40 
ssize_t
 
	$»adv
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
)

41 
__wur
;

51 
ssize_t
 
	$wr™ev
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
)

52 
__wur
;

55 #ifdeà
__USE_BSD


56 #iâdeà
__USE_FILE_OFFSET64


66 
ssize_t
 
	$´—dv
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
,

67 
__off_t
 
__off£t
è
__wur
;

78 
ssize_t
 
	$pwr™ev
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
,

79 
__off_t
 
__off£t
è
__wur
;

81 #ifdeà
__REDIRECT


82 
ssize_t
 
	`__REDIRECT
 (
´—dv
, (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
,

83 
__couÁ
, 
__off64_t
 
__off£t
),

84 
´—dv64
è
__wur
;

85 
ssize_t
 
	`__REDIRECT
 (
pwr™ev
, (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
,

86 
__couÁ
, 
__off64_t
 
__off£t
),

87 
pwr™ev64
è
__wur
;

89 
	#´—dv
 
´—dv64


	)

90 
	#pwr™ev
 
pwr™ev64


	)

94 #ifdeà
__USE_LARGEFILE64


104 
ssize_t
 
	$´—dv64
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
,

105 
__off64_t
 
__off£t
è
__wur
;

116 
ssize_t
 
	$pwr™ev64
 (
__fd
, 
__cÚ¡
 
iovec
 *
__iovec
, 
__couÁ
,

117 
__off64_t
 
__off£t
è
__wur
;

121 
__END_DECLS


	@/usr/include/time.h

23 #iâdef 
_TIME_H


25 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

26 ! 
defšed
 
	g__Ãed_time¥ec
)

27 
	#_TIME_H
 1

	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


34 #ifdef 
_TIME_H


36 
	#__Ãed_size_t


	)

37 
	#__Ãed_NULL


	)

38 
	~<¡ddef.h
>

42 
	~<b™s/time.h
>

45 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


46 #iâdeà
CLK_TCK


47 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

53 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

54 
	#__şock_t_defšed
 1

	)

56 
	~<b™s/ty³s.h
>

58 
__BEGIN_NAMESPACE_STD


60 
__şock_t
 
	tşock_t
;

61 
	g__END_NAMESPACE_STD


62 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


63 
	$__USING_NAMESPACE_STD
(
şock_t
)

67 #undeà
__Ãed_şock_t


69 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

70 
	#__time_t_defšed
 1

	)

72 
	~<b™s/ty³s.h
>

74 
__BEGIN_NAMESPACE_STD


76 
__time_t
 
	ttime_t
;

77 
__END_NAMESPACE_STD


78 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


79 
	$__USING_NAMESPACE_STD
(
time_t
)

83 #undeà
__Ãed_time_t


85 #ià!
defšed
 
__şockid_t_defšed
 && \

86 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

87 
	#__şockid_t_defšed
 1

	)

89 
	~<b™s/ty³s.h
>

92 
__şockid_t
 
	tşockid_t
;

95 #undeà
__şockid_time_t


97 #ià!
defšed
 
__tim”_t_defšed
 && \

98 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

99 
	#__tim”_t_defšed
 1

	)

101 
	~<b™s/ty³s.h
>

104 
__tim”_t
 
	ttim”_t
;

107 #undeà
__Ãed_tim”_t


110 #ià!
defšed
 
__time¥ec_defšed
 && \

111 ((
defšed
 
_TIME_H
 && \

112 (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
)) || \

113 
defšed
 
__Ãed_time¥ec
)

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 
__cÚ¡
 *
tm_zÚe
;

149 
__tm_gmtoff
;

150 
__cÚ¡
 *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 
__BEGIN_NAMESPACE_STD


183 
şock_t
 
	$şock
 (è
__THROW
;

186 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

189 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

190 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

193 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

199 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

200 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

201 
__cÚ¡
 
tm
 *
__»¡riù
 
__
è
__THROW
;

202 
__END_NAMESPACE_STD


204 #ifdeà
__USE_XOPEN


207 *
	$¡½time
 (
__cÚ¡
 *
__»¡riù
 
__s
,

208 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
)

209 
__THROW
;

212 #ifdeà
__USE_XOPEN2K8


215 
	~<xloÿË.h
>

217 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

218 
__cÚ¡
 *
__»¡riù
 
__fÜm©
,

219 
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

220 
__loÿË_t
 
__loc
è
__THROW
;

223 #ifdeà
__USE_GNU


224 *
	$¡½time_l
 (
__cÚ¡
 *
__»¡riù
 
__s
,

225 
__cÚ¡
 *
__»¡riù
 
__fmt
, 
tm
 *
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

230 
__BEGIN_NAMESPACE_STD


233 
tm
 *
	$gmtime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

237 
tm
 *
	$loÿÉime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

238 
__END_NAMESPACE_STD


240 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


243 
tm
 *
	$gmtime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

244 
tm
 *
__»¡riù
 
__
è
__THROW
;

248 
tm
 *
	$loÿÉime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

249 
tm
 *
__»¡riù
 
__
è
__THROW
;

252 
__BEGIN_NAMESPACE_STD


255 *
	$asùime
 (
__cÚ¡
 
tm
 *
__
è
__THROW
;

258 *
	$ùime
 (
__cÚ¡
 
time_t
 *
__tim”
è
__THROW
;

259 
__END_NAMESPACE_STD


261 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


266 *
	$asùime_r
 (
__cÚ¡
 
tm
 *
__»¡riù
 
__
,

267 *
__»¡riù
 
__buf
è
__THROW
;

270 *
	$ùime_r
 (
__cÚ¡
 
time_t
 *
__»¡riù
 
__tim”
,

271 *
__»¡riù
 
__buf
è
__THROW
;

276 *
__tzÇme
[2];

277 
__daylight
;

278 
__timezÚe
;

281 #ifdef 
__USE_POSIX


283 *
tzÇme
[2];

287 
	$tz£t
 (è
__THROW
;

290 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


291 
daylight
;

292 
timezÚe
;

295 #ifdeà
__USE_SVID


298 
	$¡ime
 (
__cÚ¡
 
time_t
 *
__wh’
è
__THROW
;

304 
	#__i¦—p
(
y—r
) \

305 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

308 #ifdeà
__USE_MISC


313 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

316 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

319 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

323 #ifdeà
__USE_POSIX199309


328 
	`Çno¦“p
 (
__cÚ¡
 
time¥ec
 *
__»que¡ed_time
,

329 
time¥ec
 *
__»maššg
);

333 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

336 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

339 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, 
__cÚ¡
 
time¥ec
 *
__
)

340 
__THROW
;

342 #ifdeà
__USE_XOPEN2K


347 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

348 
__cÚ¡
 
time¥ec
 *
__»q
,

349 
time¥ec
 *
__»m
);

352 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

357 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

358 
sigev’t
 *
__»¡riù
 
__evp
,

359 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

362 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

365 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

366 
__cÚ¡
 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

367 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

370 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

371 
__THROW
;

374 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

378 #ifdeà
__USE_XOPEN_EXTENDED


390 
g‘d©e_”r
;

399 
tm
 *
	`g‘d©e
 (
__cÚ¡
 *
__¡ršg
);

402 #ifdeà
__USE_GNU


413 
	`g‘d©e_r
 (
__cÚ¡
 *
__»¡riù
 
__¡ršg
,

414 
tm
 *
__»¡riù
 
__»sbuå
);

417 
__END_DECLS


	@/usr/include/asm-generic/errno-base.h

1 #iâdeà
_ASM_GENERIC_ERRNO_BASE_H


2 
	#_ASM_GENERIC_ERRNO_BASE_H


	)

4 
	#EPERM
 1

	)

5 
	#ENOENT
 2

	)

6 
	#ESRCH
 3

	)

7 
	#EINTR
 4

	)

8 
	#EIO
 5

	)

9 
	#ENXIO
 6

	)

10 
	#E2BIG
 7

	)

11 
	#ENOEXEC
 8

	)

12 
	#EBADF
 9

	)

13 
	#ECHILD
 10

	)

14 
	#EAGAIN
 11

	)

15 
	#ENOMEM
 12

	)

16 
	#EACCES
 13

	)

17 
	#EFAULT
 14

	)

18 
	#ENOTBLK
 15

	)

19 
	#EBUSY
 16

	)

20 
	#EEXIST
 17

	)

21 
	#EXDEV
 18

	)

22 
	#ENODEV
 19

	)

23 
	#ENOTDIR
 20

	)

24 
	#EISDIR
 21

	)

25 
	#EINVAL
 22

	)

26 
	#ENFILE
 23

	)

27 
	#EMFILE
 24

	)

28 
	#ENOTTY
 25

	)

29 
	#ETXTBSY
 26

	)

30 
	#EFBIG
 27

	)

31 
	#ENOSPC
 28

	)

32 
	#ESPIPE
 29

	)

33 
	#EROFS
 30

	)

34 
	#EMLINK
 31

	)

35 
	#EPIPE
 32

	)

36 
	#EDOM
 33

	)

37 
	#ERANGE
 34

	)

	@/usr/include/asm-generic/int-ll64.h

8 #iâdeà
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/b™¥”lÚg.h
>

13 #iâdeà
__ASSEMBLY__


19 
__sigÃd__
 
	t__s8
;

20 
	t__u8
;

22 
__sigÃd__
 
	t__s16
;

23 
	t__u16
;

25 
__sigÃd__
 
	t__s32
;

26 
	t__u32
;

28 #ifdeà
__GNUC__


29 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

30 
__ex‹nsiÚ__
 
	t__u64
;

32 
__sigÃd__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm-generic/ioctl.h

1 #iâdeà
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #iâdeà
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #iâdeà
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

53 #iâdeà
_IOC_NONE


54 
	#_IOC_NONE
 0U

	)

57 #iâdeà
_IOC_WRITE


58 
	#_IOC_WRITE
 1U

	)

61 #iâdeà
_IOC_READ


62 
	#_IOC_READ
 2U

	)

65 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

66 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

67 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

68 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

69 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

71 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

74 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

75 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

76 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

77 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

78 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

79 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

80 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

83 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

84 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

85 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

86 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

90 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

91 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

92 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

93 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

94 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/bits/endian.h

3 #iâdeà
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@/usr/include/bits/select.h

19 #iâdeà
_SYS_SELECT_H


23 
	~<b™s/wÜdsize.h
>

26 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

28 #ià
__WORDSIZE
 == 64

29 
	#__FD_ZERO_STOS
 "¡osq"

	)

31 
	#__FD_ZERO_STOS
 "¡o¦"

	)

34 
	#__FD_ZERO
(
fd¥
) \

36 
__d0
, 
__d1
; \

37 
__asm__
 
	`__vŞ©e__
 ("şd;„•; " 
__FD_ZERO_STOS
 \

38 : "=c" (
__d0
), "=D" (
__d1
) \

39 : "a" (0), "0" ( (
fd_£t
) \

40 /  (
__fd_mask
)), \

41 "1" (&
	`__FDS_BITS
 (
fd¥
)[0]) \

43 } 0)

	)

49 
	#__FD_ZERO
(
£t
) \

51 
__i
; \

52 
fd_£t
 *
__¬r
 = (
£t
); \

53 
__i
 = 0; __˜<  (
fd_£t
è/  (
__fd_mask
); ++__i) \

54 
	`__FDS_BITS
 (
__¬r
)[
__i
] = 0; \

55 } 0)

	)

59 
	#__FD_SET
(
d
, 
£t
è(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] |ğ
	`__FDMASK
 (d))

	)

60 
	#__FD_CLR
(
d
, 
£t
è(
	`__FDS_BITS
 (£t)[
	`__FDELT
 (d)] &ğ~
	`__FDMASK
 (d))

	)

61 
	#__FD_ISSET
(
d
, 
£t
) \

62 ((
	`__FDS_BITS
 (
£t
)[
	`__FDELT
 (
d
)] & 
	`__FDMASK
 (d)è!ğ0)

	)

	@/usr/include/bits/sockaddr.h

24 #iâdeà
_BITS_SOCKADDR_H


25 
	#_BITS_SOCKADDR_H
 1

	)

29 
	t§_çmy_t
;

35 
	#__SOCKADDR_COMMON
(
§_´efix
) \

36 
§_çmy_t
 
§_´efix
##
çmy


	)

38 
	#__SOCKADDR_COMMON_SIZE
 ( ())

	)

	@/usr/include/bits/time.h

24 #iâdeà
__Ãed_timev®


25 #iâdeà
_BITS_TIME_H


26 
	#_BITS_TIME_H
 1

	)

34 
	#CLOCKS_PER_SEC
 1000000l

	)

36 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


39 
	~<b™s/ty³s.h
>

40 
__syscÚf
 ();

41 
	#CLK_TCK
 ((
__şock_t
è
	`__syscÚf
 (2)è

	)

44 #ifdeà
__USE_POSIX199309


46 
	#CLOCK_REALTIME
 0

	)

48 
	#CLOCK_MONOTONIC
 1

	)

50 
	#CLOCK_PROCESS_CPUTIME_ID
 2

	)

52 
	#CLOCK_THREAD_CPUTIME_ID
 3

	)

54 
	#CLOCK_MONOTONIC_RAW
 4

	)

56 
	#CLOCK_REALTIME_COARSE
 5

	)

58 
	#CLOCK_MONOTONIC_COARSE
 6

	)

61 
	#TIMER_ABSTIME
 1

	)

67 #ifdeà
__Ãed_timev®


68 #undeà
__Ãed_timev®


69 #iâdeà
_STRUCT_TIMEVAL


70 
	#_STRUCT_TIMEVAL
 1

	)

71 
	~<b™s/ty³s.h
>

75 
	stimev®


77 
__time_t
 
	mtv_£c
;

78 
__su£cÚds_t
 
	mtv_u£c
;

	@/usr/include/bits/typesizes.h

20 #iâdeà
_BITS_TYPES_H


24 #iâdef 
_BITS_TYPESIZES_H


25 
	#_BITS_TYPESIZES_H
 1

	)

30 
	#__DEV_T_TYPE
 
__UQUAD_TYPE


	)

31 
	#__UID_T_TYPE
 
__U32_TYPE


	)

32 
	#__GID_T_TYPE
 
__U32_TYPE


	)

33 
	#__INO_T_TYPE
 
__ULONGWORD_TYPE


	)

34 
	#__INO64_T_TYPE
 
__UQUAD_TYPE


	)

35 
	#__MODE_T_TYPE
 
__U32_TYPE


	)

36 
	#__NLINK_T_TYPE
 
__UWORD_TYPE


	)

37 
	#__OFF_T_TYPE
 
__SLONGWORD_TYPE


	)

38 
	#__OFF64_T_TYPE
 
__SQUAD_TYPE


	)

39 
	#__PID_T_TYPE
 
__S32_TYPE


	)

40 
	#__RLIM_T_TYPE
 
__ULONGWORD_TYPE


	)

41 
	#__RLIM64_T_TYPE
 
__UQUAD_TYPE


	)

42 
	#__BLKCNT_T_TYPE
 
__SLONGWORD_TYPE


	)

43 
	#__BLKCNT64_T_TYPE
 
__SQUAD_TYPE


	)

44 
	#__FSBLKCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

45 
	#__FSBLKCNT64_T_TYPE
 
__UQUAD_TYPE


	)

46 
	#__FSFILCNT_T_TYPE
 
__ULONGWORD_TYPE


	)

47 
	#__FSFILCNT64_T_TYPE
 
__UQUAD_TYPE


	)

48 
	#__ID_T_TYPE
 
__U32_TYPE


	)

49 
	#__CLOCK_T_TYPE
 
__SLONGWORD_TYPE


	)

50 
	#__TIME_T_TYPE
 
__SLONGWORD_TYPE


	)

51 
	#__USECONDS_T_TYPE
 
__U32_TYPE


	)

52 
	#__SUSECONDS_T_TYPE
 
__SLONGWORD_TYPE


	)

53 
	#__DADDR_T_TYPE
 
__S32_TYPE


	)

54 
	#__SWBLK_T_TYPE
 
__SLONGWORD_TYPE


	)

55 
	#__KEY_T_TYPE
 
__S32_TYPE


	)

56 
	#__CLOCKID_T_TYPE
 
__S32_TYPE


	)

57 
	#__TIMER_T_TYPE
 *

	)

58 
	#__BLKSIZE_T_TYPE
 
__SLONGWORD_TYPE


	)

59 
	#__FSID_T_TYPE
 sŒuù { 
__v®
[2]; }

	)

60 
	#__SSIZE_T_TYPE
 
__SWORD_TYPE


	)

63 
	#__FD_SETSIZE
 1024

	)

	@/usr/include/bits/uio.h

19 #ià!
defšed
 
_SYS_UIO_H
 && !defšed 
_FCNTL_H


23 #iâdeà
_BITS_UIO_H


24 
	#_BITS_UIO_H
 1

	)

26 
	~<sys/ty³s.h
>

40 
	#UIO_MAXIOV
 1024

	)

44 
	siovec


46 *
	miov_ba£
;

47 
size_t
 
	miov_Ën
;

	@/usr/include/bits/wchar.h

20 #iâdeà
_BITS_WCHAR_H


21 
	#_BITS_WCHAR_H
 1

	)

23 
	#__WCHAR_MIN
 (-2147483647 - 1)

	)

24 
	#__WCHAR_MAX
 (2147483647)

	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ç‰ach


	)

13 
	#__¡ub_fchæags


	)

14 
	#__¡ub_fd‘ach


	)

15 
	#__¡ub_g‘msg


	)

16 
	#__¡ub_g‰y


	)

17 
	#__¡ub_lchmod


	)

18 
	#__¡ub_putmsg


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/linux/swab.h

1 #iâdeà
_LINUX_SWAB_H


2 
	#_LINUX_SWAB_H


	)

4 
	~<lšux/ty³s.h
>

6 
	~<asm/swab.h
>

12 
	#___cÚ¡ªt_swab16
(
x
è((
__u16
)( \

13 (((
__u16
)(
x
) & (__u16)0x00ffU) << 8) | \

14 (((
__u16
)(
x
è& (__u16)0xff00Uè>> 8)))

	)

16 
	#___cÚ¡ªt_swab32
(
x
è((
__u32
)( \

17 (((
__u32
)(
x
) & (__u32)0x000000ffUL) << 24) | \

18 (((
__u32
)(
x
) & (__u32)0x0000ff00UL) << 8) | \

19 (((
__u32
)(
x
) & (__u32)0x00ff0000UL) >> 8) | \

20 (((
__u32
)(
x
è& (__u32)0xff000000ULè>> 24)))

	)

22 
	#___cÚ¡ªt_swab64
(
x
è((
__u64
)( \

23 (((
__u64
)(
x
) & (__u64)0x00000000000000ffULL) << 56) | \

24 (((
__u64
)(
x
) & (__u64)0x000000000000ff00ULL) << 40) | \

25 (((
__u64
)(
x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

26 (((
__u64
)(
x
) & (__u64)0x00000000ff000000ULL) << 8) | \

27 (((
__u64
)(
x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

28 (((
__u64
)(
x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

29 (((
__u64
)(
x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

30 (((
__u64
)(
x
è& (__u64)0xff00000000000000ULLè>> 56)))

	)

32 
	#___cÚ¡ªt_swahw32
(
x
è((
__u32
)( \

33 (((
__u32
)(
x
) & (__u32)0x0000ffffUL) << 16) | \

34 (((
__u32
)(
x
è& (__u32)0xffff0000ULè>> 16)))

	)

36 
	#___cÚ¡ªt_swahb32
(
x
è((
__u32
)( \

37 (((
__u32
)(
x
) & (__u32)0x00ff00ffUL) << 8) | \

38 (((
__u32
)(
x
è& (__u32)0xff00ff00ULè>> 8)))

	)

46 
__šlše__
 
__u16
 
	$__fswab16
(
__u16
 
v®
)

48 #ifdeà
__¬ch_swab16


49  
	`__¬ch_swab16
(
v®
);

51  
	`___cÚ¡ªt_swab16
(
v®
);

53 
	}
}

55 
__šlše__
 
__u32
 
	$__fswab32
(
__u32
 
v®
)

57 #ifdeà
__¬ch_swab32


58  
	`__¬ch_swab32
(
v®
);

60  
	`___cÚ¡ªt_swab32
(
v®
);

62 
	}
}

64 
__šlše__
 
__u64
 
	$__fswab64
(
__u64
 
v®
)

66 #ifdeà
__¬ch_swab64


67  
	`__¬ch_swab64
(
v®
);

68 #–ià
	`defšed
(
__SWAB_64_THRU_32__
)

69 
__u32
 
h
 = 
v®
 >> 32;

70 
__u32
 
l
 = 
v®
 & ((1ULL << 32) - 1);

71  (((
__u64
)
	`__fswab32
(
l
)è<< 32è| ((__u64)(__fswab32(
h
)));

73  
	`___cÚ¡ªt_swab64
(
v®
);

75 
	}
}

77 
__šlše__
 
__u32
 
	$__fswahw32
(
__u32
 
v®
)

79 #ifdeà
__¬ch_swahw32


80  
	`__¬ch_swahw32
(
v®
);

82  
	`___cÚ¡ªt_swahw32
(
v®
);

84 
	}
}

86 
__šlše__
 
__u32
 
	$__fswahb32
(
__u32
 
v®
)

88 #ifdeà
__¬ch_swahb32


89  
	`__¬ch_swahb32
(
v®
);

91  
	`___cÚ¡ªt_swahb32
(
v®
);

93 
	}
}

99 
	#__swab16
(
x
) \

100 (
	`__butš_cÚ¡ªt_p
((
__u16
)(
x
)) ? \

101 
	`___cÚ¡ªt_swab16
(
x
) : \

102 
	`__fswab16
(
x
))

	)

108 
	#__swab32
(
x
) \

109 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

110 
	`___cÚ¡ªt_swab32
(
x
) : \

111 
	`__fswab32
(
x
))

	)

117 
	#__swab64
(
x
) \

118 (
	`__butš_cÚ¡ªt_p
((
__u64
)(
x
)) ? \

119 
	`___cÚ¡ªt_swab64
(
x
) : \

120 
	`__fswab64
(
x
))

	)

128 
	#__swahw32
(
x
) \

129 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

130 
	`___cÚ¡ªt_swahw32
(
x
) : \

131 
	`__fswahw32
(
x
))

	)

139 
	#__swahb32
(
x
) \

140 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

141 
	`___cÚ¡ªt_swahb32
(
x
) : \

142 
	`__fswahb32
(
x
))

	)

148 
__šlše__
 
__u16
 
	$__swab16p
(cÚ¡ 
__u16
 *
p
)

150 #ifdeà
__¬ch_swab16p


151  
	`__¬ch_swab16p
(
p
);

153  
	`__swab16
(*
p
);

155 
	}
}

161 
__šlše__
 
__u32
 
	$__swab32p
(cÚ¡ 
__u32
 *
p
)

163 #ifdeà
__¬ch_swab32p


164  
	`__¬ch_swab32p
(
p
);

166  
	`__swab32
(*
p
);

168 
	}
}

174 
__šlše__
 
__u64
 
	$__swab64p
(cÚ¡ 
__u64
 *
p
)

176 #ifdeà
__¬ch_swab64p


177  
	`__¬ch_swab64p
(
p
);

179  
	`__swab64
(*
p
);

181 
	}
}

189 
__šlše__
 
__u32
 
	$__swahw32p
(cÚ¡ 
__u32
 *
p
)

191 #ifdeà
__¬ch_swahw32p


192  
	`__¬ch_swahw32p
(
p
);

194  
	`__swahw32
(*
p
);

196 
	}
}

204 
__šlše__
 
__u32
 
	$__swahb32p
(cÚ¡ 
__u32
 *
p
)

206 #ifdeà
__¬ch_swahb32p


207  
	`__¬ch_swahb32p
(
p
);

209  
	`__swahb32
(*
p
);

211 
	}
}

217 
__šlše__
 
	$__swab16s
(
__u16
 *
p
)

219 #ifdeà
__¬ch_swab16s


220 
	`__¬ch_swab16s
(
p
);

222 *
p
 = 
	`__swab16p
(p);

224 
	}
}

229 
__šlše__
 
	$__swab32s
(
__u32
 *
p
)

231 #ifdeà
__¬ch_swab32s


232 
	`__¬ch_swab32s
(
p
);

234 *
p
 = 
	`__swab32p
(p);

236 
	}
}

242 
__šlše__
 
	$__swab64s
(
__u64
 *
p
)

244 #ifdeà
__¬ch_swab64s


245 
	`__¬ch_swab64s
(
p
);

247 *
p
 = 
	`__swab64p
(p);

249 
	}
}

257 
__šlše__
 
	$__swahw32s
(
__u32
 *
p
)

259 #ifdeà
__¬ch_swahw32s


260 
	`__¬ch_swahw32s
(
p
);

262 *
p
 = 
	`__swahw32p
(p);

264 
	}
}

272 
__šlše__
 
	$__swahb32s
(
__u32
 *
p
)

274 #ifdeà
__¬ch_swahb32s


275 
	`__¬ch_swahb32s
(
p
);

277 *
p
 = 
	`__swahb32p
(p);

279 
	}
}

	@/usr/include/xlocale.h

21 #iâdeà
_XLOCALE_H


22 
	#_XLOCALE_H
 1

	)

28 
	s__loÿË_¡ruù


31 
__loÿË_d©a
 *
	m__loÿËs
[13];

34 cÚ¡ *
	m__ùy³_b
;

35 cÚ¡ *
	m__ùy³_tŞow”
;

36 cÚ¡ *
	m__ùy³_touµ”
;

39 cÚ¡ *
	m__Çmes
[13];

40 } *
	t__loÿË_t
;

43 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/asm/bitsperlong.h

1 #iâdeà
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ifdeà
__x86_64__


5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-g’”ic/b™¥”lÚg.h
>

	@/usr/include/asm/swab.h

1 #iâdeà
_ASM_X86_SWAB_H


2 
	#_ASM_X86_SWAB_H


	)

4 
	~<lšux/ty³s.h
>

7 
__šlše__
 
__u32
 
	$__¬ch_swab32
(
__u32
 
v®
)

9 #ifdeà
__i386__


10 #ifdeà
CONFIG_X86_BSWAP


11 
	`__asm__
("bsw­ %0" : "ô" (
v®
) : "0" (val));

13 
	`__asm__
("xchgb %b0,%h0\n\t"

16 : "=q" (
v®
)

17 : "0" (
v®
));

21 
	`__asm__
("bswapl %0"

22 : "ô" (
v®
)

23 : "0" (
v®
));

25  
v®
;

26 
	}
}

27 
	#__¬ch_swab32
 
__¬ch_swab32


	)

29 
__šlše__
 
__u64
 
	$__¬ch_swab64
(
__u64
 
v®
)

31 #ifdeà
__i386__


34 
__u32
 
a
;

35 
__u32
 
b
;

36 } 
s
;

37 
__u64
 
u
;

38 } 
v
;

39 
v
.
u
 = 
v®
;

40 #ifdeà
CONFIG_X86_BSWAP


41 
	`__asm__
("bswapl %0 ; bswapl %1 ; xchgl %0,%1"

42 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

43 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

45 
v
.
s
.
a
 = 
	`__¬ch_swab32
(v.s.a);

46 
v
.
s
.
b
 = 
	`__¬ch_swab32
(v.s.b);

47 
	`__asm__
("xchgl %0,%1"

48 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

49 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

51  
v
.
u
;

53 
	`__asm__
("bswapq %0"

54 : "ô" (
v®
)

55 : "0" (
v®
));

56  
v®
;

58 
	}
}

59 
	#__¬ch_swab64
 
__¬ch_swab64


	)

	@/usr/include/asm-generic/bitsperlong.h

1 #iâdeà
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #iâdeà
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@
1
.
1
/usr/include
129
2904
associola.c
auth.c
auth.h
bind_addr.c
checksum.h
chunk.c
command.c
command.h
constants.h
debug.c
endpointola.c
input.c
inqueue.c
ipv6.c
net_namespace.h
objcnt.c
output.c
outqueue.c
primitive.c
probe.c
proc.c
protocol.c
sctp.h
sm.h
sm_make_chunk.c
sm_sideeffect.c
sm_statefuns.c
sm_statetable.c
socket.c
ssnmap.c
structs.h
sysctl.c
transport.c
tsnmap.c
tsnmap.h
ulpevent.c
ulpevent.h
ulpqueue.c
ulpqueue.h
user.h
/usr/include/asm/param.h
/usr/include/linux/capability.h
/usr/include/linux/errno.h
/usr/include/linux/fcntl.h
/usr/include/linux/icmpv6.h
/usr/include/linux/in.h
/usr/include/linux/in6.h
/usr/include/linux/ip.h
/usr/include/linux/ipsec.h
/usr/include/linux/ipv6.h
/usr/include/linux/kernel.h
/usr/include/linux/net.h
/usr/include/linux/netdevice.h
/usr/include/linux/poll.h
/usr/include/linux/random.h
/usr/include/linux/sched.h
/usr/include/linux/socket.h
/usr/include/linux/sockios.h
/usr/include/linux/sysctl.h
/usr/include/linux/time.h
/usr/include/linux/tty.h
/usr/include/linux/types.h
/usr/include/linux/wait.h
/usr/include/net/route.h
/usr/include/asm-generic/param.h
/usr/include/asm/byteorder.h
/usr/include/asm/errno.h
/usr/include/asm/fcntl.h
/usr/include/asm/poll.h
/usr/include/asm/socket.h
/usr/include/asm/sockios.h
/usr/include/asm/types.h
/usr/include/bits/wordsize.h
/usr/include/features.h
/usr/include/linux/if.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_link.h
/usr/include/linux/if_packet.h
/usr/include/linux/ioctl.h
/usr/include/linux/irqnr.h
/usr/include/linux/libc-compat.h
/usr/include/linux/pfkeyv2.h
/usr/include/linux/posix_types.h
/usr/include/netinet/in.h
/usr/include/sys/socket.h
/usr/include/sys/types.h
/usr/include/asm-generic/errno.h
/usr/include/asm-generic/fcntl.h
/usr/include/asm-generic/poll.h
/usr/include/asm-generic/socket.h
/usr/include/asm-generic/sockios.h
/usr/include/asm-generic/types.h
/usr/include/asm/ioctl.h
/usr/include/asm/posix_types.h
/usr/include/bits/byteswap.h
/usr/include/bits/in.h
/usr/include/bits/pthreadtypes.h
/usr/include/bits/sigset.h
/usr/include/bits/socket.h
/usr/include/bits/socket2.h
/usr/include/bits/types.h
/usr/include/endian.h
/usr/include/gnu/stubs.h
/usr/include/linux/byteorder/little_endian.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/netlink.h
/usr/include/linux/stddef.h
/usr/include/stdint.h
/usr/include/sys/cdefs.h
/usr/include/sys/select.h
/usr/include/sys/sysmacros.h
/usr/include/sys/uio.h
/usr/include/time.h
/usr/include/asm-generic/errno-base.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm-generic/ioctl.h
/usr/include/bits/endian.h
/usr/include/bits/select.h
/usr/include/bits/sockaddr.h
/usr/include/bits/time.h
/usr/include/bits/typesizes.h
/usr/include/bits/uio.h
/usr/include/bits/wchar.h
/usr/include/gnu/stubs-64.h
/usr/include/linux/swab.h
/usr/include/xlocale.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/swab.h
/usr/include/asm-generic/bitsperlong.h
